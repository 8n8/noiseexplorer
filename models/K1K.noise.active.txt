File "K1K.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1K.noise.active.pv", line 270, characters 7-8:
Warning: identifier ck rebound.
File "K1K.noise.active.pv", line 271, characters 7-8:
Warning: identifier cs rebound.
File "K1K.noise.active.pv", line 271, character 36:
Warning: identifier h rebound.
File "K1K.noise.active.pv", line 280, characters 7-8:
Warning: identifier cs rebound.
File "K1K.noise.active.pv", line 281, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 286, characters 7-8:
Warning: identifier cs rebound.
File "K1K.noise.active.pv", line 287, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 301, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 302, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 307, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 308, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 314, character 6:
Warning: identifier e rebound.
File "K1K.noise.active.pv", line 315, characters 6-7:
Warning: identifier ne rebound.
File "K1K.noise.active.pv", line 316, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 318, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 319, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 319, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1K.noise.active.pv", line 320, characters 6-7:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 327, character 6:
Warning: identifier e rebound.
File "K1K.noise.active.pv", line 328, characters 6-7:
Warning: identifier ne rebound.
File "K1K.noise.active.pv", line 329, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 331, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 332, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 332, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1K.noise.active.pv", line 333, characters 6-7:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 340, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 341, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 341, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1K.noise.active.pv", line 342, characters 6-7:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 351, characters 6-7:
Warning: identifier re rebound.
File "K1K.noise.active.pv", line 352, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 354, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 355, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 357, characters 7-8:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 365, characters 6-7:
Warning: identifier re rebound.
File "K1K.noise.active.pv", line 366, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 368, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 369, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 371, characters 7-8:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 379, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 380, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 382, characters 7-8:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 504, characters 8-9:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 340, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 341, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 341, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1K.noise.active.pv", line 342, characters 6-7:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1K.noise.active.pv", line 280, characters 7-8:
Warning: identifier cs rebound.
File "K1K.noise.active.pv", line 281, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 497, characters 8-9:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 365, characters 6-7:
Warning: identifier re rebound.
File "K1K.noise.active.pv", line 366, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 368, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 369, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 371, characters 7-8:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1K.noise.active.pv", line 286, characters 7-8:
Warning: identifier cs rebound.
File "K1K.noise.active.pv", line 287, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 489, characters 8-9:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 314, character 6:
Warning: identifier e rebound.
File "K1K.noise.active.pv", line 315, characters 6-7:
Warning: identifier ne rebound.
File "K1K.noise.active.pv", line 316, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 318, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 319, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 319, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1K.noise.active.pv", line 320, characters 6-7:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1K.noise.active.pv", line 280, characters 7-8:
Warning: identifier cs rebound.
File "K1K.noise.active.pv", line 281, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 301, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 302, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 547, characters 8-9:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 379, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 380, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 382, characters 7-8:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1K.noise.active.pv", line 286, characters 7-8:
Warning: identifier cs rebound.
File "K1K.noise.active.pv", line 287, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 539, characters 8-9:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 327, character 6:
Warning: identifier e rebound.
File "K1K.noise.active.pv", line 328, characters 6-7:
Warning: identifier ne rebound.
File "K1K.noise.active.pv", line 329, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 331, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 332, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 332, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1K.noise.active.pv", line 333, characters 6-7:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1K.noise.active.pv", line 280, characters 7-8:
Warning: identifier cs rebound.
File "K1K.noise.active.pv", line 281, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 532, characters 8-9:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 351, characters 6-7:
Warning: identifier re rebound.
File "K1K.noise.active.pv", line 352, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 354, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 355, characters 7-8:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 357, characters 7-8:
Warning: identifier hs rebound.
File "K1K.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1K.noise.active.pv", line 286, characters 7-8:
Warning: identifier cs rebound.
File "K1K.noise.active.pv", line 287, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 307, characters 6-7:
Warning: identifier ss rebound.
File "K1K.noise.active.pv", line 308, characters 6-7:
Warning: identifier ss rebound.
Linear part:
dhexp(b_49,dhexp(a_48,g)) = dhexp(a_48,dhexp(b_49,g))
Completing equations...
Completed equations:
dhexp(b_49,dhexp(a_48,g)) = dhexp(a_48,dhexp(b_49,g))
Convergent part:
Completing equations...
Completed equations:
Process:
{1}!
(
    {2}let v_433: key = catch-fail(dhexp(key_s(alice),g)) in
    {3}let s_434: keypair = (if not-caught-fail(v_433) then keypairpack(v_433,key_s(alice)) else fail-any) in
    {4}out(pub, getpublickey(s_434));
    (
        {5}let e_435: keypair = keypairpack(empty,empty) in
        {6}let v_436: key = catch-fail(dhexp(key_s(bob),g)) in
        {7}let rs_437: key = getpublickey((if not-caught-fail(v_436) then keypairpack(v_436,key_s(bob)) else fail-any)) in
        {8}let re_438: key = empty in
        {9}let v_439: bitstring = catch-fail(hash(somename,empty)) in
        {10}let v_440: key = catch-fail(v_439) in
        {11}let v_441: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {12}let v_442: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_439) then (if not-caught-fail(v_440) then (if not-caught-fail(v_441) then symmetricstatepack(v_441,v_440,v_439) else fail-any) else fail-any) else fail-any))) in
        {13}let v_443: symmetricstate = catch-fail((if success?((if not-caught-fail(v_439) then (if not-caught-fail(v_440) then (if not-caught-fail(v_441) then symmetricstatepack(v_441,v_440,v_439) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_442) && success?(is-true(success?(1-proj-3-tuple(v_442))))) then symmetricstatepack(1-proj-3-tuple(v_442),2-proj-3-tuple(v_442),hash(3-proj-3-tuple(v_442),empty)) else fail-any) else fail-any)) in
        {14}let v_444: bitstring = catch-fail(symmetricstateunpack(v_443)) in
        {15}let v_445: symmetricstate = catch-fail((if success?(getpublickey(s_434)) then (if (not-caught-fail(v_444) && success?(is-true(success?(1-proj-3-tuple(v_444))))) then symmetricstatepack(1-proj-3-tuple(v_444),2-proj-3-tuple(v_444),hash(3-proj-3-tuple(v_444),getpublickey(s_434))) else fail-any) else fail-any)) in
        {16}let v_446: bitstring = catch-fail(symmetricstateunpack(v_445)) in
        {17}let v_447: symmetricstate = catch-fail((if (not-caught-fail(v_446) && success?(is-true(success?(1-proj-3-tuple(v_446))))) then symmetricstatepack(1-proj-3-tuple(v_446),2-proj-3-tuple(v_446),hash(3-proj-3-tuple(v_446),rs_437)) else fail-any)) in
        {18}let hs: handshakestate = (if not-caught-fail(v_443) then (if not-caught-fail(v_445) then (if not-caught-fail(v_447) then handshakestatepack(v_447,s_434,e_435,rs_437,re_438,empty,true) else fail-any) else fail-any) else fail-any) in
        {19}insert statestore(alice,bob,statepack_a(hs))
    ) | (
        {49}get statestore(=alice,=bob,statepack_a(hs_448: handshakestate)) in
        {20}let v_449: bitstring = catch-fail(handshakestateunpack(hs_448)) in
        {21}let v_450: bitstring = catch-fail((empty,empty,empty)) in
        {22}let v_451: key = catch-fail(dhexp(key_e(alice,bob),g)) in
        {23}let v_452: keypair = catch-fail((if not-caught-fail(v_451) then keypairpack(v_451,key_e(alice,bob)) else fail-any)) in
        {24}let v_453: bitstring = catch-fail(getpublickey(v_452)) in
        {25}let v_454: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_449))) in
        {26}let v_455: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_449)) then (if (not-caught-fail(v_454) && success?(is-true(success?(1-proj-3-tuple(v_454))))) then symmetricstatepack(1-proj-3-tuple(v_454),2-proj-3-tuple(v_454),hash(3-proj-3-tuple(v_454),v_453)) else fail-any) else fail-any)) in
        {27}let v_456: bitstring = catch-fail(keypairunpack(v_452)) in
        {28}let v_457: bitstring = catch-fail(symmetricstateunpack(v_455)) in
        {29}let v_458: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_457),(if success?(4-proj-7-tuple(v_449)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),4-proj-7-tuple(v_449)) else fail-any) else fail-any))) in
        {30}let v_459: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_457),(if success?(4-proj-7-tuple(v_449)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),4-proj-7-tuple(v_449)) else fail-any) else fail-any))) in
        {31}let v_460: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_457),(if success?(4-proj-7-tuple(v_449)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),4-proj-7-tuple(v_449)) else fail-any) else fail-any))) in
        {32}let v_461: bitstring = catch-fail((if (success?((if success?(4-proj-7-tuple(v_449)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),4-proj-7-tuple(v_449)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_457))) then (if not-caught-fail(v_458) then (if not-caught-fail(v_459) then (if not-caught-fail(v_460) then (v_458,v_459,v_460) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {33}let v_462: symmetricstate = catch-fail((if success?((if success?(4-proj-7-tuple(v_449)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),4-proj-7-tuple(v_449)) else fail-any) else fail-any)) then (if (not-caught-fail(v_457) && success?(is-true(success?(1-proj-3-tuple(v_457))))) then (if (not-caught-fail(v_461) && success?(is-true(success?(1-proj-3-tuple(v_461))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_461)) then cipherstatepack(2-proj-3-tuple(v_461),minnonce) else fail-any),1-proj-3-tuple(v_461),3-proj-3-tuple(v_457)) else fail-any) else fail-any) else fail-any)) in
        {34}let v_463: bitstring = catch-fail(symmetricstateunpack(v_462)) in
        {35}let v_464: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_463))) in
        {36}let v_465: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_464),2-proj-2-tuple(v_464),3-proj-3-tuple(v_463),msg_a(alice,bob))) in
        {37}let v_466: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_463))) in
        {38}let v_467: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_464))) && success?(1-proj-3-tuple(v_463))) then (if (not-caught-fail(v_466) && success?(is-true(success?(1-proj-2-tuple(v_466))))) then cipherstatepack(1-proj-2-tuple(v_466),increment_nonce(2-proj-2-tuple(v_464))) else fail-any) else fail-any)) in
        {39}let v_468: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_463)) && success?(1-proj-3-tuple(v_463))) then (if (not-caught-fail(v_464) && success?(is-true(success?(1-proj-2-tuple(v_464))))) then (if not-caught-fail(v_465) then (if not-caught-fail(v_467) then (v_467,v_465) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {40}let v_469: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_468),2-proj-3-tuple(v_463),3-proj-3-tuple(v_463)))) in
        {41}let v_470: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_468)) && success?(symmetricstatepack(1-proj-2-tuple(v_468),2-proj-3-tuple(v_463),3-proj-3-tuple(v_463)))) then (if (not-caught-fail(v_469) && success?(is-true(success?(1-proj-3-tuple(v_469))))) then symmetricstatepack(1-proj-3-tuple(v_469),2-proj-3-tuple(v_469),hash(3-proj-3-tuple(v_469),2-proj-2-tuple(v_468))) else fail-any) else fail-any)) in
        {42}let v_471: bitstring = catch-fail((if (not-caught-fail(v_463) && success?(is-true(success?(1-proj-3-tuple(v_463))))) then (if (not-caught-fail(v_468) && success?(is-true(success?(1-proj-2-tuple(v_468))))) then (if not-caught-fail(v_470) then (v_470,2-proj-2-tuple(v_468)) else fail-any) else fail-any) else fail-any)) in
        {43}let v_472: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_471),2-proj-7-tuple(v_449),v_452,4-proj-7-tuple(v_449),5-proj-7-tuple(v_449),6-proj-7-tuple(v_449),7-proj-7-tuple(v_449))) in
        {44}let v_473: bitstring = catch-fail(concat3(v_453,2-proj-3-tuple(v_450),2-proj-2-tuple(v_471))) in
        {45}let (hs_474: handshakestate,re_475: key,message_a: bitstring) = (if (not-caught-fail(v_449) && success?(is-true(success?(1-proj-7-tuple(v_449))))) then (if (not-caught-fail(v_450) && success?(is-true(success?(1-proj-3-tuple(v_450))))) then (if not-caught-fail(v_452) then (if not-caught-fail(v_453) then (if not-caught-fail(v_455) then (if not-caught-fail(v_462) then (if (not-caught-fail(v_471) && success?(is-true(success?(1-proj-2-tuple(v_471))))) then (if not-caught-fail(v_472) then (if not-caught-fail(v_473) then (v_472,5-proj-7-tuple(v_449),v_473) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {46}event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true);
        {47}insert statestore(alice,bob,statepack_b(hs_474));
        {48}out(pub, message_a)
    ) | (
        {78}get statestore(=alice,=bob,statepack_b(hs_476: handshakestate)) in
        {50}in(pub, message_b: bitstring);
        {51}let v_477: bitstring = catch-fail(handshakestateunpack(hs_476)) in
        {52}let v_478: bitstring = catch-fail(deconcat3(message_b)) in
        {53}let v_479: bool = catch-fail(true) in
        {54}let v_480: key = catch-fail(1-proj-3-tuple(v_478)) in
        {55}let v_481: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_477))) in
        {56}let v_482: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_477)) then (if (not-caught-fail(v_481) && success?(is-true(success?(1-proj-3-tuple(v_481))))) then symmetricstatepack(1-proj-3-tuple(v_481),2-proj-3-tuple(v_481),hash(3-proj-3-tuple(v_481),v_480)) else fail-any) else fail-any)) in
        {57}let v_483: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_477))) in
        {58}let v_484: bitstring = catch-fail(symmetricstateunpack(v_482)) in
        {59}let v_485: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_484),(if success?(3-proj-7-tuple(v_477)) then (if (not-caught-fail(v_483) && success?(is-true(success?(1-proj-2-tuple(v_483))))) then dhexp(2-proj-2-tuple(v_483),v_480) else fail-any) else fail-any))) in
        {60}let v_486: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_484),(if success?(3-proj-7-tuple(v_477)) then (if (not-caught-fail(v_483) && success?(is-true(success?(1-proj-2-tuple(v_483))))) then dhexp(2-proj-2-tuple(v_483),v_480) else fail-any) else fail-any))) in
        {61}let v_487: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_484),(if success?(3-proj-7-tuple(v_477)) then (if (not-caught-fail(v_483) && success?(is-true(success?(1-proj-2-tuple(v_483))))) then dhexp(2-proj-2-tuple(v_483),v_480) else fail-any) else fail-any))) in
        {62}let v_488: bitstring = catch-fail((if (success?((if success?(3-proj-7-tuple(v_477)) then (if (not-caught-fail(v_483) && success?(is-true(success?(1-proj-2-tuple(v_483))))) then dhexp(2-proj-2-tuple(v_483),v_480) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_484))) then (if not-caught-fail(v_485) then (if not-caught-fail(v_486) then (if not-caught-fail(v_487) then (v_485,v_486,v_487) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {63}let v_489: symmetricstate = catch-fail((if success?((if success?(3-proj-7-tuple(v_477)) then (if (not-caught-fail(v_483) && success?(is-true(success?(1-proj-2-tuple(v_483))))) then dhexp(2-proj-2-tuple(v_483),v_480) else fail-any) else fail-any)) then (if (not-caught-fail(v_484) && success?(is-true(success?(1-proj-3-tuple(v_484))))) then (if (not-caught-fail(v_488) && success?(is-true(success?(1-proj-3-tuple(v_488))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_488)) then cipherstatepack(2-proj-3-tuple(v_488),minnonce) else fail-any),1-proj-3-tuple(v_488),3-proj-3-tuple(v_484)) else fail-any) else fail-any) else fail-any)) in
        {64}let v_490: bitstring = catch-fail(symmetricstateunpack(v_489)) in
        {65}let v_491: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_490))) in
        {66}let v_492: aead = catch-fail(decrypt(1-proj-2-tuple(v_491),2-proj-2-tuple(v_491),3-proj-3-tuple(v_490),3-proj-3-tuple(v_478))) in
        {67}let v_493: bitstring = catch-fail(aeadunpack(v_492)) in
        {68}let v_494: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_490))) in
        {69}let v_495: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_491))) && success?(1-proj-3-tuple(v_490))) then (if (not-caught-fail(v_494) && success?(is-true(success?(1-proj-2-tuple(v_494))))) then cipherstatepack(1-proj-2-tuple(v_494),increment_nonce(2-proj-2-tuple(v_491))) else fail-any) else fail-any)) in
        {70}let v_496: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_478)) && (success?(3-proj-3-tuple(v_490)) && success?(1-proj-3-tuple(v_490)))) then (if (not-caught-fail(v_491) && success?(is-true(success?(1-proj-2-tuple(v_491))))) then (if not-caught-fail(v_492) then (if (not-caught-fail(v_493) && success?(is-true(success?(1-proj-3-tuple(v_493))))) then (if not-caught-fail(v_495) then (v_495,3-proj-3-tuple(v_493),1-proj-3-tuple(v_493)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {71}let v_497: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_496),2-proj-3-tuple(v_490),3-proj-3-tuple(v_490)))) in
        {72}let v_498: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_478)) && success?(symmetricstatepack(1-proj-3-tuple(v_496),2-proj-3-tuple(v_490),3-proj-3-tuple(v_490)))) then (if (not-caught-fail(v_497) && success?(is-true(success?(1-proj-3-tuple(v_497))))) then symmetricstatepack(1-proj-3-tuple(v_497),2-proj-3-tuple(v_497),hash(3-proj-3-tuple(v_497),3-proj-3-tuple(v_478))) else fail-any) else fail-any)) in
        {73}let v_499: bitstring = catch-fail((if success?(3-proj-3-tuple(v_478)) then (if (not-caught-fail(v_490) && success?(is-true(success?(1-proj-3-tuple(v_490))))) then (if (not-caught-fail(v_496) && success?(is-true(success?(1-proj-3-tuple(v_496))))) then (if not-caught-fail(v_498) then (v_498,2-proj-3-tuple(v_496),3-proj-3-tuple(v_496)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {74}let v_500: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_499),2-proj-7-tuple(v_477),3-proj-7-tuple(v_477),4-proj-7-tuple(v_477),v_480,6-proj-7-tuple(v_477),7-proj-7-tuple(v_477))) in
        {75}let (hs_501: handshakestate,re_502: key,plaintext_b: bitstring,valid: bool) = (if (not-caught-fail(v_477) && success?(is-true(success?(1-proj-7-tuple(v_477))))) then (if (not-caught-fail(v_478) && success?(is-true(success?(1-proj-3-tuple(v_478))))) then (if not-caught-fail(v_479) then (if not-caught-fail(v_480) then (if not-caught-fail(v_482) then (if not-caught-fail(v_489) then (if (not-caught-fail(v_499) && success?(is-true(success?(1-proj-3-tuple(v_499))))) then (if (v_479 && 3-proj-3-tuple(v_499)) then (if not-caught-fail(v_500) then (v_500,getpublickey(3-proj-7-tuple(v_477)),2-proj-3-tuple(v_499),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {76}event RecvMsg(alice,bob,stage_b,plaintext_b,valid);
        {77}insert statestore(alice,bob,statepack_c(hs_501))
    ) | (
        {111}get statestore(=alice,=bob,statepack_c(hs_503: handshakestate)) in
        {79}let v_504: bitstring = catch-fail(handshakestateunpack(hs_503)) in
        {80}let v_505: bitstring = catch-fail((empty,empty,empty)) in
        {81}let v_506: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_504))) in
        {82}let v_507: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_504))) in
        {83}let v_508: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_507),(if (success?(5-proj-7-tuple(v_504)) && success?(2-proj-7-tuple(v_504))) then (if (not-caught-fail(v_506) && success?(is-true(success?(1-proj-2-tuple(v_506))))) then dhexp(2-proj-2-tuple(v_506),5-proj-7-tuple(v_504)) else fail-any) else fail-any))) in
        {84}let v_509: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_507),(if (success?(5-proj-7-tuple(v_504)) && success?(2-proj-7-tuple(v_504))) then (if (not-caught-fail(v_506) && success?(is-true(success?(1-proj-2-tuple(v_506))))) then dhexp(2-proj-2-tuple(v_506),5-proj-7-tuple(v_504)) else fail-any) else fail-any))) in
        {85}let v_510: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_507),(if (success?(5-proj-7-tuple(v_504)) && success?(2-proj-7-tuple(v_504))) then (if (not-caught-fail(v_506) && success?(is-true(success?(1-proj-2-tuple(v_506))))) then dhexp(2-proj-2-tuple(v_506),5-proj-7-tuple(v_504)) else fail-any) else fail-any))) in
        {86}let v_511: bitstring = catch-fail((if (success?((if (success?(5-proj-7-tuple(v_504)) && success?(2-proj-7-tuple(v_504))) then (if (not-caught-fail(v_506) && success?(is-true(success?(1-proj-2-tuple(v_506))))) then dhexp(2-proj-2-tuple(v_506),5-proj-7-tuple(v_504)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_507))) then (if not-caught-fail(v_508) then (if not-caught-fail(v_509) then (if not-caught-fail(v_510) then (v_508,v_509,v_510) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {87}let v_512: symmetricstate = catch-fail((if (success?((if (success?(5-proj-7-tuple(v_504)) && success?(2-proj-7-tuple(v_504))) then (if (not-caught-fail(v_506) && success?(is-true(success?(1-proj-2-tuple(v_506))))) then dhexp(2-proj-2-tuple(v_506),5-proj-7-tuple(v_504)) else fail-any) else fail-any)) && success?(1-proj-7-tuple(v_504))) then (if (not-caught-fail(v_507) && success?(is-true(success?(1-proj-3-tuple(v_507))))) then (if (not-caught-fail(v_511) && success?(is-true(success?(1-proj-3-tuple(v_511))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_511)) then cipherstatepack(2-proj-3-tuple(v_511),minnonce) else fail-any),1-proj-3-tuple(v_511),3-proj-3-tuple(v_507)) else fail-any) else fail-any) else fail-any)) in
        {88}let v_513: bitstring = catch-fail(symmetricstateunpack(v_512)) in
        {89}let v_514: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_513))) in
        {90}let v_515: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_514),2-proj-2-tuple(v_514),3-proj-3-tuple(v_513),msg_c(alice,bob))) in
        {91}let v_516: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_513))) in
        {92}let v_517: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_514))) && success?(1-proj-3-tuple(v_513))) then (if (not-caught-fail(v_516) && success?(is-true(success?(1-proj-2-tuple(v_516))))) then cipherstatepack(1-proj-2-tuple(v_516),increment_nonce(2-proj-2-tuple(v_514))) else fail-any) else fail-any)) in
        {93}let v_518: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_513)) && success?(1-proj-3-tuple(v_513))) then (if (not-caught-fail(v_514) && success?(is-true(success?(1-proj-2-tuple(v_514))))) then (if not-caught-fail(v_515) then (if not-caught-fail(v_517) then (v_517,v_515) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {94}let v_519: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_518),2-proj-3-tuple(v_513),3-proj-3-tuple(v_513)))) in
        {95}let v_520: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_518)) && success?(symmetricstatepack(1-proj-2-tuple(v_518),2-proj-3-tuple(v_513),3-proj-3-tuple(v_513)))) then (if (not-caught-fail(v_519) && success?(is-true(success?(1-proj-3-tuple(v_519))))) then symmetricstatepack(1-proj-3-tuple(v_519),2-proj-3-tuple(v_519),hash(3-proj-3-tuple(v_519),2-proj-2-tuple(v_518))) else fail-any) else fail-any)) in
        {96}let v_521: bitstring = catch-fail((if (not-caught-fail(v_513) && success?(is-true(success?(1-proj-3-tuple(v_513))))) then (if (not-caught-fail(v_518) && success?(is-true(success?(1-proj-2-tuple(v_518))))) then (if not-caught-fail(v_520) then (v_520,2-proj-2-tuple(v_518)) else fail-any) else fail-any) else fail-any)) in
        {97}let v_522: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_521),2-proj-7-tuple(v_504),3-proj-7-tuple(v_504),4-proj-7-tuple(v_504),5-proj-7-tuple(v_504),6-proj-7-tuple(v_504),7-proj-7-tuple(v_504))) in
        {98}let v_523: bitstring = catch-fail(concat3(1-proj-3-tuple(v_505),2-proj-3-tuple(v_505),2-proj-2-tuple(v_521))) in
        {99}let v_524: bitstring = catch-fail(symmetricstateunpack(1-proj-2-tuple(v_521))) in
        {100}let v_525: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_524),zero)) in
        {101}let v_526: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_524),zero)) in
        {102}let v_527: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_524),zero)) in
        {103}let v_528: bitstring = catch-fail((if success?(2-proj-3-tuple(v_524)) then (if not-caught-fail(v_525) then (if not-caught-fail(v_526) then (if not-caught-fail(v_527) then (v_525,v_526,v_527) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {104}let v_529: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_528)) then cipherstatepack(1-proj-3-tuple(v_528),minnonce) else fail-any)) in
        {105}let v_530: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_528)) then cipherstatepack(2-proj-3-tuple(v_528),minnonce) else fail-any)) in
        {106}let v_531: bitstring = catch-fail((if success?(1-proj-2-tuple(v_521)) then (if (not-caught-fail(v_524) && success?(is-true(success?(1-proj-3-tuple(v_524))))) then (if (not-caught-fail(v_528) && success?(is-true(success?(1-proj-3-tuple(v_528))))) then (if not-caught-fail(v_529) then (if not-caught-fail(v_530) then (1-proj-2-tuple(v_521),v_529,v_530) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {107}let (hs_532: handshakestate,re_533: key,message_c: bitstring,cs1: cipherstate,cs2: cipherstate) = (if (not-caught-fail(v_504) && success?(is-true(success?(1-proj-7-tuple(v_504))))) then (if (not-caught-fail(v_505) && success?(is-true(success?(1-proj-3-tuple(v_505))))) then (if not-caught-fail(v_512) then (if (not-caught-fail(v_521) && success?(is-true(success?(1-proj-2-tuple(v_521))))) then (if not-caught-fail(v_522) then (if not-caught-fail(v_523) then (if (not-caught-fail(v_531) && success?(is-true(success?(1-proj-3-tuple(v_531))))) then (v_522,5-proj-7-tuple(v_504),v_523,2-proj-3-tuple(v_531),3-proj-3-tuple(v_531)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {108}event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true);
        {109}insert statestore(alice,bob,statepack_d(hs_532));
        {110}out(pub, message_c)
    ) | (
        {112}event LeakS(phase0,alice);
        {113}out(pub, key_s(alice))
    ) | (
        {114}phase 1;
        {115}event LeakS(phase1,alice);
        {116}out(pub, key_s(alice))
    )
) | (
    {117}let v_534: key = catch-fail(dhexp(key_s(alice),g)) in
    {118}let s_535: keypair = (if not-caught-fail(v_534) then keypairpack(v_534,key_s(alice)) else fail-any) in
    {119}out(pub, getpublickey(s_535));
    (
        {120}let e_536: keypair = keypairpack(empty,empty) in
        {121}let v_537: key = catch-fail(dhexp(key_s(charlie),g)) in
        {122}let rs_538: key = getpublickey((if not-caught-fail(v_537) then keypairpack(v_537,key_s(charlie)) else fail-any)) in
        {123}let re_539: key = empty in
        {124}let v_540: bitstring = catch-fail(hash(somename,empty)) in
        {125}let v_541: key = catch-fail(v_540) in
        {126}let v_542: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {127}let v_543: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_540) then (if not-caught-fail(v_541) then (if not-caught-fail(v_542) then symmetricstatepack(v_542,v_541,v_540) else fail-any) else fail-any) else fail-any))) in
        {128}let v_544: symmetricstate = catch-fail((if success?((if not-caught-fail(v_540) then (if not-caught-fail(v_541) then (if not-caught-fail(v_542) then symmetricstatepack(v_542,v_541,v_540) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_543) && success?(is-true(success?(1-proj-3-tuple(v_543))))) then symmetricstatepack(1-proj-3-tuple(v_543),2-proj-3-tuple(v_543),hash(3-proj-3-tuple(v_543),empty)) else fail-any) else fail-any)) in
        {129}let v_545: bitstring = catch-fail(symmetricstateunpack(v_544)) in
        {130}let v_546: symmetricstate = catch-fail((if success?(getpublickey(s_535)) then (if (not-caught-fail(v_545) && success?(is-true(success?(1-proj-3-tuple(v_545))))) then symmetricstatepack(1-proj-3-tuple(v_545),2-proj-3-tuple(v_545),hash(3-proj-3-tuple(v_545),getpublickey(s_535))) else fail-any) else fail-any)) in
        {131}let v_547: bitstring = catch-fail(symmetricstateunpack(v_546)) in
        {132}let v_548: symmetricstate = catch-fail((if (not-caught-fail(v_547) && success?(is-true(success?(1-proj-3-tuple(v_547))))) then symmetricstatepack(1-proj-3-tuple(v_547),2-proj-3-tuple(v_547),hash(3-proj-3-tuple(v_547),rs_538)) else fail-any)) in
        {133}let hs_549: handshakestate = (if not-caught-fail(v_544) then (if not-caught-fail(v_546) then (if not-caught-fail(v_548) then handshakestatepack(v_548,s_535,e_536,rs_538,re_539,empty,true) else fail-any) else fail-any) else fail-any) in
        {134}insert statestore(alice,charlie,statepack_a(hs_549))
    ) | (
        {164}get statestore(=alice,=charlie,statepack_a(hs_550: handshakestate)) in
        {135}let v_551: bitstring = catch-fail(handshakestateunpack(hs_550)) in
        {136}let v_552: bitstring = catch-fail((empty,empty,empty)) in
        {137}let v_553: key = catch-fail(dhexp(key_e(alice,charlie),g)) in
        {138}let v_554: keypair = catch-fail((if not-caught-fail(v_553) then keypairpack(v_553,key_e(alice,charlie)) else fail-any)) in
        {139}let v_555: bitstring = catch-fail(getpublickey(v_554)) in
        {140}let v_556: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_551))) in
        {141}let v_557: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_551)) then (if (not-caught-fail(v_556) && success?(is-true(success?(1-proj-3-tuple(v_556))))) then symmetricstatepack(1-proj-3-tuple(v_556),2-proj-3-tuple(v_556),hash(3-proj-3-tuple(v_556),v_555)) else fail-any) else fail-any)) in
        {142}let v_558: bitstring = catch-fail(keypairunpack(v_554)) in
        {143}let v_559: bitstring = catch-fail(symmetricstateunpack(v_557)) in
        {144}let v_560: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_559),(if success?(4-proj-7-tuple(v_551)) then (if (not-caught-fail(v_558) && success?(is-true(success?(1-proj-2-tuple(v_558))))) then dhexp(2-proj-2-tuple(v_558),4-proj-7-tuple(v_551)) else fail-any) else fail-any))) in
        {145}let v_561: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_559),(if success?(4-proj-7-tuple(v_551)) then (if (not-caught-fail(v_558) && success?(is-true(success?(1-proj-2-tuple(v_558))))) then dhexp(2-proj-2-tuple(v_558),4-proj-7-tuple(v_551)) else fail-any) else fail-any))) in
        {146}let v_562: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_559),(if success?(4-proj-7-tuple(v_551)) then (if (not-caught-fail(v_558) && success?(is-true(success?(1-proj-2-tuple(v_558))))) then dhexp(2-proj-2-tuple(v_558),4-proj-7-tuple(v_551)) else fail-any) else fail-any))) in
        {147}let v_563: bitstring = catch-fail((if (success?((if success?(4-proj-7-tuple(v_551)) then (if (not-caught-fail(v_558) && success?(is-true(success?(1-proj-2-tuple(v_558))))) then dhexp(2-proj-2-tuple(v_558),4-proj-7-tuple(v_551)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_559))) then (if not-caught-fail(v_560) then (if not-caught-fail(v_561) then (if not-caught-fail(v_562) then (v_560,v_561,v_562) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {148}let v_564: symmetricstate = catch-fail((if success?((if success?(4-proj-7-tuple(v_551)) then (if (not-caught-fail(v_558) && success?(is-true(success?(1-proj-2-tuple(v_558))))) then dhexp(2-proj-2-tuple(v_558),4-proj-7-tuple(v_551)) else fail-any) else fail-any)) then (if (not-caught-fail(v_559) && success?(is-true(success?(1-proj-3-tuple(v_559))))) then (if (not-caught-fail(v_563) && success?(is-true(success?(1-proj-3-tuple(v_563))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_563)) then cipherstatepack(2-proj-3-tuple(v_563),minnonce) else fail-any),1-proj-3-tuple(v_563),3-proj-3-tuple(v_559)) else fail-any) else fail-any) else fail-any)) in
        {149}let v_565: bitstring = catch-fail(symmetricstateunpack(v_564)) in
        {150}let v_566: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_565))) in
        {151}let v_567: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_566),2-proj-2-tuple(v_566),3-proj-3-tuple(v_565),msg_a(alice,charlie))) in
        {152}let v_568: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_565))) in
        {153}let v_569: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_566))) && success?(1-proj-3-tuple(v_565))) then (if (not-caught-fail(v_568) && success?(is-true(success?(1-proj-2-tuple(v_568))))) then cipherstatepack(1-proj-2-tuple(v_568),increment_nonce(2-proj-2-tuple(v_566))) else fail-any) else fail-any)) in
        {154}let v_570: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_565)) && success?(1-proj-3-tuple(v_565))) then (if (not-caught-fail(v_566) && success?(is-true(success?(1-proj-2-tuple(v_566))))) then (if not-caught-fail(v_567) then (if not-caught-fail(v_569) then (v_569,v_567) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {155}let v_571: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_570),2-proj-3-tuple(v_565),3-proj-3-tuple(v_565)))) in
        {156}let v_572: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_570)) && success?(symmetricstatepack(1-proj-2-tuple(v_570),2-proj-3-tuple(v_565),3-proj-3-tuple(v_565)))) then (if (not-caught-fail(v_571) && success?(is-true(success?(1-proj-3-tuple(v_571))))) then symmetricstatepack(1-proj-3-tuple(v_571),2-proj-3-tuple(v_571),hash(3-proj-3-tuple(v_571),2-proj-2-tuple(v_570))) else fail-any) else fail-any)) in
        {157}let v_573: bitstring = catch-fail((if (not-caught-fail(v_565) && success?(is-true(success?(1-proj-3-tuple(v_565))))) then (if (not-caught-fail(v_570) && success?(is-true(success?(1-proj-2-tuple(v_570))))) then (if not-caught-fail(v_572) then (v_572,2-proj-2-tuple(v_570)) else fail-any) else fail-any) else fail-any)) in
        {158}let v_574: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_573),2-proj-7-tuple(v_551),v_554,4-proj-7-tuple(v_551),5-proj-7-tuple(v_551),6-proj-7-tuple(v_551),7-proj-7-tuple(v_551))) in
        {159}let v_575: bitstring = catch-fail(concat3(v_555,2-proj-3-tuple(v_552),2-proj-2-tuple(v_573))) in
        {160}let (hs_576: handshakestate,re_577: key,message_a_578: bitstring) = (if (not-caught-fail(v_551) && success?(is-true(success?(1-proj-7-tuple(v_551))))) then (if (not-caught-fail(v_552) && success?(is-true(success?(1-proj-3-tuple(v_552))))) then (if not-caught-fail(v_554) then (if not-caught-fail(v_555) then (if not-caught-fail(v_557) then (if not-caught-fail(v_564) then (if (not-caught-fail(v_573) && success?(is-true(success?(1-proj-2-tuple(v_573))))) then (if not-caught-fail(v_574) then (if not-caught-fail(v_575) then (v_574,5-proj-7-tuple(v_551),v_575) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {161}event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true);
        {162}insert statestore(alice,charlie,statepack_b(hs_576));
        {163}out(pub, message_a_578)
    ) | (
        {193}get statestore(=alice,=charlie,statepack_b(hs_579: handshakestate)) in
        {165}in(pub, message_b_580: bitstring);
        {166}let v_581: bitstring = catch-fail(handshakestateunpack(hs_579)) in
        {167}let v_582: bitstring = catch-fail(deconcat3(message_b_580)) in
        {168}let v_583: bool = catch-fail(true) in
        {169}let v_584: key = catch-fail(1-proj-3-tuple(v_582)) in
        {170}let v_585: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_581))) in
        {171}let v_586: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_581)) then (if (not-caught-fail(v_585) && success?(is-true(success?(1-proj-3-tuple(v_585))))) then symmetricstatepack(1-proj-3-tuple(v_585),2-proj-3-tuple(v_585),hash(3-proj-3-tuple(v_585),v_584)) else fail-any) else fail-any)) in
        {172}let v_587: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_581))) in
        {173}let v_588: bitstring = catch-fail(symmetricstateunpack(v_586)) in
        {174}let v_589: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_588),(if success?(3-proj-7-tuple(v_581)) then (if (not-caught-fail(v_587) && success?(is-true(success?(1-proj-2-tuple(v_587))))) then dhexp(2-proj-2-tuple(v_587),v_584) else fail-any) else fail-any))) in
        {175}let v_590: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_588),(if success?(3-proj-7-tuple(v_581)) then (if (not-caught-fail(v_587) && success?(is-true(success?(1-proj-2-tuple(v_587))))) then dhexp(2-proj-2-tuple(v_587),v_584) else fail-any) else fail-any))) in
        {176}let v_591: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_588),(if success?(3-proj-7-tuple(v_581)) then (if (not-caught-fail(v_587) && success?(is-true(success?(1-proj-2-tuple(v_587))))) then dhexp(2-proj-2-tuple(v_587),v_584) else fail-any) else fail-any))) in
        {177}let v_592: bitstring = catch-fail((if (success?((if success?(3-proj-7-tuple(v_581)) then (if (not-caught-fail(v_587) && success?(is-true(success?(1-proj-2-tuple(v_587))))) then dhexp(2-proj-2-tuple(v_587),v_584) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_588))) then (if not-caught-fail(v_589) then (if not-caught-fail(v_590) then (if not-caught-fail(v_591) then (v_589,v_590,v_591) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {178}let v_593: symmetricstate = catch-fail((if success?((if success?(3-proj-7-tuple(v_581)) then (if (not-caught-fail(v_587) && success?(is-true(success?(1-proj-2-tuple(v_587))))) then dhexp(2-proj-2-tuple(v_587),v_584) else fail-any) else fail-any)) then (if (not-caught-fail(v_588) && success?(is-true(success?(1-proj-3-tuple(v_588))))) then (if (not-caught-fail(v_592) && success?(is-true(success?(1-proj-3-tuple(v_592))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_592)) then cipherstatepack(2-proj-3-tuple(v_592),minnonce) else fail-any),1-proj-3-tuple(v_592),3-proj-3-tuple(v_588)) else fail-any) else fail-any) else fail-any)) in
        {179}let v_594: bitstring = catch-fail(symmetricstateunpack(v_593)) in
        {180}let v_595: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_594))) in
        {181}let v_596: aead = catch-fail(decrypt(1-proj-2-tuple(v_595),2-proj-2-tuple(v_595),3-proj-3-tuple(v_594),3-proj-3-tuple(v_582))) in
        {182}let v_597: bitstring = catch-fail(aeadunpack(v_596)) in
        {183}let v_598: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_594))) in
        {184}let v_599: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_595))) && success?(1-proj-3-tuple(v_594))) then (if (not-caught-fail(v_598) && success?(is-true(success?(1-proj-2-tuple(v_598))))) then cipherstatepack(1-proj-2-tuple(v_598),increment_nonce(2-proj-2-tuple(v_595))) else fail-any) else fail-any)) in
        {185}let v_600: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_582)) && (success?(3-proj-3-tuple(v_594)) && success?(1-proj-3-tuple(v_594)))) then (if (not-caught-fail(v_595) && success?(is-true(success?(1-proj-2-tuple(v_595))))) then (if not-caught-fail(v_596) then (if (not-caught-fail(v_597) && success?(is-true(success?(1-proj-3-tuple(v_597))))) then (if not-caught-fail(v_599) then (v_599,3-proj-3-tuple(v_597),1-proj-3-tuple(v_597)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {186}let v_601: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_600),2-proj-3-tuple(v_594),3-proj-3-tuple(v_594)))) in
        {187}let v_602: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_582)) && success?(symmetricstatepack(1-proj-3-tuple(v_600),2-proj-3-tuple(v_594),3-proj-3-tuple(v_594)))) then (if (not-caught-fail(v_601) && success?(is-true(success?(1-proj-3-tuple(v_601))))) then symmetricstatepack(1-proj-3-tuple(v_601),2-proj-3-tuple(v_601),hash(3-proj-3-tuple(v_601),3-proj-3-tuple(v_582))) else fail-any) else fail-any)) in
        {188}let v_603: bitstring = catch-fail((if success?(3-proj-3-tuple(v_582)) then (if (not-caught-fail(v_594) && success?(is-true(success?(1-proj-3-tuple(v_594))))) then (if (not-caught-fail(v_600) && success?(is-true(success?(1-proj-3-tuple(v_600))))) then (if not-caught-fail(v_602) then (v_602,2-proj-3-tuple(v_600),3-proj-3-tuple(v_600)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {189}let v_604: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_603),2-proj-7-tuple(v_581),3-proj-7-tuple(v_581),4-proj-7-tuple(v_581),v_584,6-proj-7-tuple(v_581),7-proj-7-tuple(v_581))) in
        {190}let (hs_605: handshakestate,re_606: key,plaintext_b_607: bitstring,valid_608: bool) = (if (not-caught-fail(v_581) && success?(is-true(success?(1-proj-7-tuple(v_581))))) then (if (not-caught-fail(v_582) && success?(is-true(success?(1-proj-3-tuple(v_582))))) then (if not-caught-fail(v_583) then (if not-caught-fail(v_584) then (if not-caught-fail(v_586) then (if not-caught-fail(v_593) then (if (not-caught-fail(v_603) && success?(is-true(success?(1-proj-3-tuple(v_603))))) then (if (v_583 && 3-proj-3-tuple(v_603)) then (if not-caught-fail(v_604) then (v_604,getpublickey(3-proj-7-tuple(v_581)),2-proj-3-tuple(v_603),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {191}event RecvMsg(alice,charlie,stage_b,plaintext_b_607,valid_608);
        {192}insert statestore(alice,charlie,statepack_c(hs_605))
    ) | (
        {226}get statestore(=alice,=charlie,statepack_c(hs_609: handshakestate)) in
        {194}let v_610: bitstring = catch-fail(handshakestateunpack(hs_609)) in
        {195}let v_611: bitstring = catch-fail((empty,empty,empty)) in
        {196}let v_612: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_610))) in
        {197}let v_613: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_610))) in
        {198}let v_614: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_613),(if (success?(5-proj-7-tuple(v_610)) && success?(2-proj-7-tuple(v_610))) then (if (not-caught-fail(v_612) && success?(is-true(success?(1-proj-2-tuple(v_612))))) then dhexp(2-proj-2-tuple(v_612),5-proj-7-tuple(v_610)) else fail-any) else fail-any))) in
        {199}let v_615: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_613),(if (success?(5-proj-7-tuple(v_610)) && success?(2-proj-7-tuple(v_610))) then (if (not-caught-fail(v_612) && success?(is-true(success?(1-proj-2-tuple(v_612))))) then dhexp(2-proj-2-tuple(v_612),5-proj-7-tuple(v_610)) else fail-any) else fail-any))) in
        {200}let v_616: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_613),(if (success?(5-proj-7-tuple(v_610)) && success?(2-proj-7-tuple(v_610))) then (if (not-caught-fail(v_612) && success?(is-true(success?(1-proj-2-tuple(v_612))))) then dhexp(2-proj-2-tuple(v_612),5-proj-7-tuple(v_610)) else fail-any) else fail-any))) in
        {201}let v_617: bitstring = catch-fail((if (success?((if (success?(5-proj-7-tuple(v_610)) && success?(2-proj-7-tuple(v_610))) then (if (not-caught-fail(v_612) && success?(is-true(success?(1-proj-2-tuple(v_612))))) then dhexp(2-proj-2-tuple(v_612),5-proj-7-tuple(v_610)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_613))) then (if not-caught-fail(v_614) then (if not-caught-fail(v_615) then (if not-caught-fail(v_616) then (v_614,v_615,v_616) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {202}let v_618: symmetricstate = catch-fail((if (success?((if (success?(5-proj-7-tuple(v_610)) && success?(2-proj-7-tuple(v_610))) then (if (not-caught-fail(v_612) && success?(is-true(success?(1-proj-2-tuple(v_612))))) then dhexp(2-proj-2-tuple(v_612),5-proj-7-tuple(v_610)) else fail-any) else fail-any)) && success?(1-proj-7-tuple(v_610))) then (if (not-caught-fail(v_613) && success?(is-true(success?(1-proj-3-tuple(v_613))))) then (if (not-caught-fail(v_617) && success?(is-true(success?(1-proj-3-tuple(v_617))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_617)) then cipherstatepack(2-proj-3-tuple(v_617),minnonce) else fail-any),1-proj-3-tuple(v_617),3-proj-3-tuple(v_613)) else fail-any) else fail-any) else fail-any)) in
        {203}let v_619: bitstring = catch-fail(symmetricstateunpack(v_618)) in
        {204}let v_620: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_619))) in
        {205}let v_621: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_620),2-proj-2-tuple(v_620),3-proj-3-tuple(v_619),msg_c(alice,charlie))) in
        {206}let v_622: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_619))) in
        {207}let v_623: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_620))) && success?(1-proj-3-tuple(v_619))) then (if (not-caught-fail(v_622) && success?(is-true(success?(1-proj-2-tuple(v_622))))) then cipherstatepack(1-proj-2-tuple(v_622),increment_nonce(2-proj-2-tuple(v_620))) else fail-any) else fail-any)) in
        {208}let v_624: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_619)) && success?(1-proj-3-tuple(v_619))) then (if (not-caught-fail(v_620) && success?(is-true(success?(1-proj-2-tuple(v_620))))) then (if not-caught-fail(v_621) then (if not-caught-fail(v_623) then (v_623,v_621) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {209}let v_625: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_624),2-proj-3-tuple(v_619),3-proj-3-tuple(v_619)))) in
        {210}let v_626: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_624)) && success?(symmetricstatepack(1-proj-2-tuple(v_624),2-proj-3-tuple(v_619),3-proj-3-tuple(v_619)))) then (if (not-caught-fail(v_625) && success?(is-true(success?(1-proj-3-tuple(v_625))))) then symmetricstatepack(1-proj-3-tuple(v_625),2-proj-3-tuple(v_625),hash(3-proj-3-tuple(v_625),2-proj-2-tuple(v_624))) else fail-any) else fail-any)) in
        {211}let v_627: bitstring = catch-fail((if (not-caught-fail(v_619) && success?(is-true(success?(1-proj-3-tuple(v_619))))) then (if (not-caught-fail(v_624) && success?(is-true(success?(1-proj-2-tuple(v_624))))) then (if not-caught-fail(v_626) then (v_626,2-proj-2-tuple(v_624)) else fail-any) else fail-any) else fail-any)) in
        {212}let v_628: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_627),2-proj-7-tuple(v_610),3-proj-7-tuple(v_610),4-proj-7-tuple(v_610),5-proj-7-tuple(v_610),6-proj-7-tuple(v_610),7-proj-7-tuple(v_610))) in
        {213}let v_629: bitstring = catch-fail(concat3(1-proj-3-tuple(v_611),2-proj-3-tuple(v_611),2-proj-2-tuple(v_627))) in
        {214}let v_630: bitstring = catch-fail(symmetricstateunpack(1-proj-2-tuple(v_627))) in
        {215}let v_631: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_630),zero)) in
        {216}let v_632: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_630),zero)) in
        {217}let v_633: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_630),zero)) in
        {218}let v_634: bitstring = catch-fail((if success?(2-proj-3-tuple(v_630)) then (if not-caught-fail(v_631) then (if not-caught-fail(v_632) then (if not-caught-fail(v_633) then (v_631,v_632,v_633) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {219}let v_635: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_634)) then cipherstatepack(1-proj-3-tuple(v_634),minnonce) else fail-any)) in
        {220}let v_636: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_634)) then cipherstatepack(2-proj-3-tuple(v_634),minnonce) else fail-any)) in
        {221}let v_637: bitstring = catch-fail((if success?(1-proj-2-tuple(v_627)) then (if (not-caught-fail(v_630) && success?(is-true(success?(1-proj-3-tuple(v_630))))) then (if (not-caught-fail(v_634) && success?(is-true(success?(1-proj-3-tuple(v_634))))) then (if not-caught-fail(v_635) then (if not-caught-fail(v_636) then (1-proj-2-tuple(v_627),v_635,v_636) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {222}let (hs_638: handshakestate,re_639: key,message_c_640: bitstring,cs1_641: cipherstate,cs2_642: cipherstate) = (if (not-caught-fail(v_610) && success?(is-true(success?(1-proj-7-tuple(v_610))))) then (if (not-caught-fail(v_611) && success?(is-true(success?(1-proj-3-tuple(v_611))))) then (if not-caught-fail(v_618) then (if (not-caught-fail(v_627) && success?(is-true(success?(1-proj-2-tuple(v_627))))) then (if not-caught-fail(v_628) then (if not-caught-fail(v_629) then (if (not-caught-fail(v_637) && success?(is-true(success?(1-proj-3-tuple(v_637))))) then (v_628,5-proj-7-tuple(v_610),v_629,2-proj-3-tuple(v_637),3-proj-3-tuple(v_637)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {223}event SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true);
        {224}insert statestore(alice,charlie,statepack_d(hs_638));
        {225}out(pub, message_c_640)
    ) | (
        {227}event LeakS(phase0,alice);
        {228}out(pub, key_s(alice))
    ) | (
        {229}phase 1;
        {230}event LeakS(phase1,alice);
        {231}out(pub, key_s(alice))
    )
) | (
    {232}let v_643: key = catch-fail(dhexp(key_s(bob),g)) in
    {233}let s_644: keypair = (if not-caught-fail(v_643) then keypairpack(v_643,key_s(bob)) else fail-any) in
    {234}out(pub, getpublickey(s_644));
    (
        {235}let e_645: keypair = keypairpack(empty,empty) in
        {236}let v_646: key = catch-fail(dhexp(key_s(alice),g)) in
        {237}let rs_647: key = getpublickey((if not-caught-fail(v_646) then keypairpack(v_646,key_s(alice)) else fail-any)) in
        {238}let re_648: key = empty in
        {239}let v_649: bitstring = catch-fail(hash(somename,empty)) in
        {240}let v_650: key = catch-fail(v_649) in
        {241}let v_651: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {242}let v_652: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_649) then (if not-caught-fail(v_650) then (if not-caught-fail(v_651) then symmetricstatepack(v_651,v_650,v_649) else fail-any) else fail-any) else fail-any))) in
        {243}let v_653: symmetricstate = catch-fail((if success?((if not-caught-fail(v_649) then (if not-caught-fail(v_650) then (if not-caught-fail(v_651) then symmetricstatepack(v_651,v_650,v_649) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_652) && success?(is-true(success?(1-proj-3-tuple(v_652))))) then symmetricstatepack(1-proj-3-tuple(v_652),2-proj-3-tuple(v_652),hash(3-proj-3-tuple(v_652),empty)) else fail-any) else fail-any)) in
        {244}let v_654: bitstring = catch-fail(symmetricstateunpack(v_653)) in
        {245}let v_655: symmetricstate = catch-fail((if (not-caught-fail(v_654) && success?(is-true(success?(1-proj-3-tuple(v_654))))) then symmetricstatepack(1-proj-3-tuple(v_654),2-proj-3-tuple(v_654),hash(3-proj-3-tuple(v_654),rs_647)) else fail-any)) in
        {246}let v_656: bitstring = catch-fail(symmetricstateunpack(v_655)) in
        {247}let v_657: symmetricstate = catch-fail((if success?(getpublickey(s_644)) then (if (not-caught-fail(v_656) && success?(is-true(success?(1-proj-3-tuple(v_656))))) then symmetricstatepack(1-proj-3-tuple(v_656),2-proj-3-tuple(v_656),hash(3-proj-3-tuple(v_656),getpublickey(s_644))) else fail-any) else fail-any)) in
        {248}let hs_658: handshakestate = (if not-caught-fail(v_653) then (if not-caught-fail(v_655) then (if not-caught-fail(v_657) then handshakestatepack(v_657,s_644,e_645,rs_647,re_648,empty,false) else fail-any) else fail-any) else fail-any) in
        {249}insert statestore(bob,alice,statepack_a(hs_658))
    ) | (
        {278}get statestore(=bob,=alice,statepack_a(hs_659: handshakestate)) in
        {250}in(pub, message_a_660: bitstring);
        {251}let v_661: bitstring = catch-fail(handshakestateunpack(hs_659)) in
        {252}let v_662: bitstring = catch-fail(deconcat3(message_a_660)) in
        {253}let v_663: bool = catch-fail(true) in
        {254}let v_664: key = catch-fail(1-proj-3-tuple(v_662)) in
        {255}let v_665: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_661))) in
        {256}let v_666: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_661)) then (if (not-caught-fail(v_665) && success?(is-true(success?(1-proj-3-tuple(v_665))))) then symmetricstatepack(1-proj-3-tuple(v_665),2-proj-3-tuple(v_665),hash(3-proj-3-tuple(v_665),v_664)) else fail-any) else fail-any)) in
        {257}let v_667: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_661))) in
        {258}let v_668: bitstring = catch-fail(symmetricstateunpack(v_666)) in
        {259}let v_669: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_668),(if success?(2-proj-7-tuple(v_661)) then (if (not-caught-fail(v_667) && success?(is-true(success?(1-proj-2-tuple(v_667))))) then dhexp(2-proj-2-tuple(v_667),v_664) else fail-any) else fail-any))) in
        {260}let v_670: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_668),(if success?(2-proj-7-tuple(v_661)) then (if (not-caught-fail(v_667) && success?(is-true(success?(1-proj-2-tuple(v_667))))) then dhexp(2-proj-2-tuple(v_667),v_664) else fail-any) else fail-any))) in
        {261}let v_671: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_668),(if success?(2-proj-7-tuple(v_661)) then (if (not-caught-fail(v_667) && success?(is-true(success?(1-proj-2-tuple(v_667))))) then dhexp(2-proj-2-tuple(v_667),v_664) else fail-any) else fail-any))) in
        {262}let v_672: bitstring = catch-fail((if (success?((if success?(2-proj-7-tuple(v_661)) then (if (not-caught-fail(v_667) && success?(is-true(success?(1-proj-2-tuple(v_667))))) then dhexp(2-proj-2-tuple(v_667),v_664) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_668))) then (if not-caught-fail(v_669) then (if not-caught-fail(v_670) then (if not-caught-fail(v_671) then (v_669,v_670,v_671) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {263}let v_673: symmetricstate = catch-fail((if success?((if success?(2-proj-7-tuple(v_661)) then (if (not-caught-fail(v_667) && success?(is-true(success?(1-proj-2-tuple(v_667))))) then dhexp(2-proj-2-tuple(v_667),v_664) else fail-any) else fail-any)) then (if (not-caught-fail(v_668) && success?(is-true(success?(1-proj-3-tuple(v_668))))) then (if (not-caught-fail(v_672) && success?(is-true(success?(1-proj-3-tuple(v_672))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_672)) then cipherstatepack(2-proj-3-tuple(v_672),minnonce) else fail-any),1-proj-3-tuple(v_672),3-proj-3-tuple(v_668)) else fail-any) else fail-any) else fail-any)) in
        {264}let v_674: bitstring = catch-fail(symmetricstateunpack(v_673)) in
        {265}let v_675: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_674))) in
        {266}let v_676: aead = catch-fail(decrypt(1-proj-2-tuple(v_675),2-proj-2-tuple(v_675),3-proj-3-tuple(v_674),3-proj-3-tuple(v_662))) in
        {267}let v_677: bitstring = catch-fail(aeadunpack(v_676)) in
        {268}let v_678: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_674))) in
        {269}let v_679: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_675))) && success?(1-proj-3-tuple(v_674))) then (if (not-caught-fail(v_678) && success?(is-true(success?(1-proj-2-tuple(v_678))))) then cipherstatepack(1-proj-2-tuple(v_678),increment_nonce(2-proj-2-tuple(v_675))) else fail-any) else fail-any)) in
        {270}let v_680: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_662)) && (success?(3-proj-3-tuple(v_674)) && success?(1-proj-3-tuple(v_674)))) then (if (not-caught-fail(v_675) && success?(is-true(success?(1-proj-2-tuple(v_675))))) then (if not-caught-fail(v_676) then (if (not-caught-fail(v_677) && success?(is-true(success?(1-proj-3-tuple(v_677))))) then (if not-caught-fail(v_679) then (v_679,3-proj-3-tuple(v_677),1-proj-3-tuple(v_677)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {271}let v_681: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_680),2-proj-3-tuple(v_674),3-proj-3-tuple(v_674)))) in
        {272}let v_682: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_662)) && success?(symmetricstatepack(1-proj-3-tuple(v_680),2-proj-3-tuple(v_674),3-proj-3-tuple(v_674)))) then (if (not-caught-fail(v_681) && success?(is-true(success?(1-proj-3-tuple(v_681))))) then symmetricstatepack(1-proj-3-tuple(v_681),2-proj-3-tuple(v_681),hash(3-proj-3-tuple(v_681),3-proj-3-tuple(v_662))) else fail-any) else fail-any)) in
        {273}let v_683: bitstring = catch-fail((if success?(3-proj-3-tuple(v_662)) then (if (not-caught-fail(v_674) && success?(is-true(success?(1-proj-3-tuple(v_674))))) then (if (not-caught-fail(v_680) && success?(is-true(success?(1-proj-3-tuple(v_680))))) then (if not-caught-fail(v_682) then (v_682,2-proj-3-tuple(v_680),3-proj-3-tuple(v_680)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {274}let v_684: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_683),2-proj-7-tuple(v_661),3-proj-7-tuple(v_661),4-proj-7-tuple(v_661),v_664,6-proj-7-tuple(v_661),7-proj-7-tuple(v_661))) in
        {275}let (hs_685: handshakestate,re_686: key,plaintext_a: bitstring,valid_687: bool) = (if (not-caught-fail(v_661) && success?(is-true(success?(1-proj-7-tuple(v_661))))) then (if (not-caught-fail(v_662) && success?(is-true(success?(1-proj-3-tuple(v_662))))) then (if not-caught-fail(v_663) then (if not-caught-fail(v_664) then (if not-caught-fail(v_666) then (if not-caught-fail(v_673) then (if (not-caught-fail(v_683) && success?(is-true(success?(1-proj-3-tuple(v_683))))) then (if (v_663 && 3-proj-3-tuple(v_683)) then (if not-caught-fail(v_684) then (v_684,getpublickey(3-proj-7-tuple(v_661)),2-proj-3-tuple(v_683),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {276}event RecvMsg(bob,alice,stage_a,plaintext_a,valid_687);
        {277}insert statestore(bob,alice,statepack_b(hs_685))
    ) | (
        {308}get statestore(=bob,=alice,statepack_b(hs_688: handshakestate)) in
        {279}let v_689: bitstring = catch-fail(handshakestateunpack(hs_688)) in
        {280}let v_690: bitstring = catch-fail((empty,empty,empty)) in
        {281}let v_691: key = catch-fail(dhexp(key_e(bob,alice),g)) in
        {282}let v_692: keypair = catch-fail((if not-caught-fail(v_691) then keypairpack(v_691,key_e(bob,alice)) else fail-any)) in
        {283}let v_693: bitstring = catch-fail(getpublickey(v_692)) in
        {284}let v_694: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_689))) in
        {285}let v_695: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_689)) then (if (not-caught-fail(v_694) && success?(is-true(success?(1-proj-3-tuple(v_694))))) then symmetricstatepack(1-proj-3-tuple(v_694),2-proj-3-tuple(v_694),hash(3-proj-3-tuple(v_694),v_693)) else fail-any) else fail-any)) in
        {286}let v_696: bitstring = catch-fail(keypairunpack(v_692)) in
        {287}let v_697: bitstring = catch-fail(symmetricstateunpack(v_695)) in
        {288}let v_698: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_697),(if success?(5-proj-7-tuple(v_689)) then (if (not-caught-fail(v_696) && success?(is-true(success?(1-proj-2-tuple(v_696))))) then dhexp(2-proj-2-tuple(v_696),5-proj-7-tuple(v_689)) else fail-any) else fail-any))) in
        {289}let v_699: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_697),(if success?(5-proj-7-tuple(v_689)) then (if (not-caught-fail(v_696) && success?(is-true(success?(1-proj-2-tuple(v_696))))) then dhexp(2-proj-2-tuple(v_696),5-proj-7-tuple(v_689)) else fail-any) else fail-any))) in
        {290}let v_700: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_697),(if success?(5-proj-7-tuple(v_689)) then (if (not-caught-fail(v_696) && success?(is-true(success?(1-proj-2-tuple(v_696))))) then dhexp(2-proj-2-tuple(v_696),5-proj-7-tuple(v_689)) else fail-any) else fail-any))) in
        {291}let v_701: bitstring = catch-fail((if (success?((if success?(5-proj-7-tuple(v_689)) then (if (not-caught-fail(v_696) && success?(is-true(success?(1-proj-2-tuple(v_696))))) then dhexp(2-proj-2-tuple(v_696),5-proj-7-tuple(v_689)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_697))) then (if not-caught-fail(v_698) then (if not-caught-fail(v_699) then (if not-caught-fail(v_700) then (v_698,v_699,v_700) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {292}let v_702: symmetricstate = catch-fail((if success?((if success?(5-proj-7-tuple(v_689)) then (if (not-caught-fail(v_696) && success?(is-true(success?(1-proj-2-tuple(v_696))))) then dhexp(2-proj-2-tuple(v_696),5-proj-7-tuple(v_689)) else fail-any) else fail-any)) then (if (not-caught-fail(v_697) && success?(is-true(success?(1-proj-3-tuple(v_697))))) then (if (not-caught-fail(v_701) && success?(is-true(success?(1-proj-3-tuple(v_701))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_701)) then cipherstatepack(2-proj-3-tuple(v_701),minnonce) else fail-any),1-proj-3-tuple(v_701),3-proj-3-tuple(v_697)) else fail-any) else fail-any) else fail-any)) in
        {293}let v_703: bitstring = catch-fail(symmetricstateunpack(v_702)) in
        {294}let v_704: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_703))) in
        {295}let v_705: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_704),2-proj-2-tuple(v_704),3-proj-3-tuple(v_703),msg_b(bob,alice))) in
        {296}let v_706: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_703))) in
        {297}let v_707: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_704))) && success?(1-proj-3-tuple(v_703))) then (if (not-caught-fail(v_706) && success?(is-true(success?(1-proj-2-tuple(v_706))))) then cipherstatepack(1-proj-2-tuple(v_706),increment_nonce(2-proj-2-tuple(v_704))) else fail-any) else fail-any)) in
        {298}let v_708: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_703)) && success?(1-proj-3-tuple(v_703))) then (if (not-caught-fail(v_704) && success?(is-true(success?(1-proj-2-tuple(v_704))))) then (if not-caught-fail(v_705) then (if not-caught-fail(v_707) then (v_707,v_705) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {299}let v_709: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_708),2-proj-3-tuple(v_703),3-proj-3-tuple(v_703)))) in
        {300}let v_710: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_708)) && success?(symmetricstatepack(1-proj-2-tuple(v_708),2-proj-3-tuple(v_703),3-proj-3-tuple(v_703)))) then (if (not-caught-fail(v_709) && success?(is-true(success?(1-proj-3-tuple(v_709))))) then symmetricstatepack(1-proj-3-tuple(v_709),2-proj-3-tuple(v_709),hash(3-proj-3-tuple(v_709),2-proj-2-tuple(v_708))) else fail-any) else fail-any)) in
        {301}let v_711: bitstring = catch-fail((if (not-caught-fail(v_703) && success?(is-true(success?(1-proj-3-tuple(v_703))))) then (if (not-caught-fail(v_708) && success?(is-true(success?(1-proj-2-tuple(v_708))))) then (if not-caught-fail(v_710) then (v_710,2-proj-2-tuple(v_708)) else fail-any) else fail-any) else fail-any)) in
        {302}let v_712: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_711),2-proj-7-tuple(v_689),v_692,4-proj-7-tuple(v_689),5-proj-7-tuple(v_689),6-proj-7-tuple(v_689),7-proj-7-tuple(v_689))) in
        {303}let v_713: bitstring = catch-fail(concat3(v_693,2-proj-3-tuple(v_690),2-proj-2-tuple(v_711))) in
        {304}let (hs_714: handshakestate,re_715: key,message_b_716: bitstring) = (if (not-caught-fail(v_689) && success?(is-true(success?(1-proj-7-tuple(v_689))))) then (if (not-caught-fail(v_690) && success?(is-true(success?(1-proj-3-tuple(v_690))))) then (if not-caught-fail(v_692) then (if not-caught-fail(v_693) then (if not-caught-fail(v_695) then (if not-caught-fail(v_702) then (if (not-caught-fail(v_711) && success?(is-true(success?(1-proj-2-tuple(v_711))))) then (if not-caught-fail(v_712) then (if not-caught-fail(v_713) then (v_712,5-proj-7-tuple(v_689),v_713) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {305}event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true);
        {306}insert statestore(bob,alice,statepack_c(hs_714));
        {307}out(pub, message_b_716)
    ) | (
        {343}get statestore(=bob,=alice,statepack_c(hs_717: handshakestate)) in
        {309}in(pub, message_c_718: bitstring);
        {310}let v_719: bitstring = catch-fail(handshakestateunpack(hs_717)) in
        {311}let v_720: bitstring = catch-fail(deconcat3(message_c_718)) in
        {312}let v_721: bool = catch-fail(true) in
        {313}let v_722: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_719))) in
        {314}let v_723: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_719))) in
        {315}let v_724: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_723),(if (success?(4-proj-7-tuple(v_719)) && success?(3-proj-7-tuple(v_719))) then (if (not-caught-fail(v_722) && success?(is-true(success?(1-proj-2-tuple(v_722))))) then dhexp(2-proj-2-tuple(v_722),4-proj-7-tuple(v_719)) else fail-any) else fail-any))) in
        {316}let v_725: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_723),(if (success?(4-proj-7-tuple(v_719)) && success?(3-proj-7-tuple(v_719))) then (if (not-caught-fail(v_722) && success?(is-true(success?(1-proj-2-tuple(v_722))))) then dhexp(2-proj-2-tuple(v_722),4-proj-7-tuple(v_719)) else fail-any) else fail-any))) in
        {317}let v_726: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_723),(if (success?(4-proj-7-tuple(v_719)) && success?(3-proj-7-tuple(v_719))) then (if (not-caught-fail(v_722) && success?(is-true(success?(1-proj-2-tuple(v_722))))) then dhexp(2-proj-2-tuple(v_722),4-proj-7-tuple(v_719)) else fail-any) else fail-any))) in
        {318}let v_727: bitstring = catch-fail((if (success?((if (success?(4-proj-7-tuple(v_719)) && success?(3-proj-7-tuple(v_719))) then (if (not-caught-fail(v_722) && success?(is-true(success?(1-proj-2-tuple(v_722))))) then dhexp(2-proj-2-tuple(v_722),4-proj-7-tuple(v_719)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_723))) then (if not-caught-fail(v_724) then (if not-caught-fail(v_725) then (if not-caught-fail(v_726) then (v_724,v_725,v_726) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {319}let v_728: symmetricstate = catch-fail((if (success?((if (success?(4-proj-7-tuple(v_719)) && success?(3-proj-7-tuple(v_719))) then (if (not-caught-fail(v_722) && success?(is-true(success?(1-proj-2-tuple(v_722))))) then dhexp(2-proj-2-tuple(v_722),4-proj-7-tuple(v_719)) else fail-any) else fail-any)) && success?(1-proj-7-tuple(v_719))) then (if (not-caught-fail(v_723) && success?(is-true(success?(1-proj-3-tuple(v_723))))) then (if (not-caught-fail(v_727) && success?(is-true(success?(1-proj-3-tuple(v_727))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_727)) then cipherstatepack(2-proj-3-tuple(v_727),minnonce) else fail-any),1-proj-3-tuple(v_727),3-proj-3-tuple(v_723)) else fail-any) else fail-any) else fail-any)) in
        {320}let v_729: bitstring = catch-fail(symmetricstateunpack(v_728)) in
        {321}let v_730: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_729))) in
        {322}let v_731: aead = catch-fail(decrypt(1-proj-2-tuple(v_730),2-proj-2-tuple(v_730),3-proj-3-tuple(v_729),3-proj-3-tuple(v_720))) in
        {323}let v_732: bitstring = catch-fail(aeadunpack(v_731)) in
        {324}let v_733: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_729))) in
        {325}let v_734: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_730))) && success?(1-proj-3-tuple(v_729))) then (if (not-caught-fail(v_733) && success?(is-true(success?(1-proj-2-tuple(v_733))))) then cipherstatepack(1-proj-2-tuple(v_733),increment_nonce(2-proj-2-tuple(v_730))) else fail-any) else fail-any)) in
        {326}let v_735: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_720)) && (success?(3-proj-3-tuple(v_729)) && success?(1-proj-3-tuple(v_729)))) then (if (not-caught-fail(v_730) && success?(is-true(success?(1-proj-2-tuple(v_730))))) then (if not-caught-fail(v_731) then (if (not-caught-fail(v_732) && success?(is-true(success?(1-proj-3-tuple(v_732))))) then (if not-caught-fail(v_734) then (v_734,3-proj-3-tuple(v_732),1-proj-3-tuple(v_732)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {327}let v_736: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_735),2-proj-3-tuple(v_729),3-proj-3-tuple(v_729)))) in
        {328}let v_737: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_720)) && success?(symmetricstatepack(1-proj-3-tuple(v_735),2-proj-3-tuple(v_729),3-proj-3-tuple(v_729)))) then (if (not-caught-fail(v_736) && success?(is-true(success?(1-proj-3-tuple(v_736))))) then symmetricstatepack(1-proj-3-tuple(v_736),2-proj-3-tuple(v_736),hash(3-proj-3-tuple(v_736),3-proj-3-tuple(v_720))) else fail-any) else fail-any)) in
        {329}let v_738: bitstring = catch-fail((if success?(3-proj-3-tuple(v_720)) then (if (not-caught-fail(v_729) && success?(is-true(success?(1-proj-3-tuple(v_729))))) then (if (not-caught-fail(v_735) && success?(is-true(success?(1-proj-3-tuple(v_735))))) then (if not-caught-fail(v_737) then (v_737,2-proj-3-tuple(v_735),3-proj-3-tuple(v_735)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {330}let v_739: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_738),2-proj-7-tuple(v_719),3-proj-7-tuple(v_719),4-proj-7-tuple(v_719),5-proj-7-tuple(v_719),6-proj-7-tuple(v_719),7-proj-7-tuple(v_719))) in
        {331}let v_740: bitstring = catch-fail(symmetricstateunpack(1-proj-3-tuple(v_738))) in
        {332}let v_741: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_740),zero)) in
        {333}let v_742: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_740),zero)) in
        {334}let v_743: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_740),zero)) in
        {335}let v_744: bitstring = catch-fail((if success?(2-proj-3-tuple(v_740)) then (if not-caught-fail(v_741) then (if not-caught-fail(v_742) then (if not-caught-fail(v_743) then (v_741,v_742,v_743) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {336}let v_745: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_744)) then cipherstatepack(1-proj-3-tuple(v_744),minnonce) else fail-any)) in
        {337}let v_746: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_744)) then cipherstatepack(2-proj-3-tuple(v_744),minnonce) else fail-any)) in
        {338}let v_747: bitstring = catch-fail((if success?(1-proj-3-tuple(v_738)) then (if (not-caught-fail(v_740) && success?(is-true(success?(1-proj-3-tuple(v_740))))) then (if (not-caught-fail(v_744) && success?(is-true(success?(1-proj-3-tuple(v_744))))) then (if not-caught-fail(v_745) then (if not-caught-fail(v_746) then (1-proj-3-tuple(v_738),v_745,v_746) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {339}let (hs_748: handshakestate,re_749: key,plaintext_c: bitstring,valid_750: bool,cs1_751: cipherstate,cs2_752: cipherstate) = (if (not-caught-fail(v_719) && success?(is-true(success?(1-proj-7-tuple(v_719))))) then (if (not-caught-fail(v_720) && success?(is-true(success?(1-proj-3-tuple(v_720))))) then (if not-caught-fail(v_721) then (if not-caught-fail(v_728) then (if (not-caught-fail(v_738) && success?(is-true(success?(1-proj-3-tuple(v_738))))) then (if (v_721 && 3-proj-3-tuple(v_738)) then (if not-caught-fail(v_739) then (if (not-caught-fail(v_747) && success?(is-true(success?(1-proj-3-tuple(v_747))))) then (v_739,getpublickey(3-proj-7-tuple(v_719)),2-proj-3-tuple(v_738),true,2-proj-3-tuple(v_747),3-proj-3-tuple(v_747)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {340}event RecvMsg(bob,alice,stage_c,plaintext_c,valid_750);
        {341}insert statestore(bob,alice,statepack_d(hs_748));
        {342}event RecvEnd(valid_750)
    ) | (
        {344}event LeakS(phase0,bob);
        {345}out(pub, key_s(bob))
    ) | (
        {346}phase 1;
        {347}event LeakS(phase1,bob);
        {348}out(pub, key_s(bob))
    )
) | (
    {349}let v_753: key = catch-fail(dhexp(key_s(bob),g)) in
    {350}let s_754: keypair = (if not-caught-fail(v_753) then keypairpack(v_753,key_s(bob)) else fail-any) in
    {351}out(pub, getpublickey(s_754));
    (
        {352}let e_755: keypair = keypairpack(empty,empty) in
        {353}let v_756: key = catch-fail(dhexp(key_s(charlie),g)) in
        {354}let rs_757: key = getpublickey((if not-caught-fail(v_756) then keypairpack(v_756,key_s(charlie)) else fail-any)) in
        {355}let re_758: key = empty in
        {356}let v_759: bitstring = catch-fail(hash(somename,empty)) in
        {357}let v_760: key = catch-fail(v_759) in
        {358}let v_761: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {359}let v_762: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_759) then (if not-caught-fail(v_760) then (if not-caught-fail(v_761) then symmetricstatepack(v_761,v_760,v_759) else fail-any) else fail-any) else fail-any))) in
        {360}let v_763: symmetricstate = catch-fail((if success?((if not-caught-fail(v_759) then (if not-caught-fail(v_760) then (if not-caught-fail(v_761) then symmetricstatepack(v_761,v_760,v_759) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_762) && success?(is-true(success?(1-proj-3-tuple(v_762))))) then symmetricstatepack(1-proj-3-tuple(v_762),2-proj-3-tuple(v_762),hash(3-proj-3-tuple(v_762),empty)) else fail-any) else fail-any)) in
        {361}let v_764: bitstring = catch-fail(symmetricstateunpack(v_763)) in
        {362}let v_765: symmetricstate = catch-fail((if (not-caught-fail(v_764) && success?(is-true(success?(1-proj-3-tuple(v_764))))) then symmetricstatepack(1-proj-3-tuple(v_764),2-proj-3-tuple(v_764),hash(3-proj-3-tuple(v_764),rs_757)) else fail-any)) in
        {363}let v_766: bitstring = catch-fail(symmetricstateunpack(v_765)) in
        {364}let v_767: symmetricstate = catch-fail((if success?(getpublickey(s_754)) then (if (not-caught-fail(v_766) && success?(is-true(success?(1-proj-3-tuple(v_766))))) then symmetricstatepack(1-proj-3-tuple(v_766),2-proj-3-tuple(v_766),hash(3-proj-3-tuple(v_766),getpublickey(s_754))) else fail-any) else fail-any)) in
        {365}let hs_768: handshakestate = (if not-caught-fail(v_763) then (if not-caught-fail(v_765) then (if not-caught-fail(v_767) then handshakestatepack(v_767,s_754,e_755,rs_757,re_758,empty,false) else fail-any) else fail-any) else fail-any) in
        {366}insert statestore(bob,charlie,statepack_a(hs_768))
    ) | (
        {395}get statestore(=bob,=charlie,statepack_a(hs_769: handshakestate)) in
        {367}in(pub, message_a_770: bitstring);
        {368}let v_771: bitstring = catch-fail(handshakestateunpack(hs_769)) in
        {369}let v_772: bitstring = catch-fail(deconcat3(message_a_770)) in
        {370}let v_773: bool = catch-fail(true) in
        {371}let v_774: key = catch-fail(1-proj-3-tuple(v_772)) in
        {372}let v_775: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_771))) in
        {373}let v_776: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_771)) then (if (not-caught-fail(v_775) && success?(is-true(success?(1-proj-3-tuple(v_775))))) then symmetricstatepack(1-proj-3-tuple(v_775),2-proj-3-tuple(v_775),hash(3-proj-3-tuple(v_775),v_774)) else fail-any) else fail-any)) in
        {374}let v_777: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_771))) in
        {375}let v_778: bitstring = catch-fail(symmetricstateunpack(v_776)) in
        {376}let v_779: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_778),(if success?(2-proj-7-tuple(v_771)) then (if (not-caught-fail(v_777) && success?(is-true(success?(1-proj-2-tuple(v_777))))) then dhexp(2-proj-2-tuple(v_777),v_774) else fail-any) else fail-any))) in
        {377}let v_780: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_778),(if success?(2-proj-7-tuple(v_771)) then (if (not-caught-fail(v_777) && success?(is-true(success?(1-proj-2-tuple(v_777))))) then dhexp(2-proj-2-tuple(v_777),v_774) else fail-any) else fail-any))) in
        {378}let v_781: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_778),(if success?(2-proj-7-tuple(v_771)) then (if (not-caught-fail(v_777) && success?(is-true(success?(1-proj-2-tuple(v_777))))) then dhexp(2-proj-2-tuple(v_777),v_774) else fail-any) else fail-any))) in
        {379}let v_782: bitstring = catch-fail((if (success?((if success?(2-proj-7-tuple(v_771)) then (if (not-caught-fail(v_777) && success?(is-true(success?(1-proj-2-tuple(v_777))))) then dhexp(2-proj-2-tuple(v_777),v_774) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_778))) then (if not-caught-fail(v_779) then (if not-caught-fail(v_780) then (if not-caught-fail(v_781) then (v_779,v_780,v_781) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {380}let v_783: symmetricstate = catch-fail((if success?((if success?(2-proj-7-tuple(v_771)) then (if (not-caught-fail(v_777) && success?(is-true(success?(1-proj-2-tuple(v_777))))) then dhexp(2-proj-2-tuple(v_777),v_774) else fail-any) else fail-any)) then (if (not-caught-fail(v_778) && success?(is-true(success?(1-proj-3-tuple(v_778))))) then (if (not-caught-fail(v_782) && success?(is-true(success?(1-proj-3-tuple(v_782))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_782)) then cipherstatepack(2-proj-3-tuple(v_782),minnonce) else fail-any),1-proj-3-tuple(v_782),3-proj-3-tuple(v_778)) else fail-any) else fail-any) else fail-any)) in
        {381}let v_784: bitstring = catch-fail(symmetricstateunpack(v_783)) in
        {382}let v_785: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_784))) in
        {383}let v_786: aead = catch-fail(decrypt(1-proj-2-tuple(v_785),2-proj-2-tuple(v_785),3-proj-3-tuple(v_784),3-proj-3-tuple(v_772))) in
        {384}let v_787: bitstring = catch-fail(aeadunpack(v_786)) in
        {385}let v_788: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_784))) in
        {386}let v_789: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_785))) && success?(1-proj-3-tuple(v_784))) then (if (not-caught-fail(v_788) && success?(is-true(success?(1-proj-2-tuple(v_788))))) then cipherstatepack(1-proj-2-tuple(v_788),increment_nonce(2-proj-2-tuple(v_785))) else fail-any) else fail-any)) in
        {387}let v_790: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_772)) && (success?(3-proj-3-tuple(v_784)) && success?(1-proj-3-tuple(v_784)))) then (if (not-caught-fail(v_785) && success?(is-true(success?(1-proj-2-tuple(v_785))))) then (if not-caught-fail(v_786) then (if (not-caught-fail(v_787) && success?(is-true(success?(1-proj-3-tuple(v_787))))) then (if not-caught-fail(v_789) then (v_789,3-proj-3-tuple(v_787),1-proj-3-tuple(v_787)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {388}let v_791: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_790),2-proj-3-tuple(v_784),3-proj-3-tuple(v_784)))) in
        {389}let v_792: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_772)) && success?(symmetricstatepack(1-proj-3-tuple(v_790),2-proj-3-tuple(v_784),3-proj-3-tuple(v_784)))) then (if (not-caught-fail(v_791) && success?(is-true(success?(1-proj-3-tuple(v_791))))) then symmetricstatepack(1-proj-3-tuple(v_791),2-proj-3-tuple(v_791),hash(3-proj-3-tuple(v_791),3-proj-3-tuple(v_772))) else fail-any) else fail-any)) in
        {390}let v_793: bitstring = catch-fail((if success?(3-proj-3-tuple(v_772)) then (if (not-caught-fail(v_784) && success?(is-true(success?(1-proj-3-tuple(v_784))))) then (if (not-caught-fail(v_790) && success?(is-true(success?(1-proj-3-tuple(v_790))))) then (if not-caught-fail(v_792) then (v_792,2-proj-3-tuple(v_790),3-proj-3-tuple(v_790)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {391}let v_794: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_793),2-proj-7-tuple(v_771),3-proj-7-tuple(v_771),4-proj-7-tuple(v_771),v_774,6-proj-7-tuple(v_771),7-proj-7-tuple(v_771))) in
        {392}let (hs_795: handshakestate,re_796: key,plaintext_a_797: bitstring,valid_798: bool) = (if (not-caught-fail(v_771) && success?(is-true(success?(1-proj-7-tuple(v_771))))) then (if (not-caught-fail(v_772) && success?(is-true(success?(1-proj-3-tuple(v_772))))) then (if not-caught-fail(v_773) then (if not-caught-fail(v_774) then (if not-caught-fail(v_776) then (if not-caught-fail(v_783) then (if (not-caught-fail(v_793) && success?(is-true(success?(1-proj-3-tuple(v_793))))) then (if (v_773 && 3-proj-3-tuple(v_793)) then (if not-caught-fail(v_794) then (v_794,getpublickey(3-proj-7-tuple(v_771)),2-proj-3-tuple(v_793),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {393}event RecvMsg(bob,charlie,stage_a,plaintext_a_797,valid_798);
        {394}insert statestore(bob,charlie,statepack_b(hs_795))
    ) | (
        {425}get statestore(=bob,=charlie,statepack_b(hs_799: handshakestate)) in
        {396}let v_800: bitstring = catch-fail(handshakestateunpack(hs_799)) in
        {397}let v_801: bitstring = catch-fail((empty,empty,empty)) in
        {398}let v_802: key = catch-fail(dhexp(key_e(bob,charlie),g)) in
        {399}let v_803: keypair = catch-fail((if not-caught-fail(v_802) then keypairpack(v_802,key_e(bob,charlie)) else fail-any)) in
        {400}let v_804: bitstring = catch-fail(getpublickey(v_803)) in
        {401}let v_805: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_800))) in
        {402}let v_806: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_800)) then (if (not-caught-fail(v_805) && success?(is-true(success?(1-proj-3-tuple(v_805))))) then symmetricstatepack(1-proj-3-tuple(v_805),2-proj-3-tuple(v_805),hash(3-proj-3-tuple(v_805),v_804)) else fail-any) else fail-any)) in
        {403}let v_807: bitstring = catch-fail(keypairunpack(v_803)) in
        {404}let v_808: bitstring = catch-fail(symmetricstateunpack(v_806)) in
        {405}let v_809: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_808),(if success?(5-proj-7-tuple(v_800)) then (if (not-caught-fail(v_807) && success?(is-true(success?(1-proj-2-tuple(v_807))))) then dhexp(2-proj-2-tuple(v_807),5-proj-7-tuple(v_800)) else fail-any) else fail-any))) in
        {406}let v_810: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_808),(if success?(5-proj-7-tuple(v_800)) then (if (not-caught-fail(v_807) && success?(is-true(success?(1-proj-2-tuple(v_807))))) then dhexp(2-proj-2-tuple(v_807),5-proj-7-tuple(v_800)) else fail-any) else fail-any))) in
        {407}let v_811: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_808),(if success?(5-proj-7-tuple(v_800)) then (if (not-caught-fail(v_807) && success?(is-true(success?(1-proj-2-tuple(v_807))))) then dhexp(2-proj-2-tuple(v_807),5-proj-7-tuple(v_800)) else fail-any) else fail-any))) in
        {408}let v_812: bitstring = catch-fail((if (success?((if success?(5-proj-7-tuple(v_800)) then (if (not-caught-fail(v_807) && success?(is-true(success?(1-proj-2-tuple(v_807))))) then dhexp(2-proj-2-tuple(v_807),5-proj-7-tuple(v_800)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_808))) then (if not-caught-fail(v_809) then (if not-caught-fail(v_810) then (if not-caught-fail(v_811) then (v_809,v_810,v_811) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {409}let v_813: symmetricstate = catch-fail((if success?((if success?(5-proj-7-tuple(v_800)) then (if (not-caught-fail(v_807) && success?(is-true(success?(1-proj-2-tuple(v_807))))) then dhexp(2-proj-2-tuple(v_807),5-proj-7-tuple(v_800)) else fail-any) else fail-any)) then (if (not-caught-fail(v_808) && success?(is-true(success?(1-proj-3-tuple(v_808))))) then (if (not-caught-fail(v_812) && success?(is-true(success?(1-proj-3-tuple(v_812))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_812)) then cipherstatepack(2-proj-3-tuple(v_812),minnonce) else fail-any),1-proj-3-tuple(v_812),3-proj-3-tuple(v_808)) else fail-any) else fail-any) else fail-any)) in
        {410}let v_814: bitstring = catch-fail(symmetricstateunpack(v_813)) in
        {411}let v_815: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_814))) in
        {412}let v_816: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_815),2-proj-2-tuple(v_815),3-proj-3-tuple(v_814),msg_b(bob,charlie))) in
        {413}let v_817: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_814))) in
        {414}let v_818: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_815))) && success?(1-proj-3-tuple(v_814))) then (if (not-caught-fail(v_817) && success?(is-true(success?(1-proj-2-tuple(v_817))))) then cipherstatepack(1-proj-2-tuple(v_817),increment_nonce(2-proj-2-tuple(v_815))) else fail-any) else fail-any)) in
        {415}let v_819: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_814)) && success?(1-proj-3-tuple(v_814))) then (if (not-caught-fail(v_815) && success?(is-true(success?(1-proj-2-tuple(v_815))))) then (if not-caught-fail(v_816) then (if not-caught-fail(v_818) then (v_818,v_816) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {416}let v_820: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_819),2-proj-3-tuple(v_814),3-proj-3-tuple(v_814)))) in
        {417}let v_821: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_819)) && success?(symmetricstatepack(1-proj-2-tuple(v_819),2-proj-3-tuple(v_814),3-proj-3-tuple(v_814)))) then (if (not-caught-fail(v_820) && success?(is-true(success?(1-proj-3-tuple(v_820))))) then symmetricstatepack(1-proj-3-tuple(v_820),2-proj-3-tuple(v_820),hash(3-proj-3-tuple(v_820),2-proj-2-tuple(v_819))) else fail-any) else fail-any)) in
        {418}let v_822: bitstring = catch-fail((if (not-caught-fail(v_814) && success?(is-true(success?(1-proj-3-tuple(v_814))))) then (if (not-caught-fail(v_819) && success?(is-true(success?(1-proj-2-tuple(v_819))))) then (if not-caught-fail(v_821) then (v_821,2-proj-2-tuple(v_819)) else fail-any) else fail-any) else fail-any)) in
        {419}let v_823: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_822),2-proj-7-tuple(v_800),v_803,4-proj-7-tuple(v_800),5-proj-7-tuple(v_800),6-proj-7-tuple(v_800),7-proj-7-tuple(v_800))) in
        {420}let v_824: bitstring = catch-fail(concat3(v_804,2-proj-3-tuple(v_801),2-proj-2-tuple(v_822))) in
        {421}let (hs_825: handshakestate,re_826: key,message_b_827: bitstring) = (if (not-caught-fail(v_800) && success?(is-true(success?(1-proj-7-tuple(v_800))))) then (if (not-caught-fail(v_801) && success?(is-true(success?(1-proj-3-tuple(v_801))))) then (if not-caught-fail(v_803) then (if not-caught-fail(v_804) then (if not-caught-fail(v_806) then (if not-caught-fail(v_813) then (if (not-caught-fail(v_822) && success?(is-true(success?(1-proj-2-tuple(v_822))))) then (if not-caught-fail(v_823) then (if not-caught-fail(v_824) then (v_823,5-proj-7-tuple(v_800),v_824) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {422}event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true);
        {423}insert statestore(bob,charlie,statepack_c(hs_825));
        {424}out(pub, message_b_827)
    ) | (
        {460}get statestore(=bob,=charlie,statepack_c(hs_828: handshakestate)) in
        {426}in(pub, message_c_829: bitstring);
        {427}let v_830: bitstring = catch-fail(handshakestateunpack(hs_828)) in
        {428}let v_831: bitstring = catch-fail(deconcat3(message_c_829)) in
        {429}let v_832: bool = catch-fail(true) in
        {430}let v_833: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_830))) in
        {431}let v_834: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_830))) in
        {432}let v_835: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_834),(if (success?(4-proj-7-tuple(v_830)) && success?(3-proj-7-tuple(v_830))) then (if (not-caught-fail(v_833) && success?(is-true(success?(1-proj-2-tuple(v_833))))) then dhexp(2-proj-2-tuple(v_833),4-proj-7-tuple(v_830)) else fail-any) else fail-any))) in
        {433}let v_836: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_834),(if (success?(4-proj-7-tuple(v_830)) && success?(3-proj-7-tuple(v_830))) then (if (not-caught-fail(v_833) && success?(is-true(success?(1-proj-2-tuple(v_833))))) then dhexp(2-proj-2-tuple(v_833),4-proj-7-tuple(v_830)) else fail-any) else fail-any))) in
        {434}let v_837: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_834),(if (success?(4-proj-7-tuple(v_830)) && success?(3-proj-7-tuple(v_830))) then (if (not-caught-fail(v_833) && success?(is-true(success?(1-proj-2-tuple(v_833))))) then dhexp(2-proj-2-tuple(v_833),4-proj-7-tuple(v_830)) else fail-any) else fail-any))) in
        {435}let v_838: bitstring = catch-fail((if (success?((if (success?(4-proj-7-tuple(v_830)) && success?(3-proj-7-tuple(v_830))) then (if (not-caught-fail(v_833) && success?(is-true(success?(1-proj-2-tuple(v_833))))) then dhexp(2-proj-2-tuple(v_833),4-proj-7-tuple(v_830)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_834))) then (if not-caught-fail(v_835) then (if not-caught-fail(v_836) then (if not-caught-fail(v_837) then (v_835,v_836,v_837) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {436}let v_839: symmetricstate = catch-fail((if (success?((if (success?(4-proj-7-tuple(v_830)) && success?(3-proj-7-tuple(v_830))) then (if (not-caught-fail(v_833) && success?(is-true(success?(1-proj-2-tuple(v_833))))) then dhexp(2-proj-2-tuple(v_833),4-proj-7-tuple(v_830)) else fail-any) else fail-any)) && success?(1-proj-7-tuple(v_830))) then (if (not-caught-fail(v_834) && success?(is-true(success?(1-proj-3-tuple(v_834))))) then (if (not-caught-fail(v_838) && success?(is-true(success?(1-proj-3-tuple(v_838))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_838)) then cipherstatepack(2-proj-3-tuple(v_838),minnonce) else fail-any),1-proj-3-tuple(v_838),3-proj-3-tuple(v_834)) else fail-any) else fail-any) else fail-any)) in
        {437}let v_840: bitstring = catch-fail(symmetricstateunpack(v_839)) in
        {438}let v_841: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_840))) in
        {439}let v_842: aead = catch-fail(decrypt(1-proj-2-tuple(v_841),2-proj-2-tuple(v_841),3-proj-3-tuple(v_840),3-proj-3-tuple(v_831))) in
        {440}let v_843: bitstring = catch-fail(aeadunpack(v_842)) in
        {441}let v_844: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_840))) in
        {442}let v_845: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_841))) && success?(1-proj-3-tuple(v_840))) then (if (not-caught-fail(v_844) && success?(is-true(success?(1-proj-2-tuple(v_844))))) then cipherstatepack(1-proj-2-tuple(v_844),increment_nonce(2-proj-2-tuple(v_841))) else fail-any) else fail-any)) in
        {443}let v_846: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_831)) && (success?(3-proj-3-tuple(v_840)) && success?(1-proj-3-tuple(v_840)))) then (if (not-caught-fail(v_841) && success?(is-true(success?(1-proj-2-tuple(v_841))))) then (if not-caught-fail(v_842) then (if (not-caught-fail(v_843) && success?(is-true(success?(1-proj-3-tuple(v_843))))) then (if not-caught-fail(v_845) then (v_845,3-proj-3-tuple(v_843),1-proj-3-tuple(v_843)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {444}let v_847: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_846),2-proj-3-tuple(v_840),3-proj-3-tuple(v_840)))) in
        {445}let v_848: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_831)) && success?(symmetricstatepack(1-proj-3-tuple(v_846),2-proj-3-tuple(v_840),3-proj-3-tuple(v_840)))) then (if (not-caught-fail(v_847) && success?(is-true(success?(1-proj-3-tuple(v_847))))) then symmetricstatepack(1-proj-3-tuple(v_847),2-proj-3-tuple(v_847),hash(3-proj-3-tuple(v_847),3-proj-3-tuple(v_831))) else fail-any) else fail-any)) in
        {446}let v_849: bitstring = catch-fail((if success?(3-proj-3-tuple(v_831)) then (if (not-caught-fail(v_840) && success?(is-true(success?(1-proj-3-tuple(v_840))))) then (if (not-caught-fail(v_846) && success?(is-true(success?(1-proj-3-tuple(v_846))))) then (if not-caught-fail(v_848) then (v_848,2-proj-3-tuple(v_846),3-proj-3-tuple(v_846)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {447}let v_850: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_849),2-proj-7-tuple(v_830),3-proj-7-tuple(v_830),4-proj-7-tuple(v_830),5-proj-7-tuple(v_830),6-proj-7-tuple(v_830),7-proj-7-tuple(v_830))) in
        {448}let v_851: bitstring = catch-fail(symmetricstateunpack(1-proj-3-tuple(v_849))) in
        {449}let v_852: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_851),zero)) in
        {450}let v_853: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_851),zero)) in
        {451}let v_854: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_851),zero)) in
        {452}let v_855: bitstring = catch-fail((if success?(2-proj-3-tuple(v_851)) then (if not-caught-fail(v_852) then (if not-caught-fail(v_853) then (if not-caught-fail(v_854) then (v_852,v_853,v_854) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {453}let v_856: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_855)) then cipherstatepack(1-proj-3-tuple(v_855),minnonce) else fail-any)) in
        {454}let v_857: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_855)) then cipherstatepack(2-proj-3-tuple(v_855),minnonce) else fail-any)) in
        {455}let v_858: bitstring = catch-fail((if success?(1-proj-3-tuple(v_849)) then (if (not-caught-fail(v_851) && success?(is-true(success?(1-proj-3-tuple(v_851))))) then (if (not-caught-fail(v_855) && success?(is-true(success?(1-proj-3-tuple(v_855))))) then (if not-caught-fail(v_856) then (if not-caught-fail(v_857) then (1-proj-3-tuple(v_849),v_856,v_857) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {456}let (hs_859: handshakestate,re_860: key,plaintext_c_861: bitstring,valid_862: bool,cs1_863: cipherstate,cs2_864: cipherstate) = (if (not-caught-fail(v_830) && success?(is-true(success?(1-proj-7-tuple(v_830))))) then (if (not-caught-fail(v_831) && success?(is-true(success?(1-proj-3-tuple(v_831))))) then (if not-caught-fail(v_832) then (if not-caught-fail(v_839) then (if (not-caught-fail(v_849) && success?(is-true(success?(1-proj-3-tuple(v_849))))) then (if (v_832 && 3-proj-3-tuple(v_849)) then (if not-caught-fail(v_850) then (if (not-caught-fail(v_858) && success?(is-true(success?(1-proj-3-tuple(v_858))))) then (v_850,getpublickey(3-proj-7-tuple(v_830)),2-proj-3-tuple(v_849),true,2-proj-3-tuple(v_858),3-proj-3-tuple(v_858)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {457}event RecvMsg(bob,charlie,stage_c,plaintext_c_861,valid_862);
        {458}insert statestore(bob,charlie,statepack_d(hs_859));
        {459}event RecvEnd(valid_862)
    ) | (
        {461}event LeakS(phase0,bob);
        {462}out(pub, key_s(bob))
    ) | (
        {463}phase 1;
        {464}event LeakS(phase1,bob);
        {465}out(pub, key_s(bob))
    )
) | (
    {466}out(pub, (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)))
)

-- Query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_945,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_945,stage_a,m,true)) || event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)); not attacker_p1(msg_a(alice,bob)); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_945,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_945,stage_b,m,true)) || event(LeakS(phase0,bob)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)); not attacker_p1(msg_b(bob,alice)); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice)); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob))); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_945,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_945,stage_c,m,true)) || event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)); not attacker_p1(msg_c(alice,bob)); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)); not event(RecvEnd(true))
Completing...
200 rules inserted. The rule base contains 200 rules. 172 rules in the queue.
400 rules inserted. The rule base contains 395 rules. 95 rules in the queue.
600 rules inserted. The rule base contains 583 rules. 150 rules in the queue.
800 rules inserted. The rule base contains 777 rules. 261 rules in the queue.
1000 rules inserted. The rule base contains 933 rules. 241 rules in the queue.
1200 rules inserted. The rule base contains 1133 rules. 330 rules in the queue.
1400 rules inserted. The rule base contains 1333 rules. 374 rules in the queue.
1600 rules inserted. The rule base contains 1498 rules. 385 rules in the queue.
1800 rules inserted. The rule base contains 1609 rules. 339 rules in the queue.
2000 rules inserted. The rule base contains 1767 rules. 325 rules in the queue.
2200 rules inserted. The rule base contains 1957 rules. 322 rules in the queue.
2400 rules inserted. The rule base contains 2112 rules. 328 rules in the queue.
2600 rules inserted. The rule base contains 2251 rules. 327 rules in the queue.
2800 rules inserted. The rule base contains 2349 rules. 344 rules in the queue.
3000 rules inserted. The rule base contains 2432 rules. 281 rules in the queue.
3200 rules inserted. The rule base contains 2549 rules. 359 rules in the queue.
3400 rules inserted. The rule base contains 2611 rules. 352 rules in the queue.
3600 rules inserted. The rule base contains 2753 rules. 371 rules in the queue.
3800 rules inserted. The rule base contains 2810 rules. 379 rules in the queue.
4000 rules inserted. The rule base contains 2943 rules. 443 rules in the queue.
4200 rules inserted. The rule base contains 3014 rules. 487 rules in the queue.
4400 rules inserted. The rule base contains 3158 rules. 840 rules in the queue.
4600 rules inserted. The rule base contains 3182 rules. 849 rules in the queue.
4800 rules inserted. The rule base contains 3371 rules. 992 rules in the queue.
5000 rules inserted. The rule base contains 3565 rules. 1204 rules in the queue.
5200 rules inserted. The rule base contains 3759 rules. 1494 rules in the queue.
5400 rules inserted. The rule base contains 3847 rules. 1466 rules in the queue.
5600 rules inserted. The rule base contains 4030 rules. 1454 rules in the queue.
5800 rules inserted. The rule base contains 4225 rules. 1407 rules in the queue.
6000 rules inserted. The rule base contains 4419 rules. 1348 rules in the queue.
6200 rules inserted. The rule base contains 4613 rules. 1287 rules in the queue.
6400 rules inserted. The rule base contains 4805 rules. 1567 rules in the queue.
6600 rules inserted. The rule base contains 5000 rules. 1923 rules in the queue.
6800 rules inserted. The rule base contains 5164 rules. 1912 rules in the queue.
7000 rules inserted. The rule base contains 5296 rules. 1911 rules in the queue.
7200 rules inserted. The rule base contains 5496 rules. 1924 rules in the queue.
7400 rules inserted. The rule base contains 5696 rules. 1936 rules in the queue.
7600 rules inserted. The rule base contains 5892 rules. 1988 rules in the queue.
7800 rules inserted. The rule base contains 6085 rules. 1916 rules in the queue.
8000 rules inserted. The rule base contains 6280 rules. 1866 rules in the queue.
8200 rules inserted. The rule base contains 6473 rules. 1790 rules in the queue.
8400 rules inserted. The rule base contains 6666 rules. 1711 rules in the queue.
8600 rules inserted. The rule base contains 6835 rules. 1681 rules in the queue.
8800 rules inserted. The rule base contains 6924 rules. 1681 rules in the queue.
9000 rules inserted. The rule base contains 7011 rules. 1751 rules in the queue.
9200 rules inserted. The rule base contains 7139 rules. 1740 rules in the queue.
9400 rules inserted. The rule base contains 7291 rules. 1736 rules in the queue.
9600 rules inserted. The rule base contains 7462 rules. 1740 rules in the queue.
9800 rules inserted. The rule base contains 7662 rules. 1752 rules in the queue.
10000 rules inserted. The rule base contains 7862 rules. 1763 rules in the queue.
10200 rules inserted. The rule base contains 8033 rules. 1788 rules in the queue.
10400 rules inserted. The rule base contains 8120 rules. 1848 rules in the queue.
10600 rules inserted. The rule base contains 8219 rules. 1819 rules in the queue.
10800 rules inserted. The rule base contains 8339 rules. 1812 rules in the queue.
11000 rules inserted. The rule base contains 8411 rules. 1777 rules in the queue.
11200 rules inserted. The rule base contains 8567 rules. 1840 rules in the queue.
11400 rules inserted. The rule base contains 8756 rules. 1852 rules in the queue.
11600 rules inserted. The rule base contains 8911 rules. 1849 rules in the queue.
11800 rules inserted. The rule base contains 9063 rules. 1851 rules in the queue.
12000 rules inserted. The rule base contains 9137 rules. 1914 rules in the queue.
12200 rules inserted. The rule base contains 9267 rules. 2054 rules in the queue.
12400 rules inserted. The rule base contains 9392 rules. 2058 rules in the queue.
12600 rules inserted. The rule base contains 9592 rules. 2055 rules in the queue.
12800 rules inserted. The rule base contains 9792 rules. 2056 rules in the queue.
13000 rules inserted. The rule base contains 9939 rules. 2030 rules in the queue.
13200 rules inserted. The rule base contains 10011 rules. 2010 rules in the queue.
13400 rules inserted. The rule base contains 10074 rules. 1977 rules in the queue.
13600 rules inserted. The rule base contains 10180 rules. 1978 rules in the queue.
13800 rules inserted. The rule base contains 10258 rules. 1964 rules in the queue.
14000 rules inserted. The rule base contains 10423 rules. 1944 rules in the queue.
14200 rules inserted. The rule base contains 10545 rules. 1950 rules in the queue.
14400 rules inserted. The rule base contains 10745 rules. 1939 rules in the queue.
14600 rules inserted. The rule base contains 10945 rules. 1938 rules in the queue.
14800 rules inserted. The rule base contains 11125 rules. 1940 rules in the queue.
15000 rules inserted. The rule base contains 11305 rules. 1947 rules in the queue.
15200 rules inserted. The rule base contains 11505 rules. 1956 rules in the queue.
15400 rules inserted. The rule base contains 11705 rules. 1968 rules in the queue.
15600 rules inserted. The rule base contains 11838 rules. 1990 rules in the queue.
15800 rules inserted. The rule base contains 11919 rules. 1921 rules in the queue.
16000 rules inserted. The rule base contains 12052 rules. 1884 rules in the queue.
16200 rules inserted. The rule base contains 12140 rules. 1881 rules in the queue.
16400 rules inserted. The rule base contains 12340 rules. 1909 rules in the queue.
16600 rules inserted. The rule base contains 12540 rules. 1941 rules in the queue.
16800 rules inserted. The rule base contains 12724 rules. 1956 rules in the queue.
17000 rules inserted. The rule base contains 12924 rules. 1957 rules in the queue.
17200 rules inserted. The rule base contains 13124 rules. 1961 rules in the queue.
17400 rules inserted. The rule base contains 13324 rules. 1961 rules in the queue.
17600 rules inserted. The rule base contains 13426 rules. 1958 rules in the queue.
17800 rules inserted. The rule base contains 13531 rules. 2037 rules in the queue.
18000 rules inserted. The rule base contains 13633 rules. 2033 rules in the queue.
18200 rules inserted. The rule base contains 13833 rules. 2048 rules in the queue.
18400 rules inserted. The rule base contains 14033 rules. 2063 rules in the queue.
18600 rules inserted. The rule base contains 14233 rules. 2078 rules in the queue.
18800 rules inserted. The rule base contains 14401 rules. 2076 rules in the queue.
19000 rules inserted. The rule base contains 14601 rules. 2105 rules in the queue.
19200 rules inserted. The rule base contains 14801 rules. 2141 rules in the queue.
19400 rules inserted. The rule base contains 14977 rules. 2173 rules in the queue.
19600 rules inserted. The rule base contains 15051 rules. 2161 rules in the queue.
19800 rules inserted. The rule base contains 15235 rules. 2202 rules in the queue.
20000 rules inserted. The rule base contains 15340 rules. 2159 rules in the queue.
20200 rules inserted. The rule base contains 15532 rules. 2160 rules in the queue.
20400 rules inserted. The rule base contains 15732 rules. 2175 rules in the queue.
20600 rules inserted. The rule base contains 15928 rules. 2180 rules in the queue.
20800 rules inserted. The rule base contains 16124 rules. 2191 rules in the queue.
21000 rules inserted. The rule base contains 16324 rules. 2214 rules in the queue.
21200 rules inserted. The rule base contains 16524 rules. 2232 rules in the queue.
21400 rules inserted. The rule base contains 16724 rules. 2252 rules in the queue.
21600 rules inserted. The rule base contains 16910 rules. 2200 rules in the queue.
21800 rules inserted. The rule base contains 17110 rules. 2129 rules in the queue.
22000 rules inserted. The rule base contains 17267 rules. 2153 rules in the queue.
22200 rules inserted. The rule base contains 17343 rules. 2203 rules in the queue.
22400 rules inserted. The rule base contains 17543 rules. 2231 rules in the queue.
22600 rules inserted. The rule base contains 17739 rules. 2259 rules in the queue.
22800 rules inserted. The rule base contains 17927 rules. 2267 rules in the queue.
23000 rules inserted. The rule base contains 18123 rules. 2285 rules in the queue.
23200 rules inserted. The rule base contains 18323 rules. 2299 rules in the queue.
23400 rules inserted. The rule base contains 18523 rules. 2309 rules in the queue.
23600 rules inserted. The rule base contains 18723 rules. 2327 rules in the queue.
23800 rules inserted. The rule base contains 18901 rules. 2323 rules in the queue.
24000 rules inserted. The rule base contains 19101 rules. 2322 rules in the queue.
24200 rules inserted. The rule base contains 19214 rules. 2293 rules in the queue.
24400 rules inserted. The rule base contains 19209 rules. 2324 rules in the queue.
24600 rules inserted. The rule base contains 19408 rules. 2320 rules in the queue.
24800 rules inserted. The rule base contains 19604 rules. 2304 rules in the queue.
25000 rules inserted. The rule base contains 19764 rules. 2252 rules in the queue.
25200 rules inserted. The rule base contains 19959 rules. 2368 rules in the queue.
25400 rules inserted. The rule base contains 20151 rules. 2397 rules in the queue.
25600 rules inserted. The rule base contains 20351 rules. 2435 rules in the queue.
25800 rules inserted. The rule base contains 20547 rules. 2458 rules in the queue.
26000 rules inserted. The rule base contains 20719 rules. 2478 rules in the queue.
26200 rules inserted. The rule base contains 20897 rules. 2510 rules in the queue.
26400 rules inserted. The rule base contains 21063 rules. 2541 rules in the queue.
26600 rules inserted. The rule base contains 21115 rules. 2502 rules in the queue.
26800 rules inserted. The rule base contains 21259 rules. 2478 rules in the queue.
27000 rules inserted. The rule base contains 21442 rules. 2455 rules in the queue.
27200 rules inserted. The rule base contains 21546 rules. 2432 rules in the queue.
27400 rules inserted. The rule base contains 21741 rules. 2428 rules in the queue.
27600 rules inserted. The rule base contains 21926 rules. 2357 rules in the queue.
27800 rules inserted. The rule base contains 22126 rules. 2374 rules in the queue.
28000 rules inserted. The rule base contains 22326 rules. 2345 rules in the queue.
28200 rules inserted. The rule base contains 22518 rules. 2345 rules in the queue.
28400 rules inserted. The rule base contains 22688 rules. 2318 rules in the queue.
28600 rules inserted. The rule base contains 22833 rules. 2319 rules in the queue.
28800 rules inserted. The rule base contains 22924 rules. 2298 rules in the queue.
29000 rules inserted. The rule base contains 22930 rules. 2310 rules in the queue.
29200 rules inserted. The rule base contains 23079 rules. 2276 rules in the queue.
29400 rules inserted. The rule base contains 23199 rules. 2221 rules in the queue.
29600 rules inserted. The rule base contains 23324 rules. 2232 rules in the queue.
29800 rules inserted. The rule base contains 23491 rules. 2184 rules in the queue.
30000 rules inserted. The rule base contains 23674 rules. 2181 rules in the queue.
30200 rules inserted. The rule base contains 23868 rules. 2157 rules in the queue.
30400 rules inserted. The rule base contains 23992 rules. 2109 rules in the queue.
30600 rules inserted. The rule base contains 24027 rules. 2040 rules in the queue.
30800 rules inserted. The rule base contains 24049 rules. 1928 rules in the queue.
31000 rules inserted. The rule base contains 23673 rules. 1872 rules in the queue.
31200 rules inserted. The rule base contains 23853 rules. 1917 rules in the queue.
31400 rules inserted. The rule base contains 23993 rules. 1932 rules in the queue.
31600 rules inserted. The rule base contains 24144 rules. 1932 rules in the queue.
31800 rules inserted. The rule base contains 24284 rules. 1887 rules in the queue.
32000 rules inserted. The rule base contains 24482 rules. 1808 rules in the queue.
32200 rules inserted. The rule base contains 24546 rules. 1741 rules in the queue.
32400 rules inserted. The rule base contains 24625 rules. 1799 rules in the queue.
32600 rules inserted. The rule base contains 24744 rules. 1871 rules in the queue.
32800 rules inserted. The rule base contains 24540 rules. 1767 rules in the queue.
33000 rules inserted. The rule base contains 24644 rules. 1875 rules in the queue.
33200 rules inserted. The rule base contains 24755 rules. 1914 rules in the queue.
33400 rules inserted. The rule base contains 24896 rules. 1886 rules in the queue.
33600 rules inserted. The rule base contains 25070 rules. 1894 rules in the queue.
33800 rules inserted. The rule base contains 25270 rules. 1876 rules in the queue.
34000 rules inserted. The rule base contains 25449 rules. 1878 rules in the queue.
34200 rules inserted. The rule base contains 25629 rules. 1884 rules in the queue.
34400 rules inserted. The rule base contains 25716 rules. 1858 rules in the queue.
34600 rules inserted. The rule base contains 23851 rules. 1812 rules in the queue.
34800 rules inserted. The rule base contains 23899 rules. 1852 rules in the queue.
35000 rules inserted. The rule base contains 23964 rules. 1831 rules in the queue.
35200 rules inserted. The rule base contains 23757 rules. 1784 rules in the queue.
35400 rules inserted. The rule base contains 23945 rules. 1862 rules in the queue.
35600 rules inserted. The rule base contains 24100 rules. 1939 rules in the queue.
35800 rules inserted. The rule base contains 24250 rules. 1980 rules in the queue.
36000 rules inserted. The rule base contains 24416 rules. 2034 rules in the queue.
36200 rules inserted. The rule base contains 24473 rules. 2041 rules in the queue.
36400 rules inserted. The rule base contains 24533 rules. 2008 rules in the queue.
36600 rules inserted. The rule base contains 24571 rules. 1992 rules in the queue.
36800 rules inserted. The rule base contains 24605 rules. 1987 rules in the queue.
37000 rules inserted. The rule base contains 24773 rules. 1963 rules in the queue.
37200 rules inserted. The rule base contains 24891 rules. 1912 rules in the queue.
37400 rules inserted. The rule base contains 24975 rules. 1908 rules in the queue.
37600 rules inserted. The rule base contains 25108 rules. 1815 rules in the queue.
37800 rules inserted. The rule base contains 25284 rules. 1808 rules in the queue.
38000 rules inserted. The rule base contains 25452 rules. 1798 rules in the queue.
38200 rules inserted. The rule base contains 25515 rules. 1792 rules in the queue.
38400 rules inserted. The rule base contains 25513 rules. 1792 rules in the queue.
38600 rules inserted. The rule base contains 25513 rules. 1792 rules in the queue.
38800 rules inserted. The rule base contains 25554 rules. 1768 rules in the queue.
39000 rules inserted. The rule base contains 22860 rules. 1666 rules in the queue.
39200 rules inserted. The rule base contains 22972 rules. 1602 rules in the queue.
39400 rules inserted. The rule base contains 23099 rules. 1578 rules in the queue.
39600 rules inserted. The rule base contains 23241 rules. 1576 rules in the queue.
39800 rules inserted. The rule base contains 23330 rules. 1595 rules in the queue.
40000 rules inserted. The rule base contains 23330 rules. 1594 rules in the queue.
40200 rules inserted. The rule base contains 23330 rules. 1594 rules in the queue.
40400 rules inserted. The rule base contains 23357 rules. 1591 rules in the queue.
40600 rules inserted. The rule base contains 23434 rules. 1595 rules in the queue.
40800 rules inserted. The rule base contains 23434 rules. 1595 rules in the queue.
41000 rules inserted. The rule base contains 23534 rules. 1598 rules in the queue.
41200 rules inserted. The rule base contains 23630 rules. 1617 rules in the queue.
41400 rules inserted. The rule base contains 23683 rules. 1584 rules in the queue.
41600 rules inserted. The rule base contains 23687 rules. 1580 rules in the queue.
41800 rules inserted. The rule base contains 23691 rules. 1576 rules in the queue.
42000 rules inserted. The rule base contains 23774 rules. 1564 rules in the queue.
42200 rules inserted. The rule base contains 21473 rules. 1532 rules in the queue.
42400 rules inserted. The rule base contains 21506 rules. 1517 rules in the queue.
42600 rules inserted. The rule base contains 21610 rules. 1530 rules in the queue.
42800 rules inserted. The rule base contains 21716 rules. 1540 rules in the queue.
43000 rules inserted. The rule base contains 21786 rules. 1521 rules in the queue.
43200 rules inserted. The rule base contains 21801 rules. 1507 rules in the queue.
43400 rules inserted. The rule base contains 21836 rules. 1480 rules in the queue.
43600 rules inserted. The rule base contains 21725 rules. 1437 rules in the queue.
43800 rules inserted. The rule base contains 21745 rules. 1421 rules in the queue.
44000 rules inserted. The rule base contains 21878 rules. 1431 rules in the queue.
44200 rules inserted. The rule base contains 22052 rules. 1436 rules in the queue.
44400 rules inserted. The rule base contains 22221 rules. 1438 rules in the queue.
44600 rules inserted. The rule base contains 22294 rules. 1418 rules in the queue.
44800 rules inserted. The rule base contains 22353 rules. 1361 rules in the queue.
45000 rules inserted. The rule base contains 22462 rules. 1339 rules in the queue.
45200 rules inserted. The rule base contains 22490 rules. 1339 rules in the queue.
45400 rules inserted. The rule base contains 22619 rules. 1333 rules in the queue.
45600 rules inserted. The rule base contains 22801 rules. 1336 rules in the queue.
45800 rules inserted. The rule base contains 22979 rules. 1324 rules in the queue.
46000 rules inserted. The rule base contains 23055 rules. 1290 rules in the queue.
46200 rules inserted. The rule base contains 23039 rules. 1209 rules in the queue.
46400 rules inserted. The rule base contains 23115 rules. 1203 rules in the queue.
46600 rules inserted. The rule base contains 23004 rules. 1210 rules in the queue.
46800 rules inserted. The rule base contains 23145 rules. 1191 rules in the queue.
47000 rules inserted. The rule base contains 23285 rules. 1164 rules in the queue.
47200 rules inserted. The rule base contains 23367 rules. 1142 rules in the queue.
47400 rules inserted. The rule base contains 23348 rules. 1089 rules in the queue.
47600 rules inserted. The rule base contains 23080 rules. 1031 rules in the queue.
47800 rules inserted. The rule base contains 23053 rules. 955 rules in the queue.
48000 rules inserted. The rule base contains 23169 rules. 905 rules in the queue.
48200 rules inserted. The rule base contains 23278 rules. 824 rules in the queue.
48400 rules inserted. The rule base contains 23374 rules. 772 rules in the queue.
48600 rules inserted. The rule base contains 23318 rules. 662 rules in the queue.
48800 rules inserted. The rule base contains 22821 rules. 361 rules in the queue.
49000 rules inserted. The rule base contains 22949 rules. 347 rules in the queue.
49200 rules inserted. The rule base contains 22982 rules. 216 rules in the queue.
49400 rules inserted. The rule base contains 18843 rules. 122 rules in the queue.
49600 rules inserted. The rule base contains 18915 rules. 64 rules in the queue.
49800 rules inserted. The rule base contains 18899 rules. 64 rules in the queue.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true))
goal reachable: attacker(m_43378268) -> end(RecvMsg(bob,alice,stage_a,m_43378268,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_43378316).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 4, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_43378316.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43378316).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43378316)).

19. The attacker has some term b_43378302.
attacker(b_43378302).

20. By 3, the attacker may know g.
By 19, the attacker may know b_43378302.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43378316).
Using the function concat3 the attacker may obtain concat3(g,b_43378302,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43378316)).
attacker(concat3(g,b_43378302,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43378316))).

21. By 4, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43378302,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43378316)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43378302,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43378316))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {278}.
The message concat3(g,b_43378302,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43378316)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_43378316,true) may be executed at {276}.
end(RecvMsg(bob,alice,stage_a,m_43378316,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43380106,~M_43380107,~M_43380108)) with ~M_43380106 = key_s(charlie), ~M_43380107 = key_e(charlie,alice), ~M_43380108 = key_e(charlie,bob) at {466} in copy a_43378322

out(pub, ~M_43380337) with ~M_43380337 = dhexp(key_s(bob),g) at {351} in copy a_43378322

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43378322

out(pub, ~M_43380772) with ~M_43380772 = dhexp(key_s(bob),g) at {234} in copy a_43378322

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43378322

out(pub, ~M_43381201) with ~M_43381201 = dhexp(key_s(alice),g) at {119} in copy a_43378322

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43378322

out(pub, ~M_43381630) with ~M_43381630 = dhexp(key_s(alice),g) at {4} in copy a_43378322

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43378322

out(pub, (~M_43381839,~M_43381840,~M_43381841)) with ~M_43381839 = key_s(charlie), ~M_43381840 = key_e(charlie,alice), ~M_43381841 = key_e(charlie,bob) at {466} in copy a_43378321

out(pub, ~M_43382070) with ~M_43382070 = dhexp(key_s(bob),g) at {351} in copy a_43378321

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43378321

out(pub, ~M_43382505) with ~M_43382505 = dhexp(key_s(bob),g) at {234} in copy a_43378321

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43378321

out(pub, ~M_43382934) with ~M_43382934 = dhexp(key_s(alice),g) at {119} in copy a_43378321

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43378321

out(pub, ~M_43383363) with ~M_43383363 = dhexp(key_s(alice),g) at {4} in copy a_43378321

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43378321

out(pub, (~M_43383572,~M_43383573,~M_43383574)) with ~M_43383572 = key_s(charlie), ~M_43383573 = key_e(charlie,alice), ~M_43383574 = key_e(charlie,bob) at {466} in copy a_43378320

out(pub, ~M_43383803) with ~M_43383803 = dhexp(key_s(bob),g) at {351} in copy a_43378320

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43378320

out(pub, ~M_43384238) with ~M_43384238 = dhexp(key_s(bob),g) at {234} in copy a_43378320

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43378320

out(pub, ~M_43384667) with ~M_43384667 = dhexp(key_s(alice),g) at {119} in copy a_43378320

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43378320

out(pub, ~M_43385096) with ~M_43385096 = dhexp(key_s(alice),g) at {4} in copy a_43378320

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43378320

out(pub, (~M_43385305,~M_43385306,~M_43385307)) with ~M_43385305 = key_s(charlie), ~M_43385306 = key_e(charlie,alice), ~M_43385307 = key_e(charlie,bob) at {466} in copy a_43378319

out(pub, ~M_43385536) with ~M_43385536 = dhexp(key_s(bob),g) at {351} in copy a_43378319

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43378319

out(pub, ~M_43385971) with ~M_43385971 = dhexp(key_s(bob),g) at {234} in copy a_43378319

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43378319

out(pub, ~M_43386400) with ~M_43386400 = dhexp(key_s(alice),g) at {119} in copy a_43378319

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43378319

out(pub, ~M_43386829) with ~M_43386829 = dhexp(key_s(alice),g) at {4} in copy a_43378319

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43378319

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43378322

in(pub, concat3(g,a_43378318,encrypt(hmac_hash2(hash(somename,empty),~M_43380337),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43381201),~M_43380337),g),a_43378317))) with encrypt(hmac_hash2(hash(somename,empty),~M_43380337),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43381201),~M_43380337),g),a_43378317) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43378317) at {250} in copy a_43378322

event RecvMsg(bob,alice,stage_a,a_43378317,true) at {276} in copy a_43378322 (goal)

The event RecvMsg(bob,alice,stage_a,a_43378317,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_945,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_43388054) -> end(RecvMsg(bob,alice,stage_a,m_43388054,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_43388103).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 4, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_43388103.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43388103).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43388103)).

19. The attacker has some term b_43388089.
attacker(b_43388089).

20. By 3, the attacker may know g.
By 19, the attacker may know b_43388089.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43388103).
Using the function concat3 the attacker may obtain concat3(g,b_43388089,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43388103)).
attacker(concat3(g,b_43388089,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43388103))).

21. By 4, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43388089,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43388103)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43388089,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43388103))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {278}.
The message concat3(g,b_43388089,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43388103)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_43388103,true) may be executed at {276}.
end(RecvMsg(bob,alice,stage_a,m_43388103,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43389897,~M_43389898,~M_43389899)) with ~M_43389897 = key_s(charlie), ~M_43389898 = key_e(charlie,alice), ~M_43389899 = key_e(charlie,bob) at {466} in copy a_43388109

out(pub, ~M_43390128) with ~M_43390128 = dhexp(key_s(bob),g) at {351} in copy a_43388109

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43388109

out(pub, ~M_43390563) with ~M_43390563 = dhexp(key_s(bob),g) at {234} in copy a_43388109

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43388109

out(pub, ~M_43390992) with ~M_43390992 = dhexp(key_s(alice),g) at {119} in copy a_43388109

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43388109

out(pub, ~M_43391421) with ~M_43391421 = dhexp(key_s(alice),g) at {4} in copy a_43388109

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43388109

out(pub, (~M_43391630,~M_43391631,~M_43391632)) with ~M_43391630 = key_s(charlie), ~M_43391631 = key_e(charlie,alice), ~M_43391632 = key_e(charlie,bob) at {466} in copy a_43388108

out(pub, ~M_43391861) with ~M_43391861 = dhexp(key_s(bob),g) at {351} in copy a_43388108

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43388108

out(pub, ~M_43392296) with ~M_43392296 = dhexp(key_s(bob),g) at {234} in copy a_43388108

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43388108

out(pub, ~M_43392725) with ~M_43392725 = dhexp(key_s(alice),g) at {119} in copy a_43388108

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43388108

out(pub, ~M_43393154) with ~M_43393154 = dhexp(key_s(alice),g) at {4} in copy a_43388108

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43388108

out(pub, (~M_43393363,~M_43393364,~M_43393365)) with ~M_43393363 = key_s(charlie), ~M_43393364 = key_e(charlie,alice), ~M_43393365 = key_e(charlie,bob) at {466} in copy a_43388107

out(pub, ~M_43393594) with ~M_43393594 = dhexp(key_s(bob),g) at {351} in copy a_43388107

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43388107

out(pub, ~M_43394029) with ~M_43394029 = dhexp(key_s(bob),g) at {234} in copy a_43388107

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43388107

out(pub, ~M_43394458) with ~M_43394458 = dhexp(key_s(alice),g) at {119} in copy a_43388107

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43388107

out(pub, ~M_43394887) with ~M_43394887 = dhexp(key_s(alice),g) at {4} in copy a_43388107

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43388107

out(pub, (~M_43395096,~M_43395097,~M_43395098)) with ~M_43395096 = key_s(charlie), ~M_43395097 = key_e(charlie,alice), ~M_43395098 = key_e(charlie,bob) at {466} in copy a_43388106

out(pub, ~M_43395327) with ~M_43395327 = dhexp(key_s(bob),g) at {351} in copy a_43388106

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43388106

out(pub, ~M_43395762) with ~M_43395762 = dhexp(key_s(bob),g) at {234} in copy a_43388106

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43388106

out(pub, ~M_43396191) with ~M_43396191 = dhexp(key_s(alice),g) at {119} in copy a_43388106

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43388106

out(pub, ~M_43396620) with ~M_43396620 = dhexp(key_s(alice),g) at {4} in copy a_43388106

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43388106

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43388109

in(pub, concat3(g,a_43388105,encrypt(hmac_hash2(hash(somename,empty),~M_43390128),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43390992),~M_43390128),g),a_43388104))) with encrypt(hmac_hash2(hash(somename,empty),~M_43390128),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43390992),~M_43390128),g),a_43388104) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43388104) at {250} in copy a_43388109

event RecvMsg(bob,alice,stage_a,a_43388104,true) at {276} in copy a_43388109 (goal)

The event RecvMsg(bob,alice,stage_a,a_43388104,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_945,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_945,stage_a,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_43397845) -> end(RecvMsg(bob,alice,stage_a,m_43397845,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_43397894).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 4, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_43397894.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43397894).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43397894)).

19. The attacker has some term b_43397880.
attacker(b_43397880).

20. By 3, the attacker may know g.
By 19, the attacker may know b_43397880.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43397894).
Using the function concat3 the attacker may obtain concat3(g,b_43397880,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43397894)).
attacker(concat3(g,b_43397880,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43397894))).

21. By 4, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43397880,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43397894)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43397880,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43397894))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {278}.
The message concat3(g,b_43397880,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43397894)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_43397894,true) may be executed at {276}.
end(RecvMsg(bob,alice,stage_a,m_43397894,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43399688,~M_43399689,~M_43399690)) with ~M_43399688 = key_s(charlie), ~M_43399689 = key_e(charlie,alice), ~M_43399690 = key_e(charlie,bob) at {466} in copy a_43397900

out(pub, ~M_43399919) with ~M_43399919 = dhexp(key_s(bob),g) at {351} in copy a_43397900

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43397900

out(pub, ~M_43400354) with ~M_43400354 = dhexp(key_s(bob),g) at {234} in copy a_43397900

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43397900

out(pub, ~M_43400783) with ~M_43400783 = dhexp(key_s(alice),g) at {119} in copy a_43397900

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43397900

out(pub, ~M_43401212) with ~M_43401212 = dhexp(key_s(alice),g) at {4} in copy a_43397900

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43397900

out(pub, (~M_43401421,~M_43401422,~M_43401423)) with ~M_43401421 = key_s(charlie), ~M_43401422 = key_e(charlie,alice), ~M_43401423 = key_e(charlie,bob) at {466} in copy a_43397899

out(pub, ~M_43401652) with ~M_43401652 = dhexp(key_s(bob),g) at {351} in copy a_43397899

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43397899

out(pub, ~M_43402087) with ~M_43402087 = dhexp(key_s(bob),g) at {234} in copy a_43397899

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43397899

out(pub, ~M_43402516) with ~M_43402516 = dhexp(key_s(alice),g) at {119} in copy a_43397899

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43397899

out(pub, ~M_43402945) with ~M_43402945 = dhexp(key_s(alice),g) at {4} in copy a_43397899

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43397899

out(pub, (~M_43403154,~M_43403155,~M_43403156)) with ~M_43403154 = key_s(charlie), ~M_43403155 = key_e(charlie,alice), ~M_43403156 = key_e(charlie,bob) at {466} in copy a_43397898

out(pub, ~M_43403385) with ~M_43403385 = dhexp(key_s(bob),g) at {351} in copy a_43397898

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43397898

out(pub, ~M_43403820) with ~M_43403820 = dhexp(key_s(bob),g) at {234} in copy a_43397898

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43397898

out(pub, ~M_43404249) with ~M_43404249 = dhexp(key_s(alice),g) at {119} in copy a_43397898

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43397898

out(pub, ~M_43404678) with ~M_43404678 = dhexp(key_s(alice),g) at {4} in copy a_43397898

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43397898

out(pub, (~M_43404887,~M_43404888,~M_43404889)) with ~M_43404887 = key_s(charlie), ~M_43404888 = key_e(charlie,alice), ~M_43404889 = key_e(charlie,bob) at {466} in copy a_43397897

out(pub, ~M_43405118) with ~M_43405118 = dhexp(key_s(bob),g) at {351} in copy a_43397897

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43397897

out(pub, ~M_43405553) with ~M_43405553 = dhexp(key_s(bob),g) at {234} in copy a_43397897

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43397897

out(pub, ~M_43405982) with ~M_43405982 = dhexp(key_s(alice),g) at {119} in copy a_43397897

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43397897

out(pub, ~M_43406411) with ~M_43406411 = dhexp(key_s(alice),g) at {4} in copy a_43397897

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43397897

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43397900

in(pub, concat3(g,a_43397896,encrypt(hmac_hash2(hash(somename,empty),~M_43399919),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43400783),~M_43399919),g),a_43397895))) with encrypt(hmac_hash2(hash(somename,empty),~M_43399919),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43400783),~M_43399919),g),a_43397895) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43397895) at {250} in copy a_43397900

event RecvMsg(bob,alice,stage_a,a_43397895,true) at {276} in copy a_43397900 (goal)

The event RecvMsg(bob,alice,stage_a,a_43397895,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_945,stage_a,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_43407636) -> end(RecvMsg(bob,alice,stage_a,m_43407636,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_43407684).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 4, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_43407684.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43407684).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43407684)).

19. The attacker has some term b_43407670.
attacker(b_43407670).

20. By 3, the attacker may know g.
By 19, the attacker may know b_43407670.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43407684).
Using the function concat3 the attacker may obtain concat3(g,b_43407670,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43407684)).
attacker(concat3(g,b_43407670,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43407684))).

21. By 4, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43407670,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43407684)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43407670,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43407684))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {278}.
The message concat3(g,b_43407670,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43407684)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_43407684,true) may be executed at {276}.
end(RecvMsg(bob,alice,stage_a,m_43407684,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43409478,~M_43409479,~M_43409480)) with ~M_43409478 = key_s(charlie), ~M_43409479 = key_e(charlie,alice), ~M_43409480 = key_e(charlie,bob) at {466} in copy a_43407690

out(pub, ~M_43409709) with ~M_43409709 = dhexp(key_s(bob),g) at {351} in copy a_43407690

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43407690

out(pub, ~M_43410144) with ~M_43410144 = dhexp(key_s(bob),g) at {234} in copy a_43407690

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43407690

out(pub, ~M_43410573) with ~M_43410573 = dhexp(key_s(alice),g) at {119} in copy a_43407690

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43407690

out(pub, ~M_43411002) with ~M_43411002 = dhexp(key_s(alice),g) at {4} in copy a_43407690

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43407690

out(pub, (~M_43411211,~M_43411212,~M_43411213)) with ~M_43411211 = key_s(charlie), ~M_43411212 = key_e(charlie,alice), ~M_43411213 = key_e(charlie,bob) at {466} in copy a_43407689

out(pub, ~M_43411442) with ~M_43411442 = dhexp(key_s(bob),g) at {351} in copy a_43407689

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43407689

out(pub, ~M_43411877) with ~M_43411877 = dhexp(key_s(bob),g) at {234} in copy a_43407689

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43407689

out(pub, ~M_43412306) with ~M_43412306 = dhexp(key_s(alice),g) at {119} in copy a_43407689

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43407689

out(pub, ~M_43412735) with ~M_43412735 = dhexp(key_s(alice),g) at {4} in copy a_43407689

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43407689

out(pub, (~M_43412944,~M_43412945,~M_43412946)) with ~M_43412944 = key_s(charlie), ~M_43412945 = key_e(charlie,alice), ~M_43412946 = key_e(charlie,bob) at {466} in copy a_43407688

out(pub, ~M_43413175) with ~M_43413175 = dhexp(key_s(bob),g) at {351} in copy a_43407688

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43407688

out(pub, ~M_43413610) with ~M_43413610 = dhexp(key_s(bob),g) at {234} in copy a_43407688

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43407688

out(pub, ~M_43414039) with ~M_43414039 = dhexp(key_s(alice),g) at {119} in copy a_43407688

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43407688

out(pub, ~M_43414468) with ~M_43414468 = dhexp(key_s(alice),g) at {4} in copy a_43407688

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43407688

out(pub, (~M_43414677,~M_43414678,~M_43414679)) with ~M_43414677 = key_s(charlie), ~M_43414678 = key_e(charlie,alice), ~M_43414679 = key_e(charlie,bob) at {466} in copy a_43407687

out(pub, ~M_43414908) with ~M_43414908 = dhexp(key_s(bob),g) at {351} in copy a_43407687

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43407687

out(pub, ~M_43415343) with ~M_43415343 = dhexp(key_s(bob),g) at {234} in copy a_43407687

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43407687

out(pub, ~M_43415772) with ~M_43415772 = dhexp(key_s(alice),g) at {119} in copy a_43407687

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43407687

out(pub, ~M_43416201) with ~M_43416201 = dhexp(key_s(alice),g) at {4} in copy a_43407687

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43407687

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43407690

in(pub, concat3(g,a_43407686,encrypt(hmac_hash2(hash(somename,empty),~M_43409709),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43410573),~M_43409709),g),a_43407685))) with encrypt(hmac_hash2(hash(somename,empty),~M_43409709),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43410573),~M_43409709),g),a_43407685) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43407685) at {250} in copy a_43407690

event RecvMsg(bob,alice,stage_a,a_43407685,true) at {276} in copy a_43407690 (goal)

The event RecvMsg(bob,alice,stage_a,a_43407685,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_43417426) -> end(RecvMsg(bob,alice,stage_a,m_43417426,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_43417474).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 4, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_43417474.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43417474).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43417474)).

19. The attacker has some term b_43417460.
attacker(b_43417460).

20. By 3, the attacker may know g.
By 19, the attacker may know b_43417460.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43417474).
Using the function concat3 the attacker may obtain concat3(g,b_43417460,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43417474)).
attacker(concat3(g,b_43417460,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43417474))).

21. By 4, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43417460,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43417474)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43417460,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43417474))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {278}.
The message concat3(g,b_43417460,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),m_43417474)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_43417474,true) may be executed at {276}.
end(RecvMsg(bob,alice,stage_a,m_43417474,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43419268,~M_43419269,~M_43419270)) with ~M_43419268 = key_s(charlie), ~M_43419269 = key_e(charlie,alice), ~M_43419270 = key_e(charlie,bob) at {466} in copy a_43417480

out(pub, ~M_43419499) with ~M_43419499 = dhexp(key_s(bob),g) at {351} in copy a_43417480

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43417480

out(pub, ~M_43419934) with ~M_43419934 = dhexp(key_s(bob),g) at {234} in copy a_43417480

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43417480

out(pub, ~M_43420363) with ~M_43420363 = dhexp(key_s(alice),g) at {119} in copy a_43417480

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43417480

out(pub, ~M_43420792) with ~M_43420792 = dhexp(key_s(alice),g) at {4} in copy a_43417480

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43417480

out(pub, (~M_43421001,~M_43421002,~M_43421003)) with ~M_43421001 = key_s(charlie), ~M_43421002 = key_e(charlie,alice), ~M_43421003 = key_e(charlie,bob) at {466} in copy a_43417479

out(pub, ~M_43421232) with ~M_43421232 = dhexp(key_s(bob),g) at {351} in copy a_43417479

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43417479

out(pub, ~M_43421667) with ~M_43421667 = dhexp(key_s(bob),g) at {234} in copy a_43417479

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43417479

out(pub, ~M_43422096) with ~M_43422096 = dhexp(key_s(alice),g) at {119} in copy a_43417479

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43417479

out(pub, ~M_43422525) with ~M_43422525 = dhexp(key_s(alice),g) at {4} in copy a_43417479

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43417479

out(pub, (~M_43422734,~M_43422735,~M_43422736)) with ~M_43422734 = key_s(charlie), ~M_43422735 = key_e(charlie,alice), ~M_43422736 = key_e(charlie,bob) at {466} in copy a_43417478

out(pub, ~M_43422965) with ~M_43422965 = dhexp(key_s(bob),g) at {351} in copy a_43417478

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43417478

out(pub, ~M_43423400) with ~M_43423400 = dhexp(key_s(bob),g) at {234} in copy a_43417478

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43417478

out(pub, ~M_43423829) with ~M_43423829 = dhexp(key_s(alice),g) at {119} in copy a_43417478

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43417478

out(pub, ~M_43424258) with ~M_43424258 = dhexp(key_s(alice),g) at {4} in copy a_43417478

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43417478

out(pub, (~M_43424467,~M_43424468,~M_43424469)) with ~M_43424467 = key_s(charlie), ~M_43424468 = key_e(charlie,alice), ~M_43424469 = key_e(charlie,bob) at {466} in copy a_43417477

out(pub, ~M_43424698) with ~M_43424698 = dhexp(key_s(bob),g) at {351} in copy a_43417477

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43417477

out(pub, ~M_43425133) with ~M_43425133 = dhexp(key_s(bob),g) at {234} in copy a_43417477

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43417477

out(pub, ~M_43425562) with ~M_43425562 = dhexp(key_s(alice),g) at {119} in copy a_43417477

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43417477

out(pub, ~M_43425991) with ~M_43425991 = dhexp(key_s(alice),g) at {4} in copy a_43417477

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43417477

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43417480

in(pub, concat3(g,a_43417476,encrypt(hmac_hash2(hash(somename,empty),~M_43419499),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43420363),~M_43419499),g),a_43417475))) with encrypt(hmac_hash2(hash(somename,empty),~M_43419499),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43420363),~M_43419499),g),a_43417475) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43417475) at {250} in copy a_43417480

event RecvMsg(bob,alice,stage_a,a_43417475,true) at {276} in copy a_43417480 (goal)

The event RecvMsg(bob,alice,stage_a,a_43417475,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query not attacker_p1(msg_a(alice,bob))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {19}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {49}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {46}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {48}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 5, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

7. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

8. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

9. By 1, the attacker may have the channel pub.
By 8, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

10. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

11. By 1, the attacker may have the channel pub.
By 10, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

12. Using the function empty the attacker may obtain empty.
attacker(empty).

13. Using the function somename the attacker may obtain somename.
attacker(somename).

14. By 13, the attacker may know somename.
By 12, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

15. By 14, the attacker may know hash(somename,empty).
By 12, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

16. By 15, the attacker may know hash(hash(somename,empty),empty).
By 11, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

17. By 16, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 9, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 7, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
So the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

20. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

21. By 7, the attacker may know dhexp(key_e(alice,bob),g).
So the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),g)).

22. Using the function pub the attacker may obtain pub in phase 1.
attacker_p1(pub).

23. The event LeakS(phase1,bob) may be executed at {347}.
So the message key_s(bob) may be sent on channel pub in phase 1 at output {348}.
mess_p1(pub,key_s(bob)).

24. By 22, the attacker may have the channel pub in phase 1.
By 23, the message key_s(bob) in phase 1 may be sent on this channel.
So the attacker may obtain the message key_s(bob) in phase 1 by listening on this channel.
attacker_p1(key_s(bob)).

25. By 24, the attacker may know key_s(bob) in phase 1.
By 21, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

26. By 14, the attacker may know hash(somename,empty).
So the attacker may know hash(somename,empty) in phase 1.
attacker_p1(hash(somename,empty)).

27. By 26, the attacker may know hash(somename,empty) in phase 1.
By 25, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
attacker_p1(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

28. By 27, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
By 20, the attacker may know minnonce in phase 1.
By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
By 6, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

29. By 28, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43429545,~M_43429546,~M_43429547)) with ~M_43429545 = key_s(charlie), ~M_43429546 = key_e(charlie,alice), ~M_43429547 = key_e(charlie,bob) at {466} in copy a_43427301

out(pub, ~M_43429776) with ~M_43429776 = dhexp(key_s(bob),g) at {351} in copy a_43427301

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43427301

out(pub, ~M_43430211) with ~M_43430211 = dhexp(key_s(bob),g) at {234} in copy a_43427301

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43427301

out(pub, ~M_43430640) with ~M_43430640 = dhexp(key_s(alice),g) at {119} in copy a_43427301

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43427301

out(pub, ~M_43431069) with ~M_43431069 = dhexp(key_s(alice),g) at {4} in copy a_43427301

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43427301

out(pub, (~M_43431278,~M_43431279,~M_43431280)) with ~M_43431278 = key_s(charlie), ~M_43431279 = key_e(charlie,alice), ~M_43431280 = key_e(charlie,bob) at {466} in copy a_43427300

out(pub, ~M_43431509) with ~M_43431509 = dhexp(key_s(bob),g) at {351} in copy a_43427300

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43427300

out(pub, ~M_43431944) with ~M_43431944 = dhexp(key_s(bob),g) at {234} in copy a_43427300

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43427300

out(pub, ~M_43432373) with ~M_43432373 = dhexp(key_s(alice),g) at {119} in copy a_43427300

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43427300

out(pub, ~M_43432802) with ~M_43432802 = dhexp(key_s(alice),g) at {4} in copy a_43427300

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43427300

out(pub, (~M_43433011,~M_43433012,~M_43433013)) with ~M_43433011 = key_s(charlie), ~M_43433012 = key_e(charlie,alice), ~M_43433013 = key_e(charlie,bob) at {466} in copy a_43427299

out(pub, ~M_43433242) with ~M_43433242 = dhexp(key_s(bob),g) at {351} in copy a_43427299

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43427299

out(pub, ~M_43433677) with ~M_43433677 = dhexp(key_s(bob),g) at {234} in copy a_43427299

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43427299

out(pub, ~M_43434106) with ~M_43434106 = dhexp(key_s(alice),g) at {119} in copy a_43427299

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43427299

out(pub, ~M_43434535) with ~M_43434535 = dhexp(key_s(alice),g) at {4} in copy a_43427299

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43427299

out(pub, (~M_43434744,~M_43434745,~M_43434746)) with ~M_43434744 = key_s(charlie), ~M_43434745 = key_e(charlie,alice), ~M_43434746 = key_e(charlie,bob) at {466} in copy a_43427298

out(pub, ~M_43434975) with ~M_43434975 = dhexp(key_s(bob),g) at {351} in copy a_43427298

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43427298

out(pub, ~M_43435410) with ~M_43435410 = dhexp(key_s(bob),g) at {234} in copy a_43427298

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43427298

out(pub, ~M_43435839) with ~M_43435839 = dhexp(key_s(alice),g) at {119} in copy a_43427298

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43427298

out(pub, ~M_43436268) with ~M_43436268 = dhexp(key_s(alice),g) at {4} in copy a_43427298

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43427298

out(pub, (~M_43436477,~M_43436478,~M_43436479)) with ~M_43436477 = key_s(charlie), ~M_43436478 = key_e(charlie,alice), ~M_43436479 = key_e(charlie,bob) at {466} in copy a_43427297

out(pub, ~M_43436708) with ~M_43436708 = dhexp(key_s(bob),g) at {351} in copy a_43427297

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43427297

out(pub, ~M_43437143) with ~M_43437143 = dhexp(key_s(bob),g) at {234} in copy a_43427297

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43427297

out(pub, ~M_43437572) with ~M_43437572 = dhexp(key_s(alice),g) at {119} in copy a_43427297

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43427297

out(pub, ~M_43438001) with ~M_43438001 = dhexp(key_s(alice),g) at {4} in copy a_43427297

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43427297

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {49} in copy a_43427301

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {46} in copy a_43427301

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {47} in copy a_43427301

out(pub, concat3(~M_43439178,empty,~M_43439180)) with ~M_43439178 = dhexp(key_e(alice,bob),g), ~M_43439180 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {48} in copy a_43427301

event LeakS(phase1,bob) at {347} in copy a_43427297

out(pub, ~M_43439193) with ~M_43439193 = key_s(bob) at {348} in copy a_43427297

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hash(somename,empty),dhexp(~M_43439193,~M_43439178)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43430640),~M_43429776),~M_43439178),~M_43439180)) = msg_a(alice,bob) in phase 1.
A trace has been found.
RESULT not attacker_p1(msg_a(alice,bob)) is false.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))
goal reachable: begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)) is true.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice)))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {19}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {49}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {46}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {48}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 5, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

7. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

8. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

9. By 1, the attacker may have the channel pub.
By 8, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

10. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

11. By 1, the attacker may have the channel pub.
By 10, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

12. Using the function empty the attacker may obtain empty.
attacker(empty).

13. Using the function somename the attacker may obtain somename.
attacker(somename).

14. By 13, the attacker may know somename.
By 12, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

15. By 14, the attacker may know hash(somename,empty).
By 12, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

16. By 15, the attacker may know hash(hash(somename,empty),empty).
By 11, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

17. By 16, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 9, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 7, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
So the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

20. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

21. By 7, the attacker may know dhexp(key_e(alice,bob),g).
So the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),g)).

22. Using the function pub the attacker may obtain pub in phase 1.
attacker_p1(pub).

23. The event LeakS(phase1,bob) may be executed at {347}.
So the message key_s(bob) may be sent on channel pub in phase 1 at output {348}.
mess_p1(pub,key_s(bob)).

24. By 22, the attacker may have the channel pub in phase 1.
By 23, the message key_s(bob) in phase 1 may be sent on this channel.
So the attacker may obtain the message key_s(bob) in phase 1 by listening on this channel.
attacker_p1(key_s(bob)).

25. By 24, the attacker may know key_s(bob) in phase 1.
By 21, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

26. By 14, the attacker may know hash(somename,empty).
So the attacker may know hash(somename,empty) in phase 1.
attacker_p1(hash(somename,empty)).

27. By 26, the attacker may know hash(somename,empty) in phase 1.
By 25, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
attacker_p1(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

28. By 27, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
By 20, the attacker may know minnonce in phase 1.
By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
By 6, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

29. By 28, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43441525,~M_43441526,~M_43441527)) with ~M_43441525 = key_s(charlie), ~M_43441526 = key_e(charlie,alice), ~M_43441527 = key_e(charlie,bob) at {466} in copy a_43439281

out(pub, ~M_43441756) with ~M_43441756 = dhexp(key_s(bob),g) at {351} in copy a_43439281

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43439281

out(pub, ~M_43442191) with ~M_43442191 = dhexp(key_s(bob),g) at {234} in copy a_43439281

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43439281

out(pub, ~M_43442620) with ~M_43442620 = dhexp(key_s(alice),g) at {119} in copy a_43439281

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43439281

out(pub, ~M_43443049) with ~M_43443049 = dhexp(key_s(alice),g) at {4} in copy a_43439281

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43439281

out(pub, (~M_43443258,~M_43443259,~M_43443260)) with ~M_43443258 = key_s(charlie), ~M_43443259 = key_e(charlie,alice), ~M_43443260 = key_e(charlie,bob) at {466} in copy a_43439280

out(pub, ~M_43443489) with ~M_43443489 = dhexp(key_s(bob),g) at {351} in copy a_43439280

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43439280

out(pub, ~M_43443924) with ~M_43443924 = dhexp(key_s(bob),g) at {234} in copy a_43439280

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43439280

out(pub, ~M_43444353) with ~M_43444353 = dhexp(key_s(alice),g) at {119} in copy a_43439280

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43439280

out(pub, ~M_43444782) with ~M_43444782 = dhexp(key_s(alice),g) at {4} in copy a_43439280

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43439280

out(pub, (~M_43444991,~M_43444992,~M_43444993)) with ~M_43444991 = key_s(charlie), ~M_43444992 = key_e(charlie,alice), ~M_43444993 = key_e(charlie,bob) at {466} in copy a_43439279

out(pub, ~M_43445222) with ~M_43445222 = dhexp(key_s(bob),g) at {351} in copy a_43439279

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43439279

out(pub, ~M_43445657) with ~M_43445657 = dhexp(key_s(bob),g) at {234} in copy a_43439279

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43439279

out(pub, ~M_43446086) with ~M_43446086 = dhexp(key_s(alice),g) at {119} in copy a_43439279

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43439279

out(pub, ~M_43446515) with ~M_43446515 = dhexp(key_s(alice),g) at {4} in copy a_43439279

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43439279

out(pub, (~M_43446724,~M_43446725,~M_43446726)) with ~M_43446724 = key_s(charlie), ~M_43446725 = key_e(charlie,alice), ~M_43446726 = key_e(charlie,bob) at {466} in copy a_43439278

out(pub, ~M_43446955) with ~M_43446955 = dhexp(key_s(bob),g) at {351} in copy a_43439278

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43439278

out(pub, ~M_43447390) with ~M_43447390 = dhexp(key_s(bob),g) at {234} in copy a_43439278

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43439278

out(pub, ~M_43447819) with ~M_43447819 = dhexp(key_s(alice),g) at {119} in copy a_43439278

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43439278

out(pub, ~M_43448248) with ~M_43448248 = dhexp(key_s(alice),g) at {4} in copy a_43439278

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43439278

out(pub, (~M_43448457,~M_43448458,~M_43448459)) with ~M_43448457 = key_s(charlie), ~M_43448458 = key_e(charlie,alice), ~M_43448459 = key_e(charlie,bob) at {466} in copy a_43439277

out(pub, ~M_43448688) with ~M_43448688 = dhexp(key_s(bob),g) at {351} in copy a_43439277

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43439277

out(pub, ~M_43449123) with ~M_43449123 = dhexp(key_s(bob),g) at {234} in copy a_43439277

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43439277

out(pub, ~M_43449552) with ~M_43449552 = dhexp(key_s(alice),g) at {119} in copy a_43439277

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43439277

out(pub, ~M_43449981) with ~M_43449981 = dhexp(key_s(alice),g) at {4} in copy a_43439277

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43439277

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {49} in copy a_43439281

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {46} in copy a_43439281

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {47} in copy a_43439281

out(pub, concat3(~M_43451158,empty,~M_43451160)) with ~M_43451158 = dhexp(key_e(alice,bob),g), ~M_43451160 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {48} in copy a_43439281

event LeakS(phase1,bob) at {347} in copy a_43439277

out(pub, ~M_43451173) with ~M_43451173 = key_s(bob) at {348} in copy a_43439277

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hash(somename,empty),dhexp(~M_43451173,~M_43451158)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43442620),~M_43441756),~M_43451158),~M_43451160)) = msg_a(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))) is false.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {19}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {49}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {46}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {48}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 5, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

7. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

8. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

9. By 1, the attacker may have the channel pub.
By 8, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

10. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

11. By 1, the attacker may have the channel pub.
By 10, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

12. Using the function empty the attacker may obtain empty.
attacker(empty).

13. Using the function somename the attacker may obtain somename.
attacker(somename).

14. By 13, the attacker may know somename.
By 12, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

15. By 14, the attacker may know hash(somename,empty).
By 12, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

16. By 15, the attacker may know hash(hash(somename,empty),empty).
By 11, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

17. By 16, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 9, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 7, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
So the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

20. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

21. By 7, the attacker may know dhexp(key_e(alice,bob),g).
So the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),g)).

22. Using the function pub the attacker may obtain pub in phase 1.
attacker_p1(pub).

23. The event LeakS(phase1,bob) may be executed at {347}.
So the message key_s(bob) may be sent on channel pub in phase 1 at output {348}.
mess_p1(pub,key_s(bob)).

24. By 22, the attacker may have the channel pub in phase 1.
By 23, the message key_s(bob) in phase 1 may be sent on this channel.
So the attacker may obtain the message key_s(bob) in phase 1 by listening on this channel.
attacker_p1(key_s(bob)).

25. By 24, the attacker may know key_s(bob) in phase 1.
By 21, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

26. By 14, the attacker may know hash(somename,empty).
So the attacker may know hash(somename,empty) in phase 1.
attacker_p1(hash(somename,empty)).

27. By 26, the attacker may know hash(somename,empty) in phase 1.
By 25, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
attacker_p1(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

28. By 27, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
By 20, the attacker may know minnonce in phase 1.
By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
By 6, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

29. By 28, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43453504,~M_43453505,~M_43453506)) with ~M_43453504 = key_s(charlie), ~M_43453505 = key_e(charlie,alice), ~M_43453506 = key_e(charlie,bob) at {466} in copy a_43451260

out(pub, ~M_43453735) with ~M_43453735 = dhexp(key_s(bob),g) at {351} in copy a_43451260

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43451260

out(pub, ~M_43454170) with ~M_43454170 = dhexp(key_s(bob),g) at {234} in copy a_43451260

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43451260

out(pub, ~M_43454599) with ~M_43454599 = dhexp(key_s(alice),g) at {119} in copy a_43451260

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43451260

out(pub, ~M_43455028) with ~M_43455028 = dhexp(key_s(alice),g) at {4} in copy a_43451260

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43451260

out(pub, (~M_43455237,~M_43455238,~M_43455239)) with ~M_43455237 = key_s(charlie), ~M_43455238 = key_e(charlie,alice), ~M_43455239 = key_e(charlie,bob) at {466} in copy a_43451259

out(pub, ~M_43455468) with ~M_43455468 = dhexp(key_s(bob),g) at {351} in copy a_43451259

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43451259

out(pub, ~M_43455903) with ~M_43455903 = dhexp(key_s(bob),g) at {234} in copy a_43451259

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43451259

out(pub, ~M_43456332) with ~M_43456332 = dhexp(key_s(alice),g) at {119} in copy a_43451259

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43451259

out(pub, ~M_43456761) with ~M_43456761 = dhexp(key_s(alice),g) at {4} in copy a_43451259

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43451259

out(pub, (~M_43456970,~M_43456971,~M_43456972)) with ~M_43456970 = key_s(charlie), ~M_43456971 = key_e(charlie,alice), ~M_43456972 = key_e(charlie,bob) at {466} in copy a_43451258

out(pub, ~M_43457201) with ~M_43457201 = dhexp(key_s(bob),g) at {351} in copy a_43451258

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43451258

out(pub, ~M_43457636) with ~M_43457636 = dhexp(key_s(bob),g) at {234} in copy a_43451258

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43451258

out(pub, ~M_43458065) with ~M_43458065 = dhexp(key_s(alice),g) at {119} in copy a_43451258

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43451258

out(pub, ~M_43458494) with ~M_43458494 = dhexp(key_s(alice),g) at {4} in copy a_43451258

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43451258

out(pub, (~M_43458703,~M_43458704,~M_43458705)) with ~M_43458703 = key_s(charlie), ~M_43458704 = key_e(charlie,alice), ~M_43458705 = key_e(charlie,bob) at {466} in copy a_43451257

out(pub, ~M_43458934) with ~M_43458934 = dhexp(key_s(bob),g) at {351} in copy a_43451257

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43451257

out(pub, ~M_43459369) with ~M_43459369 = dhexp(key_s(bob),g) at {234} in copy a_43451257

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43451257

out(pub, ~M_43459798) with ~M_43459798 = dhexp(key_s(alice),g) at {119} in copy a_43451257

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43451257

out(pub, ~M_43460227) with ~M_43460227 = dhexp(key_s(alice),g) at {4} in copy a_43451257

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43451257

out(pub, (~M_43460436,~M_43460437,~M_43460438)) with ~M_43460436 = key_s(charlie), ~M_43460437 = key_e(charlie,alice), ~M_43460438 = key_e(charlie,bob) at {466} in copy a_43451256

out(pub, ~M_43460667) with ~M_43460667 = dhexp(key_s(bob),g) at {351} in copy a_43451256

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43451256

out(pub, ~M_43461102) with ~M_43461102 = dhexp(key_s(bob),g) at {234} in copy a_43451256

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43451256

out(pub, ~M_43461531) with ~M_43461531 = dhexp(key_s(alice),g) at {119} in copy a_43451256

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43451256

out(pub, ~M_43461960) with ~M_43461960 = dhexp(key_s(alice),g) at {4} in copy a_43451256

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43451256

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {49} in copy a_43451260

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {46} in copy a_43451260

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {47} in copy a_43451260

out(pub, concat3(~M_43463137,empty,~M_43463139)) with ~M_43463137 = dhexp(key_e(alice,bob),g), ~M_43463139 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {48} in copy a_43451260

event LeakS(phase1,bob) at {347} in copy a_43451256

out(pub, ~M_43463152) with ~M_43463152 = key_s(bob) at {348} in copy a_43451256

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hash(somename,empty),dhexp(~M_43463152,~M_43463137)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43454599),~M_43453735),~M_43463137),~M_43463139)) = msg_a(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_43463154) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_43463154,true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {19}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 1 may be read at get {49}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {46}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {47}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

3. We assume as hypothesis that
attacker(m_43463268).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {19}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

8. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 7 may be read at get {49}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {46}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {48}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 4, the attacker may have the channel pub.
By 8, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

10. By 9, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

11. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {19}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

12. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 11 may be read at get {49}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {46}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {48}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

13. By 4, the attacker may have the channel pub.
By 12, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

14. By 13, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

15. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

16. By 4, the attacker may have the channel pub.
By 15, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

17. Using the function empty the attacker may obtain empty.
attacker(empty).

18. Using the function somename the attacker may obtain somename.
attacker(somename).

19. By 18, the attacker may know somename.
By 17, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

20. By 19, the attacker may know hash(somename,empty).
By 17, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

21. By 20, the attacker may know hash(hash(somename,empty),empty).
By 16, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

22. By 21, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

23. By 22, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 14, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

24. By 23, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
By 10, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

25. By 24, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g))).

26. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

27. The event LeakS(phase0,bob) may be executed at {344}.
So the message key_s(bob) may be sent on channel pub at output {345}.
mess(pub,key_s(bob)).

28. By 4, the attacker may have the channel pub.
By 27, the message key_s(bob) may be sent on this channel.
So the attacker may obtain the message key_s(bob) by listening on this channel.
attacker(key_s(bob)).

29. By 28, the attacker may know key_s(bob).
By 14, the attacker may know dhexp(key_e(alice,bob),g).
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
attacker(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

30. By 19, the attacker may know hash(somename,empty).
By 29, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

31. By 30, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
By 29, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

32. By 31, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
By 26, the attacker may know minnonce.
By 25, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)).
By 3, the attacker may know m_43463268.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_43463268).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_43463268)).

33. The attacker has some term b_43463255.
attacker(b_43463255).

34. By 6, the attacker may know dhexp(key_s(bob),g).
By 33, the attacker may know b_43463255.
By 32, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_43463268).
Using the function concat3 the attacker may obtain concat3(dhexp(key_s(bob),g),b_43463255,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_43463268)).
attacker(concat3(dhexp(key_s(bob),g),b_43463255,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_43463268))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(dhexp(key_s(bob),g),b_43463255,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_43463268)).
So the attacker may send this message on this channel.
mess(pub,concat3(dhexp(key_s(bob),g),b_43463255,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_43463268))).

36. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {78}.
The message concat3(dhexp(key_s(bob),g),b_43463255,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_43463268)) that may be sent on channel pub by 35 may be received at input {50}.
We have dhexp(key_s(bob),g) <> caught-fail.
So event RecvMsg(alice,bob,stage_b,m_43463268,true) may be executed at {76}.
end(RecvMsg(alice,bob,stage_b,m_43463268,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43467736,~M_43467737,~M_43467738)) with ~M_43467736 = key_s(charlie), ~M_43467737 = key_e(charlie,alice), ~M_43467738 = key_e(charlie,bob) at {466} in copy a_43463280

out(pub, ~M_43467967) with ~M_43467967 = dhexp(key_s(bob),g) at {351} in copy a_43463280

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463280

out(pub, ~M_43468402) with ~M_43468402 = dhexp(key_s(bob),g) at {234} in copy a_43463280

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463280

out(pub, ~M_43468831) with ~M_43468831 = dhexp(key_s(alice),g) at {119} in copy a_43463280

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463280

out(pub, ~M_43469260) with ~M_43469260 = dhexp(key_s(alice),g) at {4} in copy a_43463280

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463280

out(pub, (~M_43469469,~M_43469470,~M_43469471)) with ~M_43469469 = key_s(charlie), ~M_43469470 = key_e(charlie,alice), ~M_43469471 = key_e(charlie,bob) at {466} in copy a_43463279

out(pub, ~M_43469700) with ~M_43469700 = dhexp(key_s(bob),g) at {351} in copy a_43463279

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463279

out(pub, ~M_43470135) with ~M_43470135 = dhexp(key_s(bob),g) at {234} in copy a_43463279

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463279

out(pub, ~M_43470564) with ~M_43470564 = dhexp(key_s(alice),g) at {119} in copy a_43463279

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463279

out(pub, ~M_43470993) with ~M_43470993 = dhexp(key_s(alice),g) at {4} in copy a_43463279

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463279

out(pub, (~M_43471202,~M_43471203,~M_43471204)) with ~M_43471202 = key_s(charlie), ~M_43471203 = key_e(charlie,alice), ~M_43471204 = key_e(charlie,bob) at {466} in copy a_43463278

out(pub, ~M_43471433) with ~M_43471433 = dhexp(key_s(bob),g) at {351} in copy a_43463278

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463278

out(pub, ~M_43471868) with ~M_43471868 = dhexp(key_s(bob),g) at {234} in copy a_43463278

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463278

out(pub, ~M_43472297) with ~M_43472297 = dhexp(key_s(alice),g) at {119} in copy a_43463278

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463278

out(pub, ~M_43472726) with ~M_43472726 = dhexp(key_s(alice),g) at {4} in copy a_43463278

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463278

out(pub, (~M_43472935,~M_43472936,~M_43472937)) with ~M_43472935 = key_s(charlie), ~M_43472936 = key_e(charlie,alice), ~M_43472937 = key_e(charlie,bob) at {466} in copy a_43463277

out(pub, ~M_43473166) with ~M_43473166 = dhexp(key_s(bob),g) at {351} in copy a_43463277

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463277

out(pub, ~M_43473601) with ~M_43473601 = dhexp(key_s(bob),g) at {234} in copy a_43463277

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463277

out(pub, ~M_43474030) with ~M_43474030 = dhexp(key_s(alice),g) at {119} in copy a_43463277

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463277

out(pub, ~M_43474459) with ~M_43474459 = dhexp(key_s(alice),g) at {4} in copy a_43463277

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463277

out(pub, (~M_43474668,~M_43474669,~M_43474670)) with ~M_43474668 = key_s(charlie), ~M_43474669 = key_e(charlie,alice), ~M_43474670 = key_e(charlie,bob) at {466} in copy a_43463276

out(pub, ~M_43474899) with ~M_43474899 = dhexp(key_s(bob),g) at {351} in copy a_43463276

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463276

out(pub, ~M_43475334) with ~M_43475334 = dhexp(key_s(bob),g) at {234} in copy a_43463276

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463276

out(pub, ~M_43475763) with ~M_43475763 = dhexp(key_s(alice),g) at {119} in copy a_43463276

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463276

out(pub, ~M_43476192) with ~M_43476192 = dhexp(key_s(alice),g) at {4} in copy a_43463276

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463276

out(pub, (~M_43476401,~M_43476402,~M_43476403)) with ~M_43476401 = key_s(charlie), ~M_43476402 = key_e(charlie,alice), ~M_43476403 = key_e(charlie,bob) at {466} in copy a_43463275

out(pub, ~M_43476632) with ~M_43476632 = dhexp(key_s(bob),g) at {351} in copy a_43463275

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463275

out(pub, ~M_43477067) with ~M_43477067 = dhexp(key_s(bob),g) at {234} in copy a_43463275

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463275

out(pub, ~M_43477496) with ~M_43477496 = dhexp(key_s(alice),g) at {119} in copy a_43463275

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463275

out(pub, ~M_43477925) with ~M_43477925 = dhexp(key_s(alice),g) at {4} in copy a_43463275

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463275

out(pub, (~M_43478134,~M_43478135,~M_43478136)) with ~M_43478134 = key_s(charlie), ~M_43478135 = key_e(charlie,alice), ~M_43478136 = key_e(charlie,bob) at {466} in copy a_43463274

out(pub, ~M_43478365) with ~M_43478365 = dhexp(key_s(bob),g) at {351} in copy a_43463274

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463274

out(pub, ~M_43478800) with ~M_43478800 = dhexp(key_s(bob),g) at {234} in copy a_43463274

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463274

out(pub, ~M_43479229) with ~M_43479229 = dhexp(key_s(alice),g) at {119} in copy a_43463274

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463274

out(pub, ~M_43479658) with ~M_43479658 = dhexp(key_s(alice),g) at {4} in copy a_43463274

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463274

out(pub, (~M_43479867,~M_43479868,~M_43479869)) with ~M_43479867 = key_s(charlie), ~M_43479868 = key_e(charlie,alice), ~M_43479869 = key_e(charlie,bob) at {466} in copy a_43463273

out(pub, ~M_43480098) with ~M_43480098 = dhexp(key_s(bob),g) at {351} in copy a_43463273

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463273

out(pub, ~M_43480533) with ~M_43480533 = dhexp(key_s(bob),g) at {234} in copy a_43463273

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463273

out(pub, ~M_43480962) with ~M_43480962 = dhexp(key_s(alice),g) at {119} in copy a_43463273

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463273

out(pub, ~M_43481391) with ~M_43481391 = dhexp(key_s(alice),g) at {4} in copy a_43463273

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463273

out(pub, (~M_43481600,~M_43481601,~M_43481602)) with ~M_43481600 = key_s(charlie), ~M_43481601 = key_e(charlie,alice), ~M_43481602 = key_e(charlie,bob) at {466} in copy a_43463272

out(pub, ~M_43481831) with ~M_43481831 = dhexp(key_s(bob),g) at {351} in copy a_43463272

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463272

out(pub, ~M_43482266) with ~M_43482266 = dhexp(key_s(bob),g) at {234} in copy a_43463272

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463272

out(pub, ~M_43482695) with ~M_43482695 = dhexp(key_s(alice),g) at {119} in copy a_43463272

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463272

out(pub, ~M_43483124) with ~M_43483124 = dhexp(key_s(alice),g) at {4} in copy a_43463272

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463272

out(pub, (~M_43483333,~M_43483334,~M_43483335)) with ~M_43483333 = key_s(charlie), ~M_43483334 = key_e(charlie,alice), ~M_43483335 = key_e(charlie,bob) at {466} in copy a_43463271

out(pub, ~M_43483564) with ~M_43483564 = dhexp(key_s(bob),g) at {351} in copy a_43463271

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43463271

out(pub, ~M_43483999) with ~M_43483999 = dhexp(key_s(bob),g) at {234} in copy a_43463271

event LeakS(phase0,bob) at {344} in copy a_43463271

out(pub, ~M_43484001) with ~M_43484001 = key_s(bob) at {345} in copy a_43463271

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43463271

out(pub, ~M_43484430) with ~M_43484430 = dhexp(key_s(alice),g) at {119} in copy a_43463271

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43463271

out(pub, ~M_43484859) with ~M_43484859 = dhexp(key_s(alice),g) at {4} in copy a_43463271

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43463271

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {49} in copy a_43463274

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {46} in copy a_43463274

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {47} in copy a_43463274

out(pub, concat3(~M_43486024,empty,~M_43486026)) with ~M_43486024 = dhexp(key_e(alice,bob),g), ~M_43486026 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {48} in copy a_43463274

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {49} in copy a_43463276

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {46} in copy a_43463276

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {47} in copy a_43463276

out(pub, concat3(~M_43486972,empty,~M_43486974)) with ~M_43486972 = dhexp(key_e(alice,bob),g), ~M_43486974 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {48} in copy a_43463276

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {49} in copy a_43463279

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {46} in copy a_43463279

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {47} in copy a_43463279

out(pub, concat3(~M_43487932,empty,~M_43487934)) with ~M_43487932 = dhexp(key_e(alice,bob),g), ~M_43487934 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {48} in copy a_43463279

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {78} in copy a_43463280

in(pub, concat3(~M_43467967,a_43463270,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_43484001,~M_43486024)),dhexp(~M_43484001,~M_43486024)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43468831),~M_43467967),~M_43486024),~M_43486026),~M_43467967),a_43463269))) with ~M_43467967 = dhexp(key_s(bob),g), encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_43484001,~M_43486024)),dhexp(~M_43484001,~M_43486024)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43468831),~M_43467967),~M_43486024),~M_43486026),~M_43467967),a_43463269) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),a_43463269) at {50} in copy a_43463280

event RecvMsg(alice,bob,stage_b,a_43463269,true) at {76} in copy a_43463280 (goal)

The event RecvMsg(alice,bob,stage_b,a_43463269,true) is executed.
A trace has been found.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_945,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_43488923) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_43488923,true))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,alice),true))
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_945,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)) is true.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_945,stage_b,m,true)) || event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_43488928) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_43488928,true))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,alice),true))
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_945,stage_b,m,true)) || event(LeakS(phase0,bob)) is true.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_43488933) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_43488933,true))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,alice),true))
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)) is true.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_43488937) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_43488937,true))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,alice),true))
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) is true.
Starting query not attacker_p1(msg_b(bob,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

3. The attacker has some term plaintext_a_43489067.
attacker(plaintext_a_43489067).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 1, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_43489067.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)).

19. The attacker has some term b_43489063.
attacker(b_43489063).

20. By 4, the attacker may know g.
By 19, the attacker may know b_43489063.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067).
Using the function concat3 the attacker may obtain concat3(g,b_43489063,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)).
attacker(concat3(g,b_43489063,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067))).

21. By 1, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43489063,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43489063,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 2 may be read at get {278}.
The message concat3(g,b_43489063,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

23. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 22 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

24. By 1, the attacker may have the channel pub.
By 23, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

25. By 24, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

27. The attacker has some term plaintext_a_43488984.
attacker(plaintext_a_43488984).

28. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 27, the attacker may know plaintext_a_43488984.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)).

29. The attacker has some term b_43488980.
attacker(b_43488980).

30. By 4, the attacker may know g.
By 29, the attacker may know b_43488980.
By 28, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984).
Using the function concat3 the attacker may obtain concat3(g,b_43488980,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)).
attacker(concat3(g,b_43488980,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984))).

31. By 1, the attacker may have the channel pub.
By 30, the attacker may have the message concat3(g,b_43488980,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43488980,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984))).

32. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 26 may be read at get {278}.
The message concat3(g,b_43488980,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)) that may be sent on channel pub by 31 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

33. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 32 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

34. By 1, the attacker may have the channel pub.
By 33, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

35. By 34, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43488984)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

36. By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067))).

37. By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)).
By 35, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g))).

38. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 35, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 16, the attacker may know minnonce.
By 37, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)).
By 25, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

41. By 40, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43489067)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice).
attacker(msg_b(bob,alice)).

42. By 41, the attacker may know msg_b(bob,alice).
So the attacker may know msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43492695,~M_43492696,~M_43492697)) with ~M_43492695 = key_s(charlie), ~M_43492696 = key_e(charlie,alice), ~M_43492697 = key_e(charlie,bob) at {466} in copy a_43489111

out(pub, ~M_43492926) with ~M_43492926 = dhexp(key_s(bob),g) at {351} in copy a_43489111

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43489111

out(pub, ~M_43493361) with ~M_43493361 = dhexp(key_s(bob),g) at {234} in copy a_43489111

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43489111

out(pub, ~M_43493790) with ~M_43493790 = dhexp(key_s(alice),g) at {119} in copy a_43489111

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43489111

out(pub, ~M_43494219) with ~M_43494219 = dhexp(key_s(alice),g) at {4} in copy a_43489111

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43489111

out(pub, (~M_43494428,~M_43494429,~M_43494430)) with ~M_43494428 = key_s(charlie), ~M_43494429 = key_e(charlie,alice), ~M_43494430 = key_e(charlie,bob) at {466} in copy a_43489110

out(pub, ~M_43494659) with ~M_43494659 = dhexp(key_s(bob),g) at {351} in copy a_43489110

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43489110

out(pub, ~M_43495094) with ~M_43495094 = dhexp(key_s(bob),g) at {234} in copy a_43489110

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43489110

out(pub, ~M_43495523) with ~M_43495523 = dhexp(key_s(alice),g) at {119} in copy a_43489110

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43489110

out(pub, ~M_43495952) with ~M_43495952 = dhexp(key_s(alice),g) at {4} in copy a_43489110

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43489110

out(pub, (~M_43496161,~M_43496162,~M_43496163)) with ~M_43496161 = key_s(charlie), ~M_43496162 = key_e(charlie,alice), ~M_43496163 = key_e(charlie,bob) at {466} in copy a_43489109

out(pub, ~M_43496392) with ~M_43496392 = dhexp(key_s(bob),g) at {351} in copy a_43489109

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43489109

out(pub, ~M_43496827) with ~M_43496827 = dhexp(key_s(bob),g) at {234} in copy a_43489109

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43489109

out(pub, ~M_43497256) with ~M_43497256 = dhexp(key_s(alice),g) at {119} in copy a_43489109

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43489109

out(pub, ~M_43497685) with ~M_43497685 = dhexp(key_s(alice),g) at {4} in copy a_43489109

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43489109

out(pub, (~M_43497894,~M_43497895,~M_43497896)) with ~M_43497894 = key_s(charlie), ~M_43497895 = key_e(charlie,alice), ~M_43497896 = key_e(charlie,bob) at {466} in copy a_43489108

out(pub, ~M_43498125) with ~M_43498125 = dhexp(key_s(bob),g) at {351} in copy a_43489108

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43489108

out(pub, ~M_43498560) with ~M_43498560 = dhexp(key_s(bob),g) at {234} in copy a_43489108

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43489108

out(pub, ~M_43498989) with ~M_43498989 = dhexp(key_s(alice),g) at {119} in copy a_43489108

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43489108

out(pub, ~M_43499418) with ~M_43499418 = dhexp(key_s(alice),g) at {4} in copy a_43489108

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43489108

out(pub, (~M_43499627,~M_43499628,~M_43499629)) with ~M_43499627 = key_s(charlie), ~M_43499628 = key_e(charlie,alice), ~M_43499629 = key_e(charlie,bob) at {466} in copy a_43489107

out(pub, ~M_43499858) with ~M_43499858 = dhexp(key_s(bob),g) at {351} in copy a_43489107

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43489107

out(pub, ~M_43500293) with ~M_43500293 = dhexp(key_s(bob),g) at {234} in copy a_43489107

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43489107

out(pub, ~M_43500722) with ~M_43500722 = dhexp(key_s(alice),g) at {119} in copy a_43489107

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43489107

out(pub, ~M_43501151) with ~M_43501151 = dhexp(key_s(alice),g) at {4} in copy a_43489107

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43489107

out(pub, (~M_43501360,~M_43501361,~M_43501362)) with ~M_43501360 = key_s(charlie), ~M_43501361 = key_e(charlie,alice), ~M_43501362 = key_e(charlie,bob) at {466} in copy a_43489105

out(pub, ~M_43501591) with ~M_43501591 = dhexp(key_s(bob),g) at {351} in copy a_43489105

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43489105

out(pub, ~M_43502026) with ~M_43502026 = dhexp(key_s(bob),g) at {234} in copy a_43489105

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43489105

out(pub, ~M_43502455) with ~M_43502455 = dhexp(key_s(alice),g) at {119} in copy a_43489105

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43489105

out(pub, ~M_43502884) with ~M_43502884 = dhexp(key_s(alice),g) at {4} in copy a_43489105

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43489105

out(pub, (~M_43503093,~M_43503094,~M_43503095)) with ~M_43503093 = key_s(charlie), ~M_43503094 = key_e(charlie,alice), ~M_43503095 = key_e(charlie,bob) at {466} in copy a_43489104

out(pub, ~M_43503324) with ~M_43503324 = dhexp(key_s(bob),g) at {351} in copy a_43489104

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43489104

out(pub, ~M_43503759) with ~M_43503759 = dhexp(key_s(bob),g) at {234} in copy a_43489104

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43489104

out(pub, ~M_43504188) with ~M_43504188 = dhexp(key_s(alice),g) at {119} in copy a_43489104

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43489104

out(pub, ~M_43504617) with ~M_43504617 = dhexp(key_s(alice),g) at {4} in copy a_43489104

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43489104

out(pub, (~M_43504826,~M_43504827,~M_43504828)) with ~M_43504826 = key_s(charlie), ~M_43504827 = key_e(charlie,alice), ~M_43504828 = key_e(charlie,bob) at {466} in copy a_43489103

out(pub, ~M_43505057) with ~M_43505057 = dhexp(key_s(bob),g) at {351} in copy a_43489103

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43489103

out(pub, ~M_43505492) with ~M_43505492 = dhexp(key_s(bob),g) at {234} in copy a_43489103

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43489103

out(pub, ~M_43505921) with ~M_43505921 = dhexp(key_s(alice),g) at {119} in copy a_43489103

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43489103

out(pub, ~M_43506350) with ~M_43506350 = dhexp(key_s(alice),g) at {4} in copy a_43489103

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43489103

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43489104

in(pub, concat3(g,a_43489102,encrypt(hmac_hash2(hash(somename,empty),~M_43492926),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43493790),~M_43492926),g),a_43489101))) with encrypt(hmac_hash2(hash(somename,empty),~M_43492926),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43493790),~M_43492926),g),a_43489101) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489101) at {250} in copy a_43489104

event RecvMsg(bob,alice,stage_a,a_43489101,true) at {276} in copy a_43489104

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489101))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43489104

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489101))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43489105

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43489105

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489101)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489101)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43489105

out(pub, concat3(~M_43508484,empty,~M_43508486)) with ~M_43508484 = dhexp(key_e(bob,alice),g), ~M_43508486 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489101)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43489105

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43489110

in(pub, concat3(g,a_43489106,encrypt(hmac_hash2(hash(somename,empty),~M_43492926),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43493790),~M_43492926),g),a_43489100))) with encrypt(hmac_hash2(hash(somename,empty),~M_43492926),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43493790),~M_43492926),g),a_43489100) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489100) at {250} in copy a_43489110

event RecvMsg(bob,alice,stage_a,a_43489100,true) at {276} in copy a_43489110

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489100))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43489110

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489100))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43489111

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43489111

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489100)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489100)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43489111

out(pub, concat3(~M_43510442,empty,~M_43510444)) with ~M_43510442 = dhexp(key_e(bob,alice),g), ~M_43510444 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43489100)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43489111

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_43492926),~M_43508484),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43493790),~M_43492926),g),encrypt(hmac_hash2(hash(somename,empty),~M_43492926),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43493790),~M_43492926),g),a_43489100)),~M_43508484),~M_43510444)) = msg_b(bob,alice) in phase 1.
A trace has been found.
RESULT not attacker_p1(msg_b(bob,alice)) is false.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

3. The attacker has some term plaintext_a_43510572.
attacker(plaintext_a_43510572).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 1, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_43510572.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)).

19. The attacker has some term b_43510568.
attacker(b_43510568).

20. By 4, the attacker may know g.
By 19, the attacker may know b_43510568.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572).
Using the function concat3 the attacker may obtain concat3(g,b_43510568,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)).
attacker(concat3(g,b_43510568,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572))).

21. By 1, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43510568,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43510568,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 2 may be read at get {278}.
The message concat3(g,b_43510568,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

23. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 22 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

24. By 1, the attacker may have the channel pub.
By 23, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

25. By 24, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

27. The attacker has some term plaintext_a_43510489.
attacker(plaintext_a_43510489).

28. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 27, the attacker may know plaintext_a_43510489.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)).

29. The attacker has some term b_43510485.
attacker(b_43510485).

30. By 4, the attacker may know g.
By 29, the attacker may know b_43510485.
By 28, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489).
Using the function concat3 the attacker may obtain concat3(g,b_43510485,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)).
attacker(concat3(g,b_43510485,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489))).

31. By 1, the attacker may have the channel pub.
By 30, the attacker may have the message concat3(g,b_43510485,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43510485,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489))).

32. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 26 may be read at get {278}.
The message concat3(g,b_43510485,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)) that may be sent on channel pub by 31 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

33. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 32 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

34. By 1, the attacker may have the channel pub.
By 33, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

35. By 34, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510489)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

36. By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572))).

37. By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)).
By 35, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g))).

38. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 35, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 16, the attacker may know minnonce.
By 37, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)).
By 25, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

41. By 40, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43510572)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice).
attacker(msg_b(bob,alice)).

42. By 41, the attacker may know msg_b(bob,alice).
So the attacker may know msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43514200,~M_43514201,~M_43514202)) with ~M_43514200 = key_s(charlie), ~M_43514201 = key_e(charlie,alice), ~M_43514202 = key_e(charlie,bob) at {466} in copy a_43510616

out(pub, ~M_43514431) with ~M_43514431 = dhexp(key_s(bob),g) at {351} in copy a_43510616

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43510616

out(pub, ~M_43514866) with ~M_43514866 = dhexp(key_s(bob),g) at {234} in copy a_43510616

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43510616

out(pub, ~M_43515295) with ~M_43515295 = dhexp(key_s(alice),g) at {119} in copy a_43510616

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43510616

out(pub, ~M_43515724) with ~M_43515724 = dhexp(key_s(alice),g) at {4} in copy a_43510616

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43510616

out(pub, (~M_43515933,~M_43515934,~M_43515935)) with ~M_43515933 = key_s(charlie), ~M_43515934 = key_e(charlie,alice), ~M_43515935 = key_e(charlie,bob) at {466} in copy a_43510615

out(pub, ~M_43516164) with ~M_43516164 = dhexp(key_s(bob),g) at {351} in copy a_43510615

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43510615

out(pub, ~M_43516599) with ~M_43516599 = dhexp(key_s(bob),g) at {234} in copy a_43510615

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43510615

out(pub, ~M_43517028) with ~M_43517028 = dhexp(key_s(alice),g) at {119} in copy a_43510615

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43510615

out(pub, ~M_43517457) with ~M_43517457 = dhexp(key_s(alice),g) at {4} in copy a_43510615

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43510615

out(pub, (~M_43517666,~M_43517667,~M_43517668)) with ~M_43517666 = key_s(charlie), ~M_43517667 = key_e(charlie,alice), ~M_43517668 = key_e(charlie,bob) at {466} in copy a_43510614

out(pub, ~M_43517897) with ~M_43517897 = dhexp(key_s(bob),g) at {351} in copy a_43510614

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43510614

out(pub, ~M_43518332) with ~M_43518332 = dhexp(key_s(bob),g) at {234} in copy a_43510614

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43510614

out(pub, ~M_43518761) with ~M_43518761 = dhexp(key_s(alice),g) at {119} in copy a_43510614

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43510614

out(pub, ~M_43519190) with ~M_43519190 = dhexp(key_s(alice),g) at {4} in copy a_43510614

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43510614

out(pub, (~M_43519399,~M_43519400,~M_43519401)) with ~M_43519399 = key_s(charlie), ~M_43519400 = key_e(charlie,alice), ~M_43519401 = key_e(charlie,bob) at {466} in copy a_43510613

out(pub, ~M_43519630) with ~M_43519630 = dhexp(key_s(bob),g) at {351} in copy a_43510613

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43510613

out(pub, ~M_43520065) with ~M_43520065 = dhexp(key_s(bob),g) at {234} in copy a_43510613

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43510613

out(pub, ~M_43520494) with ~M_43520494 = dhexp(key_s(alice),g) at {119} in copy a_43510613

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43510613

out(pub, ~M_43520923) with ~M_43520923 = dhexp(key_s(alice),g) at {4} in copy a_43510613

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43510613

out(pub, (~M_43521132,~M_43521133,~M_43521134)) with ~M_43521132 = key_s(charlie), ~M_43521133 = key_e(charlie,alice), ~M_43521134 = key_e(charlie,bob) at {466} in copy a_43510612

out(pub, ~M_43521363) with ~M_43521363 = dhexp(key_s(bob),g) at {351} in copy a_43510612

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43510612

out(pub, ~M_43521798) with ~M_43521798 = dhexp(key_s(bob),g) at {234} in copy a_43510612

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43510612

out(pub, ~M_43522227) with ~M_43522227 = dhexp(key_s(alice),g) at {119} in copy a_43510612

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43510612

out(pub, ~M_43522656) with ~M_43522656 = dhexp(key_s(alice),g) at {4} in copy a_43510612

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43510612

out(pub, (~M_43522865,~M_43522866,~M_43522867)) with ~M_43522865 = key_s(charlie), ~M_43522866 = key_e(charlie,alice), ~M_43522867 = key_e(charlie,bob) at {466} in copy a_43510610

out(pub, ~M_43523096) with ~M_43523096 = dhexp(key_s(bob),g) at {351} in copy a_43510610

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43510610

out(pub, ~M_43523531) with ~M_43523531 = dhexp(key_s(bob),g) at {234} in copy a_43510610

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43510610

out(pub, ~M_43523960) with ~M_43523960 = dhexp(key_s(alice),g) at {119} in copy a_43510610

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43510610

out(pub, ~M_43524389) with ~M_43524389 = dhexp(key_s(alice),g) at {4} in copy a_43510610

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43510610

out(pub, (~M_43524598,~M_43524599,~M_43524600)) with ~M_43524598 = key_s(charlie), ~M_43524599 = key_e(charlie,alice), ~M_43524600 = key_e(charlie,bob) at {466} in copy a_43510609

out(pub, ~M_43524829) with ~M_43524829 = dhexp(key_s(bob),g) at {351} in copy a_43510609

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43510609

out(pub, ~M_43525264) with ~M_43525264 = dhexp(key_s(bob),g) at {234} in copy a_43510609

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43510609

out(pub, ~M_43525693) with ~M_43525693 = dhexp(key_s(alice),g) at {119} in copy a_43510609

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43510609

out(pub, ~M_43526122) with ~M_43526122 = dhexp(key_s(alice),g) at {4} in copy a_43510609

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43510609

out(pub, (~M_43526331,~M_43526332,~M_43526333)) with ~M_43526331 = key_s(charlie), ~M_43526332 = key_e(charlie,alice), ~M_43526333 = key_e(charlie,bob) at {466} in copy a_43510608

out(pub, ~M_43526562) with ~M_43526562 = dhexp(key_s(bob),g) at {351} in copy a_43510608

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43510608

out(pub, ~M_43526997) with ~M_43526997 = dhexp(key_s(bob),g) at {234} in copy a_43510608

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43510608

out(pub, ~M_43527426) with ~M_43527426 = dhexp(key_s(alice),g) at {119} in copy a_43510608

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43510608

out(pub, ~M_43527855) with ~M_43527855 = dhexp(key_s(alice),g) at {4} in copy a_43510608

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43510608

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43510609

in(pub, concat3(g,a_43510607,encrypt(hmac_hash2(hash(somename,empty),~M_43514431),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43515295),~M_43514431),g),a_43510606))) with encrypt(hmac_hash2(hash(somename,empty),~M_43514431),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43515295),~M_43514431),g),a_43510606) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510606) at {250} in copy a_43510609

event RecvMsg(bob,alice,stage_a,a_43510606,true) at {276} in copy a_43510609

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510606))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43510609

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510606))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43510610

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43510610

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510606)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510606)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43510610

out(pub, concat3(~M_43529989,empty,~M_43529991)) with ~M_43529989 = dhexp(key_e(bob,alice),g), ~M_43529991 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510606)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43510610

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43510615

in(pub, concat3(g,a_43510611,encrypt(hmac_hash2(hash(somename,empty),~M_43514431),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43515295),~M_43514431),g),a_43510605))) with encrypt(hmac_hash2(hash(somename,empty),~M_43514431),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43515295),~M_43514431),g),a_43510605) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510605) at {250} in copy a_43510615

event RecvMsg(bob,alice,stage_a,a_43510605,true) at {276} in copy a_43510615

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510605))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43510615

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510605))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43510616

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43510616

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510605)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510605)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43510616

out(pub, concat3(~M_43531947,empty,~M_43531949)) with ~M_43531947 = dhexp(key_e(bob,alice),g), ~M_43531949 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43510605)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43510616

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_43514431),~M_43529989),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43515295),~M_43514431),g),encrypt(hmac_hash2(hash(somename,empty),~M_43514431),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43515295),~M_43514431),g),a_43510605)),~M_43529989),~M_43531949)) = msg_b(bob,alice) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice)) is false.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob)))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

3. The attacker has some term plaintext_a_43532078.
attacker(plaintext_a_43532078).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 1, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_43532078.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)).

19. The attacker has some term b_43532074.
attacker(b_43532074).

20. By 4, the attacker may know g.
By 19, the attacker may know b_43532074.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078).
Using the function concat3 the attacker may obtain concat3(g,b_43532074,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)).
attacker(concat3(g,b_43532074,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078))).

21. By 1, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43532074,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43532074,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 2 may be read at get {278}.
The message concat3(g,b_43532074,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

23. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 22 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

24. By 1, the attacker may have the channel pub.
By 23, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

25. By 24, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

27. The attacker has some term plaintext_a_43531995.
attacker(plaintext_a_43531995).

28. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 27, the attacker may know plaintext_a_43531995.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)).

29. The attacker has some term b_43531991.
attacker(b_43531991).

30. By 4, the attacker may know g.
By 29, the attacker may know b_43531991.
By 28, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995).
Using the function concat3 the attacker may obtain concat3(g,b_43531991,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)).
attacker(concat3(g,b_43531991,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995))).

31. By 1, the attacker may have the channel pub.
By 30, the attacker may have the message concat3(g,b_43531991,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43531991,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995))).

32. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 26 may be read at get {278}.
The message concat3(g,b_43531991,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)) that may be sent on channel pub by 31 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

33. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 32 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

34. By 1, the attacker may have the channel pub.
By 33, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

35. By 34, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43531995)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

36. By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078))).

37. By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)).
By 35, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g))).

38. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 35, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 16, the attacker may know minnonce.
By 37, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)).
By 25, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

41. By 40, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43532078)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice).
attacker(msg_b(bob,alice)).

42. By 41, the attacker may know msg_b(bob,alice).
So the attacker may know msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43535706,~M_43535707,~M_43535708)) with ~M_43535706 = key_s(charlie), ~M_43535707 = key_e(charlie,alice), ~M_43535708 = key_e(charlie,bob) at {466} in copy a_43532122

out(pub, ~M_43535937) with ~M_43535937 = dhexp(key_s(bob),g) at {351} in copy a_43532122

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43532122

out(pub, ~M_43536372) with ~M_43536372 = dhexp(key_s(bob),g) at {234} in copy a_43532122

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43532122

out(pub, ~M_43536801) with ~M_43536801 = dhexp(key_s(alice),g) at {119} in copy a_43532122

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43532122

out(pub, ~M_43537230) with ~M_43537230 = dhexp(key_s(alice),g) at {4} in copy a_43532122

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43532122

out(pub, (~M_43537439,~M_43537440,~M_43537441)) with ~M_43537439 = key_s(charlie), ~M_43537440 = key_e(charlie,alice), ~M_43537441 = key_e(charlie,bob) at {466} in copy a_43532121

out(pub, ~M_43537670) with ~M_43537670 = dhexp(key_s(bob),g) at {351} in copy a_43532121

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43532121

out(pub, ~M_43538105) with ~M_43538105 = dhexp(key_s(bob),g) at {234} in copy a_43532121

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43532121

out(pub, ~M_43538534) with ~M_43538534 = dhexp(key_s(alice),g) at {119} in copy a_43532121

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43532121

out(pub, ~M_43538963) with ~M_43538963 = dhexp(key_s(alice),g) at {4} in copy a_43532121

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43532121

out(pub, (~M_43539172,~M_43539173,~M_43539174)) with ~M_43539172 = key_s(charlie), ~M_43539173 = key_e(charlie,alice), ~M_43539174 = key_e(charlie,bob) at {466} in copy a_43532120

out(pub, ~M_43539403) with ~M_43539403 = dhexp(key_s(bob),g) at {351} in copy a_43532120

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43532120

out(pub, ~M_43539838) with ~M_43539838 = dhexp(key_s(bob),g) at {234} in copy a_43532120

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43532120

out(pub, ~M_43540267) with ~M_43540267 = dhexp(key_s(alice),g) at {119} in copy a_43532120

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43532120

out(pub, ~M_43540696) with ~M_43540696 = dhexp(key_s(alice),g) at {4} in copy a_43532120

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43532120

out(pub, (~M_43540905,~M_43540906,~M_43540907)) with ~M_43540905 = key_s(charlie), ~M_43540906 = key_e(charlie,alice), ~M_43540907 = key_e(charlie,bob) at {466} in copy a_43532119

out(pub, ~M_43541136) with ~M_43541136 = dhexp(key_s(bob),g) at {351} in copy a_43532119

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43532119

out(pub, ~M_43541571) with ~M_43541571 = dhexp(key_s(bob),g) at {234} in copy a_43532119

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43532119

out(pub, ~M_43542000) with ~M_43542000 = dhexp(key_s(alice),g) at {119} in copy a_43532119

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43532119

out(pub, ~M_43542429) with ~M_43542429 = dhexp(key_s(alice),g) at {4} in copy a_43532119

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43532119

out(pub, (~M_43542638,~M_43542639,~M_43542640)) with ~M_43542638 = key_s(charlie), ~M_43542639 = key_e(charlie,alice), ~M_43542640 = key_e(charlie,bob) at {466} in copy a_43532118

out(pub, ~M_43542869) with ~M_43542869 = dhexp(key_s(bob),g) at {351} in copy a_43532118

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43532118

out(pub, ~M_43543304) with ~M_43543304 = dhexp(key_s(bob),g) at {234} in copy a_43532118

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43532118

out(pub, ~M_43543733) with ~M_43543733 = dhexp(key_s(alice),g) at {119} in copy a_43532118

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43532118

out(pub, ~M_43544162) with ~M_43544162 = dhexp(key_s(alice),g) at {4} in copy a_43532118

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43532118

out(pub, (~M_43544371,~M_43544372,~M_43544373)) with ~M_43544371 = key_s(charlie), ~M_43544372 = key_e(charlie,alice), ~M_43544373 = key_e(charlie,bob) at {466} in copy a_43532116

out(pub, ~M_43544602) with ~M_43544602 = dhexp(key_s(bob),g) at {351} in copy a_43532116

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43532116

out(pub, ~M_43545037) with ~M_43545037 = dhexp(key_s(bob),g) at {234} in copy a_43532116

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43532116

out(pub, ~M_43545466) with ~M_43545466 = dhexp(key_s(alice),g) at {119} in copy a_43532116

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43532116

out(pub, ~M_43545895) with ~M_43545895 = dhexp(key_s(alice),g) at {4} in copy a_43532116

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43532116

out(pub, (~M_43546104,~M_43546105,~M_43546106)) with ~M_43546104 = key_s(charlie), ~M_43546105 = key_e(charlie,alice), ~M_43546106 = key_e(charlie,bob) at {466} in copy a_43532115

out(pub, ~M_43546335) with ~M_43546335 = dhexp(key_s(bob),g) at {351} in copy a_43532115

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43532115

out(pub, ~M_43546770) with ~M_43546770 = dhexp(key_s(bob),g) at {234} in copy a_43532115

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43532115

out(pub, ~M_43547199) with ~M_43547199 = dhexp(key_s(alice),g) at {119} in copy a_43532115

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43532115

out(pub, ~M_43547628) with ~M_43547628 = dhexp(key_s(alice),g) at {4} in copy a_43532115

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43532115

out(pub, (~M_43547837,~M_43547838,~M_43547839)) with ~M_43547837 = key_s(charlie), ~M_43547838 = key_e(charlie,alice), ~M_43547839 = key_e(charlie,bob) at {466} in copy a_43532114

out(pub, ~M_43548068) with ~M_43548068 = dhexp(key_s(bob),g) at {351} in copy a_43532114

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43532114

out(pub, ~M_43548503) with ~M_43548503 = dhexp(key_s(bob),g) at {234} in copy a_43532114

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43532114

out(pub, ~M_43548932) with ~M_43548932 = dhexp(key_s(alice),g) at {119} in copy a_43532114

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43532114

out(pub, ~M_43549361) with ~M_43549361 = dhexp(key_s(alice),g) at {4} in copy a_43532114

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43532114

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43532115

in(pub, concat3(g,a_43532113,encrypt(hmac_hash2(hash(somename,empty),~M_43535937),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43536801),~M_43535937),g),a_43532112))) with encrypt(hmac_hash2(hash(somename,empty),~M_43535937),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43536801),~M_43535937),g),a_43532112) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532112) at {250} in copy a_43532115

event RecvMsg(bob,alice,stage_a,a_43532112,true) at {276} in copy a_43532115

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532112))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43532115

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532112))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43532116

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43532116

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532112)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532112)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43532116

out(pub, concat3(~M_43551495,empty,~M_43551497)) with ~M_43551495 = dhexp(key_e(bob,alice),g), ~M_43551497 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532112)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43532116

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43532121

in(pub, concat3(g,a_43532117,encrypt(hmac_hash2(hash(somename,empty),~M_43535937),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43536801),~M_43535937),g),a_43532111))) with encrypt(hmac_hash2(hash(somename,empty),~M_43535937),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43536801),~M_43535937),g),a_43532111) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532111) at {250} in copy a_43532121

event RecvMsg(bob,alice,stage_a,a_43532111,true) at {276} in copy a_43532121

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532111))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43532121

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532111))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43532122

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43532122

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532111)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532111)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43532122

out(pub, concat3(~M_43553453,empty,~M_43553455)) with ~M_43553453 = dhexp(key_e(bob,alice),g), ~M_43553455 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43532111)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43532122

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_43535937),~M_43551495),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43536801),~M_43535937),g),encrypt(hmac_hash2(hash(somename,empty),~M_43535937),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43536801),~M_43535937),g),a_43532111)),~M_43551495),~M_43553455)) = msg_b(bob,alice) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob))) is false.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

3. The attacker has some term plaintext_a_43553583.
attacker(plaintext_a_43553583).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 1, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_43553583.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)).

19. The attacker has some term b_43553579.
attacker(b_43553579).

20. By 4, the attacker may know g.
By 19, the attacker may know b_43553579.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583).
Using the function concat3 the attacker may obtain concat3(g,b_43553579,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)).
attacker(concat3(g,b_43553579,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583))).

21. By 1, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43553579,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43553579,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 2 may be read at get {278}.
The message concat3(g,b_43553579,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

23. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 22 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

24. By 1, the attacker may have the channel pub.
By 23, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

25. By 24, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

27. The attacker has some term plaintext_a_43553500.
attacker(plaintext_a_43553500).

28. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 27, the attacker may know plaintext_a_43553500.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)).

29. The attacker has some term b_43553496.
attacker(b_43553496).

30. By 4, the attacker may know g.
By 29, the attacker may know b_43553496.
By 28, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500).
Using the function concat3 the attacker may obtain concat3(g,b_43553496,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)).
attacker(concat3(g,b_43553496,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500))).

31. By 1, the attacker may have the channel pub.
By 30, the attacker may have the message concat3(g,b_43553496,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43553496,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500))).

32. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 26 may be read at get {278}.
The message concat3(g,b_43553496,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)) that may be sent on channel pub by 31 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

33. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 32 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

34. By 1, the attacker may have the channel pub.
By 33, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

35. By 34, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553500)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

36. By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583))).

37. By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)).
By 35, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g))).

38. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 35, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 16, the attacker may know minnonce.
By 37, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)).
By 25, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

41. By 40, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43553583)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice).
attacker(msg_b(bob,alice)).

42. By 41, the attacker may know msg_b(bob,alice).
So the attacker may know msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43557211,~M_43557212,~M_43557213)) with ~M_43557211 = key_s(charlie), ~M_43557212 = key_e(charlie,alice), ~M_43557213 = key_e(charlie,bob) at {466} in copy a_43553627

out(pub, ~M_43557442) with ~M_43557442 = dhexp(key_s(bob),g) at {351} in copy a_43553627

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43553627

out(pub, ~M_43557877) with ~M_43557877 = dhexp(key_s(bob),g) at {234} in copy a_43553627

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43553627

out(pub, ~M_43558306) with ~M_43558306 = dhexp(key_s(alice),g) at {119} in copy a_43553627

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43553627

out(pub, ~M_43558735) with ~M_43558735 = dhexp(key_s(alice),g) at {4} in copy a_43553627

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43553627

out(pub, (~M_43558944,~M_43558945,~M_43558946)) with ~M_43558944 = key_s(charlie), ~M_43558945 = key_e(charlie,alice), ~M_43558946 = key_e(charlie,bob) at {466} in copy a_43553626

out(pub, ~M_43559175) with ~M_43559175 = dhexp(key_s(bob),g) at {351} in copy a_43553626

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43553626

out(pub, ~M_43559610) with ~M_43559610 = dhexp(key_s(bob),g) at {234} in copy a_43553626

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43553626

out(pub, ~M_43560039) with ~M_43560039 = dhexp(key_s(alice),g) at {119} in copy a_43553626

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43553626

out(pub, ~M_43560468) with ~M_43560468 = dhexp(key_s(alice),g) at {4} in copy a_43553626

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43553626

out(pub, (~M_43560677,~M_43560678,~M_43560679)) with ~M_43560677 = key_s(charlie), ~M_43560678 = key_e(charlie,alice), ~M_43560679 = key_e(charlie,bob) at {466} in copy a_43553625

out(pub, ~M_43560908) with ~M_43560908 = dhexp(key_s(bob),g) at {351} in copy a_43553625

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43553625

out(pub, ~M_43561343) with ~M_43561343 = dhexp(key_s(bob),g) at {234} in copy a_43553625

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43553625

out(pub, ~M_43561772) with ~M_43561772 = dhexp(key_s(alice),g) at {119} in copy a_43553625

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43553625

out(pub, ~M_43562201) with ~M_43562201 = dhexp(key_s(alice),g) at {4} in copy a_43553625

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43553625

out(pub, (~M_43562410,~M_43562411,~M_43562412)) with ~M_43562410 = key_s(charlie), ~M_43562411 = key_e(charlie,alice), ~M_43562412 = key_e(charlie,bob) at {466} in copy a_43553624

out(pub, ~M_43562641) with ~M_43562641 = dhexp(key_s(bob),g) at {351} in copy a_43553624

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43553624

out(pub, ~M_43563076) with ~M_43563076 = dhexp(key_s(bob),g) at {234} in copy a_43553624

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43553624

out(pub, ~M_43563505) with ~M_43563505 = dhexp(key_s(alice),g) at {119} in copy a_43553624

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43553624

out(pub, ~M_43563934) with ~M_43563934 = dhexp(key_s(alice),g) at {4} in copy a_43553624

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43553624

out(pub, (~M_43564143,~M_43564144,~M_43564145)) with ~M_43564143 = key_s(charlie), ~M_43564144 = key_e(charlie,alice), ~M_43564145 = key_e(charlie,bob) at {466} in copy a_43553623

out(pub, ~M_43564374) with ~M_43564374 = dhexp(key_s(bob),g) at {351} in copy a_43553623

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43553623

out(pub, ~M_43564809) with ~M_43564809 = dhexp(key_s(bob),g) at {234} in copy a_43553623

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43553623

out(pub, ~M_43565238) with ~M_43565238 = dhexp(key_s(alice),g) at {119} in copy a_43553623

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43553623

out(pub, ~M_43565667) with ~M_43565667 = dhexp(key_s(alice),g) at {4} in copy a_43553623

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43553623

out(pub, (~M_43565876,~M_43565877,~M_43565878)) with ~M_43565876 = key_s(charlie), ~M_43565877 = key_e(charlie,alice), ~M_43565878 = key_e(charlie,bob) at {466} in copy a_43553621

out(pub, ~M_43566107) with ~M_43566107 = dhexp(key_s(bob),g) at {351} in copy a_43553621

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43553621

out(pub, ~M_43566542) with ~M_43566542 = dhexp(key_s(bob),g) at {234} in copy a_43553621

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43553621

out(pub, ~M_43566971) with ~M_43566971 = dhexp(key_s(alice),g) at {119} in copy a_43553621

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43553621

out(pub, ~M_43567400) with ~M_43567400 = dhexp(key_s(alice),g) at {4} in copy a_43553621

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43553621

out(pub, (~M_43567609,~M_43567610,~M_43567611)) with ~M_43567609 = key_s(charlie), ~M_43567610 = key_e(charlie,alice), ~M_43567611 = key_e(charlie,bob) at {466} in copy a_43553620

out(pub, ~M_43567840) with ~M_43567840 = dhexp(key_s(bob),g) at {351} in copy a_43553620

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43553620

out(pub, ~M_43568275) with ~M_43568275 = dhexp(key_s(bob),g) at {234} in copy a_43553620

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43553620

out(pub, ~M_43568704) with ~M_43568704 = dhexp(key_s(alice),g) at {119} in copy a_43553620

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43553620

out(pub, ~M_43569133) with ~M_43569133 = dhexp(key_s(alice),g) at {4} in copy a_43553620

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43553620

out(pub, (~M_43569342,~M_43569343,~M_43569344)) with ~M_43569342 = key_s(charlie), ~M_43569343 = key_e(charlie,alice), ~M_43569344 = key_e(charlie,bob) at {466} in copy a_43553619

out(pub, ~M_43569573) with ~M_43569573 = dhexp(key_s(bob),g) at {351} in copy a_43553619

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43553619

out(pub, ~M_43570008) with ~M_43570008 = dhexp(key_s(bob),g) at {234} in copy a_43553619

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43553619

out(pub, ~M_43570437) with ~M_43570437 = dhexp(key_s(alice),g) at {119} in copy a_43553619

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43553619

out(pub, ~M_43570866) with ~M_43570866 = dhexp(key_s(alice),g) at {4} in copy a_43553619

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43553619

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43553620

in(pub, concat3(g,a_43553618,encrypt(hmac_hash2(hash(somename,empty),~M_43557442),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43558306),~M_43557442),g),a_43553617))) with encrypt(hmac_hash2(hash(somename,empty),~M_43557442),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43558306),~M_43557442),g),a_43553617) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553617) at {250} in copy a_43553620

event RecvMsg(bob,alice,stage_a,a_43553617,true) at {276} in copy a_43553620

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553617))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43553620

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553617))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43553621

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43553621

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553617)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553617)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43553621

out(pub, concat3(~M_43573000,empty,~M_43573002)) with ~M_43573000 = dhexp(key_e(bob,alice),g), ~M_43573002 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553617)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43553621

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43553626

in(pub, concat3(g,a_43553622,encrypt(hmac_hash2(hash(somename,empty),~M_43557442),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43558306),~M_43557442),g),a_43553616))) with encrypt(hmac_hash2(hash(somename,empty),~M_43557442),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43558306),~M_43557442),g),a_43553616) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553616) at {250} in copy a_43553626

event RecvMsg(bob,alice,stage_a,a_43553616,true) at {276} in copy a_43553626

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553616))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43553626

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553616))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43553627

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43553627

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553616)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553616)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43553627

out(pub, concat3(~M_43574958,empty,~M_43574960)) with ~M_43574958 = dhexp(key_e(bob,alice),g), ~M_43574960 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43553616)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43553627

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_43557442),~M_43573000),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43558306),~M_43557442),g),encrypt(hmac_hash2(hash(somename,empty),~M_43557442),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43558306),~M_43557442),g),a_43553616)),~M_43573000),~M_43574960)) = msg_b(bob,alice) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true))
goal reachable: begin(LeakS(phase0,alice)) && attacker(m_43574962) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_43574962,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. The attacker has some term plaintext_a_43575171.
attacker(plaintext_a_43575171).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 4, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g)).

16. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

17. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

18. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_43575171.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)).

19. The attacker has some term b_43575167.
attacker(b_43575167).

20. By 3, the attacker may know g.
By 19, the attacker may know b_43575167.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171).
Using the function concat3 the attacker may obtain concat3(g,b_43575167,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)).
attacker(concat3(g,b_43575167,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))).

21. By 4, the attacker may have the channel pub.
By 20, the attacker may have the message concat3(g,b_43575167,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43575167,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {278}.
The message concat3(g,b_43575167,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)) that may be sent on channel pub by 21 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

23. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 22 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {306}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false)))).

24. We assume as hypothesis that
attacker(m_43575205).

25. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

26. The attacker has some term b_43575095.
attacker(b_43575095).

27. By 3, the attacker may know g.
By 26, the attacker may know b_43575095.
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171).
Using the function concat3 the attacker may obtain concat3(g,b_43575095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)).
attacker(concat3(g,b_43575095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))).

28. By 4, the attacker may have the channel pub.
By 27, the attacker may have the message concat3(g,b_43575095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43575095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))).

29. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 25 may be read at get {278}.
The message concat3(g,b_43575095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)) that may be sent on channel pub by 28 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

30. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 29 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

31. By 4, the attacker may have the channel pub.
By 30, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 31, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

33. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {249}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

34. The attacker has some term plaintext_a_43575012.
attacker(plaintext_a_43575012).

35. By 17, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 16, the attacker may know minnonce.
By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 34, the attacker may know plaintext_a_43575012.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)).

36. The attacker has some term b_43575008.
attacker(b_43575008).

37. By 3, the attacker may know g.
By 36, the attacker may know b_43575008.
By 35, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012).
Using the function concat3 the attacker may obtain concat3(g,b_43575008,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)).
attacker(concat3(g,b_43575008,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012))).

38. By 4, the attacker may have the channel pub.
By 37, the attacker may have the message concat3(g,b_43575008,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43575008,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012))).

39. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 33 may be read at get {278}.
The message concat3(g,b_43575008,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)) that may be sent on channel pub by 38 may be received at input {250}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {277}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

40. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 39 may be read at get {308}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {305}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {307}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

41. By 4, the attacker may have the channel pub.
By 40, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

42. By 41, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575012)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

43. By 15, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g).
By 18, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171))).

44. By 43, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)).
By 42, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g))).

45. By 44, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)).
By 32, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

46. The event LeakS(phase0,alice) may be executed at {112}.
So the message key_s(alice) may be sent on channel pub at output {113}.
mess(pub,key_s(alice)).

47. By 4, the attacker may have the channel pub.
By 46, the message key_s(alice) may be sent on this channel.
So the attacker may obtain the message key_s(alice) by listening on this channel.
attacker(key_s(alice)).

48. By 47, the attacker may know key_s(alice).
By 42, the attacker may know dhexp(key_e(bob,alice),g).
Using the function dhexp the attacker may obtain dhexp(key_s(alice),dhexp(key_e(bob,alice),g)).
attacker(dhexp(key_s(alice),dhexp(key_e(bob,alice),g))).

49. By 11, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

50. By 49, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 42, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

51. By 50, the attacker may know hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 48, the attacker may know dhexp(key_s(alice),dhexp(key_e(bob,alice),g)).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))).
attacker(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g)))).

52. By 51, the attacker may know hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))).
By 16, the attacker may know minnonce.
By 45, the attacker may know hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 24, the attacker may know m_43575205.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_43575205).
attacker(encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_43575205)).

53. The attacker has some term b_43575192.
attacker(b_43575192).

54. The attacker has some term a_43575191.
attacker(a_43575191).

55. By 54, the attacker may know a_43575191.
By 53, the attacker may know b_43575192.
By 52, the attacker may know encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_43575205).
Using the function concat3 the attacker may obtain concat3(a_43575191,b_43575192,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_43575205)).
attacker(concat3(a_43575191,b_43575192,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_43575205))).

56. By 4, the attacker may have the channel pub.
By 55, the attacker may have the message concat3(a_43575191,b_43575192,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_43575205)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_43575191,b_43575192,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_43575205))).

57. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 23 may be read at get {343}.
The message concat3(a_43575191,b_43575192,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),plaintext_a_43575171)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_43575205)) that may be sent on channel pub by 56 may be received at input {309}.
So event RecvMsg(bob,alice,stage_c,m_43575205,true) may be executed at {340}.
end(RecvMsg(bob,alice,stage_c,m_43575205,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43581022,~M_43581023,~M_43581024)) with ~M_43581022 = key_s(charlie), ~M_43581023 = key_e(charlie,alice), ~M_43581024 = key_e(charlie,bob) at {466} in copy a_43575226

out(pub, ~M_43581253) with ~M_43581253 = dhexp(key_s(bob),g) at {351} in copy a_43575226

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575226

out(pub, ~M_43581688) with ~M_43581688 = dhexp(key_s(bob),g) at {234} in copy a_43575226

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575226

out(pub, ~M_43582117) with ~M_43582117 = dhexp(key_s(alice),g) at {119} in copy a_43575226

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575226

out(pub, ~M_43582546) with ~M_43582546 = dhexp(key_s(alice),g) at {4} in copy a_43575226

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575226

out(pub, (~M_43582755,~M_43582756,~M_43582757)) with ~M_43582755 = key_s(charlie), ~M_43582756 = key_e(charlie,alice), ~M_43582757 = key_e(charlie,bob) at {466} in copy a_43575225

out(pub, ~M_43582986) with ~M_43582986 = dhexp(key_s(bob),g) at {351} in copy a_43575225

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575225

out(pub, ~M_43583421) with ~M_43583421 = dhexp(key_s(bob),g) at {234} in copy a_43575225

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575225

out(pub, ~M_43583850) with ~M_43583850 = dhexp(key_s(alice),g) at {119} in copy a_43575225

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575225

out(pub, ~M_43584279) with ~M_43584279 = dhexp(key_s(alice),g) at {4} in copy a_43575225

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575225

out(pub, (~M_43584488,~M_43584489,~M_43584490)) with ~M_43584488 = key_s(charlie), ~M_43584489 = key_e(charlie,alice), ~M_43584490 = key_e(charlie,bob) at {466} in copy a_43575224

out(pub, ~M_43584719) with ~M_43584719 = dhexp(key_s(bob),g) at {351} in copy a_43575224

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575224

out(pub, ~M_43585154) with ~M_43585154 = dhexp(key_s(bob),g) at {234} in copy a_43575224

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575224

out(pub, ~M_43585583) with ~M_43585583 = dhexp(key_s(alice),g) at {119} in copy a_43575224

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575224

out(pub, ~M_43586012) with ~M_43586012 = dhexp(key_s(alice),g) at {4} in copy a_43575224

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575224

out(pub, (~M_43586221,~M_43586222,~M_43586223)) with ~M_43586221 = key_s(charlie), ~M_43586222 = key_e(charlie,alice), ~M_43586223 = key_e(charlie,bob) at {466} in copy a_43575223

out(pub, ~M_43586452) with ~M_43586452 = dhexp(key_s(bob),g) at {351} in copy a_43575223

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575223

out(pub, ~M_43586887) with ~M_43586887 = dhexp(key_s(bob),g) at {234} in copy a_43575223

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575223

out(pub, ~M_43587316) with ~M_43587316 = dhexp(key_s(alice),g) at {119} in copy a_43575223

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575223

out(pub, ~M_43587745) with ~M_43587745 = dhexp(key_s(alice),g) at {4} in copy a_43575223

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575223

out(pub, (~M_43587954,~M_43587955,~M_43587956)) with ~M_43587954 = key_s(charlie), ~M_43587955 = key_e(charlie,alice), ~M_43587956 = key_e(charlie,bob) at {466} in copy a_43575222

out(pub, ~M_43588185) with ~M_43588185 = dhexp(key_s(bob),g) at {351} in copy a_43575222

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575222

out(pub, ~M_43588620) with ~M_43588620 = dhexp(key_s(bob),g) at {234} in copy a_43575222

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575222

out(pub, ~M_43589049) with ~M_43589049 = dhexp(key_s(alice),g) at {119} in copy a_43575222

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575222

out(pub, ~M_43589478) with ~M_43589478 = dhexp(key_s(alice),g) at {4} in copy a_43575222

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575222

out(pub, (~M_43589687,~M_43589688,~M_43589689)) with ~M_43589687 = key_s(charlie), ~M_43589688 = key_e(charlie,alice), ~M_43589689 = key_e(charlie,bob) at {466} in copy a_43575221

out(pub, ~M_43589918) with ~M_43589918 = dhexp(key_s(bob),g) at {351} in copy a_43575221

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575221

out(pub, ~M_43590353) with ~M_43590353 = dhexp(key_s(bob),g) at {234} in copy a_43575221

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575221

out(pub, ~M_43590782) with ~M_43590782 = dhexp(key_s(alice),g) at {119} in copy a_43575221

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575221

out(pub, ~M_43591211) with ~M_43591211 = dhexp(key_s(alice),g) at {4} in copy a_43575221

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575221

out(pub, (~M_43591420,~M_43591421,~M_43591422)) with ~M_43591420 = key_s(charlie), ~M_43591421 = key_e(charlie,alice), ~M_43591422 = key_e(charlie,bob) at {466} in copy a_43575219

out(pub, ~M_43591651) with ~M_43591651 = dhexp(key_s(bob),g) at {351} in copy a_43575219

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575219

out(pub, ~M_43592086) with ~M_43592086 = dhexp(key_s(bob),g) at {234} in copy a_43575219

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575219

out(pub, ~M_43592515) with ~M_43592515 = dhexp(key_s(alice),g) at {119} in copy a_43575219

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575219

out(pub, ~M_43592944) with ~M_43592944 = dhexp(key_s(alice),g) at {4} in copy a_43575219

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575219

out(pub, (~M_43593153,~M_43593154,~M_43593155)) with ~M_43593153 = key_s(charlie), ~M_43593154 = key_e(charlie,alice), ~M_43593155 = key_e(charlie,bob) at {466} in copy a_43575218

out(pub, ~M_43593384) with ~M_43593384 = dhexp(key_s(bob),g) at {351} in copy a_43575218

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575218

out(pub, ~M_43593819) with ~M_43593819 = dhexp(key_s(bob),g) at {234} in copy a_43575218

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575218

out(pub, ~M_43594248) with ~M_43594248 = dhexp(key_s(alice),g) at {119} in copy a_43575218

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575218

out(pub, ~M_43594677) with ~M_43594677 = dhexp(key_s(alice),g) at {4} in copy a_43575218

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575218

out(pub, (~M_43594886,~M_43594887,~M_43594888)) with ~M_43594886 = key_s(charlie), ~M_43594887 = key_e(charlie,alice), ~M_43594888 = key_e(charlie,bob) at {466} in copy a_43575217

out(pub, ~M_43595117) with ~M_43595117 = dhexp(key_s(bob),g) at {351} in copy a_43575217

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575217

out(pub, ~M_43595552) with ~M_43595552 = dhexp(key_s(bob),g) at {234} in copy a_43575217

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575217

out(pub, ~M_43595981) with ~M_43595981 = dhexp(key_s(alice),g) at {119} in copy a_43575217

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575217

out(pub, ~M_43596410) with ~M_43596410 = dhexp(key_s(alice),g) at {4} in copy a_43575217

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575217

out(pub, (~M_43596619,~M_43596620,~M_43596621)) with ~M_43596619 = key_s(charlie), ~M_43596620 = key_e(charlie,alice), ~M_43596621 = key_e(charlie,bob) at {466} in copy a_43575215

out(pub, ~M_43596850) with ~M_43596850 = dhexp(key_s(bob),g) at {351} in copy a_43575215

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575215

out(pub, ~M_43597285) with ~M_43597285 = dhexp(key_s(bob),g) at {234} in copy a_43575215

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575215

out(pub, ~M_43597714) with ~M_43597714 = dhexp(key_s(alice),g) at {119} in copy a_43575215

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575215

out(pub, ~M_43598143) with ~M_43598143 = dhexp(key_s(alice),g) at {4} in copy a_43575215

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575215

out(pub, (~M_43598352,~M_43598353,~M_43598354)) with ~M_43598352 = key_s(charlie), ~M_43598353 = key_e(charlie,alice), ~M_43598354 = key_e(charlie,bob) at {466} in copy a_43575214

out(pub, ~M_43598583) with ~M_43598583 = dhexp(key_s(bob),g) at {351} in copy a_43575214

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575214

out(pub, ~M_43599018) with ~M_43599018 = dhexp(key_s(bob),g) at {234} in copy a_43575214

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575214

out(pub, ~M_43599447) with ~M_43599447 = dhexp(key_s(alice),g) at {119} in copy a_43575214

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575214

out(pub, ~M_43599876) with ~M_43599876 = dhexp(key_s(alice),g) at {4} in copy a_43575214

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575214

out(pub, (~M_43600085,~M_43600086,~M_43600087)) with ~M_43600085 = key_s(charlie), ~M_43600086 = key_e(charlie,alice), ~M_43600087 = key_e(charlie,bob) at {466} in copy a_43575213

out(pub, ~M_43600316) with ~M_43600316 = dhexp(key_s(bob),g) at {351} in copy a_43575213

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575213

out(pub, ~M_43600751) with ~M_43600751 = dhexp(key_s(bob),g) at {234} in copy a_43575213

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575213

out(pub, ~M_43601180) with ~M_43601180 = dhexp(key_s(alice),g) at {119} in copy a_43575213

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575213

out(pub, ~M_43601609) with ~M_43601609 = dhexp(key_s(alice),g) at {4} in copy a_43575213

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575213

out(pub, (~M_43601818,~M_43601819,~M_43601820)) with ~M_43601818 = key_s(charlie), ~M_43601819 = key_e(charlie,alice), ~M_43601820 = key_e(charlie,bob) at {466} in copy a_43575210

out(pub, ~M_43602049) with ~M_43602049 = dhexp(key_s(bob),g) at {351} in copy a_43575210

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43575210

out(pub, ~M_43602484) with ~M_43602484 = dhexp(key_s(bob),g) at {234} in copy a_43575210

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43575210

out(pub, ~M_43602913) with ~M_43602913 = dhexp(key_s(alice),g) at {119} in copy a_43575210

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43575210

out(pub, ~M_43603342) with ~M_43603342 = dhexp(key_s(alice),g) at {4} in copy a_43575210

event LeakS(phase0,alice) at {112} in copy a_43575210

out(pub, ~M_43603344) with ~M_43603344 = key_s(alice) at {113} in copy a_43575210

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43575210

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43575214

in(pub, concat3(g,a_43575212,encrypt(hmac_hash2(hash(somename,empty),~M_43581253),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),a_43575211))) with encrypt(hmac_hash2(hash(somename,empty),~M_43581253),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),a_43575211) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575211) at {250} in copy a_43575214

event RecvMsg(bob,alice,stage_a,a_43575211,true) at {276} in copy a_43575214

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575211))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43575214

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575211))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43575215

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43575215

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575211)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575211)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43575215

out(pub, concat3(~M_43605490,empty,~M_43605492)) with ~M_43605490 = dhexp(key_e(bob,alice),g), ~M_43605492 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575211)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43575215

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43575218

in(pub, concat3(g,a_43575216,encrypt(hmac_hash2(hash(somename,empty),~M_43581253),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),a_43575209))) with encrypt(hmac_hash2(hash(somename,empty),~M_43581253),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),a_43575209) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209) at {250} in copy a_43575218

event RecvMsg(bob,alice,stage_a,a_43575209,true) at {276} in copy a_43575218

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43575218

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43575219

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43575219

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43575219

out(pub, concat3(~M_43607424,empty,~M_43607426)) with ~M_43607424 = dhexp(key_e(bob,alice),g), ~M_43607426 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43575219

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {278} in copy a_43575224

in(pub, concat3(g,a_43575220,encrypt(hmac_hash2(hash(somename,empty),~M_43581253),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),a_43575209))) with encrypt(hmac_hash2(hash(somename,empty),~M_43581253),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),a_43575209) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209) at {250} in copy a_43575224

event RecvMsg(bob,alice,stage_a,a_43575209,true) at {276} in copy a_43575224

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_43575224

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {308} in copy a_43575225

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {305} in copy a_43575225

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {306} in copy a_43575225

out(pub, concat3(~M_43609382,empty,~M_43609384)) with ~M_43609382 = dhexp(key_e(bob,alice),g), ~M_43609384 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {307} in copy a_43575225

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {343} in copy a_43575226

in(pub, concat3(a_43575207,a_43575208,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),~M_43581253),~M_43605490),dhexp(~M_43603344,~M_43605490)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),encrypt(hmac_hash2(hash(somename,empty),~M_43581253),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),a_43575209)),~M_43605490),~M_43607426),a_43575206))) with encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),~M_43581253),~M_43605490),dhexp(~M_43603344,~M_43605490)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),encrypt(hmac_hash2(hash(somename,empty),~M_43581253),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),~M_43582117),~M_43581253),g),a_43575209)),~M_43605490),~M_43607426),a_43575206) = encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),dhexp(key_s(alice),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),g),a_43575209)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_43575206) at {309} in copy a_43575226

event RecvMsg(bob,alice,stage_c,a_43575206,true) at {340} in copy a_43575226 (goal)

The event RecvMsg(bob,alice,stage_c,a_43575206,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_945,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase0,alice)) && attacker(m_43610754) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_43610754,true))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,bob),true))
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_945,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is true.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_945,stage_c,m,true)) || event(LeakS(phase0,alice))
goal reachable: begin(LeakS(phase0,alice)) && attacker(m_43610759) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_43610759,true))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,bob),true))
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_945,stage_c,m,true)) || event(LeakS(phase0,alice)) is true.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase0,alice)) && attacker(m_43610764) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_43610764,true))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,bob),true))
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is true.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice))
goal reachable: begin(LeakS(phase0,alice)) && attacker(m_43610768) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_43610768,true))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,bob),true))
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) is true.
Starting query not attacker_p1(msg_c(alice,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {19}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {49}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {46}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {47}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

4. The attacker has some term plaintext_b_43610944.
attacker(plaintext_b_43610944).

5. Using the function g the attacker may obtain g.
attacker(g).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {19}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 6 may be read at get {49}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {46}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {48}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 1, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {19}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

11. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 10 may be read at get {49}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {46}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {48}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

12. By 1, the attacker may have the channel pub.
By 11, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

13. By 12, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

14. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

15. By 1, the attacker may have the channel pub.
By 14, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

16. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

17. By 1, the attacker may have the channel pub.
By 16, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

18. Using the function empty the attacker may obtain empty.
attacker(empty).

19. Using the function somename the attacker may obtain somename.
attacker(somename).

20. By 19, the attacker may know somename.
By 18, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

21. By 20, the attacker may know hash(somename,empty).
By 18, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

22. By 21, the attacker may know hash(hash(somename,empty),empty).
By 17, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

23. By 22, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 15, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))).

24. By 23, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

25. By 24, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

26. By 25, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 5, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

27. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

28. The event LeakS(phase0,bob) may be executed at {344}.
So the message key_s(bob) may be sent on channel pub at output {345}.
mess(pub,key_s(bob)).

29. By 1, the attacker may have the channel pub.
By 28, the message key_s(bob) may be sent on this channel.
So the attacker may obtain the message key_s(bob) by listening on this channel.
attacker(key_s(bob)).

30. By 29, the attacker may know key_s(bob).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function dhexp the attacker may obtain dhexp(key_s(bob),dhexp(key_e(alice,bob),g)).
attacker(dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).

31. By 20, the attacker may know hash(somename,empty).
By 30, the attacker may know dhexp(key_s(bob),dhexp(key_e(alice,bob),g)).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g)))).

32. By 31, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g))).

33. By 32, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
By 27, the attacker may know minnonce.
By 26, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 4, the attacker may know plaintext_b_43610944.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)).

34. The attacker has some term b_43610940.
attacker(b_43610940).

35. By 5, the attacker may know g.
By 34, the attacker may know b_43610940.
By 33, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944).
Using the function concat3 the attacker may obtain concat3(g,b_43610940,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)).
attacker(concat3(g,b_43610940,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944))).

36. By 1, the attacker may have the channel pub.
By 35, the attacker may have the message concat3(g,b_43610940,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43610940,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944))).

37. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 3 may be read at get {78}.
The message concat3(g,b_43610940,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)) that may be sent on channel pub by 36 may be received at input {50}.
We have g <> caught-fail.
So the entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true))) may be inserted in a table at insert {77}.
table(statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true)))).

38. The entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true))) that may be in a table by 37 may be read at get {111}.
The event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) may be executed at {108}.
So the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob))) may be sent on channel pub at output {110}.
mess(pub,concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob)))).

39. By 1, the attacker may have the channel pub.
By 38, the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob))) by listening on this channel.
attacker(concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob)))).

40. By 39, the attacker may know concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob)).
attacker(encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob))).

41. By 26, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 33, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)).
attacker(hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944))).

42. By 31, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g))).

43. By 42, the attacker may know hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
By 17, the attacker may know dhexp(key_s(alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
attacker(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g))).

44. By 43, the attacker may know hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
By 27, the attacker may know minnonce.
By 41, the attacker may know hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)).
By 40, the attacker may know encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob))).

45. By 44, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_43610944)),msg_c(alice,bob)).
Using the function 3-proj-aeadpack the attacker may obtain msg_c(alice,bob).
attacker(msg_c(alice,bob)).

46. By 45, the attacker may know msg_c(alice,bob).
So the attacker may know msg_c(alice,bob) in phase 1.
attacker_p1(msg_c(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43615905,~M_43615906,~M_43615907)) with ~M_43615905 = key_s(charlie), ~M_43615906 = key_e(charlie,alice), ~M_43615907 = key_e(charlie,bob) at {466} in copy a_43610989

out(pub, ~M_43616136) with ~M_43616136 = dhexp(key_s(bob),g) at {351} in copy a_43610989

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610989

out(pub, ~M_43616571) with ~M_43616571 = dhexp(key_s(bob),g) at {234} in copy a_43610989

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610989

out(pub, ~M_43617000) with ~M_43617000 = dhexp(key_s(alice),g) at {119} in copy a_43610989

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610989

out(pub, ~M_43617429) with ~M_43617429 = dhexp(key_s(alice),g) at {4} in copy a_43610989

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610989

out(pub, (~M_43617638,~M_43617639,~M_43617640)) with ~M_43617638 = key_s(charlie), ~M_43617639 = key_e(charlie,alice), ~M_43617640 = key_e(charlie,bob) at {466} in copy a_43610988

out(pub, ~M_43617869) with ~M_43617869 = dhexp(key_s(bob),g) at {351} in copy a_43610988

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610988

out(pub, ~M_43618304) with ~M_43618304 = dhexp(key_s(bob),g) at {234} in copy a_43610988

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610988

out(pub, ~M_43618733) with ~M_43618733 = dhexp(key_s(alice),g) at {119} in copy a_43610988

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610988

out(pub, ~M_43619162) with ~M_43619162 = dhexp(key_s(alice),g) at {4} in copy a_43610988

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610988

out(pub, (~M_43619371,~M_43619372,~M_43619373)) with ~M_43619371 = key_s(charlie), ~M_43619372 = key_e(charlie,alice), ~M_43619373 = key_e(charlie,bob) at {466} in copy a_43610987

out(pub, ~M_43619602) with ~M_43619602 = dhexp(key_s(bob),g) at {351} in copy a_43610987

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610987

out(pub, ~M_43620037) with ~M_43620037 = dhexp(key_s(bob),g) at {234} in copy a_43610987

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610987

out(pub, ~M_43620466) with ~M_43620466 = dhexp(key_s(alice),g) at {119} in copy a_43610987

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610987

out(pub, ~M_43620895) with ~M_43620895 = dhexp(key_s(alice),g) at {4} in copy a_43610987

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610987

out(pub, (~M_43621104,~M_43621105,~M_43621106)) with ~M_43621104 = key_s(charlie), ~M_43621105 = key_e(charlie,alice), ~M_43621106 = key_e(charlie,bob) at {466} in copy a_43610986

out(pub, ~M_43621335) with ~M_43621335 = dhexp(key_s(bob),g) at {351} in copy a_43610986

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610986

out(pub, ~M_43621770) with ~M_43621770 = dhexp(key_s(bob),g) at {234} in copy a_43610986

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610986

out(pub, ~M_43622199) with ~M_43622199 = dhexp(key_s(alice),g) at {119} in copy a_43610986

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610986

out(pub, ~M_43622628) with ~M_43622628 = dhexp(key_s(alice),g) at {4} in copy a_43610986

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610986

out(pub, (~M_43622837,~M_43622838,~M_43622839)) with ~M_43622837 = key_s(charlie), ~M_43622838 = key_e(charlie,alice), ~M_43622839 = key_e(charlie,bob) at {466} in copy a_43610985

out(pub, ~M_43623068) with ~M_43623068 = dhexp(key_s(bob),g) at {351} in copy a_43610985

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610985

out(pub, ~M_43623503) with ~M_43623503 = dhexp(key_s(bob),g) at {234} in copy a_43610985

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610985

out(pub, ~M_43623932) with ~M_43623932 = dhexp(key_s(alice),g) at {119} in copy a_43610985

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610985

out(pub, ~M_43624361) with ~M_43624361 = dhexp(key_s(alice),g) at {4} in copy a_43610985

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610985

out(pub, (~M_43624570,~M_43624571,~M_43624572)) with ~M_43624570 = key_s(charlie), ~M_43624571 = key_e(charlie,alice), ~M_43624572 = key_e(charlie,bob) at {466} in copy a_43610984

out(pub, ~M_43624801) with ~M_43624801 = dhexp(key_s(bob),g) at {351} in copy a_43610984

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610984

out(pub, ~M_43625236) with ~M_43625236 = dhexp(key_s(bob),g) at {234} in copy a_43610984

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610984

out(pub, ~M_43625665) with ~M_43625665 = dhexp(key_s(alice),g) at {119} in copy a_43610984

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610984

out(pub, ~M_43626094) with ~M_43626094 = dhexp(key_s(alice),g) at {4} in copy a_43610984

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610984

out(pub, (~M_43626303,~M_43626304,~M_43626305)) with ~M_43626303 = key_s(charlie), ~M_43626304 = key_e(charlie,alice), ~M_43626305 = key_e(charlie,bob) at {466} in copy a_43610983

out(pub, ~M_43626534) with ~M_43626534 = dhexp(key_s(bob),g) at {351} in copy a_43610983

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610983

out(pub, ~M_43626969) with ~M_43626969 = dhexp(key_s(bob),g) at {234} in copy a_43610983

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610983

out(pub, ~M_43627398) with ~M_43627398 = dhexp(key_s(alice),g) at {119} in copy a_43610983

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610983

out(pub, ~M_43627827) with ~M_43627827 = dhexp(key_s(alice),g) at {4} in copy a_43610983

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610983

out(pub, (~M_43628036,~M_43628037,~M_43628038)) with ~M_43628036 = key_s(charlie), ~M_43628037 = key_e(charlie,alice), ~M_43628038 = key_e(charlie,bob) at {466} in copy a_43610982

out(pub, ~M_43628267) with ~M_43628267 = dhexp(key_s(bob),g) at {351} in copy a_43610982

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610982

out(pub, ~M_43628702) with ~M_43628702 = dhexp(key_s(bob),g) at {234} in copy a_43610982

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610982

out(pub, ~M_43629131) with ~M_43629131 = dhexp(key_s(alice),g) at {119} in copy a_43610982

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610982

out(pub, ~M_43629560) with ~M_43629560 = dhexp(key_s(alice),g) at {4} in copy a_43610982

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610982

out(pub, (~M_43629769,~M_43629770,~M_43629771)) with ~M_43629769 = key_s(charlie), ~M_43629770 = key_e(charlie,alice), ~M_43629771 = key_e(charlie,bob) at {466} in copy a_43610981

out(pub, ~M_43630000) with ~M_43630000 = dhexp(key_s(bob),g) at {351} in copy a_43610981

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610981

out(pub, ~M_43630435) with ~M_43630435 = dhexp(key_s(bob),g) at {234} in copy a_43610981

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610981

out(pub, ~M_43630864) with ~M_43630864 = dhexp(key_s(alice),g) at {119} in copy a_43610981

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610981

out(pub, ~M_43631293) with ~M_43631293 = dhexp(key_s(alice),g) at {4} in copy a_43610981

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610981

out(pub, (~M_43631502,~M_43631503,~M_43631504)) with ~M_43631502 = key_s(charlie), ~M_43631503 = key_e(charlie,alice), ~M_43631504 = key_e(charlie,bob) at {466} in copy a_43610980

out(pub, ~M_43631733) with ~M_43631733 = dhexp(key_s(bob),g) at {351} in copy a_43610980

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610980

out(pub, ~M_43632168) with ~M_43632168 = dhexp(key_s(bob),g) at {234} in copy a_43610980

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610980

out(pub, ~M_43632597) with ~M_43632597 = dhexp(key_s(alice),g) at {119} in copy a_43610980

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610980

out(pub, ~M_43633026) with ~M_43633026 = dhexp(key_s(alice),g) at {4} in copy a_43610980

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610980

out(pub, (~M_43633235,~M_43633236,~M_43633237)) with ~M_43633235 = key_s(charlie), ~M_43633236 = key_e(charlie,alice), ~M_43633237 = key_e(charlie,bob) at {466} in copy a_43610979

out(pub, ~M_43633466) with ~M_43633466 = dhexp(key_s(bob),g) at {351} in copy a_43610979

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43610979

out(pub, ~M_43633901) with ~M_43633901 = dhexp(key_s(bob),g) at {234} in copy a_43610979

event LeakS(phase0,bob) at {344} in copy a_43610979

out(pub, ~M_43633903) with ~M_43633903 = key_s(bob) at {345} in copy a_43610979

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43610979

out(pub, ~M_43634332) with ~M_43634332 = dhexp(key_s(alice),g) at {119} in copy a_43610979

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43610979

out(pub, ~M_43634761) with ~M_43634761 = dhexp(key_s(alice),g) at {4} in copy a_43610979

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43610979

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {49} in copy a_43610983

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {46} in copy a_43610983

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {47} in copy a_43610983

out(pub, concat3(~M_43635938,empty,~M_43635940)) with ~M_43635938 = dhexp(key_e(alice,bob),g), ~M_43635940 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {48} in copy a_43610983

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {49} in copy a_43610985

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {46} in copy a_43610985

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {47} in copy a_43610985

out(pub, concat3(~M_43636886,empty,~M_43636888)) with ~M_43636886 = dhexp(key_e(alice,bob),g), ~M_43636888 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {48} in copy a_43610985

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {49} in copy a_43610987

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {46} in copy a_43610987

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {47} in copy a_43610987

out(pub, concat3(~M_43637834,empty,~M_43637836)) with ~M_43637834 = dhexp(key_e(alice,bob),g), ~M_43637836 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {48} in copy a_43610987

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {78} in copy a_43610988

in(pub, concat3(g,a_43610978,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_43633903,~M_43635938)),~M_43635938),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43617000),~M_43616136),~M_43635938),~M_43635940),g),a_43610977))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_43633903,~M_43635938)),~M_43635938),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43617000),~M_43616136),~M_43635938),~M_43635940),g),a_43610977) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_43610977) at {50} in copy a_43610988

event RecvMsg(alice,bob,stage_b,a_43610977,true) at {76} in copy a_43610988

insert statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_43610977))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true))) at {77} in copy a_43610988

get statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_43610977))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true))) at {111} in copy a_43610989

event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) at {108} in copy a_43610989

insert statestore(alice,bob,statepack_d(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_43610977)),encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_43610977)),msg_c(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true))) at {109} in copy a_43610989

out(pub, concat3(empty,empty,~M_43640032)) with ~M_43640032 = encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_43610977)),msg_c(alice,bob)) at {110} in copy a_43610989

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(~M_43633903,~M_43635938)),~M_43635938),~M_43617000),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43617000),~M_43616136),~M_43635938),~M_43635940),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_43633903,~M_43635938)),~M_43635938),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_43617000),~M_43616136),~M_43635938),~M_43635940),g),a_43610977)),~M_43640032)) = msg_c(alice,bob) in phase 1.
A trace has been found.
RESULT not attacker_p1(msg_c(alice,bob)) is false.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)) is true.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice)))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))) is true.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) is true.
Starting query not event(RecvEnd(true))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) -> end(RecvEnd(true))

1. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) may be inserted in a table at insert {366}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false)))).

2. The attacker has some term plaintext_a_43640257.
attacker(plaintext_a_43640257).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {234}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The message (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)) may be sent on channel pub at output {466}.
mess(pub,(key_s(charlie),key_e(charlie,alice),key_e(charlie,bob))).

8. By 4, the attacker may have the channel pub.
By 7, the message (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)) may be sent on this channel.
So the attacker may obtain the message (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)) by listening on this channel.
attacker((key_s(charlie),key_e(charlie,alice),key_e(charlie,bob))).

9. By 8, the attacker may know (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)).
Using the function 1-proj-3-tuple the attacker may obtain key_s(charlie).
attacker(key_s(charlie)).

10. By 9, the attacker may know key_s(charlie).
By 3, the attacker may know g.
Using the function dhexp the attacker may obtain dhexp(key_s(charlie),g).
attacker(dhexp(key_s(charlie),g)).

11. Using the function empty the attacker may obtain empty.
attacker(empty).

12. Using the function somename the attacker may obtain somename.
attacker(somename).

13. By 12, the attacker may know somename.
By 11, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

14. By 13, the attacker may know hash(somename,empty).
By 11, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

15. By 14, the attacker may know hash(hash(somename,empty),empty).
By 10, the attacker may know dhexp(key_s(charlie),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))).

16. By 15, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))).

17. By 16, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g)).

18. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

19. By 13, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

20. By 19, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 18, the attacker may know minnonce.
By 17, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_43640257.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)).

21. The attacker has some term b_43640253.
attacker(b_43640253).

22. By 3, the attacker may know g.
By 21, the attacker may know b_43640253.
By 20, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257).
Using the function concat3 the attacker may obtain concat3(g,b_43640253,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)).
attacker(concat3(g,b_43640253,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))).

23. By 4, the attacker may have the channel pub.
By 22, the attacker may have the message concat3(g,b_43640253,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43640253,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))).

24. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) that may be in a table by 1 may be read at get {395}.
The message concat3(g,b_43640253,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)) that may be sent on channel pub by 23 may be received at input {367}.
We have g <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) may be inserted in a table at insert {394}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false)))).

25. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) that may be in a table by 24 may be read at get {425}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {422}.
So the entry statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),g,empty,false))) may be inserted in a table at insert {423}.
table(statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),g,empty,false)))).

26. The attacker has some term plaintext_c_43640283.
attacker(plaintext_c_43640283).

27. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) may be inserted in a table at insert {366}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false)))).

28. The attacker has some term b_43640176.
attacker(b_43640176).

29. By 3, the attacker may know g.
By 28, the attacker may know b_43640176.
By 20, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257).
Using the function concat3 the attacker may obtain concat3(g,b_43640176,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)).
attacker(concat3(g,b_43640176,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))).

30. By 4, the attacker may have the channel pub.
By 29, the attacker may have the message concat3(g,b_43640176,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43640176,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))).

31. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) that may be in a table by 27 may be read at get {395}.
The message concat3(g,b_43640176,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)) that may be sent on channel pub by 30 may be received at input {367}.
We have g <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) may be inserted in a table at insert {394}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false)))).

32. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) that may be in a table by 31 may be read at get {425}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {422}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {424}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

33. By 4, the attacker may have the channel pub.
By 32, the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

34. By 33, the attacker may know concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).

35. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) may be inserted in a table at insert {366}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false)))).

36. The attacker has some term plaintext_a_43640088.
attacker(plaintext_a_43640088).

37. By 19, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 18, the attacker may know minnonce.
By 17, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g).
By 36, the attacker may know plaintext_a_43640088.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)).

38. The attacker has some term b_43640084.
attacker(b_43640084).

39. By 3, the attacker may know g.
By 38, the attacker may know b_43640084.
By 37, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088).
Using the function concat3 the attacker may obtain concat3(g,b_43640084,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)).
attacker(concat3(g,b_43640084,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088))).

40. By 4, the attacker may have the channel pub.
By 39, the attacker may have the message concat3(g,b_43640084,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_43640084,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088))).

41. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) that may be in a table by 35 may be read at get {395}.
The message concat3(g,b_43640084,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)) that may be sent on channel pub by 40 may be received at input {367}.
We have g <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) may be inserted in a table at insert {394}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false)))).

42. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) that may be in a table by 41 may be read at get {425}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {422}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {424}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

43. By 4, the attacker may have the channel pub.
By 42, the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

44. By 43, the attacker may know concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640088)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,charlie),g).
attacker(dhexp(key_e(bob,charlie),g)).

45. By 17, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g).
By 20, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257))).

46. By 45, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)).
By 44, the attacker may know dhexp(key_e(bob,charlie),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g))).

47. By 46, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)).
By 34, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
attacker(hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

48. By 9, the attacker may know key_s(charlie).
By 44, the attacker may know dhexp(key_e(bob,charlie),g).
Using the function dhexp the attacker may obtain dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g)).
attacker(dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))).

49. By 13, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

50. By 49, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 44, the attacker may know dhexp(key_e(bob,charlie),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)).
attacker(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g))).

51. By 50, the attacker may know hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)).
By 48, the attacker may know dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g)).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))).
attacker(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g)))).

52. By 51, the attacker may know hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))).
By 18, the attacker may know minnonce.
By 47, the attacker may know hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
By 26, the attacker may know plaintext_c_43640283.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_43640283).
attacker(encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_43640283)).

53. The attacker has some term b_43640278.
attacker(b_43640278).

54. The attacker has some term a_43640277.
attacker(a_43640277).

55. By 54, the attacker may know a_43640277.
By 53, the attacker may know b_43640278.
By 52, the attacker may know encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_43640283).
Using the function concat3 the attacker may obtain concat3(a_43640277,b_43640278,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_43640283)).
attacker(concat3(a_43640277,b_43640278,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_43640283))).

56. By 4, the attacker may have the channel pub.
By 55, the attacker may have the message concat3(a_43640277,b_43640278,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_43640283)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_43640277,b_43640278,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_43640283))).

57. The entry statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),g,empty,false))) that may be in a table by 25 may be read at get {460}.
The message concat3(a_43640277,b_43640278,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),plaintext_a_43640257)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_43640283)) that may be sent on channel pub by 56 may be received at input {426}.
So event RecvEnd(true) may be executed at {459}.
end(RecvEnd(true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_43645670,~M_43645671,~M_43645672)) with ~M_43645670 = key_s(charlie), ~M_43645671 = key_e(charlie,alice), ~M_43645672 = key_e(charlie,bob) at {466} in copy a_43640310

out(pub, ~M_43645901) with ~M_43645901 = dhexp(key_s(bob),g) at {351} in copy a_43640310

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640310

out(pub, ~M_43646336) with ~M_43646336 = dhexp(key_s(bob),g) at {234} in copy a_43640310

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640310

out(pub, ~M_43646765) with ~M_43646765 = dhexp(key_s(alice),g) at {119} in copy a_43640310

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640310

out(pub, ~M_43647194) with ~M_43647194 = dhexp(key_s(alice),g) at {4} in copy a_43640310

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640310

out(pub, (~M_43647403,~M_43647404,~M_43647405)) with ~M_43647403 = key_s(charlie), ~M_43647404 = key_e(charlie,alice), ~M_43647405 = key_e(charlie,bob) at {466} in copy a_43640309

out(pub, ~M_43647634) with ~M_43647634 = dhexp(key_s(bob),g) at {351} in copy a_43640309

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640309

out(pub, ~M_43648069) with ~M_43648069 = dhexp(key_s(bob),g) at {234} in copy a_43640309

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640309

out(pub, ~M_43648498) with ~M_43648498 = dhexp(key_s(alice),g) at {119} in copy a_43640309

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640309

out(pub, ~M_43648927) with ~M_43648927 = dhexp(key_s(alice),g) at {4} in copy a_43640309

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640309

out(pub, (~M_43649136,~M_43649137,~M_43649138)) with ~M_43649136 = key_s(charlie), ~M_43649137 = key_e(charlie,alice), ~M_43649138 = key_e(charlie,bob) at {466} in copy a_43640308

out(pub, ~M_43649367) with ~M_43649367 = dhexp(key_s(bob),g) at {351} in copy a_43640308

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640308

out(pub, ~M_43649802) with ~M_43649802 = dhexp(key_s(bob),g) at {234} in copy a_43640308

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640308

out(pub, ~M_43650231) with ~M_43650231 = dhexp(key_s(alice),g) at {119} in copy a_43640308

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640308

out(pub, ~M_43650660) with ~M_43650660 = dhexp(key_s(alice),g) at {4} in copy a_43640308

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640308

out(pub, (~M_43650869,~M_43650870,~M_43650871)) with ~M_43650869 = key_s(charlie), ~M_43650870 = key_e(charlie,alice), ~M_43650871 = key_e(charlie,bob) at {466} in copy a_43640307

out(pub, ~M_43651100) with ~M_43651100 = dhexp(key_s(bob),g) at {351} in copy a_43640307

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640307

out(pub, ~M_43651535) with ~M_43651535 = dhexp(key_s(bob),g) at {234} in copy a_43640307

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640307

out(pub, ~M_43651964) with ~M_43651964 = dhexp(key_s(alice),g) at {119} in copy a_43640307

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640307

out(pub, ~M_43652393) with ~M_43652393 = dhexp(key_s(alice),g) at {4} in copy a_43640307

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640307

out(pub, (~M_43652602,~M_43652603,~M_43652604)) with ~M_43652602 = key_s(charlie), ~M_43652603 = key_e(charlie,alice), ~M_43652604 = key_e(charlie,bob) at {466} in copy a_43640306

out(pub, ~M_43652833) with ~M_43652833 = dhexp(key_s(bob),g) at {351} in copy a_43640306

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640306

out(pub, ~M_43653268) with ~M_43653268 = dhexp(key_s(bob),g) at {234} in copy a_43640306

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640306

out(pub, ~M_43653697) with ~M_43653697 = dhexp(key_s(alice),g) at {119} in copy a_43640306

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640306

out(pub, ~M_43654126) with ~M_43654126 = dhexp(key_s(alice),g) at {4} in copy a_43640306

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640306

out(pub, (~M_43654335,~M_43654336,~M_43654337)) with ~M_43654335 = key_s(charlie), ~M_43654336 = key_e(charlie,alice), ~M_43654337 = key_e(charlie,bob) at {466} in copy a_43640305

out(pub, ~M_43654566) with ~M_43654566 = dhexp(key_s(bob),g) at {351} in copy a_43640305

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640305

out(pub, ~M_43655001) with ~M_43655001 = dhexp(key_s(bob),g) at {234} in copy a_43640305

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640305

out(pub, ~M_43655430) with ~M_43655430 = dhexp(key_s(alice),g) at {119} in copy a_43640305

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640305

out(pub, ~M_43655859) with ~M_43655859 = dhexp(key_s(alice),g) at {4} in copy a_43640305

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640305

out(pub, (~M_43656068,~M_43656069,~M_43656070)) with ~M_43656068 = key_s(charlie), ~M_43656069 = key_e(charlie,alice), ~M_43656070 = key_e(charlie,bob) at {466} in copy a_43640303

out(pub, ~M_43656299) with ~M_43656299 = dhexp(key_s(bob),g) at {351} in copy a_43640303

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640303

out(pub, ~M_43656734) with ~M_43656734 = dhexp(key_s(bob),g) at {234} in copy a_43640303

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640303

out(pub, ~M_43657163) with ~M_43657163 = dhexp(key_s(alice),g) at {119} in copy a_43640303

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640303

out(pub, ~M_43657592) with ~M_43657592 = dhexp(key_s(alice),g) at {4} in copy a_43640303

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640303

out(pub, (~M_43657801,~M_43657802,~M_43657803)) with ~M_43657801 = key_s(charlie), ~M_43657802 = key_e(charlie,alice), ~M_43657803 = key_e(charlie,bob) at {466} in copy a_43640302

out(pub, ~M_43658032) with ~M_43658032 = dhexp(key_s(bob),g) at {351} in copy a_43640302

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640302

out(pub, ~M_43658467) with ~M_43658467 = dhexp(key_s(bob),g) at {234} in copy a_43640302

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640302

out(pub, ~M_43658896) with ~M_43658896 = dhexp(key_s(alice),g) at {119} in copy a_43640302

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640302

out(pub, ~M_43659325) with ~M_43659325 = dhexp(key_s(alice),g) at {4} in copy a_43640302

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640302

out(pub, (~M_43659534,~M_43659535,~M_43659536)) with ~M_43659534 = key_s(charlie), ~M_43659535 = key_e(charlie,alice), ~M_43659536 = key_e(charlie,bob) at {466} in copy a_43640301

out(pub, ~M_43659765) with ~M_43659765 = dhexp(key_s(bob),g) at {351} in copy a_43640301

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640301

out(pub, ~M_43660200) with ~M_43660200 = dhexp(key_s(bob),g) at {234} in copy a_43640301

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640301

out(pub, ~M_43660629) with ~M_43660629 = dhexp(key_s(alice),g) at {119} in copy a_43640301

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640301

out(pub, ~M_43661058) with ~M_43661058 = dhexp(key_s(alice),g) at {4} in copy a_43640301

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640301

out(pub, (~M_43661267,~M_43661268,~M_43661269)) with ~M_43661267 = key_s(charlie), ~M_43661268 = key_e(charlie,alice), ~M_43661269 = key_e(charlie,bob) at {466} in copy a_43640299

out(pub, ~M_43661498) with ~M_43661498 = dhexp(key_s(bob),g) at {351} in copy a_43640299

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640299

out(pub, ~M_43661933) with ~M_43661933 = dhexp(key_s(bob),g) at {234} in copy a_43640299

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640299

out(pub, ~M_43662362) with ~M_43662362 = dhexp(key_s(alice),g) at {119} in copy a_43640299

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640299

out(pub, ~M_43662791) with ~M_43662791 = dhexp(key_s(alice),g) at {4} in copy a_43640299

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640299

out(pub, (~M_43663000,~M_43663001,~M_43663002)) with ~M_43663000 = key_s(charlie), ~M_43663001 = key_e(charlie,alice), ~M_43663002 = key_e(charlie,bob) at {466} in copy a_43640298

out(pub, ~M_43663231) with ~M_43663231 = dhexp(key_s(bob),g) at {351} in copy a_43640298

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640298

out(pub, ~M_43663666) with ~M_43663666 = dhexp(key_s(bob),g) at {234} in copy a_43640298

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640298

out(pub, ~M_43664095) with ~M_43664095 = dhexp(key_s(alice),g) at {119} in copy a_43640298

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640298

out(pub, ~M_43664524) with ~M_43664524 = dhexp(key_s(alice),g) at {4} in copy a_43640298

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640298

out(pub, (~M_43664733,~M_43664734,~M_43664735)) with ~M_43664733 = key_s(charlie), ~M_43664734 = key_e(charlie,alice), ~M_43664735 = key_e(charlie,bob) at {466} in copy a_43640297

out(pub, ~M_43664964) with ~M_43664964 = dhexp(key_s(bob),g) at {351} in copy a_43640297

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {366} in copy a_43640297

out(pub, ~M_43665399) with ~M_43665399 = dhexp(key_s(bob),g) at {234} in copy a_43640297

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {249} in copy a_43640297

out(pub, ~M_43665828) with ~M_43665828 = dhexp(key_s(alice),g) at {119} in copy a_43640297

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(charlie),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {134} in copy a_43640297

out(pub, ~M_43666257) with ~M_43666257 = dhexp(key_s(alice),g) at {4} in copy a_43640297

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {19} in copy a_43640297

get statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {395} in copy a_43640298

in(pub, concat3(g,a_43640296,encrypt(hmac_hash2(hash(somename,empty),~M_43645901),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),a_43640295))) with encrypt(hmac_hash2(hash(somename,empty),~M_43645901),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),a_43640295) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640295) at {367} in copy a_43640298

event RecvMsg(bob,charlie,stage_a,a_43640295,true) at {393} in copy a_43640298

insert statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640295))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) at {394} in copy a_43640298

get statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640295))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) at {425} in copy a_43640299

event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) at {422} in copy a_43640299

insert statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640295)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640295)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),g,empty,false))) at {423} in copy a_43640299

out(pub, concat3(~M_43668394,empty,~M_43668396)) with ~M_43668394 = dhexp(key_e(bob,charlie),g), ~M_43668396 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640295)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)) at {424} in copy a_43640299

get statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {395} in copy a_43640302

in(pub, concat3(g,a_43640300,encrypt(hmac_hash2(hash(somename,empty),~M_43645901),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),a_43640293))) with encrypt(hmac_hash2(hash(somename,empty),~M_43645901),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),a_43640293) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293) at {367} in copy a_43640302

event RecvMsg(bob,charlie,stage_a,a_43640293,true) at {393} in copy a_43640302

insert statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) at {394} in copy a_43640302

get statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) at {425} in copy a_43640303

event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) at {422} in copy a_43640303

insert statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),g,empty,false))) at {423} in copy a_43640303

out(pub, concat3(~M_43670328,empty,~M_43670330)) with ~M_43670328 = dhexp(key_e(bob,charlie),g), ~M_43670330 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)) at {424} in copy a_43640303

get statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {395} in copy a_43640308

in(pub, concat3(g,a_43640304,encrypt(hmac_hash2(hash(somename,empty),~M_43645901),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),a_43640293))) with encrypt(hmac_hash2(hash(somename,empty),~M_43645901),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),a_43640293) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293) at {367} in copy a_43640308

event RecvMsg(bob,charlie,stage_a,a_43640293,true) at {393} in copy a_43640308

insert statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) at {394} in copy a_43640308

get statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),dhexp(key_s(charlie),g),g,empty,false))) at {425} in copy a_43640309

event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) at {422} in copy a_43640309

insert statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),g,empty,false))) at {423} in copy a_43640309

out(pub, concat3(~M_43672286,empty,~M_43672288)) with ~M_43672286 = dhexp(key_e(bob,charlie),g), ~M_43672288 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)) at {424} in copy a_43640309

get statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),g,empty,false))) at {460} in copy a_43640310

in(pub, concat3(a_43640291,a_43640292,encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),~M_43645901),~M_43668394),dhexp(~M_43645670,~M_43668394)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),encrypt(hmac_hash2(hash(somename,empty),~M_43645901),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),a_43640293)),~M_43668394),~M_43670330),a_43640294))) with encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),~M_43645901),~M_43668394),dhexp(~M_43645670,~M_43668394)),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),encrypt(hmac_hash2(hash(somename,empty),~M_43645901),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_43645670,g)),~M_43645901),g),a_43640293)),~M_43668394),~M_43670330),a_43640294) = encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),a_43640294) at {426} in copy a_43640310

event RecvMsg(bob,charlie,stage_c,a_43640294,true) at {457} in copy a_43640310

insert statestore(bob,charlie,statepack_d(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),hash(hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),encrypt(hmac_hash2(hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),dhexp(key_s(charlie),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(bob),g)),g),a_43640293)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),a_43640294))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),g,empty,false))) at {458} in copy a_43640310

event RecvEnd(true) at {459} in copy a_43640310 (goal)

The event RecvEnd(true) is executed.
A trace has been found.
RESULT not event(RecvEnd(true)) is false.
