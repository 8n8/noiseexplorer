File "NK.noise.active.pv", line 252, characters 7-8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 262, characters 7-8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 262, character 36:
Warning: identifier h rebound.
File "NK.noise.active.pv", line 271, characters 7-8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 272, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 277, characters 7-8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 278, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 292, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 297, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 303, character 6:
Warning: identifier e rebound.
File "NK.noise.active.pv", line 304, characters 6-7:
Warning: identifier ne rebound.
File "NK.noise.active.pv", line 305, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 307, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 308, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 308, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 309, characters 6-7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 316, character 6:
Warning: identifier e rebound.
File "NK.noise.active.pv", line 317, characters 6-7:
Warning: identifier ne rebound.
File "NK.noise.active.pv", line 318, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 320, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 321, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 321, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 322, characters 6-7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 329, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 329, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 330, characters 6-7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 339, characters 6-7:
Warning: identifier re rebound.
File "NK.noise.active.pv", line 340, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 342, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 343, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 345, characters 7-8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 353, characters 6-7:
Warning: identifier re rebound.
File "NK.noise.active.pv", line 354, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 356, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 357, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 359, characters 7-8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 367, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 369, characters 7-8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 489, characters 8-9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 329, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 329, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 330, characters 6-7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 271, characters 7-8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 272, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 482, characters 8-9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 353, characters 6-7:
Warning: identifier re rebound.
File "NK.noise.active.pv", line 354, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 356, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 357, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 359, characters 7-8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 252, characters 7-8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 277, characters 7-8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 278, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 474, characters 8-9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 303, character 6:
Warning: identifier e rebound.
File "NK.noise.active.pv", line 304, characters 6-7:
Warning: identifier ne rebound.
File "NK.noise.active.pv", line 305, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 307, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 308, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 308, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 309, characters 6-7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 252, characters 7-8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 271, characters 7-8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 272, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 292, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 532, characters 8-9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 367, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 369, characters 7-8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 277, characters 7-8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 278, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 524, characters 8-9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 316, character 6:
Warning: identifier e rebound.
File "NK.noise.active.pv", line 317, characters 6-7:
Warning: identifier ne rebound.
File "NK.noise.active.pv", line 318, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 320, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 321, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 321, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 322, characters 6-7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 252, characters 7-8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 271, characters 7-8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 272, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 517, characters 8-9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 339, characters 6-7:
Warning: identifier re rebound.
File "NK.noise.active.pv", line 340, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 342, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 343, characters 7-8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 345, characters 7-8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 252, characters 7-8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 277, characters 7-8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 278, characters 6-7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 297, characters 6-7:
Warning: identifier ss rebound.
Linear part:
dhexp(b_49,dhexp(a_48,g)) = dhexp(a_48,dhexp(b_49,g))
Completing equations...
Completed equations:
dhexp(b_49,dhexp(a_48,g)) = dhexp(a_48,dhexp(b_49,g))
Convergent part:
Completing equations...
Completed equations:
Process:
{1}!
(
    {2}let s_409: keypair = keypairpack(empty,empty) in
    (
        {3}let e_410: keypair = keypairpack(empty,empty) in
        {4}let v_411: key = catch-fail(dhexp(key_s(bob),g)) in
        {5}let rs_412: key = getpublickey((if not-caught-fail(v_411) then keypairpack(v_411,key_s(bob)) else fail-any)) in
        {6}let re_413: key = empty in
        {7}let v_414: bitstring = catch-fail(hash(somename,empty)) in
        {8}let v_415: key = catch-fail(v_414) in
        {9}let v_416: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {10}let v_417: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_414) then (if not-caught-fail(v_415) then (if not-caught-fail(v_416) then symmetricstatepack(v_416,v_415,v_414) else fail-any) else fail-any) else fail-any))) in
        {11}let v_418: symmetricstate = catch-fail((if success?((if not-caught-fail(v_414) then (if not-caught-fail(v_415) then (if not-caught-fail(v_416) then symmetricstatepack(v_416,v_415,v_414) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_417) && success?(is-true(success?(1-proj-3-tuple(v_417))))) then symmetricstatepack(1-proj-3-tuple(v_417),2-proj-3-tuple(v_417),hash(3-proj-3-tuple(v_417),empty)) else fail-any) else fail-any)) in
        {12}let v_419: bitstring = catch-fail(symmetricstateunpack(v_418)) in
        {13}let v_420: symmetricstate = catch-fail((if (not-caught-fail(v_419) && success?(is-true(success?(1-proj-3-tuple(v_419))))) then symmetricstatepack(1-proj-3-tuple(v_419),2-proj-3-tuple(v_419),hash(3-proj-3-tuple(v_419),rs_412)) else fail-any)) in
        {14}let hs: handshakestate = (if not-caught-fail(v_418) then (if not-caught-fail(v_420) then handshakestatepack(v_420,s_409,e_410,rs_412,re_413,empty,true) else fail-any) else fail-any) in
        {15}insert statestore(alice,bob,statepack_a(hs))
    ) | (
        {45}get statestore(=alice,=bob,statepack_a(hs_421: handshakestate)) in
        {16}let v_422: bitstring = catch-fail(handshakestateunpack(hs_421)) in
        {17}let v_423: bitstring = catch-fail((empty,empty,empty)) in
        {18}let v_424: key = catch-fail(dhexp(key_e(alice,bob),g)) in
        {19}let v_425: keypair = catch-fail((if not-caught-fail(v_424) then keypairpack(v_424,key_e(alice,bob)) else fail-any)) in
        {20}let v_426: bitstring = catch-fail(getpublickey(v_425)) in
        {21}let v_427: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_422))) in
        {22}let v_428: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_422)) then (if (not-caught-fail(v_427) && success?(is-true(success?(1-proj-3-tuple(v_427))))) then symmetricstatepack(1-proj-3-tuple(v_427),2-proj-3-tuple(v_427),hash(3-proj-3-tuple(v_427),v_426)) else fail-any) else fail-any)) in
        {23}let v_429: bitstring = catch-fail(keypairunpack(v_425)) in
        {24}let v_430: bitstring = catch-fail(symmetricstateunpack(v_428)) in
        {25}let v_431: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_430),(if success?(4-proj-7-tuple(v_422)) then (if (not-caught-fail(v_429) && success?(is-true(success?(1-proj-2-tuple(v_429))))) then dhexp(2-proj-2-tuple(v_429),4-proj-7-tuple(v_422)) else fail-any) else fail-any))) in
        {26}let v_432: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_430),(if success?(4-proj-7-tuple(v_422)) then (if (not-caught-fail(v_429) && success?(is-true(success?(1-proj-2-tuple(v_429))))) then dhexp(2-proj-2-tuple(v_429),4-proj-7-tuple(v_422)) else fail-any) else fail-any))) in
        {27}let v_433: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_430),(if success?(4-proj-7-tuple(v_422)) then (if (not-caught-fail(v_429) && success?(is-true(success?(1-proj-2-tuple(v_429))))) then dhexp(2-proj-2-tuple(v_429),4-proj-7-tuple(v_422)) else fail-any) else fail-any))) in
        {28}let v_434: bitstring = catch-fail((if (success?((if success?(4-proj-7-tuple(v_422)) then (if (not-caught-fail(v_429) && success?(is-true(success?(1-proj-2-tuple(v_429))))) then dhexp(2-proj-2-tuple(v_429),4-proj-7-tuple(v_422)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_430))) then (if not-caught-fail(v_431) then (if not-caught-fail(v_432) then (if not-caught-fail(v_433) then (v_431,v_432,v_433) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {29}let v_435: symmetricstate = catch-fail((if success?((if success?(4-proj-7-tuple(v_422)) then (if (not-caught-fail(v_429) && success?(is-true(success?(1-proj-2-tuple(v_429))))) then dhexp(2-proj-2-tuple(v_429),4-proj-7-tuple(v_422)) else fail-any) else fail-any)) then (if (not-caught-fail(v_430) && success?(is-true(success?(1-proj-3-tuple(v_430))))) then (if (not-caught-fail(v_434) && success?(is-true(success?(1-proj-3-tuple(v_434))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_434)) then cipherstatepack(2-proj-3-tuple(v_434),minnonce) else fail-any),1-proj-3-tuple(v_434),3-proj-3-tuple(v_430)) else fail-any) else fail-any) else fail-any)) in
        {30}let v_436: bitstring = catch-fail(symmetricstateunpack(v_435)) in
        {31}let v_437: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_436))) in
        {32}let v_438: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_437),2-proj-2-tuple(v_437),3-proj-3-tuple(v_436),msg_a(alice,bob))) in
        {33}let v_439: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_436))) in
        {34}let v_440: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_437))) && success?(1-proj-3-tuple(v_436))) then (if (not-caught-fail(v_439) && success?(is-true(success?(1-proj-2-tuple(v_439))))) then cipherstatepack(1-proj-2-tuple(v_439),increment_nonce(2-proj-2-tuple(v_437))) else fail-any) else fail-any)) in
        {35}let v_441: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_436)) && success?(1-proj-3-tuple(v_436))) then (if (not-caught-fail(v_437) && success?(is-true(success?(1-proj-2-tuple(v_437))))) then (if not-caught-fail(v_438) then (if not-caught-fail(v_440) then (v_440,v_438) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {36}let v_442: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_441),2-proj-3-tuple(v_436),3-proj-3-tuple(v_436)))) in
        {37}let v_443: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_441)) && success?(symmetricstatepack(1-proj-2-tuple(v_441),2-proj-3-tuple(v_436),3-proj-3-tuple(v_436)))) then (if (not-caught-fail(v_442) && success?(is-true(success?(1-proj-3-tuple(v_442))))) then symmetricstatepack(1-proj-3-tuple(v_442),2-proj-3-tuple(v_442),hash(3-proj-3-tuple(v_442),2-proj-2-tuple(v_441))) else fail-any) else fail-any)) in
        {38}let v_444: bitstring = catch-fail((if (not-caught-fail(v_436) && success?(is-true(success?(1-proj-3-tuple(v_436))))) then (if (not-caught-fail(v_441) && success?(is-true(success?(1-proj-2-tuple(v_441))))) then (if not-caught-fail(v_443) then (v_443,2-proj-2-tuple(v_441)) else fail-any) else fail-any) else fail-any)) in
        {39}let v_445: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_444),2-proj-7-tuple(v_422),v_425,4-proj-7-tuple(v_422),5-proj-7-tuple(v_422),6-proj-7-tuple(v_422),7-proj-7-tuple(v_422))) in
        {40}let v_446: bitstring = catch-fail(concat3(v_426,2-proj-3-tuple(v_423),2-proj-2-tuple(v_444))) in
        {41}let (hs_447: handshakestate,re_448: key,message_a: bitstring) = (if (not-caught-fail(v_422) && success?(is-true(success?(1-proj-7-tuple(v_422))))) then (if (not-caught-fail(v_423) && success?(is-true(success?(1-proj-3-tuple(v_423))))) then (if not-caught-fail(v_425) then (if not-caught-fail(v_426) then (if not-caught-fail(v_428) then (if not-caught-fail(v_435) then (if (not-caught-fail(v_444) && success?(is-true(success?(1-proj-2-tuple(v_444))))) then (if not-caught-fail(v_445) then (if not-caught-fail(v_446) then (v_445,5-proj-7-tuple(v_422),v_446) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {42}event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true);
        {43}insert statestore(alice,bob,statepack_b(hs_447));
        {44}out(pub, message_a)
    ) | (
        {74}get statestore(=alice,=bob,statepack_b(hs_449: handshakestate)) in
        {46}in(pub, message_b: bitstring);
        {47}let v_450: bitstring = catch-fail(handshakestateunpack(hs_449)) in
        {48}let v_451: bitstring = catch-fail(deconcat3(message_b)) in
        {49}let v_452: bool = catch-fail(true) in
        {50}let v_453: key = catch-fail(1-proj-3-tuple(v_451)) in
        {51}let v_454: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_450))) in
        {52}let v_455: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_450)) then (if (not-caught-fail(v_454) && success?(is-true(success?(1-proj-3-tuple(v_454))))) then symmetricstatepack(1-proj-3-tuple(v_454),2-proj-3-tuple(v_454),hash(3-proj-3-tuple(v_454),v_453)) else fail-any) else fail-any)) in
        {53}let v_456: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_450))) in
        {54}let v_457: bitstring = catch-fail(symmetricstateunpack(v_455)) in
        {55}let v_458: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_457),(if success?(3-proj-7-tuple(v_450)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),v_453) else fail-any) else fail-any))) in
        {56}let v_459: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_457),(if success?(3-proj-7-tuple(v_450)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),v_453) else fail-any) else fail-any))) in
        {57}let v_460: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_457),(if success?(3-proj-7-tuple(v_450)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),v_453) else fail-any) else fail-any))) in
        {58}let v_461: bitstring = catch-fail((if (success?((if success?(3-proj-7-tuple(v_450)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),v_453) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_457))) then (if not-caught-fail(v_458) then (if not-caught-fail(v_459) then (if not-caught-fail(v_460) then (v_458,v_459,v_460) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {59}let v_462: symmetricstate = catch-fail((if success?((if success?(3-proj-7-tuple(v_450)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-2-tuple(v_456))))) then dhexp(2-proj-2-tuple(v_456),v_453) else fail-any) else fail-any)) then (if (not-caught-fail(v_457) && success?(is-true(success?(1-proj-3-tuple(v_457))))) then (if (not-caught-fail(v_461) && success?(is-true(success?(1-proj-3-tuple(v_461))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_461)) then cipherstatepack(2-proj-3-tuple(v_461),minnonce) else fail-any),1-proj-3-tuple(v_461),3-proj-3-tuple(v_457)) else fail-any) else fail-any) else fail-any)) in
        {60}let v_463: bitstring = catch-fail(symmetricstateunpack(v_462)) in
        {61}let v_464: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_463))) in
        {62}let v_465: aead = catch-fail(decrypt(1-proj-2-tuple(v_464),2-proj-2-tuple(v_464),3-proj-3-tuple(v_463),3-proj-3-tuple(v_451))) in
        {63}let v_466: bitstring = catch-fail(aeadunpack(v_465)) in
        {64}let v_467: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_463))) in
        {65}let v_468: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_464))) && success?(1-proj-3-tuple(v_463))) then (if (not-caught-fail(v_467) && success?(is-true(success?(1-proj-2-tuple(v_467))))) then cipherstatepack(1-proj-2-tuple(v_467),increment_nonce(2-proj-2-tuple(v_464))) else fail-any) else fail-any)) in
        {66}let v_469: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_451)) && (success?(3-proj-3-tuple(v_463)) && success?(1-proj-3-tuple(v_463)))) then (if (not-caught-fail(v_464) && success?(is-true(success?(1-proj-2-tuple(v_464))))) then (if not-caught-fail(v_465) then (if (not-caught-fail(v_466) && success?(is-true(success?(1-proj-3-tuple(v_466))))) then (if not-caught-fail(v_468) then (v_468,3-proj-3-tuple(v_466),1-proj-3-tuple(v_466)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {67}let v_470: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_469),2-proj-3-tuple(v_463),3-proj-3-tuple(v_463)))) in
        {68}let v_471: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_451)) && success?(symmetricstatepack(1-proj-3-tuple(v_469),2-proj-3-tuple(v_463),3-proj-3-tuple(v_463)))) then (if (not-caught-fail(v_470) && success?(is-true(success?(1-proj-3-tuple(v_470))))) then symmetricstatepack(1-proj-3-tuple(v_470),2-proj-3-tuple(v_470),hash(3-proj-3-tuple(v_470),3-proj-3-tuple(v_451))) else fail-any) else fail-any)) in
        {69}let v_472: bitstring = catch-fail((if success?(3-proj-3-tuple(v_451)) then (if (not-caught-fail(v_463) && success?(is-true(success?(1-proj-3-tuple(v_463))))) then (if (not-caught-fail(v_469) && success?(is-true(success?(1-proj-3-tuple(v_469))))) then (if not-caught-fail(v_471) then (v_471,2-proj-3-tuple(v_469),3-proj-3-tuple(v_469)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {70}let v_473: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_472),2-proj-7-tuple(v_450),3-proj-7-tuple(v_450),4-proj-7-tuple(v_450),v_453,6-proj-7-tuple(v_450),7-proj-7-tuple(v_450))) in
        {71}let (hs_474: handshakestate,re_475: key,plaintext_b: bitstring,valid: bool) = (if (not-caught-fail(v_450) && success?(is-true(success?(1-proj-7-tuple(v_450))))) then (if (not-caught-fail(v_451) && success?(is-true(success?(1-proj-3-tuple(v_451))))) then (if not-caught-fail(v_452) then (if not-caught-fail(v_453) then (if not-caught-fail(v_455) then (if not-caught-fail(v_462) then (if (not-caught-fail(v_472) && success?(is-true(success?(1-proj-3-tuple(v_472))))) then (if (v_452 && 3-proj-3-tuple(v_472)) then (if not-caught-fail(v_473) then (v_473,getpublickey(3-proj-7-tuple(v_450)),2-proj-3-tuple(v_472),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {72}event RecvMsg(alice,bob,stage_b,plaintext_b,valid);
        {73}insert statestore(alice,bob,statepack_c(hs_474))
    ) | (
        {100}get statestore(=alice,=bob,statepack_c(hs_476: handshakestate)) in
        {75}let v_477: bitstring = catch-fail(handshakestateunpack(hs_476)) in
        {76}let v_478: bitstring = catch-fail((empty,empty,empty)) in
        {77}let v_479: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_477))) in
        {78}let v_480: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_479))) in
        {79}let v_481: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_480),2-proj-2-tuple(v_480),3-proj-3-tuple(v_479),msg_c(alice,bob))) in
        {80}let v_482: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_479))) in
        {81}let v_483: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_480))) && success?(1-proj-3-tuple(v_479))) then (if (not-caught-fail(v_482) && success?(is-true(success?(1-proj-2-tuple(v_482))))) then cipherstatepack(1-proj-2-tuple(v_482),increment_nonce(2-proj-2-tuple(v_480))) else fail-any) else fail-any)) in
        {82}let v_484: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_479)) && success?(1-proj-3-tuple(v_479))) then (if (not-caught-fail(v_480) && success?(is-true(success?(1-proj-2-tuple(v_480))))) then (if not-caught-fail(v_481) then (if not-caught-fail(v_483) then (v_483,v_481) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {83}let v_485: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_484),2-proj-3-tuple(v_479),3-proj-3-tuple(v_479)))) in
        {84}let v_486: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_484)) && success?(symmetricstatepack(1-proj-2-tuple(v_484),2-proj-3-tuple(v_479),3-proj-3-tuple(v_479)))) then (if (not-caught-fail(v_485) && success?(is-true(success?(1-proj-3-tuple(v_485))))) then symmetricstatepack(1-proj-3-tuple(v_485),2-proj-3-tuple(v_485),hash(3-proj-3-tuple(v_485),2-proj-2-tuple(v_484))) else fail-any) else fail-any)) in
        {85}let v_487: bitstring = catch-fail((if success?(1-proj-7-tuple(v_477)) then (if (not-caught-fail(v_479) && success?(is-true(success?(1-proj-3-tuple(v_479))))) then (if (not-caught-fail(v_484) && success?(is-true(success?(1-proj-2-tuple(v_484))))) then (if not-caught-fail(v_486) then (v_486,2-proj-2-tuple(v_484)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {86}let v_488: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_487),2-proj-7-tuple(v_477),3-proj-7-tuple(v_477),4-proj-7-tuple(v_477),5-proj-7-tuple(v_477),6-proj-7-tuple(v_477),7-proj-7-tuple(v_477))) in
        {87}let v_489: bitstring = catch-fail(concat3(1-proj-3-tuple(v_478),2-proj-3-tuple(v_478),2-proj-2-tuple(v_487))) in
        {88}let v_490: bitstring = catch-fail(symmetricstateunpack(1-proj-2-tuple(v_487))) in
        {89}let v_491: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_490),zero)) in
        {90}let v_492: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_490),zero)) in
        {91}let v_493: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_490),zero)) in
        {92}let v_494: bitstring = catch-fail((if success?(2-proj-3-tuple(v_490)) then (if not-caught-fail(v_491) then (if not-caught-fail(v_492) then (if not-caught-fail(v_493) then (v_491,v_492,v_493) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {93}let v_495: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_494)) then cipherstatepack(1-proj-3-tuple(v_494),minnonce) else fail-any)) in
        {94}let v_496: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_494)) then cipherstatepack(2-proj-3-tuple(v_494),minnonce) else fail-any)) in
        {95}let v_497: bitstring = catch-fail((if success?(1-proj-2-tuple(v_487)) then (if (not-caught-fail(v_490) && success?(is-true(success?(1-proj-3-tuple(v_490))))) then (if (not-caught-fail(v_494) && success?(is-true(success?(1-proj-3-tuple(v_494))))) then (if not-caught-fail(v_495) then (if not-caught-fail(v_496) then (1-proj-2-tuple(v_487),v_495,v_496) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {96}let (hs_498: handshakestate,re_499: key,message_c: bitstring,cs1: cipherstate,cs2: cipherstate) = (if (not-caught-fail(v_477) && success?(is-true(success?(1-proj-7-tuple(v_477))))) then (if (not-caught-fail(v_478) && success?(is-true(success?(1-proj-3-tuple(v_478))))) then (if (not-caught-fail(v_487) && success?(is-true(success?(1-proj-2-tuple(v_487))))) then (if not-caught-fail(v_488) then (if not-caught-fail(v_489) then (if (not-caught-fail(v_497) && success?(is-true(success?(1-proj-3-tuple(v_497))))) then (v_488,5-proj-7-tuple(v_477),v_489,2-proj-3-tuple(v_497),3-proj-3-tuple(v_497)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {97}event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true);
        {98}insert statestore(alice,bob,statepack_d(hs_498));
        {99}out(pub, message_c)
    ) | (
        {101}event LeakS(phase0,alice);
        {102}out(pub, key_s(alice))
    ) | (
        {103}phase 1;
        {104}event LeakS(phase1,alice);
        {105}out(pub, key_s(alice))
    )
) | (
    {106}let s_500: keypair = keypairpack(empty,empty) in
    (
        {107}let e_501: keypair = keypairpack(empty,empty) in
        {108}let v_502: key = catch-fail(dhexp(key_s(charlie),g)) in
        {109}let rs_503: key = getpublickey((if not-caught-fail(v_502) then keypairpack(v_502,key_s(charlie)) else fail-any)) in
        {110}let re_504: key = empty in
        {111}let v_505: bitstring = catch-fail(hash(somename,empty)) in
        {112}let v_506: key = catch-fail(v_505) in
        {113}let v_507: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {114}let v_508: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_505) then (if not-caught-fail(v_506) then (if not-caught-fail(v_507) then symmetricstatepack(v_507,v_506,v_505) else fail-any) else fail-any) else fail-any))) in
        {115}let v_509: symmetricstate = catch-fail((if success?((if not-caught-fail(v_505) then (if not-caught-fail(v_506) then (if not-caught-fail(v_507) then symmetricstatepack(v_507,v_506,v_505) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_508) && success?(is-true(success?(1-proj-3-tuple(v_508))))) then symmetricstatepack(1-proj-3-tuple(v_508),2-proj-3-tuple(v_508),hash(3-proj-3-tuple(v_508),empty)) else fail-any) else fail-any)) in
        {116}let v_510: bitstring = catch-fail(symmetricstateunpack(v_509)) in
        {117}let v_511: symmetricstate = catch-fail((if (not-caught-fail(v_510) && success?(is-true(success?(1-proj-3-tuple(v_510))))) then symmetricstatepack(1-proj-3-tuple(v_510),2-proj-3-tuple(v_510),hash(3-proj-3-tuple(v_510),rs_503)) else fail-any)) in
        {118}let hs_512: handshakestate = (if not-caught-fail(v_509) then (if not-caught-fail(v_511) then handshakestatepack(v_511,s_500,e_501,rs_503,re_504,empty,true) else fail-any) else fail-any) in
        {119}insert statestore(alice,charlie,statepack_a(hs_512))
    ) | (
        {149}get statestore(=alice,=charlie,statepack_a(hs_513: handshakestate)) in
        {120}let v_514: bitstring = catch-fail(handshakestateunpack(hs_513)) in
        {121}let v_515: bitstring = catch-fail((empty,empty,empty)) in
        {122}let v_516: key = catch-fail(dhexp(key_e(alice,charlie),g)) in
        {123}let v_517: keypair = catch-fail((if not-caught-fail(v_516) then keypairpack(v_516,key_e(alice,charlie)) else fail-any)) in
        {124}let v_518: bitstring = catch-fail(getpublickey(v_517)) in
        {125}let v_519: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_514))) in
        {126}let v_520: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_514)) then (if (not-caught-fail(v_519) && success?(is-true(success?(1-proj-3-tuple(v_519))))) then symmetricstatepack(1-proj-3-tuple(v_519),2-proj-3-tuple(v_519),hash(3-proj-3-tuple(v_519),v_518)) else fail-any) else fail-any)) in
        {127}let v_521: bitstring = catch-fail(keypairunpack(v_517)) in
        {128}let v_522: bitstring = catch-fail(symmetricstateunpack(v_520)) in
        {129}let v_523: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_522),(if success?(4-proj-7-tuple(v_514)) then (if (not-caught-fail(v_521) && success?(is-true(success?(1-proj-2-tuple(v_521))))) then dhexp(2-proj-2-tuple(v_521),4-proj-7-tuple(v_514)) else fail-any) else fail-any))) in
        {130}let v_524: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_522),(if success?(4-proj-7-tuple(v_514)) then (if (not-caught-fail(v_521) && success?(is-true(success?(1-proj-2-tuple(v_521))))) then dhexp(2-proj-2-tuple(v_521),4-proj-7-tuple(v_514)) else fail-any) else fail-any))) in
        {131}let v_525: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_522),(if success?(4-proj-7-tuple(v_514)) then (if (not-caught-fail(v_521) && success?(is-true(success?(1-proj-2-tuple(v_521))))) then dhexp(2-proj-2-tuple(v_521),4-proj-7-tuple(v_514)) else fail-any) else fail-any))) in
        {132}let v_526: bitstring = catch-fail((if (success?((if success?(4-proj-7-tuple(v_514)) then (if (not-caught-fail(v_521) && success?(is-true(success?(1-proj-2-tuple(v_521))))) then dhexp(2-proj-2-tuple(v_521),4-proj-7-tuple(v_514)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_522))) then (if not-caught-fail(v_523) then (if not-caught-fail(v_524) then (if not-caught-fail(v_525) then (v_523,v_524,v_525) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {133}let v_527: symmetricstate = catch-fail((if success?((if success?(4-proj-7-tuple(v_514)) then (if (not-caught-fail(v_521) && success?(is-true(success?(1-proj-2-tuple(v_521))))) then dhexp(2-proj-2-tuple(v_521),4-proj-7-tuple(v_514)) else fail-any) else fail-any)) then (if (not-caught-fail(v_522) && success?(is-true(success?(1-proj-3-tuple(v_522))))) then (if (not-caught-fail(v_526) && success?(is-true(success?(1-proj-3-tuple(v_526))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_526)) then cipherstatepack(2-proj-3-tuple(v_526),minnonce) else fail-any),1-proj-3-tuple(v_526),3-proj-3-tuple(v_522)) else fail-any) else fail-any) else fail-any)) in
        {134}let v_528: bitstring = catch-fail(symmetricstateunpack(v_527)) in
        {135}let v_529: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_528))) in
        {136}let v_530: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_529),2-proj-2-tuple(v_529),3-proj-3-tuple(v_528),msg_a(alice,charlie))) in
        {137}let v_531: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_528))) in
        {138}let v_532: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_529))) && success?(1-proj-3-tuple(v_528))) then (if (not-caught-fail(v_531) && success?(is-true(success?(1-proj-2-tuple(v_531))))) then cipherstatepack(1-proj-2-tuple(v_531),increment_nonce(2-proj-2-tuple(v_529))) else fail-any) else fail-any)) in
        {139}let v_533: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_528)) && success?(1-proj-3-tuple(v_528))) then (if (not-caught-fail(v_529) && success?(is-true(success?(1-proj-2-tuple(v_529))))) then (if not-caught-fail(v_530) then (if not-caught-fail(v_532) then (v_532,v_530) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {140}let v_534: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_533),2-proj-3-tuple(v_528),3-proj-3-tuple(v_528)))) in
        {141}let v_535: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_533)) && success?(symmetricstatepack(1-proj-2-tuple(v_533),2-proj-3-tuple(v_528),3-proj-3-tuple(v_528)))) then (if (not-caught-fail(v_534) && success?(is-true(success?(1-proj-3-tuple(v_534))))) then symmetricstatepack(1-proj-3-tuple(v_534),2-proj-3-tuple(v_534),hash(3-proj-3-tuple(v_534),2-proj-2-tuple(v_533))) else fail-any) else fail-any)) in
        {142}let v_536: bitstring = catch-fail((if (not-caught-fail(v_528) && success?(is-true(success?(1-proj-3-tuple(v_528))))) then (if (not-caught-fail(v_533) && success?(is-true(success?(1-proj-2-tuple(v_533))))) then (if not-caught-fail(v_535) then (v_535,2-proj-2-tuple(v_533)) else fail-any) else fail-any) else fail-any)) in
        {143}let v_537: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_536),2-proj-7-tuple(v_514),v_517,4-proj-7-tuple(v_514),5-proj-7-tuple(v_514),6-proj-7-tuple(v_514),7-proj-7-tuple(v_514))) in
        {144}let v_538: bitstring = catch-fail(concat3(v_518,2-proj-3-tuple(v_515),2-proj-2-tuple(v_536))) in
        {145}let (hs_539: handshakestate,re_540: key,message_a_541: bitstring) = (if (not-caught-fail(v_514) && success?(is-true(success?(1-proj-7-tuple(v_514))))) then (if (not-caught-fail(v_515) && success?(is-true(success?(1-proj-3-tuple(v_515))))) then (if not-caught-fail(v_517) then (if not-caught-fail(v_518) then (if not-caught-fail(v_520) then (if not-caught-fail(v_527) then (if (not-caught-fail(v_536) && success?(is-true(success?(1-proj-2-tuple(v_536))))) then (if not-caught-fail(v_537) then (if not-caught-fail(v_538) then (v_537,5-proj-7-tuple(v_514),v_538) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {146}event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true);
        {147}insert statestore(alice,charlie,statepack_b(hs_539));
        {148}out(pub, message_a_541)
    ) | (
        {178}get statestore(=alice,=charlie,statepack_b(hs_542: handshakestate)) in
        {150}in(pub, message_b_543: bitstring);
        {151}let v_544: bitstring = catch-fail(handshakestateunpack(hs_542)) in
        {152}let v_545: bitstring = catch-fail(deconcat3(message_b_543)) in
        {153}let v_546: bool = catch-fail(true) in
        {154}let v_547: key = catch-fail(1-proj-3-tuple(v_545)) in
        {155}let v_548: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_544))) in
        {156}let v_549: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_544)) then (if (not-caught-fail(v_548) && success?(is-true(success?(1-proj-3-tuple(v_548))))) then symmetricstatepack(1-proj-3-tuple(v_548),2-proj-3-tuple(v_548),hash(3-proj-3-tuple(v_548),v_547)) else fail-any) else fail-any)) in
        {157}let v_550: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_544))) in
        {158}let v_551: bitstring = catch-fail(symmetricstateunpack(v_549)) in
        {159}let v_552: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_551),(if success?(3-proj-7-tuple(v_544)) then (if (not-caught-fail(v_550) && success?(is-true(success?(1-proj-2-tuple(v_550))))) then dhexp(2-proj-2-tuple(v_550),v_547) else fail-any) else fail-any))) in
        {160}let v_553: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_551),(if success?(3-proj-7-tuple(v_544)) then (if (not-caught-fail(v_550) && success?(is-true(success?(1-proj-2-tuple(v_550))))) then dhexp(2-proj-2-tuple(v_550),v_547) else fail-any) else fail-any))) in
        {161}let v_554: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_551),(if success?(3-proj-7-tuple(v_544)) then (if (not-caught-fail(v_550) && success?(is-true(success?(1-proj-2-tuple(v_550))))) then dhexp(2-proj-2-tuple(v_550),v_547) else fail-any) else fail-any))) in
        {162}let v_555: bitstring = catch-fail((if (success?((if success?(3-proj-7-tuple(v_544)) then (if (not-caught-fail(v_550) && success?(is-true(success?(1-proj-2-tuple(v_550))))) then dhexp(2-proj-2-tuple(v_550),v_547) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_551))) then (if not-caught-fail(v_552) then (if not-caught-fail(v_553) then (if not-caught-fail(v_554) then (v_552,v_553,v_554) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {163}let v_556: symmetricstate = catch-fail((if success?((if success?(3-proj-7-tuple(v_544)) then (if (not-caught-fail(v_550) && success?(is-true(success?(1-proj-2-tuple(v_550))))) then dhexp(2-proj-2-tuple(v_550),v_547) else fail-any) else fail-any)) then (if (not-caught-fail(v_551) && success?(is-true(success?(1-proj-3-tuple(v_551))))) then (if (not-caught-fail(v_555) && success?(is-true(success?(1-proj-3-tuple(v_555))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_555)) then cipherstatepack(2-proj-3-tuple(v_555),minnonce) else fail-any),1-proj-3-tuple(v_555),3-proj-3-tuple(v_551)) else fail-any) else fail-any) else fail-any)) in
        {164}let v_557: bitstring = catch-fail(symmetricstateunpack(v_556)) in
        {165}let v_558: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_557))) in
        {166}let v_559: aead = catch-fail(decrypt(1-proj-2-tuple(v_558),2-proj-2-tuple(v_558),3-proj-3-tuple(v_557),3-proj-3-tuple(v_545))) in
        {167}let v_560: bitstring = catch-fail(aeadunpack(v_559)) in
        {168}let v_561: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_557))) in
        {169}let v_562: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_558))) && success?(1-proj-3-tuple(v_557))) then (if (not-caught-fail(v_561) && success?(is-true(success?(1-proj-2-tuple(v_561))))) then cipherstatepack(1-proj-2-tuple(v_561),increment_nonce(2-proj-2-tuple(v_558))) else fail-any) else fail-any)) in
        {170}let v_563: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_545)) && (success?(3-proj-3-tuple(v_557)) && success?(1-proj-3-tuple(v_557)))) then (if (not-caught-fail(v_558) && success?(is-true(success?(1-proj-2-tuple(v_558))))) then (if not-caught-fail(v_559) then (if (not-caught-fail(v_560) && success?(is-true(success?(1-proj-3-tuple(v_560))))) then (if not-caught-fail(v_562) then (v_562,3-proj-3-tuple(v_560),1-proj-3-tuple(v_560)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {171}let v_564: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_563),2-proj-3-tuple(v_557),3-proj-3-tuple(v_557)))) in
        {172}let v_565: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_545)) && success?(symmetricstatepack(1-proj-3-tuple(v_563),2-proj-3-tuple(v_557),3-proj-3-tuple(v_557)))) then (if (not-caught-fail(v_564) && success?(is-true(success?(1-proj-3-tuple(v_564))))) then symmetricstatepack(1-proj-3-tuple(v_564),2-proj-3-tuple(v_564),hash(3-proj-3-tuple(v_564),3-proj-3-tuple(v_545))) else fail-any) else fail-any)) in
        {173}let v_566: bitstring = catch-fail((if success?(3-proj-3-tuple(v_545)) then (if (not-caught-fail(v_557) && success?(is-true(success?(1-proj-3-tuple(v_557))))) then (if (not-caught-fail(v_563) && success?(is-true(success?(1-proj-3-tuple(v_563))))) then (if not-caught-fail(v_565) then (v_565,2-proj-3-tuple(v_563),3-proj-3-tuple(v_563)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {174}let v_567: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_566),2-proj-7-tuple(v_544),3-proj-7-tuple(v_544),4-proj-7-tuple(v_544),v_547,6-proj-7-tuple(v_544),7-proj-7-tuple(v_544))) in
        {175}let (hs_568: handshakestate,re_569: key,plaintext_b_570: bitstring,valid_571: bool) = (if (not-caught-fail(v_544) && success?(is-true(success?(1-proj-7-tuple(v_544))))) then (if (not-caught-fail(v_545) && success?(is-true(success?(1-proj-3-tuple(v_545))))) then (if not-caught-fail(v_546) then (if not-caught-fail(v_547) then (if not-caught-fail(v_549) then (if not-caught-fail(v_556) then (if (not-caught-fail(v_566) && success?(is-true(success?(1-proj-3-tuple(v_566))))) then (if (v_546 && 3-proj-3-tuple(v_566)) then (if not-caught-fail(v_567) then (v_567,getpublickey(3-proj-7-tuple(v_544)),2-proj-3-tuple(v_566),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {176}event RecvMsg(alice,charlie,stage_b,plaintext_b_570,valid_571);
        {177}insert statestore(alice,charlie,statepack_c(hs_568))
    ) | (
        {204}get statestore(=alice,=charlie,statepack_c(hs_572: handshakestate)) in
        {179}let v_573: bitstring = catch-fail(handshakestateunpack(hs_572)) in
        {180}let v_574: bitstring = catch-fail((empty,empty,empty)) in
        {181}let v_575: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_573))) in
        {182}let v_576: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_575))) in
        {183}let v_577: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_576),2-proj-2-tuple(v_576),3-proj-3-tuple(v_575),msg_c(alice,charlie))) in
        {184}let v_578: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_575))) in
        {185}let v_579: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_576))) && success?(1-proj-3-tuple(v_575))) then (if (not-caught-fail(v_578) && success?(is-true(success?(1-proj-2-tuple(v_578))))) then cipherstatepack(1-proj-2-tuple(v_578),increment_nonce(2-proj-2-tuple(v_576))) else fail-any) else fail-any)) in
        {186}let v_580: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_575)) && success?(1-proj-3-tuple(v_575))) then (if (not-caught-fail(v_576) && success?(is-true(success?(1-proj-2-tuple(v_576))))) then (if not-caught-fail(v_577) then (if not-caught-fail(v_579) then (v_579,v_577) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {187}let v_581: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_580),2-proj-3-tuple(v_575),3-proj-3-tuple(v_575)))) in
        {188}let v_582: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_580)) && success?(symmetricstatepack(1-proj-2-tuple(v_580),2-proj-3-tuple(v_575),3-proj-3-tuple(v_575)))) then (if (not-caught-fail(v_581) && success?(is-true(success?(1-proj-3-tuple(v_581))))) then symmetricstatepack(1-proj-3-tuple(v_581),2-proj-3-tuple(v_581),hash(3-proj-3-tuple(v_581),2-proj-2-tuple(v_580))) else fail-any) else fail-any)) in
        {189}let v_583: bitstring = catch-fail((if success?(1-proj-7-tuple(v_573)) then (if (not-caught-fail(v_575) && success?(is-true(success?(1-proj-3-tuple(v_575))))) then (if (not-caught-fail(v_580) && success?(is-true(success?(1-proj-2-tuple(v_580))))) then (if not-caught-fail(v_582) then (v_582,2-proj-2-tuple(v_580)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {190}let v_584: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_583),2-proj-7-tuple(v_573),3-proj-7-tuple(v_573),4-proj-7-tuple(v_573),5-proj-7-tuple(v_573),6-proj-7-tuple(v_573),7-proj-7-tuple(v_573))) in
        {191}let v_585: bitstring = catch-fail(concat3(1-proj-3-tuple(v_574),2-proj-3-tuple(v_574),2-proj-2-tuple(v_583))) in
        {192}let v_586: bitstring = catch-fail(symmetricstateunpack(1-proj-2-tuple(v_583))) in
        {193}let v_587: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_586),zero)) in
        {194}let v_588: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_586),zero)) in
        {195}let v_589: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_586),zero)) in
        {196}let v_590: bitstring = catch-fail((if success?(2-proj-3-tuple(v_586)) then (if not-caught-fail(v_587) then (if not-caught-fail(v_588) then (if not-caught-fail(v_589) then (v_587,v_588,v_589) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {197}let v_591: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_590)) then cipherstatepack(1-proj-3-tuple(v_590),minnonce) else fail-any)) in
        {198}let v_592: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_590)) then cipherstatepack(2-proj-3-tuple(v_590),minnonce) else fail-any)) in
        {199}let v_593: bitstring = catch-fail((if success?(1-proj-2-tuple(v_583)) then (if (not-caught-fail(v_586) && success?(is-true(success?(1-proj-3-tuple(v_586))))) then (if (not-caught-fail(v_590) && success?(is-true(success?(1-proj-3-tuple(v_590))))) then (if not-caught-fail(v_591) then (if not-caught-fail(v_592) then (1-proj-2-tuple(v_583),v_591,v_592) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {200}let (hs_594: handshakestate,re_595: key,message_c_596: bitstring,cs1_597: cipherstate,cs2_598: cipherstate) = (if (not-caught-fail(v_573) && success?(is-true(success?(1-proj-7-tuple(v_573))))) then (if (not-caught-fail(v_574) && success?(is-true(success?(1-proj-3-tuple(v_574))))) then (if (not-caught-fail(v_583) && success?(is-true(success?(1-proj-2-tuple(v_583))))) then (if not-caught-fail(v_584) then (if not-caught-fail(v_585) then (if (not-caught-fail(v_593) && success?(is-true(success?(1-proj-3-tuple(v_593))))) then (v_584,5-proj-7-tuple(v_573),v_585,2-proj-3-tuple(v_593),3-proj-3-tuple(v_593)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {201}event SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true);
        {202}insert statestore(alice,charlie,statepack_d(hs_594));
        {203}out(pub, message_c_596)
    ) | (
        {205}event LeakS(phase0,alice);
        {206}out(pub, key_s(alice))
    ) | (
        {207}phase 1;
        {208}event LeakS(phase1,alice);
        {209}out(pub, key_s(alice))
    )
) | (
    {210}let v_599: key = catch-fail(dhexp(key_s(bob),g)) in
    {211}let s_600: keypair = (if not-caught-fail(v_599) then keypairpack(v_599,key_s(bob)) else fail-any) in
    {212}out(pub, getpublickey(s_600));
    (
        {213}let e_601: keypair = keypairpack(empty,empty) in
        {214}let rs_602: key = empty in
        {215}let re_603: key = empty in
        {216}let v_604: bitstring = catch-fail(hash(somename,empty)) in
        {217}let v_605: key = catch-fail(v_604) in
        {218}let v_606: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {219}let v_607: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_604) then (if not-caught-fail(v_605) then (if not-caught-fail(v_606) then symmetricstatepack(v_606,v_605,v_604) else fail-any) else fail-any) else fail-any))) in
        {220}let v_608: symmetricstate = catch-fail((if success?((if not-caught-fail(v_604) then (if not-caught-fail(v_605) then (if not-caught-fail(v_606) then symmetricstatepack(v_606,v_605,v_604) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_607) && success?(is-true(success?(1-proj-3-tuple(v_607))))) then symmetricstatepack(1-proj-3-tuple(v_607),2-proj-3-tuple(v_607),hash(3-proj-3-tuple(v_607),empty)) else fail-any) else fail-any)) in
        {221}let v_609: bitstring = catch-fail(symmetricstateunpack(v_608)) in
        {222}let v_610: symmetricstate = catch-fail((if success?(getpublickey(s_600)) then (if (not-caught-fail(v_609) && success?(is-true(success?(1-proj-3-tuple(v_609))))) then symmetricstatepack(1-proj-3-tuple(v_609),2-proj-3-tuple(v_609),hash(3-proj-3-tuple(v_609),getpublickey(s_600))) else fail-any) else fail-any)) in
        {223}let hs_611: handshakestate = (if not-caught-fail(v_608) then (if not-caught-fail(v_610) then handshakestatepack(v_610,s_600,e_601,rs_602,re_603,empty,false) else fail-any) else fail-any) in
        {224}insert statestore(bob,alice,statepack_a(hs_611))
    ) | (
        {253}get statestore(=bob,=alice,statepack_a(hs_612: handshakestate)) in
        {225}in(pub, message_a_613: bitstring);
        {226}let v_614: bitstring = catch-fail(handshakestateunpack(hs_612)) in
        {227}let v_615: bitstring = catch-fail(deconcat3(message_a_613)) in
        {228}let v_616: bool = catch-fail(true) in
        {229}let v_617: key = catch-fail(1-proj-3-tuple(v_615)) in
        {230}let v_618: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_614))) in
        {231}let v_619: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_614)) then (if (not-caught-fail(v_618) && success?(is-true(success?(1-proj-3-tuple(v_618))))) then symmetricstatepack(1-proj-3-tuple(v_618),2-proj-3-tuple(v_618),hash(3-proj-3-tuple(v_618),v_617)) else fail-any) else fail-any)) in
        {232}let v_620: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_614))) in
        {233}let v_621: bitstring = catch-fail(symmetricstateunpack(v_619)) in
        {234}let v_622: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_621),(if success?(2-proj-7-tuple(v_614)) then (if (not-caught-fail(v_620) && success?(is-true(success?(1-proj-2-tuple(v_620))))) then dhexp(2-proj-2-tuple(v_620),v_617) else fail-any) else fail-any))) in
        {235}let v_623: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_621),(if success?(2-proj-7-tuple(v_614)) then (if (not-caught-fail(v_620) && success?(is-true(success?(1-proj-2-tuple(v_620))))) then dhexp(2-proj-2-tuple(v_620),v_617) else fail-any) else fail-any))) in
        {236}let v_624: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_621),(if success?(2-proj-7-tuple(v_614)) then (if (not-caught-fail(v_620) && success?(is-true(success?(1-proj-2-tuple(v_620))))) then dhexp(2-proj-2-tuple(v_620),v_617) else fail-any) else fail-any))) in
        {237}let v_625: bitstring = catch-fail((if (success?((if success?(2-proj-7-tuple(v_614)) then (if (not-caught-fail(v_620) && success?(is-true(success?(1-proj-2-tuple(v_620))))) then dhexp(2-proj-2-tuple(v_620),v_617) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_621))) then (if not-caught-fail(v_622) then (if not-caught-fail(v_623) then (if not-caught-fail(v_624) then (v_622,v_623,v_624) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {238}let v_626: symmetricstate = catch-fail((if success?((if success?(2-proj-7-tuple(v_614)) then (if (not-caught-fail(v_620) && success?(is-true(success?(1-proj-2-tuple(v_620))))) then dhexp(2-proj-2-tuple(v_620),v_617) else fail-any) else fail-any)) then (if (not-caught-fail(v_621) && success?(is-true(success?(1-proj-3-tuple(v_621))))) then (if (not-caught-fail(v_625) && success?(is-true(success?(1-proj-3-tuple(v_625))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_625)) then cipherstatepack(2-proj-3-tuple(v_625),minnonce) else fail-any),1-proj-3-tuple(v_625),3-proj-3-tuple(v_621)) else fail-any) else fail-any) else fail-any)) in
        {239}let v_627: bitstring = catch-fail(symmetricstateunpack(v_626)) in
        {240}let v_628: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_627))) in
        {241}let v_629: aead = catch-fail(decrypt(1-proj-2-tuple(v_628),2-proj-2-tuple(v_628),3-proj-3-tuple(v_627),3-proj-3-tuple(v_615))) in
        {242}let v_630: bitstring = catch-fail(aeadunpack(v_629)) in
        {243}let v_631: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_627))) in
        {244}let v_632: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_628))) && success?(1-proj-3-tuple(v_627))) then (if (not-caught-fail(v_631) && success?(is-true(success?(1-proj-2-tuple(v_631))))) then cipherstatepack(1-proj-2-tuple(v_631),increment_nonce(2-proj-2-tuple(v_628))) else fail-any) else fail-any)) in
        {245}let v_633: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_615)) && (success?(3-proj-3-tuple(v_627)) && success?(1-proj-3-tuple(v_627)))) then (if (not-caught-fail(v_628) && success?(is-true(success?(1-proj-2-tuple(v_628))))) then (if not-caught-fail(v_629) then (if (not-caught-fail(v_630) && success?(is-true(success?(1-proj-3-tuple(v_630))))) then (if not-caught-fail(v_632) then (v_632,3-proj-3-tuple(v_630),1-proj-3-tuple(v_630)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {246}let v_634: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_633),2-proj-3-tuple(v_627),3-proj-3-tuple(v_627)))) in
        {247}let v_635: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_615)) && success?(symmetricstatepack(1-proj-3-tuple(v_633),2-proj-3-tuple(v_627),3-proj-3-tuple(v_627)))) then (if (not-caught-fail(v_634) && success?(is-true(success?(1-proj-3-tuple(v_634))))) then symmetricstatepack(1-proj-3-tuple(v_634),2-proj-3-tuple(v_634),hash(3-proj-3-tuple(v_634),3-proj-3-tuple(v_615))) else fail-any) else fail-any)) in
        {248}let v_636: bitstring = catch-fail((if success?(3-proj-3-tuple(v_615)) then (if (not-caught-fail(v_627) && success?(is-true(success?(1-proj-3-tuple(v_627))))) then (if (not-caught-fail(v_633) && success?(is-true(success?(1-proj-3-tuple(v_633))))) then (if not-caught-fail(v_635) then (v_635,2-proj-3-tuple(v_633),3-proj-3-tuple(v_633)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {249}let v_637: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_636),2-proj-7-tuple(v_614),3-proj-7-tuple(v_614),4-proj-7-tuple(v_614),v_617,6-proj-7-tuple(v_614),7-proj-7-tuple(v_614))) in
        {250}let (hs_638: handshakestate,re_639: key,plaintext_a: bitstring,valid_640: bool) = (if (not-caught-fail(v_614) && success?(is-true(success?(1-proj-7-tuple(v_614))))) then (if (not-caught-fail(v_615) && success?(is-true(success?(1-proj-3-tuple(v_615))))) then (if not-caught-fail(v_616) then (if not-caught-fail(v_617) then (if not-caught-fail(v_619) then (if not-caught-fail(v_626) then (if (not-caught-fail(v_636) && success?(is-true(success?(1-proj-3-tuple(v_636))))) then (if (v_616 && 3-proj-3-tuple(v_636)) then (if not-caught-fail(v_637) then (v_637,getpublickey(3-proj-7-tuple(v_614)),2-proj-3-tuple(v_636),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {251}event RecvMsg(bob,alice,stage_a,plaintext_a,valid_640);
        {252}insert statestore(bob,alice,statepack_b(hs_638))
    ) | (
        {283}get statestore(=bob,=alice,statepack_b(hs_641: handshakestate)) in
        {254}let v_642: bitstring = catch-fail(handshakestateunpack(hs_641)) in
        {255}let v_643: bitstring = catch-fail((empty,empty,empty)) in
        {256}let v_644: key = catch-fail(dhexp(key_e(bob,alice),g)) in
        {257}let v_645: keypair = catch-fail((if not-caught-fail(v_644) then keypairpack(v_644,key_e(bob,alice)) else fail-any)) in
        {258}let v_646: bitstring = catch-fail(getpublickey(v_645)) in
        {259}let v_647: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_642))) in
        {260}let v_648: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_642)) then (if (not-caught-fail(v_647) && success?(is-true(success?(1-proj-3-tuple(v_647))))) then symmetricstatepack(1-proj-3-tuple(v_647),2-proj-3-tuple(v_647),hash(3-proj-3-tuple(v_647),v_646)) else fail-any) else fail-any)) in
        {261}let v_649: bitstring = catch-fail(keypairunpack(v_645)) in
        {262}let v_650: bitstring = catch-fail(symmetricstateunpack(v_648)) in
        {263}let v_651: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_650),(if success?(5-proj-7-tuple(v_642)) then (if (not-caught-fail(v_649) && success?(is-true(success?(1-proj-2-tuple(v_649))))) then dhexp(2-proj-2-tuple(v_649),5-proj-7-tuple(v_642)) else fail-any) else fail-any))) in
        {264}let v_652: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_650),(if success?(5-proj-7-tuple(v_642)) then (if (not-caught-fail(v_649) && success?(is-true(success?(1-proj-2-tuple(v_649))))) then dhexp(2-proj-2-tuple(v_649),5-proj-7-tuple(v_642)) else fail-any) else fail-any))) in
        {265}let v_653: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_650),(if success?(5-proj-7-tuple(v_642)) then (if (not-caught-fail(v_649) && success?(is-true(success?(1-proj-2-tuple(v_649))))) then dhexp(2-proj-2-tuple(v_649),5-proj-7-tuple(v_642)) else fail-any) else fail-any))) in
        {266}let v_654: bitstring = catch-fail((if (success?((if success?(5-proj-7-tuple(v_642)) then (if (not-caught-fail(v_649) && success?(is-true(success?(1-proj-2-tuple(v_649))))) then dhexp(2-proj-2-tuple(v_649),5-proj-7-tuple(v_642)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_650))) then (if not-caught-fail(v_651) then (if not-caught-fail(v_652) then (if not-caught-fail(v_653) then (v_651,v_652,v_653) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {267}let v_655: symmetricstate = catch-fail((if success?((if success?(5-proj-7-tuple(v_642)) then (if (not-caught-fail(v_649) && success?(is-true(success?(1-proj-2-tuple(v_649))))) then dhexp(2-proj-2-tuple(v_649),5-proj-7-tuple(v_642)) else fail-any) else fail-any)) then (if (not-caught-fail(v_650) && success?(is-true(success?(1-proj-3-tuple(v_650))))) then (if (not-caught-fail(v_654) && success?(is-true(success?(1-proj-3-tuple(v_654))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_654)) then cipherstatepack(2-proj-3-tuple(v_654),minnonce) else fail-any),1-proj-3-tuple(v_654),3-proj-3-tuple(v_650)) else fail-any) else fail-any) else fail-any)) in
        {268}let v_656: bitstring = catch-fail(symmetricstateunpack(v_655)) in
        {269}let v_657: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_656))) in
        {270}let v_658: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_657),2-proj-2-tuple(v_657),3-proj-3-tuple(v_656),msg_b(bob,alice))) in
        {271}let v_659: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_656))) in
        {272}let v_660: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_657))) && success?(1-proj-3-tuple(v_656))) then (if (not-caught-fail(v_659) && success?(is-true(success?(1-proj-2-tuple(v_659))))) then cipherstatepack(1-proj-2-tuple(v_659),increment_nonce(2-proj-2-tuple(v_657))) else fail-any) else fail-any)) in
        {273}let v_661: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_656)) && success?(1-proj-3-tuple(v_656))) then (if (not-caught-fail(v_657) && success?(is-true(success?(1-proj-2-tuple(v_657))))) then (if not-caught-fail(v_658) then (if not-caught-fail(v_660) then (v_660,v_658) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {274}let v_662: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_661),2-proj-3-tuple(v_656),3-proj-3-tuple(v_656)))) in
        {275}let v_663: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_661)) && success?(symmetricstatepack(1-proj-2-tuple(v_661),2-proj-3-tuple(v_656),3-proj-3-tuple(v_656)))) then (if (not-caught-fail(v_662) && success?(is-true(success?(1-proj-3-tuple(v_662))))) then symmetricstatepack(1-proj-3-tuple(v_662),2-proj-3-tuple(v_662),hash(3-proj-3-tuple(v_662),2-proj-2-tuple(v_661))) else fail-any) else fail-any)) in
        {276}let v_664: bitstring = catch-fail((if (not-caught-fail(v_656) && success?(is-true(success?(1-proj-3-tuple(v_656))))) then (if (not-caught-fail(v_661) && success?(is-true(success?(1-proj-2-tuple(v_661))))) then (if not-caught-fail(v_663) then (v_663,2-proj-2-tuple(v_661)) else fail-any) else fail-any) else fail-any)) in
        {277}let v_665: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_664),2-proj-7-tuple(v_642),v_645,4-proj-7-tuple(v_642),5-proj-7-tuple(v_642),6-proj-7-tuple(v_642),7-proj-7-tuple(v_642))) in
        {278}let v_666: bitstring = catch-fail(concat3(v_646,2-proj-3-tuple(v_643),2-proj-2-tuple(v_664))) in
        {279}let (hs_667: handshakestate,re_668: key,message_b_669: bitstring) = (if (not-caught-fail(v_642) && success?(is-true(success?(1-proj-7-tuple(v_642))))) then (if (not-caught-fail(v_643) && success?(is-true(success?(1-proj-3-tuple(v_643))))) then (if not-caught-fail(v_645) then (if not-caught-fail(v_646) then (if not-caught-fail(v_648) then (if not-caught-fail(v_655) then (if (not-caught-fail(v_664) && success?(is-true(success?(1-proj-2-tuple(v_664))))) then (if not-caught-fail(v_665) then (if not-caught-fail(v_666) then (v_665,5-proj-7-tuple(v_642),v_666) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {280}event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true);
        {281}insert statestore(bob,alice,statepack_c(hs_667));
        {282}out(pub, message_b_669)
    ) | (
        {311}get statestore(=bob,=alice,statepack_c(hs_670: handshakestate)) in
        {284}in(pub, message_c_671: bitstring);
        {285}let v_672: bitstring = catch-fail(handshakestateunpack(hs_670)) in
        {286}let v_673: bitstring = catch-fail(deconcat3(message_c_671)) in
        {287}let v_674: bool = catch-fail(true) in
        {288}let v_675: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_672))) in
        {289}let v_676: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_675))) in
        {290}let v_677: aead = catch-fail(decrypt(1-proj-2-tuple(v_676),2-proj-2-tuple(v_676),3-proj-3-tuple(v_675),3-proj-3-tuple(v_673))) in
        {291}let v_678: bitstring = catch-fail(aeadunpack(v_677)) in
        {292}let v_679: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_675))) in
        {293}let v_680: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_676))) && success?(1-proj-3-tuple(v_675))) then (if (not-caught-fail(v_679) && success?(is-true(success?(1-proj-2-tuple(v_679))))) then cipherstatepack(1-proj-2-tuple(v_679),increment_nonce(2-proj-2-tuple(v_676))) else fail-any) else fail-any)) in
        {294}let v_681: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_673)) && (success?(3-proj-3-tuple(v_675)) && success?(1-proj-3-tuple(v_675)))) then (if (not-caught-fail(v_676) && success?(is-true(success?(1-proj-2-tuple(v_676))))) then (if not-caught-fail(v_677) then (if (not-caught-fail(v_678) && success?(is-true(success?(1-proj-3-tuple(v_678))))) then (if not-caught-fail(v_680) then (v_680,3-proj-3-tuple(v_678),1-proj-3-tuple(v_678)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {295}let v_682: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_681),2-proj-3-tuple(v_675),3-proj-3-tuple(v_675)))) in
        {296}let v_683: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_673)) && success?(symmetricstatepack(1-proj-3-tuple(v_681),2-proj-3-tuple(v_675),3-proj-3-tuple(v_675)))) then (if (not-caught-fail(v_682) && success?(is-true(success?(1-proj-3-tuple(v_682))))) then symmetricstatepack(1-proj-3-tuple(v_682),2-proj-3-tuple(v_682),hash(3-proj-3-tuple(v_682),3-proj-3-tuple(v_673))) else fail-any) else fail-any)) in
        {297}let v_684: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_673)) && success?(1-proj-7-tuple(v_672))) then (if (not-caught-fail(v_675) && success?(is-true(success?(1-proj-3-tuple(v_675))))) then (if (not-caught-fail(v_681) && success?(is-true(success?(1-proj-3-tuple(v_681))))) then (if not-caught-fail(v_683) then (v_683,2-proj-3-tuple(v_681),3-proj-3-tuple(v_681)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {298}let v_685: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_684),2-proj-7-tuple(v_672),3-proj-7-tuple(v_672),4-proj-7-tuple(v_672),5-proj-7-tuple(v_672),6-proj-7-tuple(v_672),7-proj-7-tuple(v_672))) in
        {299}let v_686: bitstring = catch-fail(symmetricstateunpack(1-proj-3-tuple(v_684))) in
        {300}let v_687: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_686),zero)) in
        {301}let v_688: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_686),zero)) in
        {302}let v_689: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_686),zero)) in
        {303}let v_690: bitstring = catch-fail((if success?(2-proj-3-tuple(v_686)) then (if not-caught-fail(v_687) then (if not-caught-fail(v_688) then (if not-caught-fail(v_689) then (v_687,v_688,v_689) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {304}let v_691: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_690)) then cipherstatepack(1-proj-3-tuple(v_690),minnonce) else fail-any)) in
        {305}let v_692: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_690)) then cipherstatepack(2-proj-3-tuple(v_690),minnonce) else fail-any)) in
        {306}let v_693: bitstring = catch-fail((if success?(1-proj-3-tuple(v_684)) then (if (not-caught-fail(v_686) && success?(is-true(success?(1-proj-3-tuple(v_686))))) then (if (not-caught-fail(v_690) && success?(is-true(success?(1-proj-3-tuple(v_690))))) then (if not-caught-fail(v_691) then (if not-caught-fail(v_692) then (1-proj-3-tuple(v_684),v_691,v_692) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {307}let (hs_694: handshakestate,re_695: key,plaintext_c: bitstring,valid_696: bool,cs1_697: cipherstate,cs2_698: cipherstate) = (if (not-caught-fail(v_672) && success?(is-true(success?(1-proj-7-tuple(v_672))))) then (if (not-caught-fail(v_673) && success?(is-true(success?(1-proj-3-tuple(v_673))))) then (if not-caught-fail(v_674) then (if (not-caught-fail(v_684) && success?(is-true(success?(1-proj-3-tuple(v_684))))) then (if (v_674 && 3-proj-3-tuple(v_684)) then (if not-caught-fail(v_685) then (if (not-caught-fail(v_693) && success?(is-true(success?(1-proj-3-tuple(v_693))))) then (v_685,getpublickey(3-proj-7-tuple(v_672)),2-proj-3-tuple(v_684),true,2-proj-3-tuple(v_693),3-proj-3-tuple(v_693)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {308}event RecvMsg(bob,alice,stage_c,plaintext_c,valid_696);
        {309}insert statestore(bob,alice,statepack_d(hs_694));
        {310}event RecvEnd(valid_696)
    ) | (
        {312}event LeakS(phase0,bob);
        {313}out(pub, key_s(bob))
    ) | (
        {314}phase 1;
        {315}event LeakS(phase1,bob);
        {316}out(pub, key_s(bob))
    )
) | (
    {317}let v_699: key = catch-fail(dhexp(key_s(bob),g)) in
    {318}let s_700: keypair = (if not-caught-fail(v_699) then keypairpack(v_699,key_s(bob)) else fail-any) in
    {319}out(pub, getpublickey(s_700));
    (
        {320}let e_701: keypair = keypairpack(empty,empty) in
        {321}let rs_702: key = empty in
        {322}let re_703: key = empty in
        {323}let v_704: bitstring = catch-fail(hash(somename,empty)) in
        {324}let v_705: key = catch-fail(v_704) in
        {325}let v_706: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {326}let v_707: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_704) then (if not-caught-fail(v_705) then (if not-caught-fail(v_706) then symmetricstatepack(v_706,v_705,v_704) else fail-any) else fail-any) else fail-any))) in
        {327}let v_708: symmetricstate = catch-fail((if success?((if not-caught-fail(v_704) then (if not-caught-fail(v_705) then (if not-caught-fail(v_706) then symmetricstatepack(v_706,v_705,v_704) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_707) && success?(is-true(success?(1-proj-3-tuple(v_707))))) then symmetricstatepack(1-proj-3-tuple(v_707),2-proj-3-tuple(v_707),hash(3-proj-3-tuple(v_707),empty)) else fail-any) else fail-any)) in
        {328}let v_709: bitstring = catch-fail(symmetricstateunpack(v_708)) in
        {329}let v_710: symmetricstate = catch-fail((if success?(getpublickey(s_700)) then (if (not-caught-fail(v_709) && success?(is-true(success?(1-proj-3-tuple(v_709))))) then symmetricstatepack(1-proj-3-tuple(v_709),2-proj-3-tuple(v_709),hash(3-proj-3-tuple(v_709),getpublickey(s_700))) else fail-any) else fail-any)) in
        {330}let hs_711: handshakestate = (if not-caught-fail(v_708) then (if not-caught-fail(v_710) then handshakestatepack(v_710,s_700,e_701,rs_702,re_703,empty,false) else fail-any) else fail-any) in
        {331}insert statestore(bob,charlie,statepack_a(hs_711))
    ) | (
        {360}get statestore(=bob,=charlie,statepack_a(hs_712: handshakestate)) in
        {332}in(pub, message_a_713: bitstring);
        {333}let v_714: bitstring = catch-fail(handshakestateunpack(hs_712)) in
        {334}let v_715: bitstring = catch-fail(deconcat3(message_a_713)) in
        {335}let v_716: bool = catch-fail(true) in
        {336}let v_717: key = catch-fail(1-proj-3-tuple(v_715)) in
        {337}let v_718: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_714))) in
        {338}let v_719: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_714)) then (if (not-caught-fail(v_718) && success?(is-true(success?(1-proj-3-tuple(v_718))))) then symmetricstatepack(1-proj-3-tuple(v_718),2-proj-3-tuple(v_718),hash(3-proj-3-tuple(v_718),v_717)) else fail-any) else fail-any)) in
        {339}let v_720: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_714))) in
        {340}let v_721: bitstring = catch-fail(symmetricstateunpack(v_719)) in
        {341}let v_722: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_721),(if success?(2-proj-7-tuple(v_714)) then (if (not-caught-fail(v_720) && success?(is-true(success?(1-proj-2-tuple(v_720))))) then dhexp(2-proj-2-tuple(v_720),v_717) else fail-any) else fail-any))) in
        {342}let v_723: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_721),(if success?(2-proj-7-tuple(v_714)) then (if (not-caught-fail(v_720) && success?(is-true(success?(1-proj-2-tuple(v_720))))) then dhexp(2-proj-2-tuple(v_720),v_717) else fail-any) else fail-any))) in
        {343}let v_724: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_721),(if success?(2-proj-7-tuple(v_714)) then (if (not-caught-fail(v_720) && success?(is-true(success?(1-proj-2-tuple(v_720))))) then dhexp(2-proj-2-tuple(v_720),v_717) else fail-any) else fail-any))) in
        {344}let v_725: bitstring = catch-fail((if (success?((if success?(2-proj-7-tuple(v_714)) then (if (not-caught-fail(v_720) && success?(is-true(success?(1-proj-2-tuple(v_720))))) then dhexp(2-proj-2-tuple(v_720),v_717) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_721))) then (if not-caught-fail(v_722) then (if not-caught-fail(v_723) then (if not-caught-fail(v_724) then (v_722,v_723,v_724) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {345}let v_726: symmetricstate = catch-fail((if success?((if success?(2-proj-7-tuple(v_714)) then (if (not-caught-fail(v_720) && success?(is-true(success?(1-proj-2-tuple(v_720))))) then dhexp(2-proj-2-tuple(v_720),v_717) else fail-any) else fail-any)) then (if (not-caught-fail(v_721) && success?(is-true(success?(1-proj-3-tuple(v_721))))) then (if (not-caught-fail(v_725) && success?(is-true(success?(1-proj-3-tuple(v_725))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_725)) then cipherstatepack(2-proj-3-tuple(v_725),minnonce) else fail-any),1-proj-3-tuple(v_725),3-proj-3-tuple(v_721)) else fail-any) else fail-any) else fail-any)) in
        {346}let v_727: bitstring = catch-fail(symmetricstateunpack(v_726)) in
        {347}let v_728: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_727))) in
        {348}let v_729: aead = catch-fail(decrypt(1-proj-2-tuple(v_728),2-proj-2-tuple(v_728),3-proj-3-tuple(v_727),3-proj-3-tuple(v_715))) in
        {349}let v_730: bitstring = catch-fail(aeadunpack(v_729)) in
        {350}let v_731: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_727))) in
        {351}let v_732: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_728))) && success?(1-proj-3-tuple(v_727))) then (if (not-caught-fail(v_731) && success?(is-true(success?(1-proj-2-tuple(v_731))))) then cipherstatepack(1-proj-2-tuple(v_731),increment_nonce(2-proj-2-tuple(v_728))) else fail-any) else fail-any)) in
        {352}let v_733: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_715)) && (success?(3-proj-3-tuple(v_727)) && success?(1-proj-3-tuple(v_727)))) then (if (not-caught-fail(v_728) && success?(is-true(success?(1-proj-2-tuple(v_728))))) then (if not-caught-fail(v_729) then (if (not-caught-fail(v_730) && success?(is-true(success?(1-proj-3-tuple(v_730))))) then (if not-caught-fail(v_732) then (v_732,3-proj-3-tuple(v_730),1-proj-3-tuple(v_730)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {353}let v_734: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_733),2-proj-3-tuple(v_727),3-proj-3-tuple(v_727)))) in
        {354}let v_735: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_715)) && success?(symmetricstatepack(1-proj-3-tuple(v_733),2-proj-3-tuple(v_727),3-proj-3-tuple(v_727)))) then (if (not-caught-fail(v_734) && success?(is-true(success?(1-proj-3-tuple(v_734))))) then symmetricstatepack(1-proj-3-tuple(v_734),2-proj-3-tuple(v_734),hash(3-proj-3-tuple(v_734),3-proj-3-tuple(v_715))) else fail-any) else fail-any)) in
        {355}let v_736: bitstring = catch-fail((if success?(3-proj-3-tuple(v_715)) then (if (not-caught-fail(v_727) && success?(is-true(success?(1-proj-3-tuple(v_727))))) then (if (not-caught-fail(v_733) && success?(is-true(success?(1-proj-3-tuple(v_733))))) then (if not-caught-fail(v_735) then (v_735,2-proj-3-tuple(v_733),3-proj-3-tuple(v_733)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {356}let v_737: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_736),2-proj-7-tuple(v_714),3-proj-7-tuple(v_714),4-proj-7-tuple(v_714),v_717,6-proj-7-tuple(v_714),7-proj-7-tuple(v_714))) in
        {357}let (hs_738: handshakestate,re_739: key,plaintext_a_740: bitstring,valid_741: bool) = (if (not-caught-fail(v_714) && success?(is-true(success?(1-proj-7-tuple(v_714))))) then (if (not-caught-fail(v_715) && success?(is-true(success?(1-proj-3-tuple(v_715))))) then (if not-caught-fail(v_716) then (if not-caught-fail(v_717) then (if not-caught-fail(v_719) then (if not-caught-fail(v_726) then (if (not-caught-fail(v_736) && success?(is-true(success?(1-proj-3-tuple(v_736))))) then (if (v_716 && 3-proj-3-tuple(v_736)) then (if not-caught-fail(v_737) then (v_737,getpublickey(3-proj-7-tuple(v_714)),2-proj-3-tuple(v_736),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {358}event RecvMsg(bob,charlie,stage_a,plaintext_a_740,valid_741);
        {359}insert statestore(bob,charlie,statepack_b(hs_738))
    ) | (
        {390}get statestore(=bob,=charlie,statepack_b(hs_742: handshakestate)) in
        {361}let v_743: bitstring = catch-fail(handshakestateunpack(hs_742)) in
        {362}let v_744: bitstring = catch-fail((empty,empty,empty)) in
        {363}let v_745: key = catch-fail(dhexp(key_e(bob,charlie),g)) in
        {364}let v_746: keypair = catch-fail((if not-caught-fail(v_745) then keypairpack(v_745,key_e(bob,charlie)) else fail-any)) in
        {365}let v_747: bitstring = catch-fail(getpublickey(v_746)) in
        {366}let v_748: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_743))) in
        {367}let v_749: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_743)) then (if (not-caught-fail(v_748) && success?(is-true(success?(1-proj-3-tuple(v_748))))) then symmetricstatepack(1-proj-3-tuple(v_748),2-proj-3-tuple(v_748),hash(3-proj-3-tuple(v_748),v_747)) else fail-any) else fail-any)) in
        {368}let v_750: bitstring = catch-fail(keypairunpack(v_746)) in
        {369}let v_751: bitstring = catch-fail(symmetricstateunpack(v_749)) in
        {370}let v_752: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_751),(if success?(5-proj-7-tuple(v_743)) then (if (not-caught-fail(v_750) && success?(is-true(success?(1-proj-2-tuple(v_750))))) then dhexp(2-proj-2-tuple(v_750),5-proj-7-tuple(v_743)) else fail-any) else fail-any))) in
        {371}let v_753: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_751),(if success?(5-proj-7-tuple(v_743)) then (if (not-caught-fail(v_750) && success?(is-true(success?(1-proj-2-tuple(v_750))))) then dhexp(2-proj-2-tuple(v_750),5-proj-7-tuple(v_743)) else fail-any) else fail-any))) in
        {372}let v_754: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_751),(if success?(5-proj-7-tuple(v_743)) then (if (not-caught-fail(v_750) && success?(is-true(success?(1-proj-2-tuple(v_750))))) then dhexp(2-proj-2-tuple(v_750),5-proj-7-tuple(v_743)) else fail-any) else fail-any))) in
        {373}let v_755: bitstring = catch-fail((if (success?((if success?(5-proj-7-tuple(v_743)) then (if (not-caught-fail(v_750) && success?(is-true(success?(1-proj-2-tuple(v_750))))) then dhexp(2-proj-2-tuple(v_750),5-proj-7-tuple(v_743)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_751))) then (if not-caught-fail(v_752) then (if not-caught-fail(v_753) then (if not-caught-fail(v_754) then (v_752,v_753,v_754) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {374}let v_756: symmetricstate = catch-fail((if success?((if success?(5-proj-7-tuple(v_743)) then (if (not-caught-fail(v_750) && success?(is-true(success?(1-proj-2-tuple(v_750))))) then dhexp(2-proj-2-tuple(v_750),5-proj-7-tuple(v_743)) else fail-any) else fail-any)) then (if (not-caught-fail(v_751) && success?(is-true(success?(1-proj-3-tuple(v_751))))) then (if (not-caught-fail(v_755) && success?(is-true(success?(1-proj-3-tuple(v_755))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_755)) then cipherstatepack(2-proj-3-tuple(v_755),minnonce) else fail-any),1-proj-3-tuple(v_755),3-proj-3-tuple(v_751)) else fail-any) else fail-any) else fail-any)) in
        {375}let v_757: bitstring = catch-fail(symmetricstateunpack(v_756)) in
        {376}let v_758: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_757))) in
        {377}let v_759: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_758),2-proj-2-tuple(v_758),3-proj-3-tuple(v_757),msg_b(bob,charlie))) in
        {378}let v_760: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_757))) in
        {379}let v_761: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_758))) && success?(1-proj-3-tuple(v_757))) then (if (not-caught-fail(v_760) && success?(is-true(success?(1-proj-2-tuple(v_760))))) then cipherstatepack(1-proj-2-tuple(v_760),increment_nonce(2-proj-2-tuple(v_758))) else fail-any) else fail-any)) in
        {380}let v_762: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_757)) && success?(1-proj-3-tuple(v_757))) then (if (not-caught-fail(v_758) && success?(is-true(success?(1-proj-2-tuple(v_758))))) then (if not-caught-fail(v_759) then (if not-caught-fail(v_761) then (v_761,v_759) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {381}let v_763: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_762),2-proj-3-tuple(v_757),3-proj-3-tuple(v_757)))) in
        {382}let v_764: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_762)) && success?(symmetricstatepack(1-proj-2-tuple(v_762),2-proj-3-tuple(v_757),3-proj-3-tuple(v_757)))) then (if (not-caught-fail(v_763) && success?(is-true(success?(1-proj-3-tuple(v_763))))) then symmetricstatepack(1-proj-3-tuple(v_763),2-proj-3-tuple(v_763),hash(3-proj-3-tuple(v_763),2-proj-2-tuple(v_762))) else fail-any) else fail-any)) in
        {383}let v_765: bitstring = catch-fail((if (not-caught-fail(v_757) && success?(is-true(success?(1-proj-3-tuple(v_757))))) then (if (not-caught-fail(v_762) && success?(is-true(success?(1-proj-2-tuple(v_762))))) then (if not-caught-fail(v_764) then (v_764,2-proj-2-tuple(v_762)) else fail-any) else fail-any) else fail-any)) in
        {384}let v_766: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_765),2-proj-7-tuple(v_743),v_746,4-proj-7-tuple(v_743),5-proj-7-tuple(v_743),6-proj-7-tuple(v_743),7-proj-7-tuple(v_743))) in
        {385}let v_767: bitstring = catch-fail(concat3(v_747,2-proj-3-tuple(v_744),2-proj-2-tuple(v_765))) in
        {386}let (hs_768: handshakestate,re_769: key,message_b_770: bitstring) = (if (not-caught-fail(v_743) && success?(is-true(success?(1-proj-7-tuple(v_743))))) then (if (not-caught-fail(v_744) && success?(is-true(success?(1-proj-3-tuple(v_744))))) then (if not-caught-fail(v_746) then (if not-caught-fail(v_747) then (if not-caught-fail(v_749) then (if not-caught-fail(v_756) then (if (not-caught-fail(v_765) && success?(is-true(success?(1-proj-2-tuple(v_765))))) then (if not-caught-fail(v_766) then (if not-caught-fail(v_767) then (v_766,5-proj-7-tuple(v_743),v_767) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {387}event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true);
        {388}insert statestore(bob,charlie,statepack_c(hs_768));
        {389}out(pub, message_b_770)
    ) | (
        {418}get statestore(=bob,=charlie,statepack_c(hs_771: handshakestate)) in
        {391}in(pub, message_c_772: bitstring);
        {392}let v_773: bitstring = catch-fail(handshakestateunpack(hs_771)) in
        {393}let v_774: bitstring = catch-fail(deconcat3(message_c_772)) in
        {394}let v_775: bool = catch-fail(true) in
        {395}let v_776: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_773))) in
        {396}let v_777: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_776))) in
        {397}let v_778: aead = catch-fail(decrypt(1-proj-2-tuple(v_777),2-proj-2-tuple(v_777),3-proj-3-tuple(v_776),3-proj-3-tuple(v_774))) in
        {398}let v_779: bitstring = catch-fail(aeadunpack(v_778)) in
        {399}let v_780: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_776))) in
        {400}let v_781: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_777))) && success?(1-proj-3-tuple(v_776))) then (if (not-caught-fail(v_780) && success?(is-true(success?(1-proj-2-tuple(v_780))))) then cipherstatepack(1-proj-2-tuple(v_780),increment_nonce(2-proj-2-tuple(v_777))) else fail-any) else fail-any)) in
        {401}let v_782: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_774)) && (success?(3-proj-3-tuple(v_776)) && success?(1-proj-3-tuple(v_776)))) then (if (not-caught-fail(v_777) && success?(is-true(success?(1-proj-2-tuple(v_777))))) then (if not-caught-fail(v_778) then (if (not-caught-fail(v_779) && success?(is-true(success?(1-proj-3-tuple(v_779))))) then (if not-caught-fail(v_781) then (v_781,3-proj-3-tuple(v_779),1-proj-3-tuple(v_779)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {402}let v_783: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_782),2-proj-3-tuple(v_776),3-proj-3-tuple(v_776)))) in
        {403}let v_784: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_774)) && success?(symmetricstatepack(1-proj-3-tuple(v_782),2-proj-3-tuple(v_776),3-proj-3-tuple(v_776)))) then (if (not-caught-fail(v_783) && success?(is-true(success?(1-proj-3-tuple(v_783))))) then symmetricstatepack(1-proj-3-tuple(v_783),2-proj-3-tuple(v_783),hash(3-proj-3-tuple(v_783),3-proj-3-tuple(v_774))) else fail-any) else fail-any)) in
        {404}let v_785: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_774)) && success?(1-proj-7-tuple(v_773))) then (if (not-caught-fail(v_776) && success?(is-true(success?(1-proj-3-tuple(v_776))))) then (if (not-caught-fail(v_782) && success?(is-true(success?(1-proj-3-tuple(v_782))))) then (if not-caught-fail(v_784) then (v_784,2-proj-3-tuple(v_782),3-proj-3-tuple(v_782)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {405}let v_786: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_785),2-proj-7-tuple(v_773),3-proj-7-tuple(v_773),4-proj-7-tuple(v_773),5-proj-7-tuple(v_773),6-proj-7-tuple(v_773),7-proj-7-tuple(v_773))) in
        {406}let v_787: bitstring = catch-fail(symmetricstateunpack(1-proj-3-tuple(v_785))) in
        {407}let v_788: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_787),zero)) in
        {408}let v_789: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_787),zero)) in
        {409}let v_790: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_787),zero)) in
        {410}let v_791: bitstring = catch-fail((if success?(2-proj-3-tuple(v_787)) then (if not-caught-fail(v_788) then (if not-caught-fail(v_789) then (if not-caught-fail(v_790) then (v_788,v_789,v_790) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {411}let v_792: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_791)) then cipherstatepack(1-proj-3-tuple(v_791),minnonce) else fail-any)) in
        {412}let v_793: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_791)) then cipherstatepack(2-proj-3-tuple(v_791),minnonce) else fail-any)) in
        {413}let v_794: bitstring = catch-fail((if success?(1-proj-3-tuple(v_785)) then (if (not-caught-fail(v_787) && success?(is-true(success?(1-proj-3-tuple(v_787))))) then (if (not-caught-fail(v_791) && success?(is-true(success?(1-proj-3-tuple(v_791))))) then (if not-caught-fail(v_792) then (if not-caught-fail(v_793) then (1-proj-3-tuple(v_785),v_792,v_793) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {414}let (hs_795: handshakestate,re_796: key,plaintext_c_797: bitstring,valid_798: bool,cs1_799: cipherstate,cs2_800: cipherstate) = (if (not-caught-fail(v_773) && success?(is-true(success?(1-proj-7-tuple(v_773))))) then (if (not-caught-fail(v_774) && success?(is-true(success?(1-proj-3-tuple(v_774))))) then (if not-caught-fail(v_775) then (if (not-caught-fail(v_785) && success?(is-true(success?(1-proj-3-tuple(v_785))))) then (if (v_775 && 3-proj-3-tuple(v_785)) then (if not-caught-fail(v_786) then (if (not-caught-fail(v_794) && success?(is-true(success?(1-proj-3-tuple(v_794))))) then (v_786,getpublickey(3-proj-7-tuple(v_773)),2-proj-3-tuple(v_785),true,2-proj-3-tuple(v_794),3-proj-3-tuple(v_794)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {415}event RecvMsg(bob,charlie,stage_c,plaintext_c_797,valid_798);
        {416}insert statestore(bob,charlie,statepack_d(hs_795));
        {417}event RecvEnd(valid_798)
    ) | (
        {419}event LeakS(phase0,bob);
        {420}out(pub, key_s(bob))
    ) | (
        {421}phase 1;
        {422}event LeakS(phase1,bob);
        {423}out(pub, key_s(bob))
    )
) | (
    {424}out(pub, (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)))
)

-- Query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)); not attacker_p1(msg_a(alice,bob)); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)); not attacker_p1(msg_b(bob,alice)); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice)); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob))); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)); not attacker_p1(msg_c(alice,bob)); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob))
Completing...
200 rules inserted. The rule base contains 200 rules. 132 rules in the queue.
400 rules inserted. The rule base contains 390 rules. 88 rules in the queue.
600 rules inserted. The rule base contains 586 rules. 267 rules in the queue.
800 rules inserted. The rule base contains 774 rules. 241 rules in the queue.
1000 rules inserted. The rule base contains 926 rules. 180 rules in the queue.
1200 rules inserted. The rule base contains 1122 rules. 266 rules in the queue.
1400 rules inserted. The rule base contains 1314 rules. 281 rules in the queue.
1600 rules inserted. The rule base contains 1420 rules. 271 rules in the queue.
1800 rules inserted. The rule base contains 1580 rules. 264 rules in the queue.
2000 rules inserted. The rule base contains 1698 rules. 237 rules in the queue.
2200 rules inserted. The rule base contains 1818 rules. 258 rules in the queue.
2400 rules inserted. The rule base contains 1916 rules. 345 rules in the queue.
2600 rules inserted. The rule base contains 2006 rules. 336 rules in the queue.
2800 rules inserted. The rule base contains 2081 rules. 411 rules in the queue.
3000 rules inserted. The rule base contains 2168 rules. 419 rules in the queue.
3200 rules inserted. The rule base contains 2347 rules. 778 rules in the queue.
3400 rules inserted. The rule base contains 2410 rules. 780 rules in the queue.
3600 rules inserted. The rule base contains 2572 rules. 821 rules in the queue.
3800 rules inserted. The rule base contains 2742 rules. 1046 rules in the queue.
4000 rules inserted. The rule base contains 2933 rules. 1182 rules in the queue.
4200 rules inserted. The rule base contains 3023 rules. 1156 rules in the queue.
4400 rules inserted. The rule base contains 3198 rules. 1107 rules in the queue.
4600 rules inserted. The rule base contains 3381 rules. 972 rules in the queue.
4800 rules inserted. The rule base contains 3533 rules. 927 rules in the queue.
5000 rules inserted. The rule base contains 3720 rules. 794 rules in the queue.
5200 rules inserted. The rule base contains 3896 rules. 721 rules in the queue.
5400 rules inserted. The rule base contains 4034 rules. 693 rules in the queue.
5600 rules inserted. The rule base contains 4220 rules. 744 rules in the queue.
5800 rules inserted. The rule base contains 4384 rules. 740 rules in the queue.
6000 rules inserted. The rule base contains 4506 rules. 720 rules in the queue.
6200 rules inserted. The rule base contains 4614 rules. 770 rules in the queue.
6400 rules inserted. The rule base contains 4707 rules. 815 rules in the queue.
6600 rules inserted. The rule base contains 4864 rules. 840 rules in the queue.
6800 rules inserted. The rule base contains 4966 rules. 823 rules in the queue.
7000 rules inserted. The rule base contains 5079 rules. 836 rules in the queue.
7200 rules inserted. The rule base contains 5188 rules. 810 rules in the queue.
7400 rules inserted. The rule base contains 5319 rules. 825 rules in the queue.
7600 rules inserted. The rule base contains 5440 rules. 864 rules in the queue.
7800 rules inserted. The rule base contains 5597 rules. 874 rules in the queue.
8000 rules inserted. The rule base contains 5723 rules. 879 rules in the queue.
8200 rules inserted. The rule base contains 5912 rules. 883 rules in the queue.
8400 rules inserted. The rule base contains 6034 rules. 851 rules in the queue.
8600 rules inserted. The rule base contains 6210 rules. 861 rules in the queue.
8800 rules inserted. The rule base contains 6362 rules. 874 rules in the queue.
9000 rules inserted. The rule base contains 6552 rules. 877 rules in the queue.
9200 rules inserted. The rule base contains 6680 rules. 874 rules in the queue.
9400 rules inserted. The rule base contains 6834 rules. 890 rules in the queue.
9600 rules inserted. The rule base contains 7029 rules. 943 rules in the queue.
9800 rules inserted. The rule base contains 7177 rules. 964 rules in the queue.
10000 rules inserted. The rule base contains 7369 rules. 982 rules in the queue.
10200 rules inserted. The rule base contains 7493 rules. 1000 rules in the queue.
10400 rules inserted. The rule base contains 7693 rules. 1019 rules in the queue.
10600 rules inserted. The rule base contains 7847 rules. 1041 rules in the queue.
10800 rules inserted. The rule base contains 8003 rules. 1072 rules in the queue.
11000 rules inserted. The rule base contains 8189 rules. 1080 rules in the queue.
11200 rules inserted. The rule base contains 8256 rules. 1146 rules in the queue.
11400 rules inserted. The rule base contains 8452 rules. 1184 rules in the queue.
11600 rules inserted. The rule base contains 8594 rules. 1196 rules in the queue.
11800 rules inserted. The rule base contains 8687 rules. 1286 rules in the queue.
12000 rules inserted. The rule base contains 8857 rules. 1301 rules in the queue.
12200 rules inserted. The rule base contains 8983 rules. 1301 rules in the queue.
12400 rules inserted. The rule base contains 9093 rules. 1212 rules in the queue.
12600 rules inserted. The rule base contains 9287 rules. 1174 rules in the queue.
12800 rules inserted. The rule base contains 9399 rules. 1143 rules in the queue.
13000 rules inserted. The rule base contains 9520 rules. 1062 rules in the queue.
13200 rules inserted. The rule base contains 9712 rules. 1028 rules in the queue.
13400 rules inserted. The rule base contains 9843 rules. 992 rules in the queue.
13600 rules inserted. The rule base contains 9913 rules. 941 rules in the queue.
13800 rules inserted. The rule base contains 9932 rules. 875 rules in the queue.
14000 rules inserted. The rule base contains 10017 rules. 824 rules in the queue.
14200 rules inserted. The rule base contains 10066 rules. 772 rules in the queue.
14400 rules inserted. The rule base contains 9907 rules. 726 rules in the queue.
14600 rules inserted. The rule base contains 9995 rules. 696 rules in the queue.
14800 rules inserted. The rule base contains 9919 rules. 611 rules in the queue.
15000 rules inserted. The rule base contains 10012 rules. 590 rules in the queue.
15200 rules inserted. The rule base contains 9568 rules. 363 rules in the queue.
15400 rules inserted. The rule base contains 7897 rules. 298 rules in the queue.
15600 rules inserted. The rule base contains 6279 rules. 281 rules in the queue.
15800 rules inserted. The rule base contains 6291 rules. 270 rules in the queue.
16000 rules inserted. The rule base contains 6368 rules. 250 rules in the queue.
16200 rules inserted. The rule base contains 6437 rules. 226 rules in the queue.
16400 rules inserted. The rule base contains 6479 rules. 226 rules in the queue.
16600 rules inserted. The rule base contains 6481 rules. 247 rules in the queue.
16800 rules inserted. The rule base contains 6491 rules. 210 rules in the queue.
17000 rules inserted. The rule base contains 6459 rules. 131 rules in the queue.
17200 rules inserted. The rule base contains 6381 rules. 45 rules in the queue.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true))
goal reachable: attacker(m_21046194) -> end(RecvMsg(bob,alice,stage_a,m_21046194,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21046237).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21046237.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21046237).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21046237)).

16. The attacker has some term b_21046223.
attacker(b_21046223).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21046223.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21046237).
Using the function concat3 the attacker may obtain concat3(g,b_21046223,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21046237)).
attacker(concat3(g,b_21046223,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21046237))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21046223,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21046237)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21046223,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21046237))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21046223,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21046237)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21046237,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21046237,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21047462,~M_21047463,~M_21047464)) with ~M_21047462 = key_s(charlie), ~M_21047463 = key_e(charlie,alice), ~M_21047464 = key_e(charlie,bob) at {424} in copy a_21046242

out(pub, ~M_21047673) with ~M_21047673 = dhexp(key_s(bob),g) at {319} in copy a_21046242

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21046242

out(pub, ~M_21048020) with ~M_21048020 = dhexp(key_s(bob),g) at {212} in copy a_21046242

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21046242

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21046242

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21046242

out(pub, (~M_21048653,~M_21048654,~M_21048655)) with ~M_21048653 = key_s(charlie), ~M_21048654 = key_e(charlie,alice), ~M_21048655 = key_e(charlie,bob) at {424} in copy a_21046241

out(pub, ~M_21048864) with ~M_21048864 = dhexp(key_s(bob),g) at {319} in copy a_21046241

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21046241

out(pub, ~M_21049211) with ~M_21049211 = dhexp(key_s(bob),g) at {212} in copy a_21046241

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21046241

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21046241

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21046241

out(pub, (~M_21049844,~M_21049845,~M_21049846)) with ~M_21049844 = key_s(charlie), ~M_21049845 = key_e(charlie,alice), ~M_21049846 = key_e(charlie,bob) at {424} in copy a_21046240

out(pub, ~M_21050055) with ~M_21050055 = dhexp(key_s(bob),g) at {319} in copy a_21046240

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21046240

out(pub, ~M_21050402) with ~M_21050402 = dhexp(key_s(bob),g) at {212} in copy a_21046240

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21046240

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21046240

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21046240

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21046242

in(pub, concat3(g,a_21046239,encrypt(hmac_hash2(hash(somename,empty),~M_21047673),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21047673),g),a_21046238))) with encrypt(hmac_hash2(hash(somename,empty),~M_21047673),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21047673),g),a_21046238) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21046238) at {225} in copy a_21046242

event RecvMsg(bob,alice,stage_a,a_21046238,true) at {251} in copy a_21046242 (goal)

The event RecvMsg(bob,alice,stage_a,a_21046238,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_21052039) -> end(RecvMsg(bob,alice,stage_a,m_21052039,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21052083).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21052083.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21052083).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21052083)).

16. The attacker has some term b_21052069.
attacker(b_21052069).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21052069.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21052083).
Using the function concat3 the attacker may obtain concat3(g,b_21052069,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21052083)).
attacker(concat3(g,b_21052069,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21052083))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21052069,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21052083)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21052069,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21052083))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21052069,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21052083)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21052083,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21052083,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21053312,~M_21053313,~M_21053314)) with ~M_21053312 = key_s(charlie), ~M_21053313 = key_e(charlie,alice), ~M_21053314 = key_e(charlie,bob) at {424} in copy a_21052088

out(pub, ~M_21053523) with ~M_21053523 = dhexp(key_s(bob),g) at {319} in copy a_21052088

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21052088

out(pub, ~M_21053870) with ~M_21053870 = dhexp(key_s(bob),g) at {212} in copy a_21052088

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21052088

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21052088

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21052088

out(pub, (~M_21054503,~M_21054504,~M_21054505)) with ~M_21054503 = key_s(charlie), ~M_21054504 = key_e(charlie,alice), ~M_21054505 = key_e(charlie,bob) at {424} in copy a_21052087

out(pub, ~M_21054714) with ~M_21054714 = dhexp(key_s(bob),g) at {319} in copy a_21052087

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21052087

out(pub, ~M_21055061) with ~M_21055061 = dhexp(key_s(bob),g) at {212} in copy a_21052087

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21052087

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21052087

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21052087

out(pub, (~M_21055694,~M_21055695,~M_21055696)) with ~M_21055694 = key_s(charlie), ~M_21055695 = key_e(charlie,alice), ~M_21055696 = key_e(charlie,bob) at {424} in copy a_21052086

out(pub, ~M_21055905) with ~M_21055905 = dhexp(key_s(bob),g) at {319} in copy a_21052086

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21052086

out(pub, ~M_21056252) with ~M_21056252 = dhexp(key_s(bob),g) at {212} in copy a_21052086

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21052086

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21052086

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21052086

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21052088

in(pub, concat3(g,a_21052085,encrypt(hmac_hash2(hash(somename,empty),~M_21053523),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21053523),g),a_21052084))) with encrypt(hmac_hash2(hash(somename,empty),~M_21053523),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21053523),g),a_21052084) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21052084) at {225} in copy a_21052088

event RecvMsg(bob,alice,stage_a,a_21052084,true) at {251} in copy a_21052088 (goal)

The event RecvMsg(bob,alice,stage_a,a_21052084,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_21057889) -> end(RecvMsg(bob,alice,stage_a,m_21057889,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21057933).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21057933.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21057933).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21057933)).

16. The attacker has some term b_21057919.
attacker(b_21057919).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21057919.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21057933).
Using the function concat3 the attacker may obtain concat3(g,b_21057919,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21057933)).
attacker(concat3(g,b_21057919,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21057933))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21057919,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21057933)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21057919,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21057933))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21057919,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21057933)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21057933,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21057933,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21059162,~M_21059163,~M_21059164)) with ~M_21059162 = key_s(charlie), ~M_21059163 = key_e(charlie,alice), ~M_21059164 = key_e(charlie,bob) at {424} in copy a_21057938

out(pub, ~M_21059373) with ~M_21059373 = dhexp(key_s(bob),g) at {319} in copy a_21057938

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21057938

out(pub, ~M_21059720) with ~M_21059720 = dhexp(key_s(bob),g) at {212} in copy a_21057938

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21057938

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21057938

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21057938

out(pub, (~M_21060353,~M_21060354,~M_21060355)) with ~M_21060353 = key_s(charlie), ~M_21060354 = key_e(charlie,alice), ~M_21060355 = key_e(charlie,bob) at {424} in copy a_21057937

out(pub, ~M_21060564) with ~M_21060564 = dhexp(key_s(bob),g) at {319} in copy a_21057937

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21057937

out(pub, ~M_21060911) with ~M_21060911 = dhexp(key_s(bob),g) at {212} in copy a_21057937

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21057937

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21057937

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21057937

out(pub, (~M_21061544,~M_21061545,~M_21061546)) with ~M_21061544 = key_s(charlie), ~M_21061545 = key_e(charlie,alice), ~M_21061546 = key_e(charlie,bob) at {424} in copy a_21057936

out(pub, ~M_21061755) with ~M_21061755 = dhexp(key_s(bob),g) at {319} in copy a_21057936

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21057936

out(pub, ~M_21062102) with ~M_21062102 = dhexp(key_s(bob),g) at {212} in copy a_21057936

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21057936

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21057936

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21057936

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21057938

in(pub, concat3(g,a_21057935,encrypt(hmac_hash2(hash(somename,empty),~M_21059373),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21059373),g),a_21057934))) with encrypt(hmac_hash2(hash(somename,empty),~M_21059373),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21059373),g),a_21057934) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21057934) at {225} in copy a_21057938

event RecvMsg(bob,alice,stage_a,a_21057934,true) at {251} in copy a_21057938 (goal)

The event RecvMsg(bob,alice,stage_a,a_21057934,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_21063739) -> end(RecvMsg(bob,alice,stage_a,m_21063739,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21063782).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21063782.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21063782).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21063782)).

16. The attacker has some term b_21063768.
attacker(b_21063768).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21063768.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21063782).
Using the function concat3 the attacker may obtain concat3(g,b_21063768,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21063782)).
attacker(concat3(g,b_21063768,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21063782))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21063768,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21063782)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21063768,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21063782))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21063768,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21063782)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21063782,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21063782,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21065011,~M_21065012,~M_21065013)) with ~M_21065011 = key_s(charlie), ~M_21065012 = key_e(charlie,alice), ~M_21065013 = key_e(charlie,bob) at {424} in copy a_21063787

out(pub, ~M_21065222) with ~M_21065222 = dhexp(key_s(bob),g) at {319} in copy a_21063787

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21063787

out(pub, ~M_21065569) with ~M_21065569 = dhexp(key_s(bob),g) at {212} in copy a_21063787

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21063787

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21063787

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21063787

out(pub, (~M_21066202,~M_21066203,~M_21066204)) with ~M_21066202 = key_s(charlie), ~M_21066203 = key_e(charlie,alice), ~M_21066204 = key_e(charlie,bob) at {424} in copy a_21063786

out(pub, ~M_21066413) with ~M_21066413 = dhexp(key_s(bob),g) at {319} in copy a_21063786

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21063786

out(pub, ~M_21066760) with ~M_21066760 = dhexp(key_s(bob),g) at {212} in copy a_21063786

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21063786

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21063786

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21063786

out(pub, (~M_21067393,~M_21067394,~M_21067395)) with ~M_21067393 = key_s(charlie), ~M_21067394 = key_e(charlie,alice), ~M_21067395 = key_e(charlie,bob) at {424} in copy a_21063785

out(pub, ~M_21067604) with ~M_21067604 = dhexp(key_s(bob),g) at {319} in copy a_21063785

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21063785

out(pub, ~M_21067951) with ~M_21067951 = dhexp(key_s(bob),g) at {212} in copy a_21063785

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21063785

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21063785

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21063785

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21063787

in(pub, concat3(g,a_21063784,encrypt(hmac_hash2(hash(somename,empty),~M_21065222),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21065222),g),a_21063783))) with encrypt(hmac_hash2(hash(somename,empty),~M_21065222),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21065222),g),a_21063783) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21063783) at {225} in copy a_21063787

event RecvMsg(bob,alice,stage_a,a_21063783,true) at {251} in copy a_21063787 (goal)

The event RecvMsg(bob,alice,stage_a,a_21063783,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_21069588) -> end(RecvMsg(bob,alice,stage_a,m_21069588,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21069631).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21069631.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21069631).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21069631)).

16. The attacker has some term b_21069617.
attacker(b_21069617).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21069617.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21069631).
Using the function concat3 the attacker may obtain concat3(g,b_21069617,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21069631)).
attacker(concat3(g,b_21069617,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21069631))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21069617,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21069631)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21069617,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21069631))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21069617,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21069631)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21069631,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21069631,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21070860,~M_21070861,~M_21070862)) with ~M_21070860 = key_s(charlie), ~M_21070861 = key_e(charlie,alice), ~M_21070862 = key_e(charlie,bob) at {424} in copy a_21069636

out(pub, ~M_21071071) with ~M_21071071 = dhexp(key_s(bob),g) at {319} in copy a_21069636

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21069636

out(pub, ~M_21071418) with ~M_21071418 = dhexp(key_s(bob),g) at {212} in copy a_21069636

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21069636

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21069636

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21069636

out(pub, (~M_21072051,~M_21072052,~M_21072053)) with ~M_21072051 = key_s(charlie), ~M_21072052 = key_e(charlie,alice), ~M_21072053 = key_e(charlie,bob) at {424} in copy a_21069635

out(pub, ~M_21072262) with ~M_21072262 = dhexp(key_s(bob),g) at {319} in copy a_21069635

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21069635

out(pub, ~M_21072609) with ~M_21072609 = dhexp(key_s(bob),g) at {212} in copy a_21069635

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21069635

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21069635

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21069635

out(pub, (~M_21073242,~M_21073243,~M_21073244)) with ~M_21073242 = key_s(charlie), ~M_21073243 = key_e(charlie,alice), ~M_21073244 = key_e(charlie,bob) at {424} in copy a_21069634

out(pub, ~M_21073453) with ~M_21073453 = dhexp(key_s(bob),g) at {319} in copy a_21069634

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21069634

out(pub, ~M_21073800) with ~M_21073800 = dhexp(key_s(bob),g) at {212} in copy a_21069634

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21069634

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21069634

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21069634

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21069636

in(pub, concat3(g,a_21069633,encrypt(hmac_hash2(hash(somename,empty),~M_21071071),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21071071),g),a_21069632))) with encrypt(hmac_hash2(hash(somename,empty),~M_21071071),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21071071),g),a_21069632) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21069632) at {225} in copy a_21069636

event RecvMsg(bob,alice,stage_a,a_21069632,true) at {251} in copy a_21069636 (goal)

The event RecvMsg(bob,alice,stage_a,a_21069632,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query not attacker_p1(msg_a(alice,bob))
goal reachable: begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 5, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

7. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

8. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

9. By 1, the attacker may have the channel pub.
By 8, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

10. Using the function empty the attacker may obtain empty.
attacker(empty).

11. Using the function somename the attacker may obtain somename.
attacker(somename).

12. By 11, the attacker may know somename.
By 10, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

13. By 12, the attacker may know hash(somename,empty).
By 10, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

14. By 13, the attacker may know hash(hash(somename,empty),empty).
By 9, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 7, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

16. By 15, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
So the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

17. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

18. The event LeakS(phase0,bob) may be executed at {312}.
So the message key_s(bob) may be sent on channel pub at output {313}.
mess(pub,key_s(bob)).

19. By 1, the attacker may have the channel pub.
By 18, the message key_s(bob) may be sent on this channel.
So the attacker may obtain the message key_s(bob) by listening on this channel.
attacker(key_s(bob)).

20. By 19, the attacker may know key_s(bob).
By 7, the attacker may know dhexp(key_e(alice,bob),g).
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
attacker(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

21. By 12, the attacker may know hash(somename,empty).
By 20, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

22. By 21, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
So the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
attacker_p1(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
By 17, the attacker may know minnonce in phase 1.
By 16, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
By 6, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

24. By 23, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


Could not find a trace corresponding to this derivation.
RESULT not attacker_p1(msg_a(alice,bob)) cannot be proved.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob))
goal reachable: begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)) is true.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice)))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 5, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

7. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

8. By 7, the attacker may know dhexp(key_e(alice,bob),g).
So the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),g)).

9. Using the function g the attacker may obtain g in phase 1.
attacker_p1(g).

10. Using the function pub the attacker may obtain pub in phase 1.
attacker_p1(pub).

11. The event LeakS(phase1,bob) may be executed at {315}.
So the message key_s(bob) may be sent on channel pub in phase 1 at output {316}.
mess_p1(pub,key_s(bob)).

12. By 10, the attacker may have the channel pub in phase 1.
By 11, the message key_s(bob) in phase 1 may be sent on this channel.
So the attacker may obtain the message key_s(bob) in phase 1 by listening on this channel.
attacker_p1(key_s(bob)).

13. By 12, the attacker may know key_s(bob) in phase 1.
By 9, the attacker may know g in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_s(bob),g) in phase 1.
attacker_p1(dhexp(key_s(bob),g)).

14. Using the function empty the attacker may obtain empty in phase 1.
attacker_p1(empty).

15. Using the function somename the attacker may obtain somename in phase 1.
attacker_p1(somename).

16. By 15, the attacker may know somename in phase 1.
By 14, the attacker may know empty in phase 1.
Using the function hash the attacker may obtain hash(somename,empty) in phase 1.
attacker_p1(hash(somename,empty)).

17. By 16, the attacker may know hash(somename,empty) in phase 1.
By 14, the attacker may know empty in phase 1.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty) in phase 1.
attacker_p1(hash(hash(somename,empty),empty)).

18. By 17, the attacker may know hash(hash(somename,empty),empty) in phase 1.
By 13, the attacker may know dhexp(key_s(bob),g) in phase 1.
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

19. By 18, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)) in phase 1.
By 8, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

20. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

21. By 12, the attacker may know key_s(bob) in phase 1.
By 8, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

22. By 16, the attacker may know hash(somename,empty) in phase 1.
By 21, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
attacker_p1(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
By 20, the attacker may know minnonce in phase 1.
By 19, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
By 6, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

24. By 23, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21084220,~M_21084221,~M_21084222)) with ~M_21084220 = key_s(charlie), ~M_21084221 = key_e(charlie,alice), ~M_21084222 = key_e(charlie,bob) at {424} in copy a_21082980

out(pub, ~M_21084431) with ~M_21084431 = dhexp(key_s(bob),g) at {319} in copy a_21082980

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21082980

out(pub, ~M_21084778) with ~M_21084778 = dhexp(key_s(bob),g) at {212} in copy a_21082980

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21082980

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21082980

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21082980

out(pub, (~M_21085411,~M_21085412,~M_21085413)) with ~M_21085411 = key_s(charlie), ~M_21085412 = key_e(charlie,alice), ~M_21085413 = key_e(charlie,bob) at {424} in copy a_21082979

out(pub, ~M_21085622) with ~M_21085622 = dhexp(key_s(bob),g) at {319} in copy a_21082979

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21082979

out(pub, ~M_21085969) with ~M_21085969 = dhexp(key_s(bob),g) at {212} in copy a_21082979

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21082979

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21082979

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21082979

out(pub, (~M_21086602,~M_21086603,~M_21086604)) with ~M_21086602 = key_s(charlie), ~M_21086603 = key_e(charlie,alice), ~M_21086604 = key_e(charlie,bob) at {424} in copy a_21082978

out(pub, ~M_21086813) with ~M_21086813 = dhexp(key_s(bob),g) at {319} in copy a_21082978

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21082978

out(pub, ~M_21087160) with ~M_21087160 = dhexp(key_s(bob),g) at {212} in copy a_21082978

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21082978

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21082978

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21082978

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {45} in copy a_21082980

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {42} in copy a_21082980

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {43} in copy a_21082980

out(pub, concat3(~M_21088737,empty,~M_21088739)) with ~M_21088737 = dhexp(key_e(alice,bob),g), ~M_21088739 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {44} in copy a_21082980

event LeakS(phase1,bob) at {315} in copy a_21082978

out(pub, ~M_21088752) with ~M_21088752 = key_s(bob) at {316} in copy a_21082978

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hash(somename,empty),dhexp(~M_21088752,~M_21088737)),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21084431),~M_21088737),~M_21088739)) = msg_a(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))) is false.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 5, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

7. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

8. By 7, the attacker may know dhexp(key_e(alice,bob),g).
So the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),g)).

9. Using the function g the attacker may obtain g in phase 1.
attacker_p1(g).

10. Using the function pub the attacker may obtain pub in phase 1.
attacker_p1(pub).

11. The event LeakS(phase1,bob) may be executed at {315}.
So the message key_s(bob) may be sent on channel pub in phase 1 at output {316}.
mess_p1(pub,key_s(bob)).

12. By 10, the attacker may have the channel pub in phase 1.
By 11, the message key_s(bob) in phase 1 may be sent on this channel.
So the attacker may obtain the message key_s(bob) in phase 1 by listening on this channel.
attacker_p1(key_s(bob)).

13. By 12, the attacker may know key_s(bob) in phase 1.
By 9, the attacker may know g in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_s(bob),g) in phase 1.
attacker_p1(dhexp(key_s(bob),g)).

14. Using the function empty the attacker may obtain empty in phase 1.
attacker_p1(empty).

15. Using the function somename the attacker may obtain somename in phase 1.
attacker_p1(somename).

16. By 15, the attacker may know somename in phase 1.
By 14, the attacker may know empty in phase 1.
Using the function hash the attacker may obtain hash(somename,empty) in phase 1.
attacker_p1(hash(somename,empty)).

17. By 16, the attacker may know hash(somename,empty) in phase 1.
By 14, the attacker may know empty in phase 1.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty) in phase 1.
attacker_p1(hash(hash(somename,empty),empty)).

18. By 17, the attacker may know hash(hash(somename,empty),empty) in phase 1.
By 13, the attacker may know dhexp(key_s(bob),g) in phase 1.
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

19. By 18, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)) in phase 1.
By 8, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

20. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

21. By 12, the attacker may know key_s(bob) in phase 1.
By 8, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

22. By 16, the attacker may know hash(somename,empty) in phase 1.
By 21, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
attacker_p1(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
By 20, the attacker may know minnonce in phase 1.
By 19, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
By 6, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

24. By 23, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21090070,~M_21090071,~M_21090072)) with ~M_21090070 = key_s(charlie), ~M_21090071 = key_e(charlie,alice), ~M_21090072 = key_e(charlie,bob) at {424} in copy a_21088830

out(pub, ~M_21090281) with ~M_21090281 = dhexp(key_s(bob),g) at {319} in copy a_21088830

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21088830

out(pub, ~M_21090628) with ~M_21090628 = dhexp(key_s(bob),g) at {212} in copy a_21088830

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21088830

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21088830

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21088830

out(pub, (~M_21091261,~M_21091262,~M_21091263)) with ~M_21091261 = key_s(charlie), ~M_21091262 = key_e(charlie,alice), ~M_21091263 = key_e(charlie,bob) at {424} in copy a_21088829

out(pub, ~M_21091472) with ~M_21091472 = dhexp(key_s(bob),g) at {319} in copy a_21088829

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21088829

out(pub, ~M_21091819) with ~M_21091819 = dhexp(key_s(bob),g) at {212} in copy a_21088829

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21088829

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21088829

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21088829

out(pub, (~M_21092452,~M_21092453,~M_21092454)) with ~M_21092452 = key_s(charlie), ~M_21092453 = key_e(charlie,alice), ~M_21092454 = key_e(charlie,bob) at {424} in copy a_21088828

out(pub, ~M_21092663) with ~M_21092663 = dhexp(key_s(bob),g) at {319} in copy a_21088828

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21088828

out(pub, ~M_21093010) with ~M_21093010 = dhexp(key_s(bob),g) at {212} in copy a_21088828

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21088828

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21088828

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21088828

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {45} in copy a_21088830

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {42} in copy a_21088830

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {43} in copy a_21088830

out(pub, concat3(~M_21094587,empty,~M_21094589)) with ~M_21094587 = dhexp(key_e(alice,bob),g), ~M_21094589 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {44} in copy a_21088830

event LeakS(phase1,bob) at {315} in copy a_21088828

out(pub, ~M_21094602) with ~M_21094602 = key_s(bob) at {316} in copy a_21088828

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hash(somename,empty),dhexp(~M_21094602,~M_21094587)),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21090281),~M_21094587),~M_21094589)) = msg_a(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_21094604) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_21094604,true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 1 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {43}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

3. We assume as hypothesis that
attacker(m_21094713).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

8. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 7 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 4, the attacker may have the channel pub.
By 8, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

10. By 9, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

11. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

12. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 11 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

13. By 4, the attacker may have the channel pub.
By 12, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

14. By 13, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

15. Using the function empty the attacker may obtain empty.
attacker(empty).

16. Using the function somename the attacker may obtain somename.
attacker(somename).

17. By 16, the attacker may know somename.
By 15, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

18. By 17, the attacker may know hash(somename,empty).
By 15, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

19. By 18, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

20. By 19, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 14, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

21. By 20, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
By 10, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

22. By 21, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g))).

23. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

24. The event LeakS(phase0,bob) may be executed at {312}.
So the message key_s(bob) may be sent on channel pub at output {313}.
mess(pub,key_s(bob)).

25. By 4, the attacker may have the channel pub.
By 24, the message key_s(bob) may be sent on this channel.
So the attacker may obtain the message key_s(bob) by listening on this channel.
attacker(key_s(bob)).

26. By 25, the attacker may know key_s(bob).
By 14, the attacker may know dhexp(key_e(alice,bob),g).
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
attacker(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

27. By 17, the attacker may know hash(somename,empty).
By 26, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

28. By 27, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
By 26, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

29. By 28, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
By 23, the attacker may know minnonce.
By 22, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)).
By 3, the attacker may know m_21094713.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21094713).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21094713)).

30. The attacker has some term b_21094700.
attacker(b_21094700).

31. By 6, the attacker may know dhexp(key_s(bob),g).
By 30, the attacker may know b_21094700.
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21094713).
Using the function concat3 the attacker may obtain concat3(dhexp(key_s(bob),g),b_21094700,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21094713)).
attacker(concat3(dhexp(key_s(bob),g),b_21094700,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21094713))).

32. By 4, the attacker may have the channel pub.
By 31, the attacker may have the message concat3(dhexp(key_s(bob),g),b_21094700,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21094713)).
So the attacker may send this message on this channel.
mess(pub,concat3(dhexp(key_s(bob),g),b_21094700,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21094713))).

33. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {74}.
The message concat3(dhexp(key_s(bob),g),b_21094700,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21094713)) that may be sent on channel pub by 32 may be received at input {46}.
We have dhexp(key_s(bob),g) <> caught-fail.
So event RecvMsg(alice,bob,stage_b,m_21094713,true) may be executed at {72}.
end(RecvMsg(alice,bob,stage_b,m_21094713,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21098376,~M_21098377,~M_21098378)) with ~M_21098376 = key_s(charlie), ~M_21098377 = key_e(charlie,alice), ~M_21098378 = key_e(charlie,bob) at {424} in copy a_21094724

out(pub, ~M_21098587) with ~M_21098587 = dhexp(key_s(bob),g) at {319} in copy a_21094724

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21094724

out(pub, ~M_21098934) with ~M_21098934 = dhexp(key_s(bob),g) at {212} in copy a_21094724

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21094724

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21094724

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21094724

out(pub, (~M_21099567,~M_21099568,~M_21099569)) with ~M_21099567 = key_s(charlie), ~M_21099568 = key_e(charlie,alice), ~M_21099569 = key_e(charlie,bob) at {424} in copy a_21094723

out(pub, ~M_21099778) with ~M_21099778 = dhexp(key_s(bob),g) at {319} in copy a_21094723

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21094723

out(pub, ~M_21100125) with ~M_21100125 = dhexp(key_s(bob),g) at {212} in copy a_21094723

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21094723

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21094723

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21094723

out(pub, (~M_21100758,~M_21100759,~M_21100760)) with ~M_21100758 = key_s(charlie), ~M_21100759 = key_e(charlie,alice), ~M_21100760 = key_e(charlie,bob) at {424} in copy a_21094722

out(pub, ~M_21100969) with ~M_21100969 = dhexp(key_s(bob),g) at {319} in copy a_21094722

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21094722

out(pub, ~M_21101316) with ~M_21101316 = dhexp(key_s(bob),g) at {212} in copy a_21094722

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21094722

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21094722

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21094722

out(pub, (~M_21101949,~M_21101950,~M_21101951)) with ~M_21101949 = key_s(charlie), ~M_21101950 = key_e(charlie,alice), ~M_21101951 = key_e(charlie,bob) at {424} in copy a_21094721

out(pub, ~M_21102160) with ~M_21102160 = dhexp(key_s(bob),g) at {319} in copy a_21094721

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21094721

out(pub, ~M_21102507) with ~M_21102507 = dhexp(key_s(bob),g) at {212} in copy a_21094721

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21094721

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21094721

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21094721

out(pub, (~M_21103140,~M_21103141,~M_21103142)) with ~M_21103140 = key_s(charlie), ~M_21103141 = key_e(charlie,alice), ~M_21103142 = key_e(charlie,bob) at {424} in copy a_21094720

out(pub, ~M_21103351) with ~M_21103351 = dhexp(key_s(bob),g) at {319} in copy a_21094720

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21094720

out(pub, ~M_21103698) with ~M_21103698 = dhexp(key_s(bob),g) at {212} in copy a_21094720

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21094720

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21094720

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21094720

out(pub, (~M_21104331,~M_21104332,~M_21104333)) with ~M_21104331 = key_s(charlie), ~M_21104332 = key_e(charlie,alice), ~M_21104333 = key_e(charlie,bob) at {424} in copy a_21094719

out(pub, ~M_21104542) with ~M_21104542 = dhexp(key_s(bob),g) at {319} in copy a_21094719

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21094719

out(pub, ~M_21104889) with ~M_21104889 = dhexp(key_s(bob),g) at {212} in copy a_21094719

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21094719

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21094719

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21094719

out(pub, (~M_21105522,~M_21105523,~M_21105524)) with ~M_21105522 = key_s(charlie), ~M_21105523 = key_e(charlie,alice), ~M_21105524 = key_e(charlie,bob) at {424} in copy a_21094718

out(pub, ~M_21105733) with ~M_21105733 = dhexp(key_s(bob),g) at {319} in copy a_21094718

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21094718

out(pub, ~M_21106080) with ~M_21106080 = dhexp(key_s(bob),g) at {212} in copy a_21094718

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21094718

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21094718

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21094718

out(pub, (~M_21106713,~M_21106714,~M_21106715)) with ~M_21106713 = key_s(charlie), ~M_21106714 = key_e(charlie,alice), ~M_21106715 = key_e(charlie,bob) at {424} in copy a_21094717

out(pub, ~M_21106924) with ~M_21106924 = dhexp(key_s(bob),g) at {319} in copy a_21094717

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21094717

out(pub, ~M_21107271) with ~M_21107271 = dhexp(key_s(bob),g) at {212} in copy a_21094717

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21094717

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21094717

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21094717

out(pub, (~M_21107904,~M_21107905,~M_21107906)) with ~M_21107904 = key_s(charlie), ~M_21107905 = key_e(charlie,alice), ~M_21107906 = key_e(charlie,bob) at {424} in copy a_21094716

out(pub, ~M_21108115) with ~M_21108115 = dhexp(key_s(bob),g) at {319} in copy a_21094716

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21094716

out(pub, ~M_21108462) with ~M_21108462 = dhexp(key_s(bob),g) at {212} in copy a_21094716

event LeakS(phase0,bob) at {312} in copy a_21094716

out(pub, ~M_21108464) with ~M_21108464 = key_s(bob) at {313} in copy a_21094716

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21094716

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21094716

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21094716

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {45} in copy a_21094718

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {42} in copy a_21094718

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {43} in copy a_21094718

out(pub, concat3(~M_21110041,empty,~M_21110043)) with ~M_21110041 = dhexp(key_e(alice,bob),g), ~M_21110043 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {44} in copy a_21094718

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {45} in copy a_21094720

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {42} in copy a_21094720

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {43} in copy a_21094720

out(pub, concat3(~M_21110989,empty,~M_21110991)) with ~M_21110989 = dhexp(key_e(alice,bob),g), ~M_21110991 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {44} in copy a_21094720

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {45} in copy a_21094723

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {42} in copy a_21094723

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {43} in copy a_21094723

out(pub, concat3(~M_21111949,empty,~M_21111951)) with ~M_21111949 = dhexp(key_e(alice,bob),g), ~M_21111951 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {44} in copy a_21094723

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {74} in copy a_21094724

in(pub, concat3(~M_21098587,a_21094715,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_21108464,~M_21110041)),dhexp(~M_21108464,~M_21110041)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21098587),~M_21110041),~M_21110043),~M_21098587),a_21094714))) with ~M_21098587 = dhexp(key_s(bob),g), encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_21108464,~M_21110041)),dhexp(~M_21108464,~M_21110041)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21098587),~M_21110041),~M_21110043),~M_21098587),a_21094714) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),a_21094714) at {46} in copy a_21094724

event RecvMsg(alice,bob,stage_b,a_21094714,true) at {72} in copy a_21094724 (goal)

The event RecvMsg(alice,bob,stage_b,a_21094714,true) is executed.
A trace has been found.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_21112940) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_21112940,true))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,alice),true))
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)) is true.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_21112945) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_21112945,true))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,alice),true))
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) is true.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 1 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {43}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

4. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

5. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 4 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

6. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 3 may be read at get {360}.
The message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) that may be sent on channel pub by 5 may be received at input {332}.
We have dhexp(key_e(alice,bob),g) <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false))) may be inserted in a table at insert {359}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false)))).

7. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false))) that may be in a table by 6 may be read at get {390}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {387}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {389}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

8. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {74}.
The message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) that may be sent on channel pub by 7 may be received at input {46}.
We have dhexp(key_e(bob,charlie),g) <> caught-fail.
So event RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true) may be executed at {72}.
end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true)).


Could not find a trace corresponding to this derivation.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)) cannot be proved.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 1 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {43}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

4. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

5. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 4 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

6. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 3 may be read at get {360}.
The message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) that may be sent on channel pub by 5 may be received at input {332}.
We have dhexp(key_e(alice,bob),g) <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false))) may be inserted in a table at insert {359}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false)))).

7. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false))) that may be in a table by 6 may be read at get {390}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {387}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {389}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

8. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {74}.
The message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) that may be sent on channel pub by 7 may be received at input {46}.
We have dhexp(key_e(bob,charlie),g) <> caught-fail.
So event RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true) may be executed at {72}.
end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true)).


Could not find a trace corresponding to this derivation.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) cannot be proved.
Starting query not attacker_p1(msg_b(bob,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

3. The attacker has some term plaintext_a_21378739.
attacker(plaintext_a_21378739).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_21378739.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)).

16. The attacker has some term b_21378735.
attacker(b_21378735).

17. By 4, the attacker may know g.
By 16, the attacker may know b_21378735.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739).
Using the function concat3 the attacker may obtain concat3(g,b_21378735,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)).
attacker(concat3(g,b_21378735,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739))).

18. By 1, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21378735,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21378735,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 2 may be read at get {253}.
The message concat3(g,b_21378735,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 1, the attacker may have the channel pub.
By 20, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

22. By 21, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

23. By 22, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

24. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

25. The attacker has some term plaintext_a_21378661.
attacker(plaintext_a_21378661).

26. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 25, the attacker may know plaintext_a_21378661.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)).

27. The attacker has some term b_21378657.
attacker(b_21378657).

28. By 4, the attacker may know g.
By 27, the attacker may know b_21378657.
By 26, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661).
Using the function concat3 the attacker may obtain concat3(g,b_21378657,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)).
attacker(concat3(g,b_21378657,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(g,b_21378657,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21378657,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 24 may be read at get {253}.
The message concat3(g,b_21378657,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)) that may be sent on channel pub by 29 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 30 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378661)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g))).

36. By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)).
So the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g))).

37. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

38. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

41. By 40, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
By 37, the attacker may know minnonce in phase 1.
By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)) in phase 1.
By 23, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

42. By 41, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21378739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


Could not find a trace corresponding to this derivation.
RESULT not attacker_p1(msg_b(bob,alice)) cannot be proved.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

3. The attacker has some term plaintext_a_21399999.
attacker(plaintext_a_21399999).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_21399999.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)).

16. The attacker has some term b_21399995.
attacker(b_21399995).

17. By 4, the attacker may know g.
By 16, the attacker may know b_21399995.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999).
Using the function concat3 the attacker may obtain concat3(g,b_21399995,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)).
attacker(concat3(g,b_21399995,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999))).

18. By 1, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21399995,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21399995,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 2 may be read at get {253}.
The message concat3(g,b_21399995,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 1, the attacker may have the channel pub.
By 20, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

22. By 21, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

23. By 22, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

24. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

25. The attacker has some term plaintext_a_21399921.
attacker(plaintext_a_21399921).

26. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 25, the attacker may know plaintext_a_21399921.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)).

27. The attacker has some term b_21399917.
attacker(b_21399917).

28. By 4, the attacker may know g.
By 27, the attacker may know b_21399917.
By 26, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921).
Using the function concat3 the attacker may obtain concat3(g,b_21399917,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)).
attacker(concat3(g,b_21399917,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(g,b_21399917,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21399917,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 24 may be read at get {253}.
The message concat3(g,b_21399917,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)) that may be sent on channel pub by 29 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 30 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399921)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g))).

36. By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)).
So the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g))).

37. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

38. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

41. By 40, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
By 37, the attacker may know minnonce in phase 1.
By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)) in phase 1.
By 23, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

42. By 41, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21399999)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


Could not find a trace corresponding to this derivation.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice)) cannot be proved.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob)))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

3. The attacker has some term plaintext_a_21421260.
attacker(plaintext_a_21421260).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_21421260.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)).

16. The attacker has some term b_21421256.
attacker(b_21421256).

17. By 4, the attacker may know g.
By 16, the attacker may know b_21421256.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260).
Using the function concat3 the attacker may obtain concat3(g,b_21421256,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)).
attacker(concat3(g,b_21421256,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260))).

18. By 1, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21421256,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21421256,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 2 may be read at get {253}.
The message concat3(g,b_21421256,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 1, the attacker may have the channel pub.
By 20, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

22. By 21, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

23. By 22, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

24. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

25. The attacker has some term plaintext_a_21421182.
attacker(plaintext_a_21421182).

26. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 25, the attacker may know plaintext_a_21421182.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)).

27. The attacker has some term b_21421178.
attacker(b_21421178).

28. By 4, the attacker may know g.
By 27, the attacker may know b_21421178.
By 26, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182).
Using the function concat3 the attacker may obtain concat3(g,b_21421178,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)).
attacker(concat3(g,b_21421178,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(g,b_21421178,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21421178,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 24 may be read at get {253}.
The message concat3(g,b_21421178,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)) that may be sent on channel pub by 29 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 30 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421182)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g))).

36. By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)).
So the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g))).

37. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

38. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

41. By 40, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
By 37, the attacker may know minnonce in phase 1.
By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)) in phase 1.
By 23, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

42. By 41, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21421260)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


Could not find a trace corresponding to this derivation.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob))) cannot be proved.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

3. The attacker has some term plaintext_a_21442520.
attacker(plaintext_a_21442520).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_21442520.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)).

16. The attacker has some term b_21442516.
attacker(b_21442516).

17. By 4, the attacker may know g.
By 16, the attacker may know b_21442516.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520).
Using the function concat3 the attacker may obtain concat3(g,b_21442516,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)).
attacker(concat3(g,b_21442516,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520))).

18. By 1, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21442516,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21442516,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 2 may be read at get {253}.
The message concat3(g,b_21442516,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 1, the attacker may have the channel pub.
By 20, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

22. By 21, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

23. By 22, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

24. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

25. The attacker has some term plaintext_a_21442442.
attacker(plaintext_a_21442442).

26. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 25, the attacker may know plaintext_a_21442442.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)).

27. The attacker has some term b_21442438.
attacker(b_21442438).

28. By 4, the attacker may know g.
By 27, the attacker may know b_21442438.
By 26, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442).
Using the function concat3 the attacker may obtain concat3(g,b_21442438,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)).
attacker(concat3(g,b_21442438,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(g,b_21442438,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21442438,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 24 may be read at get {253}.
The message concat3(g,b_21442438,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)) that may be sent on channel pub by 29 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 30 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442442)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g))).

36. By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)).
So the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g))).

37. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

38. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

41. By 40, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
By 37, the attacker may know minnonce in phase 1.
By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)) in phase 1.
By 23, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

42. By 41, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21442520)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


Could not find a trace corresponding to this derivation.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) cannot be proved.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true))
goal reachable: attacker(m_21463667) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21463667,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21463850.
attacker(plaintext_a_21463850).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21463850.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)).

16. The attacker has some term b_21463846.
attacker(b_21463846).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21463846.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850).
Using the function concat3 the attacker may obtain concat3(g,b_21463846,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)).
attacker(concat3(g,b_21463846,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21463846,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21463846,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21463846,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21463885).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21463779.
attacker(b_21463779).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21463779.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850).
Using the function concat3 the attacker may obtain concat3(g,b_21463779,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)).
attacker(concat3(g,b_21463779,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21463779,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21463779,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21463779,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21463707.
attacker(plaintext_a_21463707).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21463707.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)).

33. The attacker has some term b_21463703.
attacker(b_21463703).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21463703.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707).
Using the function concat3 the attacker may obtain concat3(g,b_21463703,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)).
attacker(concat3(g,b_21463703,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21463703,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21463703,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21463703,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463707)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21463885.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21463885).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21463885)).

47. The attacker has some term b_21463871.
attacker(b_21463871).

48. The attacker has some term a_21463870.
attacker(a_21463870).

49. By 48, the attacker may know a_21463870.
By 47, the attacker may know b_21463871.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21463885).
Using the function concat3 the attacker may obtain concat3(a_21463870,b_21463871,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21463885)).
attacker(concat3(a_21463870,b_21463871,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21463885))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21463870,b_21463871,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21463885)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21463870,b_21463871,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21463885))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21463870,b_21463871,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21463850)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21463885)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21463885,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21463885,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21468371,~M_21468372,~M_21468373)) with ~M_21468371 = key_s(charlie), ~M_21468372 = key_e(charlie,alice), ~M_21468373 = key_e(charlie,bob) at {424} in copy a_21463904

out(pub, ~M_21468582) with ~M_21468582 = dhexp(key_s(bob),g) at {319} in copy a_21463904

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463904

out(pub, ~M_21468929) with ~M_21468929 = dhexp(key_s(bob),g) at {212} in copy a_21463904

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463904

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463904

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463904

out(pub, (~M_21469562,~M_21469563,~M_21469564)) with ~M_21469562 = key_s(charlie), ~M_21469563 = key_e(charlie,alice), ~M_21469564 = key_e(charlie,bob) at {424} in copy a_21463903

out(pub, ~M_21469773) with ~M_21469773 = dhexp(key_s(bob),g) at {319} in copy a_21463903

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463903

out(pub, ~M_21470120) with ~M_21470120 = dhexp(key_s(bob),g) at {212} in copy a_21463903

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463903

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463903

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463903

out(pub, (~M_21470753,~M_21470754,~M_21470755)) with ~M_21470753 = key_s(charlie), ~M_21470754 = key_e(charlie,alice), ~M_21470755 = key_e(charlie,bob) at {424} in copy a_21463902

out(pub, ~M_21470964) with ~M_21470964 = dhexp(key_s(bob),g) at {319} in copy a_21463902

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463902

out(pub, ~M_21471311) with ~M_21471311 = dhexp(key_s(bob),g) at {212} in copy a_21463902

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463902

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463902

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463902

out(pub, (~M_21471944,~M_21471945,~M_21471946)) with ~M_21471944 = key_s(charlie), ~M_21471945 = key_e(charlie,alice), ~M_21471946 = key_e(charlie,bob) at {424} in copy a_21463901

out(pub, ~M_21472155) with ~M_21472155 = dhexp(key_s(bob),g) at {319} in copy a_21463901

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463901

out(pub, ~M_21472502) with ~M_21472502 = dhexp(key_s(bob),g) at {212} in copy a_21463901

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463901

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463901

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463901

out(pub, (~M_21473135,~M_21473136,~M_21473137)) with ~M_21473135 = key_s(charlie), ~M_21473136 = key_e(charlie,alice), ~M_21473137 = key_e(charlie,bob) at {424} in copy a_21463900

out(pub, ~M_21473346) with ~M_21473346 = dhexp(key_s(bob),g) at {319} in copy a_21463900

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463900

out(pub, ~M_21473693) with ~M_21473693 = dhexp(key_s(bob),g) at {212} in copy a_21463900

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463900

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463900

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463900

out(pub, (~M_21474326,~M_21474327,~M_21474328)) with ~M_21474326 = key_s(charlie), ~M_21474327 = key_e(charlie,alice), ~M_21474328 = key_e(charlie,bob) at {424} in copy a_21463898

out(pub, ~M_21474537) with ~M_21474537 = dhexp(key_s(bob),g) at {319} in copy a_21463898

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463898

out(pub, ~M_21474884) with ~M_21474884 = dhexp(key_s(bob),g) at {212} in copy a_21463898

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463898

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463898

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463898

out(pub, (~M_21475517,~M_21475518,~M_21475519)) with ~M_21475517 = key_s(charlie), ~M_21475518 = key_e(charlie,alice), ~M_21475519 = key_e(charlie,bob) at {424} in copy a_21463897

out(pub, ~M_21475728) with ~M_21475728 = dhexp(key_s(bob),g) at {319} in copy a_21463897

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463897

out(pub, ~M_21476075) with ~M_21476075 = dhexp(key_s(bob),g) at {212} in copy a_21463897

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463897

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463897

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463897

out(pub, (~M_21476708,~M_21476709,~M_21476710)) with ~M_21476708 = key_s(charlie), ~M_21476709 = key_e(charlie,alice), ~M_21476710 = key_e(charlie,bob) at {424} in copy a_21463896

out(pub, ~M_21476919) with ~M_21476919 = dhexp(key_s(bob),g) at {319} in copy a_21463896

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463896

out(pub, ~M_21477266) with ~M_21477266 = dhexp(key_s(bob),g) at {212} in copy a_21463896

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463896

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463896

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463896

out(pub, (~M_21477899,~M_21477900,~M_21477901)) with ~M_21477899 = key_s(charlie), ~M_21477900 = key_e(charlie,alice), ~M_21477901 = key_e(charlie,bob) at {424} in copy a_21463894

out(pub, ~M_21478110) with ~M_21478110 = dhexp(key_s(bob),g) at {319} in copy a_21463894

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463894

out(pub, ~M_21478457) with ~M_21478457 = dhexp(key_s(bob),g) at {212} in copy a_21463894

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463894

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463894

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463894

out(pub, (~M_21479090,~M_21479091,~M_21479092)) with ~M_21479090 = key_s(charlie), ~M_21479091 = key_e(charlie,alice), ~M_21479092 = key_e(charlie,bob) at {424} in copy a_21463893

out(pub, ~M_21479301) with ~M_21479301 = dhexp(key_s(bob),g) at {319} in copy a_21463893

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463893

out(pub, ~M_21479648) with ~M_21479648 = dhexp(key_s(bob),g) at {212} in copy a_21463893

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463893

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463893

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463893

out(pub, (~M_21480281,~M_21480282,~M_21480283)) with ~M_21480281 = key_s(charlie), ~M_21480282 = key_e(charlie,alice), ~M_21480283 = key_e(charlie,bob) at {424} in copy a_21463892

out(pub, ~M_21480492) with ~M_21480492 = dhexp(key_s(bob),g) at {319} in copy a_21463892

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21463892

out(pub, ~M_21480839) with ~M_21480839 = dhexp(key_s(bob),g) at {212} in copy a_21463892

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21463892

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21463892

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21463892

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21463893

in(pub, concat3(g,a_21463891,encrypt(hmac_hash2(hash(somename,empty),~M_21468582),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),a_21463890))) with encrypt(hmac_hash2(hash(somename,empty),~M_21468582),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),a_21463890) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463890) at {225} in copy a_21463893

event RecvMsg(bob,alice,stage_a,a_21463890,true) at {251} in copy a_21463893

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463890))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21463893

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463890))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21463894

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21463894

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463890)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463890)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21463894

out(pub, concat3(~M_21483397,empty,~M_21483399)) with ~M_21483397 = dhexp(key_e(bob,alice),g), ~M_21483399 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463890)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21463894

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21463897

in(pub, concat3(g,a_21463895,encrypt(hmac_hash2(hash(somename,empty),~M_21468582),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),a_21463889))) with encrypt(hmac_hash2(hash(somename,empty),~M_21468582),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),a_21463889) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889) at {225} in copy a_21463897

event RecvMsg(bob,alice,stage_a,a_21463889,true) at {251} in copy a_21463897

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21463897

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21463898

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21463898

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21463898

out(pub, concat3(~M_21485331,empty,~M_21485333)) with ~M_21485331 = dhexp(key_e(bob,alice),g), ~M_21485333 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21463898

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21463902

in(pub, concat3(g,a_21463899,encrypt(hmac_hash2(hash(somename,empty),~M_21468582),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),a_21463889))) with encrypt(hmac_hash2(hash(somename,empty),~M_21468582),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),a_21463889) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889) at {225} in copy a_21463902

event RecvMsg(bob,alice,stage_a,a_21463889,true) at {251} in copy a_21463902

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21463902

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21463903

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21463903

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21463903

out(pub, concat3(~M_21487277,empty,~M_21487279)) with ~M_21487277 = dhexp(key_e(bob,alice),g), ~M_21487279 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21463903

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21463904

in(pub, concat3(a_21463887,a_21463888,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21468582),~M_21483397),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),encrypt(hmac_hash2(hash(somename,empty),~M_21468582),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),a_21463889)),~M_21483397),~M_21485333),a_21463886))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21468582),~M_21483397),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),encrypt(hmac_hash2(hash(somename,empty),~M_21468582),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21468582),g),a_21463889)),~M_21483397),~M_21485333),a_21463886) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21463889)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21463886) at {284} in copy a_21463904

event RecvMsg(bob,alice,stage_c,a_21463886,true) at {308} in copy a_21463904 (goal)

The event RecvMsg(bob,alice,stage_c,a_21463886,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_21488154) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21488154,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21488338.
attacker(plaintext_a_21488338).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21488338.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)).

16. The attacker has some term b_21488334.
attacker(b_21488334).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21488334.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338).
Using the function concat3 the attacker may obtain concat3(g,b_21488334,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)).
attacker(concat3(g,b_21488334,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21488334,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21488334,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21488334,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21488373).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21488267.
attacker(b_21488267).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21488267.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338).
Using the function concat3 the attacker may obtain concat3(g,b_21488267,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)).
attacker(concat3(g,b_21488267,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21488267,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21488267,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21488267,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21488195.
attacker(plaintext_a_21488195).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21488195.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)).

33. The attacker has some term b_21488191.
attacker(b_21488191).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21488191.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195).
Using the function concat3 the attacker may obtain concat3(g,b_21488191,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)).
attacker(concat3(g,b_21488191,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21488191,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21488191,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21488191,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488195)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21488373.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21488373).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21488373)).

47. The attacker has some term b_21488359.
attacker(b_21488359).

48. The attacker has some term a_21488358.
attacker(a_21488358).

49. By 48, the attacker may know a_21488358.
By 47, the attacker may know b_21488359.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21488373).
Using the function concat3 the attacker may obtain concat3(a_21488358,b_21488359,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21488373)).
attacker(concat3(a_21488358,b_21488359,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21488373))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21488358,b_21488359,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21488373)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21488358,b_21488359,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21488373))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21488358,b_21488359,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21488338)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21488373)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21488373,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21488373,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21492859,~M_21492860,~M_21492861)) with ~M_21492859 = key_s(charlie), ~M_21492860 = key_e(charlie,alice), ~M_21492861 = key_e(charlie,bob) at {424} in copy a_21488392

out(pub, ~M_21493070) with ~M_21493070 = dhexp(key_s(bob),g) at {319} in copy a_21488392

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488392

out(pub, ~M_21493417) with ~M_21493417 = dhexp(key_s(bob),g) at {212} in copy a_21488392

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488392

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488392

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488392

out(pub, (~M_21494050,~M_21494051,~M_21494052)) with ~M_21494050 = key_s(charlie), ~M_21494051 = key_e(charlie,alice), ~M_21494052 = key_e(charlie,bob) at {424} in copy a_21488391

out(pub, ~M_21494261) with ~M_21494261 = dhexp(key_s(bob),g) at {319} in copy a_21488391

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488391

out(pub, ~M_21494608) with ~M_21494608 = dhexp(key_s(bob),g) at {212} in copy a_21488391

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488391

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488391

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488391

out(pub, (~M_21495241,~M_21495242,~M_21495243)) with ~M_21495241 = key_s(charlie), ~M_21495242 = key_e(charlie,alice), ~M_21495243 = key_e(charlie,bob) at {424} in copy a_21488390

out(pub, ~M_21495452) with ~M_21495452 = dhexp(key_s(bob),g) at {319} in copy a_21488390

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488390

out(pub, ~M_21495799) with ~M_21495799 = dhexp(key_s(bob),g) at {212} in copy a_21488390

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488390

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488390

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488390

out(pub, (~M_21496432,~M_21496433,~M_21496434)) with ~M_21496432 = key_s(charlie), ~M_21496433 = key_e(charlie,alice), ~M_21496434 = key_e(charlie,bob) at {424} in copy a_21488389

out(pub, ~M_21496643) with ~M_21496643 = dhexp(key_s(bob),g) at {319} in copy a_21488389

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488389

out(pub, ~M_21496990) with ~M_21496990 = dhexp(key_s(bob),g) at {212} in copy a_21488389

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488389

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488389

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488389

out(pub, (~M_21497623,~M_21497624,~M_21497625)) with ~M_21497623 = key_s(charlie), ~M_21497624 = key_e(charlie,alice), ~M_21497625 = key_e(charlie,bob) at {424} in copy a_21488388

out(pub, ~M_21497834) with ~M_21497834 = dhexp(key_s(bob),g) at {319} in copy a_21488388

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488388

out(pub, ~M_21498181) with ~M_21498181 = dhexp(key_s(bob),g) at {212} in copy a_21488388

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488388

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488388

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488388

out(pub, (~M_21498814,~M_21498815,~M_21498816)) with ~M_21498814 = key_s(charlie), ~M_21498815 = key_e(charlie,alice), ~M_21498816 = key_e(charlie,bob) at {424} in copy a_21488386

out(pub, ~M_21499025) with ~M_21499025 = dhexp(key_s(bob),g) at {319} in copy a_21488386

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488386

out(pub, ~M_21499372) with ~M_21499372 = dhexp(key_s(bob),g) at {212} in copy a_21488386

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488386

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488386

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488386

out(pub, (~M_21500005,~M_21500006,~M_21500007)) with ~M_21500005 = key_s(charlie), ~M_21500006 = key_e(charlie,alice), ~M_21500007 = key_e(charlie,bob) at {424} in copy a_21488385

out(pub, ~M_21500216) with ~M_21500216 = dhexp(key_s(bob),g) at {319} in copy a_21488385

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488385

out(pub, ~M_21500563) with ~M_21500563 = dhexp(key_s(bob),g) at {212} in copy a_21488385

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488385

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488385

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488385

out(pub, (~M_21501196,~M_21501197,~M_21501198)) with ~M_21501196 = key_s(charlie), ~M_21501197 = key_e(charlie,alice), ~M_21501198 = key_e(charlie,bob) at {424} in copy a_21488384

out(pub, ~M_21501407) with ~M_21501407 = dhexp(key_s(bob),g) at {319} in copy a_21488384

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488384

out(pub, ~M_21501754) with ~M_21501754 = dhexp(key_s(bob),g) at {212} in copy a_21488384

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488384

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488384

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488384

out(pub, (~M_21502387,~M_21502388,~M_21502389)) with ~M_21502387 = key_s(charlie), ~M_21502388 = key_e(charlie,alice), ~M_21502389 = key_e(charlie,bob) at {424} in copy a_21488382

out(pub, ~M_21502598) with ~M_21502598 = dhexp(key_s(bob),g) at {319} in copy a_21488382

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488382

out(pub, ~M_21502945) with ~M_21502945 = dhexp(key_s(bob),g) at {212} in copy a_21488382

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488382

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488382

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488382

out(pub, (~M_21503578,~M_21503579,~M_21503580)) with ~M_21503578 = key_s(charlie), ~M_21503579 = key_e(charlie,alice), ~M_21503580 = key_e(charlie,bob) at {424} in copy a_21488381

out(pub, ~M_21503789) with ~M_21503789 = dhexp(key_s(bob),g) at {319} in copy a_21488381

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488381

out(pub, ~M_21504136) with ~M_21504136 = dhexp(key_s(bob),g) at {212} in copy a_21488381

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488381

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488381

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488381

out(pub, (~M_21504769,~M_21504770,~M_21504771)) with ~M_21504769 = key_s(charlie), ~M_21504770 = key_e(charlie,alice), ~M_21504771 = key_e(charlie,bob) at {424} in copy a_21488380

out(pub, ~M_21504980) with ~M_21504980 = dhexp(key_s(bob),g) at {319} in copy a_21488380

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21488380

out(pub, ~M_21505327) with ~M_21505327 = dhexp(key_s(bob),g) at {212} in copy a_21488380

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21488380

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21488380

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21488380

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21488381

in(pub, concat3(g,a_21488379,encrypt(hmac_hash2(hash(somename,empty),~M_21493070),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),a_21488378))) with encrypt(hmac_hash2(hash(somename,empty),~M_21493070),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),a_21488378) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488378) at {225} in copy a_21488381

event RecvMsg(bob,alice,stage_a,a_21488378,true) at {251} in copy a_21488381

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488378))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21488381

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488378))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21488382

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21488382

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488378)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488378)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21488382

out(pub, concat3(~M_21507885,empty,~M_21507887)) with ~M_21507885 = dhexp(key_e(bob,alice),g), ~M_21507887 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488378)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21488382

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21488385

in(pub, concat3(g,a_21488383,encrypt(hmac_hash2(hash(somename,empty),~M_21493070),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),a_21488377))) with encrypt(hmac_hash2(hash(somename,empty),~M_21493070),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),a_21488377) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377) at {225} in copy a_21488385

event RecvMsg(bob,alice,stage_a,a_21488377,true) at {251} in copy a_21488385

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21488385

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21488386

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21488386

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21488386

out(pub, concat3(~M_21509819,empty,~M_21509821)) with ~M_21509819 = dhexp(key_e(bob,alice),g), ~M_21509821 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21488386

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21488390

in(pub, concat3(g,a_21488387,encrypt(hmac_hash2(hash(somename,empty),~M_21493070),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),a_21488377))) with encrypt(hmac_hash2(hash(somename,empty),~M_21493070),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),a_21488377) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377) at {225} in copy a_21488390

event RecvMsg(bob,alice,stage_a,a_21488377,true) at {251} in copy a_21488390

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21488390

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21488391

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21488391

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21488391

out(pub, concat3(~M_21511765,empty,~M_21511767)) with ~M_21511765 = dhexp(key_e(bob,alice),g), ~M_21511767 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21488391

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21488392

in(pub, concat3(a_21488375,a_21488376,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21493070),~M_21507885),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),encrypt(hmac_hash2(hash(somename,empty),~M_21493070),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),a_21488377)),~M_21507885),~M_21509821),a_21488374))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21493070),~M_21507885),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),encrypt(hmac_hash2(hash(somename,empty),~M_21493070),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21493070),g),a_21488377)),~M_21507885),~M_21509821),a_21488374) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21488377)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21488374) at {284} in copy a_21488392

event RecvMsg(bob,alice,stage_c,a_21488374,true) at {308} in copy a_21488392 (goal)

The event RecvMsg(bob,alice,stage_c,a_21488374,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_21512642) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21512642,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21512826.
attacker(plaintext_a_21512826).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21512826.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)).

16. The attacker has some term b_21512822.
attacker(b_21512822).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21512822.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826).
Using the function concat3 the attacker may obtain concat3(g,b_21512822,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)).
attacker(concat3(g,b_21512822,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21512822,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21512822,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21512822,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21512861).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21512755.
attacker(b_21512755).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21512755.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826).
Using the function concat3 the attacker may obtain concat3(g,b_21512755,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)).
attacker(concat3(g,b_21512755,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21512755,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21512755,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21512755,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21512683.
attacker(plaintext_a_21512683).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21512683.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)).

33. The attacker has some term b_21512679.
attacker(b_21512679).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21512679.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683).
Using the function concat3 the attacker may obtain concat3(g,b_21512679,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)).
attacker(concat3(g,b_21512679,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21512679,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21512679,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21512679,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512683)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21512861.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21512861).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21512861)).

47. The attacker has some term b_21512847.
attacker(b_21512847).

48. The attacker has some term a_21512846.
attacker(a_21512846).

49. By 48, the attacker may know a_21512846.
By 47, the attacker may know b_21512847.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21512861).
Using the function concat3 the attacker may obtain concat3(a_21512846,b_21512847,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21512861)).
attacker(concat3(a_21512846,b_21512847,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21512861))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21512846,b_21512847,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21512861)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21512846,b_21512847,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21512861))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21512846,b_21512847,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21512826)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21512861)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21512861,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21512861,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21517347,~M_21517348,~M_21517349)) with ~M_21517347 = key_s(charlie), ~M_21517348 = key_e(charlie,alice), ~M_21517349 = key_e(charlie,bob) at {424} in copy a_21512880

out(pub, ~M_21517558) with ~M_21517558 = dhexp(key_s(bob),g) at {319} in copy a_21512880

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512880

out(pub, ~M_21517905) with ~M_21517905 = dhexp(key_s(bob),g) at {212} in copy a_21512880

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512880

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512880

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512880

out(pub, (~M_21518538,~M_21518539,~M_21518540)) with ~M_21518538 = key_s(charlie), ~M_21518539 = key_e(charlie,alice), ~M_21518540 = key_e(charlie,bob) at {424} in copy a_21512879

out(pub, ~M_21518749) with ~M_21518749 = dhexp(key_s(bob),g) at {319} in copy a_21512879

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512879

out(pub, ~M_21519096) with ~M_21519096 = dhexp(key_s(bob),g) at {212} in copy a_21512879

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512879

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512879

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512879

out(pub, (~M_21519729,~M_21519730,~M_21519731)) with ~M_21519729 = key_s(charlie), ~M_21519730 = key_e(charlie,alice), ~M_21519731 = key_e(charlie,bob) at {424} in copy a_21512878

out(pub, ~M_21519940) with ~M_21519940 = dhexp(key_s(bob),g) at {319} in copy a_21512878

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512878

out(pub, ~M_21520287) with ~M_21520287 = dhexp(key_s(bob),g) at {212} in copy a_21512878

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512878

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512878

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512878

out(pub, (~M_21520920,~M_21520921,~M_21520922)) with ~M_21520920 = key_s(charlie), ~M_21520921 = key_e(charlie,alice), ~M_21520922 = key_e(charlie,bob) at {424} in copy a_21512877

out(pub, ~M_21521131) with ~M_21521131 = dhexp(key_s(bob),g) at {319} in copy a_21512877

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512877

out(pub, ~M_21521478) with ~M_21521478 = dhexp(key_s(bob),g) at {212} in copy a_21512877

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512877

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512877

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512877

out(pub, (~M_21522111,~M_21522112,~M_21522113)) with ~M_21522111 = key_s(charlie), ~M_21522112 = key_e(charlie,alice), ~M_21522113 = key_e(charlie,bob) at {424} in copy a_21512876

out(pub, ~M_21522322) with ~M_21522322 = dhexp(key_s(bob),g) at {319} in copy a_21512876

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512876

out(pub, ~M_21522669) with ~M_21522669 = dhexp(key_s(bob),g) at {212} in copy a_21512876

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512876

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512876

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512876

out(pub, (~M_21523302,~M_21523303,~M_21523304)) with ~M_21523302 = key_s(charlie), ~M_21523303 = key_e(charlie,alice), ~M_21523304 = key_e(charlie,bob) at {424} in copy a_21512874

out(pub, ~M_21523513) with ~M_21523513 = dhexp(key_s(bob),g) at {319} in copy a_21512874

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512874

out(pub, ~M_21523860) with ~M_21523860 = dhexp(key_s(bob),g) at {212} in copy a_21512874

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512874

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512874

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512874

out(pub, (~M_21524493,~M_21524494,~M_21524495)) with ~M_21524493 = key_s(charlie), ~M_21524494 = key_e(charlie,alice), ~M_21524495 = key_e(charlie,bob) at {424} in copy a_21512873

out(pub, ~M_21524704) with ~M_21524704 = dhexp(key_s(bob),g) at {319} in copy a_21512873

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512873

out(pub, ~M_21525051) with ~M_21525051 = dhexp(key_s(bob),g) at {212} in copy a_21512873

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512873

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512873

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512873

out(pub, (~M_21525684,~M_21525685,~M_21525686)) with ~M_21525684 = key_s(charlie), ~M_21525685 = key_e(charlie,alice), ~M_21525686 = key_e(charlie,bob) at {424} in copy a_21512872

out(pub, ~M_21525895) with ~M_21525895 = dhexp(key_s(bob),g) at {319} in copy a_21512872

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512872

out(pub, ~M_21526242) with ~M_21526242 = dhexp(key_s(bob),g) at {212} in copy a_21512872

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512872

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512872

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512872

out(pub, (~M_21526875,~M_21526876,~M_21526877)) with ~M_21526875 = key_s(charlie), ~M_21526876 = key_e(charlie,alice), ~M_21526877 = key_e(charlie,bob) at {424} in copy a_21512870

out(pub, ~M_21527086) with ~M_21527086 = dhexp(key_s(bob),g) at {319} in copy a_21512870

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512870

out(pub, ~M_21527433) with ~M_21527433 = dhexp(key_s(bob),g) at {212} in copy a_21512870

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512870

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512870

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512870

out(pub, (~M_21528066,~M_21528067,~M_21528068)) with ~M_21528066 = key_s(charlie), ~M_21528067 = key_e(charlie,alice), ~M_21528068 = key_e(charlie,bob) at {424} in copy a_21512869

out(pub, ~M_21528277) with ~M_21528277 = dhexp(key_s(bob),g) at {319} in copy a_21512869

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512869

out(pub, ~M_21528624) with ~M_21528624 = dhexp(key_s(bob),g) at {212} in copy a_21512869

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512869

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512869

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512869

out(pub, (~M_21529257,~M_21529258,~M_21529259)) with ~M_21529257 = key_s(charlie), ~M_21529258 = key_e(charlie,alice), ~M_21529259 = key_e(charlie,bob) at {424} in copy a_21512868

out(pub, ~M_21529468) with ~M_21529468 = dhexp(key_s(bob),g) at {319} in copy a_21512868

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21512868

out(pub, ~M_21529815) with ~M_21529815 = dhexp(key_s(bob),g) at {212} in copy a_21512868

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21512868

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21512868

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21512868

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21512869

in(pub, concat3(g,a_21512867,encrypt(hmac_hash2(hash(somename,empty),~M_21517558),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),a_21512866))) with encrypt(hmac_hash2(hash(somename,empty),~M_21517558),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),a_21512866) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512866) at {225} in copy a_21512869

event RecvMsg(bob,alice,stage_a,a_21512866,true) at {251} in copy a_21512869

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512866))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21512869

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512866))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21512870

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21512870

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512866)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512866)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21512870

out(pub, concat3(~M_21532373,empty,~M_21532375)) with ~M_21532373 = dhexp(key_e(bob,alice),g), ~M_21532375 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512866)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21512870

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21512873

in(pub, concat3(g,a_21512871,encrypt(hmac_hash2(hash(somename,empty),~M_21517558),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),a_21512865))) with encrypt(hmac_hash2(hash(somename,empty),~M_21517558),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),a_21512865) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865) at {225} in copy a_21512873

event RecvMsg(bob,alice,stage_a,a_21512865,true) at {251} in copy a_21512873

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21512873

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21512874

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21512874

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21512874

out(pub, concat3(~M_21534307,empty,~M_21534309)) with ~M_21534307 = dhexp(key_e(bob,alice),g), ~M_21534309 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21512874

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21512878

in(pub, concat3(g,a_21512875,encrypt(hmac_hash2(hash(somename,empty),~M_21517558),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),a_21512865))) with encrypt(hmac_hash2(hash(somename,empty),~M_21517558),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),a_21512865) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865) at {225} in copy a_21512878

event RecvMsg(bob,alice,stage_a,a_21512865,true) at {251} in copy a_21512878

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21512878

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21512879

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21512879

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21512879

out(pub, concat3(~M_21536253,empty,~M_21536255)) with ~M_21536253 = dhexp(key_e(bob,alice),g), ~M_21536255 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21512879

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21512880

in(pub, concat3(a_21512863,a_21512864,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21517558),~M_21532373),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),encrypt(hmac_hash2(hash(somename,empty),~M_21517558),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),a_21512865)),~M_21532373),~M_21534309),a_21512862))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21517558),~M_21532373),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),encrypt(hmac_hash2(hash(somename,empty),~M_21517558),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21517558),g),a_21512865)),~M_21532373),~M_21534309),a_21512862) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21512865)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21512862) at {284} in copy a_21512880

event RecvMsg(bob,alice,stage_c,a_21512862,true) at {308} in copy a_21512880 (goal)

The event RecvMsg(bob,alice,stage_c,a_21512862,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_21537130) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21537130,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21537313.
attacker(plaintext_a_21537313).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21537313.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)).

16. The attacker has some term b_21537309.
attacker(b_21537309).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21537309.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313).
Using the function concat3 the attacker may obtain concat3(g,b_21537309,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)).
attacker(concat3(g,b_21537309,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21537309,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21537309,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21537309,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21537348).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21537242.
attacker(b_21537242).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21537242.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313).
Using the function concat3 the attacker may obtain concat3(g,b_21537242,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)).
attacker(concat3(g,b_21537242,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21537242,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21537242,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21537242,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21537170.
attacker(plaintext_a_21537170).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21537170.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)).

33. The attacker has some term b_21537166.
attacker(b_21537166).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21537166.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170).
Using the function concat3 the attacker may obtain concat3(g,b_21537166,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)).
attacker(concat3(g,b_21537166,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21537166,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21537166,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21537166,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537170)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21537348.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21537348).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21537348)).

47. The attacker has some term b_21537334.
attacker(b_21537334).

48. The attacker has some term a_21537333.
attacker(a_21537333).

49. By 48, the attacker may know a_21537333.
By 47, the attacker may know b_21537334.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21537348).
Using the function concat3 the attacker may obtain concat3(a_21537333,b_21537334,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21537348)).
attacker(concat3(a_21537333,b_21537334,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21537348))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21537333,b_21537334,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21537348)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21537333,b_21537334,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21537348))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21537333,b_21537334,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21537313)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21537348)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21537348,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21537348,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21541834,~M_21541835,~M_21541836)) with ~M_21541834 = key_s(charlie), ~M_21541835 = key_e(charlie,alice), ~M_21541836 = key_e(charlie,bob) at {424} in copy a_21537367

out(pub, ~M_21542045) with ~M_21542045 = dhexp(key_s(bob),g) at {319} in copy a_21537367

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537367

out(pub, ~M_21542392) with ~M_21542392 = dhexp(key_s(bob),g) at {212} in copy a_21537367

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537367

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537367

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537367

out(pub, (~M_21543025,~M_21543026,~M_21543027)) with ~M_21543025 = key_s(charlie), ~M_21543026 = key_e(charlie,alice), ~M_21543027 = key_e(charlie,bob) at {424} in copy a_21537366

out(pub, ~M_21543236) with ~M_21543236 = dhexp(key_s(bob),g) at {319} in copy a_21537366

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537366

out(pub, ~M_21543583) with ~M_21543583 = dhexp(key_s(bob),g) at {212} in copy a_21537366

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537366

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537366

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537366

out(pub, (~M_21544216,~M_21544217,~M_21544218)) with ~M_21544216 = key_s(charlie), ~M_21544217 = key_e(charlie,alice), ~M_21544218 = key_e(charlie,bob) at {424} in copy a_21537365

out(pub, ~M_21544427) with ~M_21544427 = dhexp(key_s(bob),g) at {319} in copy a_21537365

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537365

out(pub, ~M_21544774) with ~M_21544774 = dhexp(key_s(bob),g) at {212} in copy a_21537365

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537365

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537365

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537365

out(pub, (~M_21545407,~M_21545408,~M_21545409)) with ~M_21545407 = key_s(charlie), ~M_21545408 = key_e(charlie,alice), ~M_21545409 = key_e(charlie,bob) at {424} in copy a_21537364

out(pub, ~M_21545618) with ~M_21545618 = dhexp(key_s(bob),g) at {319} in copy a_21537364

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537364

out(pub, ~M_21545965) with ~M_21545965 = dhexp(key_s(bob),g) at {212} in copy a_21537364

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537364

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537364

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537364

out(pub, (~M_21546598,~M_21546599,~M_21546600)) with ~M_21546598 = key_s(charlie), ~M_21546599 = key_e(charlie,alice), ~M_21546600 = key_e(charlie,bob) at {424} in copy a_21537363

out(pub, ~M_21546809) with ~M_21546809 = dhexp(key_s(bob),g) at {319} in copy a_21537363

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537363

out(pub, ~M_21547156) with ~M_21547156 = dhexp(key_s(bob),g) at {212} in copy a_21537363

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537363

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537363

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537363

out(pub, (~M_21547789,~M_21547790,~M_21547791)) with ~M_21547789 = key_s(charlie), ~M_21547790 = key_e(charlie,alice), ~M_21547791 = key_e(charlie,bob) at {424} in copy a_21537361

out(pub, ~M_21548000) with ~M_21548000 = dhexp(key_s(bob),g) at {319} in copy a_21537361

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537361

out(pub, ~M_21548347) with ~M_21548347 = dhexp(key_s(bob),g) at {212} in copy a_21537361

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537361

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537361

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537361

out(pub, (~M_21548980,~M_21548981,~M_21548982)) with ~M_21548980 = key_s(charlie), ~M_21548981 = key_e(charlie,alice), ~M_21548982 = key_e(charlie,bob) at {424} in copy a_21537360

out(pub, ~M_21549191) with ~M_21549191 = dhexp(key_s(bob),g) at {319} in copy a_21537360

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537360

out(pub, ~M_21549538) with ~M_21549538 = dhexp(key_s(bob),g) at {212} in copy a_21537360

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537360

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537360

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537360

out(pub, (~M_21550171,~M_21550172,~M_21550173)) with ~M_21550171 = key_s(charlie), ~M_21550172 = key_e(charlie,alice), ~M_21550173 = key_e(charlie,bob) at {424} in copy a_21537359

out(pub, ~M_21550382) with ~M_21550382 = dhexp(key_s(bob),g) at {319} in copy a_21537359

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537359

out(pub, ~M_21550729) with ~M_21550729 = dhexp(key_s(bob),g) at {212} in copy a_21537359

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537359

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537359

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537359

out(pub, (~M_21551362,~M_21551363,~M_21551364)) with ~M_21551362 = key_s(charlie), ~M_21551363 = key_e(charlie,alice), ~M_21551364 = key_e(charlie,bob) at {424} in copy a_21537357

out(pub, ~M_21551573) with ~M_21551573 = dhexp(key_s(bob),g) at {319} in copy a_21537357

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537357

out(pub, ~M_21551920) with ~M_21551920 = dhexp(key_s(bob),g) at {212} in copy a_21537357

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537357

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537357

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537357

out(pub, (~M_21552553,~M_21552554,~M_21552555)) with ~M_21552553 = key_s(charlie), ~M_21552554 = key_e(charlie,alice), ~M_21552555 = key_e(charlie,bob) at {424} in copy a_21537356

out(pub, ~M_21552764) with ~M_21552764 = dhexp(key_s(bob),g) at {319} in copy a_21537356

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537356

out(pub, ~M_21553111) with ~M_21553111 = dhexp(key_s(bob),g) at {212} in copy a_21537356

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537356

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537356

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537356

out(pub, (~M_21553744,~M_21553745,~M_21553746)) with ~M_21553744 = key_s(charlie), ~M_21553745 = key_e(charlie,alice), ~M_21553746 = key_e(charlie,bob) at {424} in copy a_21537355

out(pub, ~M_21553955) with ~M_21553955 = dhexp(key_s(bob),g) at {319} in copy a_21537355

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21537355

out(pub, ~M_21554302) with ~M_21554302 = dhexp(key_s(bob),g) at {212} in copy a_21537355

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21537355

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21537355

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21537355

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21537356

in(pub, concat3(g,a_21537354,encrypt(hmac_hash2(hash(somename,empty),~M_21542045),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),a_21537353))) with encrypt(hmac_hash2(hash(somename,empty),~M_21542045),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),a_21537353) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537353) at {225} in copy a_21537356

event RecvMsg(bob,alice,stage_a,a_21537353,true) at {251} in copy a_21537356

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537353))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21537356

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537353))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21537357

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21537357

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537353)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537353)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21537357

out(pub, concat3(~M_21556860,empty,~M_21556862)) with ~M_21556860 = dhexp(key_e(bob,alice),g), ~M_21556862 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537353)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21537357

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21537360

in(pub, concat3(g,a_21537358,encrypt(hmac_hash2(hash(somename,empty),~M_21542045),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),a_21537352))) with encrypt(hmac_hash2(hash(somename,empty),~M_21542045),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),a_21537352) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352) at {225} in copy a_21537360

event RecvMsg(bob,alice,stage_a,a_21537352,true) at {251} in copy a_21537360

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21537360

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21537361

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21537361

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21537361

out(pub, concat3(~M_21558794,empty,~M_21558796)) with ~M_21558794 = dhexp(key_e(bob,alice),g), ~M_21558796 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21537361

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21537365

in(pub, concat3(g,a_21537362,encrypt(hmac_hash2(hash(somename,empty),~M_21542045),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),a_21537352))) with encrypt(hmac_hash2(hash(somename,empty),~M_21542045),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),a_21537352) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352) at {225} in copy a_21537365

event RecvMsg(bob,alice,stage_a,a_21537352,true) at {251} in copy a_21537365

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21537365

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21537366

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21537366

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21537366

out(pub, concat3(~M_21560740,empty,~M_21560742)) with ~M_21560740 = dhexp(key_e(bob,alice),g), ~M_21560742 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21537366

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21537367

in(pub, concat3(a_21537350,a_21537351,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21542045),~M_21556860),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),encrypt(hmac_hash2(hash(somename,empty),~M_21542045),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),a_21537352)),~M_21556860),~M_21558796),a_21537349))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21542045),~M_21556860),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),encrypt(hmac_hash2(hash(somename,empty),~M_21542045),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21542045),g),a_21537352)),~M_21556860),~M_21558796),a_21537349) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21537352)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21537349) at {284} in copy a_21537367

event RecvMsg(bob,alice,stage_c,a_21537349,true) at {308} in copy a_21537367 (goal)

The event RecvMsg(bob,alice,stage_c,a_21537349,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_21561617) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21561617,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21561800.
attacker(plaintext_a_21561800).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21561800.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)).

16. The attacker has some term b_21561796.
attacker(b_21561796).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21561796.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800).
Using the function concat3 the attacker may obtain concat3(g,b_21561796,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)).
attacker(concat3(g,b_21561796,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21561796,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21561796,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21561796,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21561835).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21561729.
attacker(b_21561729).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21561729.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800).
Using the function concat3 the attacker may obtain concat3(g,b_21561729,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)).
attacker(concat3(g,b_21561729,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21561729,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21561729,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21561729,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21561657.
attacker(plaintext_a_21561657).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21561657.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)).

33. The attacker has some term b_21561653.
attacker(b_21561653).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21561653.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657).
Using the function concat3 the attacker may obtain concat3(g,b_21561653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)).
attacker(concat3(g,b_21561653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21561653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21561653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21561653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561657)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21561835.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21561835).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21561835)).

47. The attacker has some term b_21561821.
attacker(b_21561821).

48. The attacker has some term a_21561820.
attacker(a_21561820).

49. By 48, the attacker may know a_21561820.
By 47, the attacker may know b_21561821.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21561835).
Using the function concat3 the attacker may obtain concat3(a_21561820,b_21561821,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21561835)).
attacker(concat3(a_21561820,b_21561821,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21561835))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21561820,b_21561821,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21561835)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21561820,b_21561821,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21561835))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21561820,b_21561821,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21561800)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21561835)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21561835,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21561835,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21566321,~M_21566322,~M_21566323)) with ~M_21566321 = key_s(charlie), ~M_21566322 = key_e(charlie,alice), ~M_21566323 = key_e(charlie,bob) at {424} in copy a_21561854

out(pub, ~M_21566532) with ~M_21566532 = dhexp(key_s(bob),g) at {319} in copy a_21561854

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561854

out(pub, ~M_21566879) with ~M_21566879 = dhexp(key_s(bob),g) at {212} in copy a_21561854

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561854

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561854

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561854

out(pub, (~M_21567512,~M_21567513,~M_21567514)) with ~M_21567512 = key_s(charlie), ~M_21567513 = key_e(charlie,alice), ~M_21567514 = key_e(charlie,bob) at {424} in copy a_21561853

out(pub, ~M_21567723) with ~M_21567723 = dhexp(key_s(bob),g) at {319} in copy a_21561853

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561853

out(pub, ~M_21568070) with ~M_21568070 = dhexp(key_s(bob),g) at {212} in copy a_21561853

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561853

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561853

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561853

out(pub, (~M_21568703,~M_21568704,~M_21568705)) with ~M_21568703 = key_s(charlie), ~M_21568704 = key_e(charlie,alice), ~M_21568705 = key_e(charlie,bob) at {424} in copy a_21561852

out(pub, ~M_21568914) with ~M_21568914 = dhexp(key_s(bob),g) at {319} in copy a_21561852

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561852

out(pub, ~M_21569261) with ~M_21569261 = dhexp(key_s(bob),g) at {212} in copy a_21561852

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561852

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561852

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561852

out(pub, (~M_21569894,~M_21569895,~M_21569896)) with ~M_21569894 = key_s(charlie), ~M_21569895 = key_e(charlie,alice), ~M_21569896 = key_e(charlie,bob) at {424} in copy a_21561851

out(pub, ~M_21570105) with ~M_21570105 = dhexp(key_s(bob),g) at {319} in copy a_21561851

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561851

out(pub, ~M_21570452) with ~M_21570452 = dhexp(key_s(bob),g) at {212} in copy a_21561851

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561851

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561851

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561851

out(pub, (~M_21571085,~M_21571086,~M_21571087)) with ~M_21571085 = key_s(charlie), ~M_21571086 = key_e(charlie,alice), ~M_21571087 = key_e(charlie,bob) at {424} in copy a_21561850

out(pub, ~M_21571296) with ~M_21571296 = dhexp(key_s(bob),g) at {319} in copy a_21561850

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561850

out(pub, ~M_21571643) with ~M_21571643 = dhexp(key_s(bob),g) at {212} in copy a_21561850

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561850

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561850

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561850

out(pub, (~M_21572276,~M_21572277,~M_21572278)) with ~M_21572276 = key_s(charlie), ~M_21572277 = key_e(charlie,alice), ~M_21572278 = key_e(charlie,bob) at {424} in copy a_21561848

out(pub, ~M_21572487) with ~M_21572487 = dhexp(key_s(bob),g) at {319} in copy a_21561848

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561848

out(pub, ~M_21572834) with ~M_21572834 = dhexp(key_s(bob),g) at {212} in copy a_21561848

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561848

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561848

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561848

out(pub, (~M_21573467,~M_21573468,~M_21573469)) with ~M_21573467 = key_s(charlie), ~M_21573468 = key_e(charlie,alice), ~M_21573469 = key_e(charlie,bob) at {424} in copy a_21561847

out(pub, ~M_21573678) with ~M_21573678 = dhexp(key_s(bob),g) at {319} in copy a_21561847

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561847

out(pub, ~M_21574025) with ~M_21574025 = dhexp(key_s(bob),g) at {212} in copy a_21561847

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561847

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561847

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561847

out(pub, (~M_21574658,~M_21574659,~M_21574660)) with ~M_21574658 = key_s(charlie), ~M_21574659 = key_e(charlie,alice), ~M_21574660 = key_e(charlie,bob) at {424} in copy a_21561846

out(pub, ~M_21574869) with ~M_21574869 = dhexp(key_s(bob),g) at {319} in copy a_21561846

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561846

out(pub, ~M_21575216) with ~M_21575216 = dhexp(key_s(bob),g) at {212} in copy a_21561846

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561846

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561846

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561846

out(pub, (~M_21575849,~M_21575850,~M_21575851)) with ~M_21575849 = key_s(charlie), ~M_21575850 = key_e(charlie,alice), ~M_21575851 = key_e(charlie,bob) at {424} in copy a_21561844

out(pub, ~M_21576060) with ~M_21576060 = dhexp(key_s(bob),g) at {319} in copy a_21561844

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561844

out(pub, ~M_21576407) with ~M_21576407 = dhexp(key_s(bob),g) at {212} in copy a_21561844

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561844

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561844

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561844

out(pub, (~M_21577040,~M_21577041,~M_21577042)) with ~M_21577040 = key_s(charlie), ~M_21577041 = key_e(charlie,alice), ~M_21577042 = key_e(charlie,bob) at {424} in copy a_21561843

out(pub, ~M_21577251) with ~M_21577251 = dhexp(key_s(bob),g) at {319} in copy a_21561843

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561843

out(pub, ~M_21577598) with ~M_21577598 = dhexp(key_s(bob),g) at {212} in copy a_21561843

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561843

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561843

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561843

out(pub, (~M_21578231,~M_21578232,~M_21578233)) with ~M_21578231 = key_s(charlie), ~M_21578232 = key_e(charlie,alice), ~M_21578233 = key_e(charlie,bob) at {424} in copy a_21561842

out(pub, ~M_21578442) with ~M_21578442 = dhexp(key_s(bob),g) at {319} in copy a_21561842

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21561842

out(pub, ~M_21578789) with ~M_21578789 = dhexp(key_s(bob),g) at {212} in copy a_21561842

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21561842

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21561842

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21561842

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21561843

in(pub, concat3(g,a_21561841,encrypt(hmac_hash2(hash(somename,empty),~M_21566532),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),a_21561840))) with encrypt(hmac_hash2(hash(somename,empty),~M_21566532),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),a_21561840) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561840) at {225} in copy a_21561843

event RecvMsg(bob,alice,stage_a,a_21561840,true) at {251} in copy a_21561843

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561840))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21561843

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561840))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21561844

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21561844

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561840)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561840)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21561844

out(pub, concat3(~M_21581347,empty,~M_21581349)) with ~M_21581347 = dhexp(key_e(bob,alice),g), ~M_21581349 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561840)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21561844

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21561847

in(pub, concat3(g,a_21561845,encrypt(hmac_hash2(hash(somename,empty),~M_21566532),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),a_21561839))) with encrypt(hmac_hash2(hash(somename,empty),~M_21566532),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),a_21561839) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839) at {225} in copy a_21561847

event RecvMsg(bob,alice,stage_a,a_21561839,true) at {251} in copy a_21561847

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21561847

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21561848

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21561848

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21561848

out(pub, concat3(~M_21583281,empty,~M_21583283)) with ~M_21583281 = dhexp(key_e(bob,alice),g), ~M_21583283 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21561848

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21561852

in(pub, concat3(g,a_21561849,encrypt(hmac_hash2(hash(somename,empty),~M_21566532),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),a_21561839))) with encrypt(hmac_hash2(hash(somename,empty),~M_21566532),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),a_21561839) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839) at {225} in copy a_21561852

event RecvMsg(bob,alice,stage_a,a_21561839,true) at {251} in copy a_21561852

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21561852

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21561853

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21561853

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21561853

out(pub, concat3(~M_21585227,empty,~M_21585229)) with ~M_21585227 = dhexp(key_e(bob,alice),g), ~M_21585229 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21561853

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21561854

in(pub, concat3(a_21561837,a_21561838,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21566532),~M_21581347),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),encrypt(hmac_hash2(hash(somename,empty),~M_21566532),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),a_21561839)),~M_21581347),~M_21583283),a_21561836))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21566532),~M_21581347),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),encrypt(hmac_hash2(hash(somename,empty),~M_21566532),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21566532),g),a_21561839)),~M_21581347),~M_21583283),a_21561836) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21561839)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21561836) at {284} in copy a_21561854

event RecvMsg(bob,alice,stage_c,a_21561836,true) at {308} in copy a_21561854 (goal)

The event RecvMsg(bob,alice,stage_c,a_21561836,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query not attacker_p1(msg_c(alice,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {43}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

4. The attacker has some term plaintext_b_21586265.
attacker(plaintext_b_21586265).

5. Using the function g the attacker may obtain g.
attacker(g).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 6 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 1, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

11. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 10 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

12. By 1, the attacker may have the channel pub.
By 11, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

13. By 12, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

14. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

15. By 1, the attacker may have the channel pub.
By 14, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

16. Using the function empty the attacker may obtain empty.
attacker(empty).

17. Using the function somename the attacker may obtain somename.
attacker(somename).

18. By 17, the attacker may know somename.
By 16, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

19. By 18, the attacker may know hash(somename,empty).
By 16, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

20. By 19, the attacker may know hash(hash(somename,empty),empty).
By 15, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

21. By 20, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

22. By 21, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

23. By 22, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 5, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

24. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

25. The event LeakS(phase0,bob) may be executed at {312}.
So the message key_s(bob) may be sent on channel pub at output {313}.
mess(pub,key_s(bob)).

26. By 1, the attacker may have the channel pub.
By 25, the message key_s(bob) may be sent on this channel.
So the attacker may obtain the message key_s(bob) by listening on this channel.
attacker(key_s(bob)).

27. By 26, the attacker may know key_s(bob).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function dhexp the attacker may obtain dhexp(key_s(bob),dhexp(key_e(alice,bob),g)).
attacker(dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).

28. By 18, the attacker may know hash(somename,empty).
By 27, the attacker may know dhexp(key_s(bob),dhexp(key_e(alice,bob),g)).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g)))).

29. By 28, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g))).

30. By 29, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
By 24, the attacker may know minnonce.
By 23, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 4, the attacker may know plaintext_b_21586265.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)).

31. The attacker has some term b_21586261.
attacker(b_21586261).

32. By 5, the attacker may know g.
By 31, the attacker may know b_21586261.
By 30, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265).
Using the function concat3 the attacker may obtain concat3(g,b_21586261,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)).
attacker(concat3(g,b_21586261,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265))).

33. By 1, the attacker may have the channel pub.
By 32, the attacker may have the message concat3(g,b_21586261,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21586261,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265))).

34. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 3 may be read at get {74}.
The message concat3(g,b_21586261,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)) that may be sent on channel pub by 33 may be received at input {46}.
We have g <> caught-fail.
So the entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true))) may be inserted in a table at insert {73}.
table(statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true)))).

35. The entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true))) that may be in a table by 34 may be read at get {100}.
The event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) may be executed at {97}.
So the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob))) may be sent on channel pub at output {99}.
mess(pub,concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob)))).

36. By 1, the attacker may have the channel pub.
By 35, the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob))) by listening on this channel.
attacker(concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob)))).

37. By 36, the attacker may know concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob))).

38. By 37, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob))).

39. By 23, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 30, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265))).

40. By 39, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)).
So the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265))).

41. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

42. By 41, the attacker may know minnonce in phase 1.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce) in phase 1.
attacker_p1(increment_nonce(minnonce)).

43. By 29, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g))).

44. By 43, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)) in phase 1.
By 42, the attacker may know increment_nonce(minnonce) in phase 1.
By 40, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)) in phase 1.
By 38, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob))).

45. By 44, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21586265)),msg_c(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_c(alice,bob) in phase 1.
attacker_p1(msg_c(alice,bob)).


Could not find a trace corresponding to this derivation.
RESULT not attacker_p1(msg_c(alice,bob)) cannot be proved.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)) is true.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice)))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))) is true.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) is true.
