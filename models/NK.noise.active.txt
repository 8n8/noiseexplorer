File "NK.noise.active.pv", line 265, character 7 - line 265, character 8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 274, character 7 - line 274, character 8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 275, character 7 - line 275, character 8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 275, character 36 - line 275, character 36:
Warning: identifier h rebound.
File "NK.noise.active.pv", line 284, character 7 - line 284, character 8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 285, character 6 - line 285, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 290, character 7 - line 290, character 8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 291, character 6 - line 291, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 305, character 6 - line 305, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 310, character 6 - line 310, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 316, character 6 - line 316, character 6:
Warning: identifier e rebound.
File "NK.noise.active.pv", line 317, character 6 - line 317, character 7:
Warning: identifier ne rebound.
File "NK.noise.active.pv", line 318, character 6 - line 318, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 320, character 6 - line 320, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 321, character 7 - line 321, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 321, character 26 - line 321, character 36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 322, character 6 - line 322, character 7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 329, character 6 - line 329, character 6:
Warning: identifier e rebound.
File "NK.noise.active.pv", line 330, character 6 - line 330, character 7:
Warning: identifier ne rebound.
File "NK.noise.active.pv", line 331, character 6 - line 331, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 333, character 6 - line 333, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 334, character 7 - line 334, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 334, character 26 - line 334, character 36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 335, character 6 - line 335, character 7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 342, character 7 - line 342, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 342, character 26 - line 342, character 36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 343, character 6 - line 343, character 7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 352, character 6 - line 352, character 7:
Warning: identifier re rebound.
File "NK.noise.active.pv", line 353, character 6 - line 353, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 355, character 6 - line 355, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 356, character 7 - line 356, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 358, character 7 - line 358, character 8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 366, character 6 - line 366, character 7:
Warning: identifier re rebound.
File "NK.noise.active.pv", line 367, character 6 - line 367, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 369, character 6 - line 369, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 370, character 7 - line 370, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 372, character 7 - line 372, character 8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 380, character 7 - line 380, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 382, character 7 - line 382, character 8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 503, character 8 - line 503, character 9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 342, character 7 - line 342, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 342, character 26 - line 342, character 36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 343, character 6 - line 343, character 7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 284, character 7 - line 284, character 8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 285, character 6 - line 285, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 496, character 8 - line 496, character 9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 366, character 6 - line 366, character 7:
Warning: identifier re rebound.
File "NK.noise.active.pv", line 367, character 6 - line 367, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 369, character 6 - line 369, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 370, character 7 - line 370, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 372, character 7 - line 372, character 8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 265, character 7 - line 265, character 8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 290, character 7 - line 290, character 8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 291, character 6 - line 291, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 488, character 8 - line 488, character 9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 316, character 6 - line 316, character 6:
Warning: identifier e rebound.
File "NK.noise.active.pv", line 317, character 6 - line 317, character 7:
Warning: identifier ne rebound.
File "NK.noise.active.pv", line 318, character 6 - line 318, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 320, character 6 - line 320, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 321, character 7 - line 321, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 321, character 26 - line 321, character 36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 322, character 6 - line 322, character 7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 265, character 7 - line 265, character 8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 284, character 7 - line 284, character 8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 285, character 6 - line 285, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 305, character 6 - line 305, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 546, character 8 - line 546, character 9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 380, character 7 - line 380, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 382, character 7 - line 382, character 8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 290, character 7 - line 290, character 8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 291, character 6 - line 291, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 538, character 8 - line 538, character 9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 329, character 6 - line 329, character 6:
Warning: identifier e rebound.
File "NK.noise.active.pv", line 330, character 6 - line 330, character 7:
Warning: identifier ne rebound.
File "NK.noise.active.pv", line 331, character 6 - line 331, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 333, character 6 - line 333, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 334, character 7 - line 334, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 334, character 26 - line 334, character 36:
Warning: identifier ciphertext2 rebound.
File "NK.noise.active.pv", line 335, character 6 - line 335, character 7:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 265, character 7 - line 265, character 8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 284, character 7 - line 284, character 8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 285, character 6 - line 285, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 531, character 8 - line 531, character 9:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 352, character 6 - line 352, character 7:
Warning: identifier re rebound.
File "NK.noise.active.pv", line 353, character 6 - line 353, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 355, character 6 - line 355, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 356, character 7 - line 356, character 8:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 358, character 7 - line 358, character 8:
Warning: identifier hs rebound.
File "NK.noise.active.pv", line 265, character 7 - line 265, character 8:
Warning: identifier ck rebound.
File "NK.noise.active.pv", line 290, character 7 - line 290, character 8:
Warning: identifier cs rebound.
File "NK.noise.active.pv", line 291, character 6 - line 291, character 7:
Warning: identifier ss rebound.
File "NK.noise.active.pv", line 310, character 6 - line 310, character 7:
Warning: identifier ss rebound.
Linear part:
dhexp(b_49,dhexp(a_48,g)) = dhexp(a_48,dhexp(b_49,g))
Completing equations...
Completed equations:
dhexp(b_49,dhexp(a_48,g)) = dhexp(a_48,dhexp(b_49,g))
Convergent part:
Completing equations...
Completed equations:
Process:
{1}!
(
    {2}let s_487: keypair = keypairpack(empty,empty) in
    (
        {3}let e_488: keypair = keypairpack(empty,empty) in
        {4}let v_489: key = catch-fail(dhexp(key_s(bob),g)) in
        {5}let rs_490: key = getpublickey((if not-caught-fail(v_489) then keypairpack(v_489,key_s(bob)) else fail-any)) in
        {6}let re_491: key = empty in
        {7}let v_492: bitstring = catch-fail(hash(somename,empty)) in
        {8}let v_493: key = catch-fail(v_492) in
        {9}let v_494: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {10}let v_495: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_492) then (if not-caught-fail(v_493) then (if not-caught-fail(v_494) then symmetricstatepack(v_494,v_493,v_492) else fail-any) else fail-any) else fail-any))) in
        {11}let v_496: symmetricstate = catch-fail((if success?((if not-caught-fail(v_492) then (if not-caught-fail(v_493) then (if not-caught-fail(v_494) then symmetricstatepack(v_494,v_493,v_492) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_495) && success?(is-true(success?(1-proj-3-tuple(v_495))))) then symmetricstatepack(1-proj-3-tuple(v_495),2-proj-3-tuple(v_495),hash(3-proj-3-tuple(v_495),empty)) else fail-any) else fail-any)) in
        {12}let v_497: bitstring = catch-fail(symmetricstateunpack(v_496)) in
        {13}let v_498: symmetricstate = catch-fail((if (not-caught-fail(v_497) && success?(is-true(success?(1-proj-3-tuple(v_497))))) then symmetricstatepack(1-proj-3-tuple(v_497),2-proj-3-tuple(v_497),hash(3-proj-3-tuple(v_497),rs_490)) else fail-any)) in
        {14}let hs: handshakestate = (if not-caught-fail(v_496) then (if not-caught-fail(v_498) then handshakestatepack(v_498,s_487,e_488,rs_490,re_491,empty,true) else fail-any) else fail-any) in
        {15}insert statestore(alice,bob,statepack_a(hs))
    ) | (
        {45}get statestore(=alice,=bob,statepack_a(hs_499: handshakestate)) in
        {16}let v_500: bitstring = catch-fail(handshakestateunpack(hs_499)) in
        {17}let v_501: bitstring = catch-fail((empty,empty,empty)) in
        {18}let v_502: key = catch-fail(dhexp(key_e(alice,bob),g)) in
        {19}let v_503: keypair = catch-fail((if not-caught-fail(v_502) then keypairpack(v_502,key_e(alice,bob)) else fail-any)) in
        {20}let v_504: bitstring = catch-fail(getpublickey(v_503)) in
        {21}let v_505: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_500))) in
        {22}let v_506: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_500)) then (if (not-caught-fail(v_505) && success?(is-true(success?(1-proj-3-tuple(v_505))))) then symmetricstatepack(1-proj-3-tuple(v_505),2-proj-3-tuple(v_505),hash(3-proj-3-tuple(v_505),v_504)) else fail-any) else fail-any)) in
        {23}let v_507: bitstring = catch-fail(keypairunpack(v_503)) in
        {24}let v_508: bitstring = catch-fail(symmetricstateunpack(v_506)) in
        {25}let v_509: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_508),(if success?(4-proj-7-tuple(v_500)) then (if (not-caught-fail(v_507) && success?(is-true(success?(1-proj-2-tuple(v_507))))) then dhexp(2-proj-2-tuple(v_507),4-proj-7-tuple(v_500)) else fail-any) else fail-any))) in
        {26}let v_510: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_508),(if success?(4-proj-7-tuple(v_500)) then (if (not-caught-fail(v_507) && success?(is-true(success?(1-proj-2-tuple(v_507))))) then dhexp(2-proj-2-tuple(v_507),4-proj-7-tuple(v_500)) else fail-any) else fail-any))) in
        {27}let v_511: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_508),(if success?(4-proj-7-tuple(v_500)) then (if (not-caught-fail(v_507) && success?(is-true(success?(1-proj-2-tuple(v_507))))) then dhexp(2-proj-2-tuple(v_507),4-proj-7-tuple(v_500)) else fail-any) else fail-any))) in
        {28}let v_512: bitstring = catch-fail((if (success?((if success?(4-proj-7-tuple(v_500)) then (if (not-caught-fail(v_507) && success?(is-true(success?(1-proj-2-tuple(v_507))))) then dhexp(2-proj-2-tuple(v_507),4-proj-7-tuple(v_500)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_508))) then (if not-caught-fail(v_509) then (if not-caught-fail(v_510) then (if not-caught-fail(v_511) then (v_509,v_510,v_511) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {29}let v_513: symmetricstate = catch-fail((if success?((if success?(4-proj-7-tuple(v_500)) then (if (not-caught-fail(v_507) && success?(is-true(success?(1-proj-2-tuple(v_507))))) then dhexp(2-proj-2-tuple(v_507),4-proj-7-tuple(v_500)) else fail-any) else fail-any)) then (if (not-caught-fail(v_508) && success?(is-true(success?(1-proj-3-tuple(v_508))))) then (if (not-caught-fail(v_512) && success?(is-true(success?(1-proj-3-tuple(v_512))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_512)) then cipherstatepack(2-proj-3-tuple(v_512),minnonce) else fail-any),1-proj-3-tuple(v_512),3-proj-3-tuple(v_508)) else fail-any) else fail-any) else fail-any)) in
        {30}let v_514: bitstring = catch-fail(symmetricstateunpack(v_513)) in
        {31}let v_515: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_514))) in
        {32}let v_516: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_515),2-proj-2-tuple(v_515),3-proj-3-tuple(v_514),msg_a(alice,bob))) in
        {33}let v_517: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_514))) in
        {34}let v_518: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_515))) && success?(1-proj-3-tuple(v_514))) then (if (not-caught-fail(v_517) && success?(is-true(success?(1-proj-2-tuple(v_517))))) then cipherstatepack(1-proj-2-tuple(v_517),increment_nonce(2-proj-2-tuple(v_515))) else fail-any) else fail-any)) in
        {35}let v_519: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_514)) && success?(1-proj-3-tuple(v_514))) then (if (not-caught-fail(v_515) && success?(is-true(success?(1-proj-2-tuple(v_515))))) then (if not-caught-fail(v_516) then (if not-caught-fail(v_518) then (v_518,v_516) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {36}let v_520: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_519),2-proj-3-tuple(v_514),3-proj-3-tuple(v_514)))) in
        {37}let v_521: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_519)) && success?(symmetricstatepack(1-proj-2-tuple(v_519),2-proj-3-tuple(v_514),3-proj-3-tuple(v_514)))) then (if (not-caught-fail(v_520) && success?(is-true(success?(1-proj-3-tuple(v_520))))) then symmetricstatepack(1-proj-3-tuple(v_520),2-proj-3-tuple(v_520),hash(3-proj-3-tuple(v_520),2-proj-2-tuple(v_519))) else fail-any) else fail-any)) in
        {38}let v_522: bitstring = catch-fail((if (not-caught-fail(v_514) && success?(is-true(success?(1-proj-3-tuple(v_514))))) then (if (not-caught-fail(v_519) && success?(is-true(success?(1-proj-2-tuple(v_519))))) then (if not-caught-fail(v_521) then (v_521,2-proj-2-tuple(v_519)) else fail-any) else fail-any) else fail-any)) in
        {39}let v_523: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_522),2-proj-7-tuple(v_500),v_503,4-proj-7-tuple(v_500),5-proj-7-tuple(v_500),6-proj-7-tuple(v_500),7-proj-7-tuple(v_500))) in
        {40}let v_524: bitstring = catch-fail(concat3(v_504,2-proj-3-tuple(v_501),2-proj-2-tuple(v_522))) in
        {41}let (hs_525: handshakestate,re_526: key,message_a: bitstring) = (if (not-caught-fail(v_500) && success?(is-true(success?(1-proj-7-tuple(v_500))))) then (if (not-caught-fail(v_501) && success?(is-true(success?(1-proj-3-tuple(v_501))))) then (if not-caught-fail(v_503) then (if not-caught-fail(v_504) then (if not-caught-fail(v_506) then (if not-caught-fail(v_513) then (if (not-caught-fail(v_522) && success?(is-true(success?(1-proj-2-tuple(v_522))))) then (if not-caught-fail(v_523) then (if not-caught-fail(v_524) then (v_523,5-proj-7-tuple(v_500),v_524) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {42}event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true);
        {43}insert statestore(alice,bob,statepack_b(hs_525));
        {44}out(pub, message_a)
    ) | (
        {74}get statestore(=alice,=bob,statepack_b(hs_527: handshakestate)) in
        {46}in(pub, message_b: bitstring);
        {47}let v_528: bitstring = catch-fail(handshakestateunpack(hs_527)) in
        {48}let v_529: bitstring = catch-fail(deconcat3(message_b)) in
        {49}let v_530: bool = catch-fail(true) in
        {50}let v_531: key = catch-fail(1-proj-3-tuple(v_529)) in
        {51}let v_532: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_528))) in
        {52}let v_533: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_528)) then (if (not-caught-fail(v_532) && success?(is-true(success?(1-proj-3-tuple(v_532))))) then symmetricstatepack(1-proj-3-tuple(v_532),2-proj-3-tuple(v_532),hash(3-proj-3-tuple(v_532),v_531)) else fail-any) else fail-any)) in
        {53}let v_534: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_528))) in
        {54}let v_535: bitstring = catch-fail(symmetricstateunpack(v_533)) in
        {55}let v_536: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_535),(if success?(3-proj-7-tuple(v_528)) then (if (not-caught-fail(v_534) && success?(is-true(success?(1-proj-2-tuple(v_534))))) then dhexp(2-proj-2-tuple(v_534),v_531) else fail-any) else fail-any))) in
        {56}let v_537: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_535),(if success?(3-proj-7-tuple(v_528)) then (if (not-caught-fail(v_534) && success?(is-true(success?(1-proj-2-tuple(v_534))))) then dhexp(2-proj-2-tuple(v_534),v_531) else fail-any) else fail-any))) in
        {57}let v_538: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_535),(if success?(3-proj-7-tuple(v_528)) then (if (not-caught-fail(v_534) && success?(is-true(success?(1-proj-2-tuple(v_534))))) then dhexp(2-proj-2-tuple(v_534),v_531) else fail-any) else fail-any))) in
        {58}let v_539: bitstring = catch-fail((if (success?((if success?(3-proj-7-tuple(v_528)) then (if (not-caught-fail(v_534) && success?(is-true(success?(1-proj-2-tuple(v_534))))) then dhexp(2-proj-2-tuple(v_534),v_531) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_535))) then (if not-caught-fail(v_536) then (if not-caught-fail(v_537) then (if not-caught-fail(v_538) then (v_536,v_537,v_538) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {59}let v_540: symmetricstate = catch-fail((if success?((if success?(3-proj-7-tuple(v_528)) then (if (not-caught-fail(v_534) && success?(is-true(success?(1-proj-2-tuple(v_534))))) then dhexp(2-proj-2-tuple(v_534),v_531) else fail-any) else fail-any)) then (if (not-caught-fail(v_535) && success?(is-true(success?(1-proj-3-tuple(v_535))))) then (if (not-caught-fail(v_539) && success?(is-true(success?(1-proj-3-tuple(v_539))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_539)) then cipherstatepack(2-proj-3-tuple(v_539),minnonce) else fail-any),1-proj-3-tuple(v_539),3-proj-3-tuple(v_535)) else fail-any) else fail-any) else fail-any)) in
        {60}let v_541: bitstring = catch-fail(symmetricstateunpack(v_540)) in
        {61}let v_542: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_541))) in
        {62}let v_543: aead = catch-fail(decrypt(1-proj-2-tuple(v_542),2-proj-2-tuple(v_542),3-proj-3-tuple(v_541),3-proj-3-tuple(v_529))) in
        {63}let v_544: bitstring = catch-fail(aeadunpack(v_543)) in
        {64}let v_545: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_541))) in
        {65}let v_546: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_542))) && success?(1-proj-3-tuple(v_541))) then (if (not-caught-fail(v_545) && success?(is-true(success?(1-proj-2-tuple(v_545))))) then cipherstatepack(1-proj-2-tuple(v_545),increment_nonce(2-proj-2-tuple(v_542))) else fail-any) else fail-any)) in
        {66}let v_547: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_529)) && (success?(3-proj-3-tuple(v_541)) && success?(1-proj-3-tuple(v_541)))) then (if (not-caught-fail(v_542) && success?(is-true(success?(1-proj-2-tuple(v_542))))) then (if not-caught-fail(v_543) then (if (not-caught-fail(v_544) && success?(is-true(success?(1-proj-3-tuple(v_544))))) then (if not-caught-fail(v_546) then (v_546,3-proj-3-tuple(v_544),1-proj-3-tuple(v_544)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {67}let v_548: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_547),2-proj-3-tuple(v_541),3-proj-3-tuple(v_541)))) in
        {68}let v_549: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_529)) && success?(symmetricstatepack(1-proj-3-tuple(v_547),2-proj-3-tuple(v_541),3-proj-3-tuple(v_541)))) then (if (not-caught-fail(v_548) && success?(is-true(success?(1-proj-3-tuple(v_548))))) then symmetricstatepack(1-proj-3-tuple(v_548),2-proj-3-tuple(v_548),hash(3-proj-3-tuple(v_548),3-proj-3-tuple(v_529))) else fail-any) else fail-any)) in
        {69}let v_550: bitstring = catch-fail((if success?(3-proj-3-tuple(v_529)) then (if (not-caught-fail(v_541) && success?(is-true(success?(1-proj-3-tuple(v_541))))) then (if (not-caught-fail(v_547) && success?(is-true(success?(1-proj-3-tuple(v_547))))) then (if not-caught-fail(v_549) then (v_549,2-proj-3-tuple(v_547),3-proj-3-tuple(v_547)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {70}let v_551: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_550),2-proj-7-tuple(v_528),3-proj-7-tuple(v_528),4-proj-7-tuple(v_528),v_531,6-proj-7-tuple(v_528),7-proj-7-tuple(v_528))) in
        {71}let (hs_552: handshakestate,re_553: key,plaintext_b: bitstring,valid: bool) = (if (not-caught-fail(v_528) && success?(is-true(success?(1-proj-7-tuple(v_528))))) then (if (not-caught-fail(v_529) && success?(is-true(success?(1-proj-3-tuple(v_529))))) then (if not-caught-fail(v_530) then (if not-caught-fail(v_531) then (if not-caught-fail(v_533) then (if not-caught-fail(v_540) then (if (not-caught-fail(v_550) && success?(is-true(success?(1-proj-3-tuple(v_550))))) then (if (v_530 && 3-proj-3-tuple(v_550)) then (if not-caught-fail(v_551) then (v_551,getpublickey(3-proj-7-tuple(v_528)),2-proj-3-tuple(v_550),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {72}event RecvMsg(alice,bob,stage_b,plaintext_b,valid);
        {73}insert statestore(alice,bob,statepack_c(hs_552))
    ) | (
        {100}get statestore(=alice,=bob,statepack_c(hs_554: handshakestate)) in
        {75}let v_555: bitstring = catch-fail(handshakestateunpack(hs_554)) in
        {76}let v_556: bitstring = catch-fail((empty,empty,empty)) in
        {77}let v_557: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_555))) in
        {78}let v_558: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_557))) in
        {79}let v_559: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_558),2-proj-2-tuple(v_558),3-proj-3-tuple(v_557),msg_c(alice,bob))) in
        {80}let v_560: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_557))) in
        {81}let v_561: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_558))) && success?(1-proj-3-tuple(v_557))) then (if (not-caught-fail(v_560) && success?(is-true(success?(1-proj-2-tuple(v_560))))) then cipherstatepack(1-proj-2-tuple(v_560),increment_nonce(2-proj-2-tuple(v_558))) else fail-any) else fail-any)) in
        {82}let v_562: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_557)) && success?(1-proj-3-tuple(v_557))) then (if (not-caught-fail(v_558) && success?(is-true(success?(1-proj-2-tuple(v_558))))) then (if not-caught-fail(v_559) then (if not-caught-fail(v_561) then (v_561,v_559) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {83}let v_563: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_562),2-proj-3-tuple(v_557),3-proj-3-tuple(v_557)))) in
        {84}let v_564: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_562)) && success?(symmetricstatepack(1-proj-2-tuple(v_562),2-proj-3-tuple(v_557),3-proj-3-tuple(v_557)))) then (if (not-caught-fail(v_563) && success?(is-true(success?(1-proj-3-tuple(v_563))))) then symmetricstatepack(1-proj-3-tuple(v_563),2-proj-3-tuple(v_563),hash(3-proj-3-tuple(v_563),2-proj-2-tuple(v_562))) else fail-any) else fail-any)) in
        {85}let v_565: bitstring = catch-fail((if success?(1-proj-7-tuple(v_555)) then (if (not-caught-fail(v_557) && success?(is-true(success?(1-proj-3-tuple(v_557))))) then (if (not-caught-fail(v_562) && success?(is-true(success?(1-proj-2-tuple(v_562))))) then (if not-caught-fail(v_564) then (v_564,2-proj-2-tuple(v_562)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {86}let v_566: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_565),2-proj-7-tuple(v_555),3-proj-7-tuple(v_555),4-proj-7-tuple(v_555),5-proj-7-tuple(v_555),6-proj-7-tuple(v_555),7-proj-7-tuple(v_555))) in
        {87}let v_567: bitstring = catch-fail(concat3(1-proj-3-tuple(v_556),2-proj-3-tuple(v_556),2-proj-2-tuple(v_565))) in
        {88}let v_568: bitstring = catch-fail(symmetricstateunpack(1-proj-2-tuple(v_565))) in
        {89}let v_569: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_568),zero)) in
        {90}let v_570: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_568),zero)) in
        {91}let v_571: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_568),zero)) in
        {92}let v_572: bitstring = catch-fail((if success?(2-proj-3-tuple(v_568)) then (if not-caught-fail(v_569) then (if not-caught-fail(v_570) then (if not-caught-fail(v_571) then (v_569,v_570,v_571) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {93}let v_573: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_572)) then cipherstatepack(1-proj-3-tuple(v_572),minnonce) else fail-any)) in
        {94}let v_574: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_572)) then cipherstatepack(2-proj-3-tuple(v_572),minnonce) else fail-any)) in
        {95}let v_575: bitstring = catch-fail((if success?(1-proj-2-tuple(v_565)) then (if (not-caught-fail(v_568) && success?(is-true(success?(1-proj-3-tuple(v_568))))) then (if (not-caught-fail(v_572) && success?(is-true(success?(1-proj-3-tuple(v_572))))) then (if not-caught-fail(v_573) then (if not-caught-fail(v_574) then (1-proj-2-tuple(v_565),v_573,v_574) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {96}let (hs_576: handshakestate,re_577: key,message_c: bitstring,cs1: cipherstate,cs2: cipherstate) = (if (not-caught-fail(v_555) && success?(is-true(success?(1-proj-7-tuple(v_555))))) then (if (not-caught-fail(v_556) && success?(is-true(success?(1-proj-3-tuple(v_556))))) then (if (not-caught-fail(v_565) && success?(is-true(success?(1-proj-2-tuple(v_565))))) then (if not-caught-fail(v_566) then (if not-caught-fail(v_567) then (if (not-caught-fail(v_575) && success?(is-true(success?(1-proj-3-tuple(v_575))))) then (v_566,5-proj-7-tuple(v_555),v_567,2-proj-3-tuple(v_575),3-proj-3-tuple(v_575)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {97}event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true);
        {98}insert statestore(alice,bob,statepack_d(hs_576));
        {99}out(pub, message_c)
    ) | (
        {101}event LeakS(phase0,alice);
        {102}out(pub, key_s(alice))
    ) | (
        {103}phase 1;
        {104}event LeakS(phase1,alice);
        {105}out(pub, key_s(alice))
    )
) | (
    {106}let s_578: keypair = keypairpack(empty,empty) in
    (
        {107}let e_579: keypair = keypairpack(empty,empty) in
        {108}let v_580: key = catch-fail(dhexp(key_s(charlie),g)) in
        {109}let rs_581: key = getpublickey((if not-caught-fail(v_580) then keypairpack(v_580,key_s(charlie)) else fail-any)) in
        {110}let re_582: key = empty in
        {111}let v_583: bitstring = catch-fail(hash(somename,empty)) in
        {112}let v_584: key = catch-fail(v_583) in
        {113}let v_585: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {114}let v_586: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_583) then (if not-caught-fail(v_584) then (if not-caught-fail(v_585) then symmetricstatepack(v_585,v_584,v_583) else fail-any) else fail-any) else fail-any))) in
        {115}let v_587: symmetricstate = catch-fail((if success?((if not-caught-fail(v_583) then (if not-caught-fail(v_584) then (if not-caught-fail(v_585) then symmetricstatepack(v_585,v_584,v_583) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_586) && success?(is-true(success?(1-proj-3-tuple(v_586))))) then symmetricstatepack(1-proj-3-tuple(v_586),2-proj-3-tuple(v_586),hash(3-proj-3-tuple(v_586),empty)) else fail-any) else fail-any)) in
        {116}let v_588: bitstring = catch-fail(symmetricstateunpack(v_587)) in
        {117}let v_589: symmetricstate = catch-fail((if (not-caught-fail(v_588) && success?(is-true(success?(1-proj-3-tuple(v_588))))) then symmetricstatepack(1-proj-3-tuple(v_588),2-proj-3-tuple(v_588),hash(3-proj-3-tuple(v_588),rs_581)) else fail-any)) in
        {118}let hs_590: handshakestate = (if not-caught-fail(v_587) then (if not-caught-fail(v_589) then handshakestatepack(v_589,s_578,e_579,rs_581,re_582,empty,true) else fail-any) else fail-any) in
        {119}insert statestore(alice,charlie,statepack_a(hs_590))
    ) | (
        {149}get statestore(=alice,=charlie,statepack_a(hs_591: handshakestate)) in
        {120}let v_592: bitstring = catch-fail(handshakestateunpack(hs_591)) in
        {121}let v_593: bitstring = catch-fail((empty,empty,empty)) in
        {122}let v_594: key = catch-fail(dhexp(key_e(alice,charlie),g)) in
        {123}let v_595: keypair = catch-fail((if not-caught-fail(v_594) then keypairpack(v_594,key_e(alice,charlie)) else fail-any)) in
        {124}let v_596: bitstring = catch-fail(getpublickey(v_595)) in
        {125}let v_597: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_592))) in
        {126}let v_598: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_592)) then (if (not-caught-fail(v_597) && success?(is-true(success?(1-proj-3-tuple(v_597))))) then symmetricstatepack(1-proj-3-tuple(v_597),2-proj-3-tuple(v_597),hash(3-proj-3-tuple(v_597),v_596)) else fail-any) else fail-any)) in
        {127}let v_599: bitstring = catch-fail(keypairunpack(v_595)) in
        {128}let v_600: bitstring = catch-fail(symmetricstateunpack(v_598)) in
        {129}let v_601: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_600),(if success?(4-proj-7-tuple(v_592)) then (if (not-caught-fail(v_599) && success?(is-true(success?(1-proj-2-tuple(v_599))))) then dhexp(2-proj-2-tuple(v_599),4-proj-7-tuple(v_592)) else fail-any) else fail-any))) in
        {130}let v_602: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_600),(if success?(4-proj-7-tuple(v_592)) then (if (not-caught-fail(v_599) && success?(is-true(success?(1-proj-2-tuple(v_599))))) then dhexp(2-proj-2-tuple(v_599),4-proj-7-tuple(v_592)) else fail-any) else fail-any))) in
        {131}let v_603: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_600),(if success?(4-proj-7-tuple(v_592)) then (if (not-caught-fail(v_599) && success?(is-true(success?(1-proj-2-tuple(v_599))))) then dhexp(2-proj-2-tuple(v_599),4-proj-7-tuple(v_592)) else fail-any) else fail-any))) in
        {132}let v_604: bitstring = catch-fail((if (success?((if success?(4-proj-7-tuple(v_592)) then (if (not-caught-fail(v_599) && success?(is-true(success?(1-proj-2-tuple(v_599))))) then dhexp(2-proj-2-tuple(v_599),4-proj-7-tuple(v_592)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_600))) then (if not-caught-fail(v_601) then (if not-caught-fail(v_602) then (if not-caught-fail(v_603) then (v_601,v_602,v_603) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {133}let v_605: symmetricstate = catch-fail((if success?((if success?(4-proj-7-tuple(v_592)) then (if (not-caught-fail(v_599) && success?(is-true(success?(1-proj-2-tuple(v_599))))) then dhexp(2-proj-2-tuple(v_599),4-proj-7-tuple(v_592)) else fail-any) else fail-any)) then (if (not-caught-fail(v_600) && success?(is-true(success?(1-proj-3-tuple(v_600))))) then (if (not-caught-fail(v_604) && success?(is-true(success?(1-proj-3-tuple(v_604))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_604)) then cipherstatepack(2-proj-3-tuple(v_604),minnonce) else fail-any),1-proj-3-tuple(v_604),3-proj-3-tuple(v_600)) else fail-any) else fail-any) else fail-any)) in
        {134}let v_606: bitstring = catch-fail(symmetricstateunpack(v_605)) in
        {135}let v_607: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_606))) in
        {136}let v_608: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_607),2-proj-2-tuple(v_607),3-proj-3-tuple(v_606),msg_a(alice,charlie))) in
        {137}let v_609: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_606))) in
        {138}let v_610: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_607))) && success?(1-proj-3-tuple(v_606))) then (if (not-caught-fail(v_609) && success?(is-true(success?(1-proj-2-tuple(v_609))))) then cipherstatepack(1-proj-2-tuple(v_609),increment_nonce(2-proj-2-tuple(v_607))) else fail-any) else fail-any)) in
        {139}let v_611: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_606)) && success?(1-proj-3-tuple(v_606))) then (if (not-caught-fail(v_607) && success?(is-true(success?(1-proj-2-tuple(v_607))))) then (if not-caught-fail(v_608) then (if not-caught-fail(v_610) then (v_610,v_608) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {140}let v_612: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_611),2-proj-3-tuple(v_606),3-proj-3-tuple(v_606)))) in
        {141}let v_613: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_611)) && success?(symmetricstatepack(1-proj-2-tuple(v_611),2-proj-3-tuple(v_606),3-proj-3-tuple(v_606)))) then (if (not-caught-fail(v_612) && success?(is-true(success?(1-proj-3-tuple(v_612))))) then symmetricstatepack(1-proj-3-tuple(v_612),2-proj-3-tuple(v_612),hash(3-proj-3-tuple(v_612),2-proj-2-tuple(v_611))) else fail-any) else fail-any)) in
        {142}let v_614: bitstring = catch-fail((if (not-caught-fail(v_606) && success?(is-true(success?(1-proj-3-tuple(v_606))))) then (if (not-caught-fail(v_611) && success?(is-true(success?(1-proj-2-tuple(v_611))))) then (if not-caught-fail(v_613) then (v_613,2-proj-2-tuple(v_611)) else fail-any) else fail-any) else fail-any)) in
        {143}let v_615: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_614),2-proj-7-tuple(v_592),v_595,4-proj-7-tuple(v_592),5-proj-7-tuple(v_592),6-proj-7-tuple(v_592),7-proj-7-tuple(v_592))) in
        {144}let v_616: bitstring = catch-fail(concat3(v_596,2-proj-3-tuple(v_593),2-proj-2-tuple(v_614))) in
        {145}let (hs_617: handshakestate,re_618: key,message_a_619: bitstring) = (if (not-caught-fail(v_592) && success?(is-true(success?(1-proj-7-tuple(v_592))))) then (if (not-caught-fail(v_593) && success?(is-true(success?(1-proj-3-tuple(v_593))))) then (if not-caught-fail(v_595) then (if not-caught-fail(v_596) then (if not-caught-fail(v_598) then (if not-caught-fail(v_605) then (if (not-caught-fail(v_614) && success?(is-true(success?(1-proj-2-tuple(v_614))))) then (if not-caught-fail(v_615) then (if not-caught-fail(v_616) then (v_615,5-proj-7-tuple(v_592),v_616) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {146}event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true);
        {147}insert statestore(alice,charlie,statepack_b(hs_617));
        {148}out(pub, message_a_619)
    ) | (
        {178}get statestore(=alice,=charlie,statepack_b(hs_620: handshakestate)) in
        {150}in(pub, message_b_621: bitstring);
        {151}let v_622: bitstring = catch-fail(handshakestateunpack(hs_620)) in
        {152}let v_623: bitstring = catch-fail(deconcat3(message_b_621)) in
        {153}let v_624: bool = catch-fail(true) in
        {154}let v_625: key = catch-fail(1-proj-3-tuple(v_623)) in
        {155}let v_626: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_622))) in
        {156}let v_627: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_622)) then (if (not-caught-fail(v_626) && success?(is-true(success?(1-proj-3-tuple(v_626))))) then symmetricstatepack(1-proj-3-tuple(v_626),2-proj-3-tuple(v_626),hash(3-proj-3-tuple(v_626),v_625)) else fail-any) else fail-any)) in
        {157}let v_628: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_622))) in
        {158}let v_629: bitstring = catch-fail(symmetricstateunpack(v_627)) in
        {159}let v_630: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_629),(if success?(3-proj-7-tuple(v_622)) then (if (not-caught-fail(v_628) && success?(is-true(success?(1-proj-2-tuple(v_628))))) then dhexp(2-proj-2-tuple(v_628),v_625) else fail-any) else fail-any))) in
        {160}let v_631: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_629),(if success?(3-proj-7-tuple(v_622)) then (if (not-caught-fail(v_628) && success?(is-true(success?(1-proj-2-tuple(v_628))))) then dhexp(2-proj-2-tuple(v_628),v_625) else fail-any) else fail-any))) in
        {161}let v_632: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_629),(if success?(3-proj-7-tuple(v_622)) then (if (not-caught-fail(v_628) && success?(is-true(success?(1-proj-2-tuple(v_628))))) then dhexp(2-proj-2-tuple(v_628),v_625) else fail-any) else fail-any))) in
        {162}let v_633: bitstring = catch-fail((if (success?((if success?(3-proj-7-tuple(v_622)) then (if (not-caught-fail(v_628) && success?(is-true(success?(1-proj-2-tuple(v_628))))) then dhexp(2-proj-2-tuple(v_628),v_625) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_629))) then (if not-caught-fail(v_630) then (if not-caught-fail(v_631) then (if not-caught-fail(v_632) then (v_630,v_631,v_632) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {163}let v_634: symmetricstate = catch-fail((if success?((if success?(3-proj-7-tuple(v_622)) then (if (not-caught-fail(v_628) && success?(is-true(success?(1-proj-2-tuple(v_628))))) then dhexp(2-proj-2-tuple(v_628),v_625) else fail-any) else fail-any)) then (if (not-caught-fail(v_629) && success?(is-true(success?(1-proj-3-tuple(v_629))))) then (if (not-caught-fail(v_633) && success?(is-true(success?(1-proj-3-tuple(v_633))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_633)) then cipherstatepack(2-proj-3-tuple(v_633),minnonce) else fail-any),1-proj-3-tuple(v_633),3-proj-3-tuple(v_629)) else fail-any) else fail-any) else fail-any)) in
        {164}let v_635: bitstring = catch-fail(symmetricstateunpack(v_634)) in
        {165}let v_636: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_635))) in
        {166}let v_637: aead = catch-fail(decrypt(1-proj-2-tuple(v_636),2-proj-2-tuple(v_636),3-proj-3-tuple(v_635),3-proj-3-tuple(v_623))) in
        {167}let v_638: bitstring = catch-fail(aeadunpack(v_637)) in
        {168}let v_639: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_635))) in
        {169}let v_640: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_636))) && success?(1-proj-3-tuple(v_635))) then (if (not-caught-fail(v_639) && success?(is-true(success?(1-proj-2-tuple(v_639))))) then cipherstatepack(1-proj-2-tuple(v_639),increment_nonce(2-proj-2-tuple(v_636))) else fail-any) else fail-any)) in
        {170}let v_641: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_623)) && (success?(3-proj-3-tuple(v_635)) && success?(1-proj-3-tuple(v_635)))) then (if (not-caught-fail(v_636) && success?(is-true(success?(1-proj-2-tuple(v_636))))) then (if not-caught-fail(v_637) then (if (not-caught-fail(v_638) && success?(is-true(success?(1-proj-3-tuple(v_638))))) then (if not-caught-fail(v_640) then (v_640,3-proj-3-tuple(v_638),1-proj-3-tuple(v_638)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {171}let v_642: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_641),2-proj-3-tuple(v_635),3-proj-3-tuple(v_635)))) in
        {172}let v_643: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_623)) && success?(symmetricstatepack(1-proj-3-tuple(v_641),2-proj-3-tuple(v_635),3-proj-3-tuple(v_635)))) then (if (not-caught-fail(v_642) && success?(is-true(success?(1-proj-3-tuple(v_642))))) then symmetricstatepack(1-proj-3-tuple(v_642),2-proj-3-tuple(v_642),hash(3-proj-3-tuple(v_642),3-proj-3-tuple(v_623))) else fail-any) else fail-any)) in
        {173}let v_644: bitstring = catch-fail((if success?(3-proj-3-tuple(v_623)) then (if (not-caught-fail(v_635) && success?(is-true(success?(1-proj-3-tuple(v_635))))) then (if (not-caught-fail(v_641) && success?(is-true(success?(1-proj-3-tuple(v_641))))) then (if not-caught-fail(v_643) then (v_643,2-proj-3-tuple(v_641),3-proj-3-tuple(v_641)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {174}let v_645: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_644),2-proj-7-tuple(v_622),3-proj-7-tuple(v_622),4-proj-7-tuple(v_622),v_625,6-proj-7-tuple(v_622),7-proj-7-tuple(v_622))) in
        {175}let (hs_646: handshakestate,re_647: key,plaintext_b_648: bitstring,valid_649: bool) = (if (not-caught-fail(v_622) && success?(is-true(success?(1-proj-7-tuple(v_622))))) then (if (not-caught-fail(v_623) && success?(is-true(success?(1-proj-3-tuple(v_623))))) then (if not-caught-fail(v_624) then (if not-caught-fail(v_625) then (if not-caught-fail(v_627) then (if not-caught-fail(v_634) then (if (not-caught-fail(v_644) && success?(is-true(success?(1-proj-3-tuple(v_644))))) then (if (v_624 && 3-proj-3-tuple(v_644)) then (if not-caught-fail(v_645) then (v_645,getpublickey(3-proj-7-tuple(v_622)),2-proj-3-tuple(v_644),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {176}event RecvMsg(alice,charlie,stage_b,plaintext_b_648,valid_649);
        {177}insert statestore(alice,charlie,statepack_c(hs_646))
    ) | (
        {204}get statestore(=alice,=charlie,statepack_c(hs_650: handshakestate)) in
        {179}let v_651: bitstring = catch-fail(handshakestateunpack(hs_650)) in
        {180}let v_652: bitstring = catch-fail((empty,empty,empty)) in
        {181}let v_653: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_651))) in
        {182}let v_654: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_653))) in
        {183}let v_655: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_654),2-proj-2-tuple(v_654),3-proj-3-tuple(v_653),msg_c(alice,charlie))) in
        {184}let v_656: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_653))) in
        {185}let v_657: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_654))) && success?(1-proj-3-tuple(v_653))) then (if (not-caught-fail(v_656) && success?(is-true(success?(1-proj-2-tuple(v_656))))) then cipherstatepack(1-proj-2-tuple(v_656),increment_nonce(2-proj-2-tuple(v_654))) else fail-any) else fail-any)) in
        {186}let v_658: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_653)) && success?(1-proj-3-tuple(v_653))) then (if (not-caught-fail(v_654) && success?(is-true(success?(1-proj-2-tuple(v_654))))) then (if not-caught-fail(v_655) then (if not-caught-fail(v_657) then (v_657,v_655) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {187}let v_659: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_658),2-proj-3-tuple(v_653),3-proj-3-tuple(v_653)))) in
        {188}let v_660: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_658)) && success?(symmetricstatepack(1-proj-2-tuple(v_658),2-proj-3-tuple(v_653),3-proj-3-tuple(v_653)))) then (if (not-caught-fail(v_659) && success?(is-true(success?(1-proj-3-tuple(v_659))))) then symmetricstatepack(1-proj-3-tuple(v_659),2-proj-3-tuple(v_659),hash(3-proj-3-tuple(v_659),2-proj-2-tuple(v_658))) else fail-any) else fail-any)) in
        {189}let v_661: bitstring = catch-fail((if success?(1-proj-7-tuple(v_651)) then (if (not-caught-fail(v_653) && success?(is-true(success?(1-proj-3-tuple(v_653))))) then (if (not-caught-fail(v_658) && success?(is-true(success?(1-proj-2-tuple(v_658))))) then (if not-caught-fail(v_660) then (v_660,2-proj-2-tuple(v_658)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {190}let v_662: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_661),2-proj-7-tuple(v_651),3-proj-7-tuple(v_651),4-proj-7-tuple(v_651),5-proj-7-tuple(v_651),6-proj-7-tuple(v_651),7-proj-7-tuple(v_651))) in
        {191}let v_663: bitstring = catch-fail(concat3(1-proj-3-tuple(v_652),2-proj-3-tuple(v_652),2-proj-2-tuple(v_661))) in
        {192}let v_664: bitstring = catch-fail(symmetricstateunpack(1-proj-2-tuple(v_661))) in
        {193}let v_665: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_664),zero)) in
        {194}let v_666: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_664),zero)) in
        {195}let v_667: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_664),zero)) in
        {196}let v_668: bitstring = catch-fail((if success?(2-proj-3-tuple(v_664)) then (if not-caught-fail(v_665) then (if not-caught-fail(v_666) then (if not-caught-fail(v_667) then (v_665,v_666,v_667) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {197}let v_669: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_668)) then cipherstatepack(1-proj-3-tuple(v_668),minnonce) else fail-any)) in
        {198}let v_670: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_668)) then cipherstatepack(2-proj-3-tuple(v_668),minnonce) else fail-any)) in
        {199}let v_671: bitstring = catch-fail((if success?(1-proj-2-tuple(v_661)) then (if (not-caught-fail(v_664) && success?(is-true(success?(1-proj-3-tuple(v_664))))) then (if (not-caught-fail(v_668) && success?(is-true(success?(1-proj-3-tuple(v_668))))) then (if not-caught-fail(v_669) then (if not-caught-fail(v_670) then (1-proj-2-tuple(v_661),v_669,v_670) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {200}let (hs_672: handshakestate,re_673: key,message_c_674: bitstring,cs1_675: cipherstate,cs2_676: cipherstate) = (if (not-caught-fail(v_651) && success?(is-true(success?(1-proj-7-tuple(v_651))))) then (if (not-caught-fail(v_652) && success?(is-true(success?(1-proj-3-tuple(v_652))))) then (if (not-caught-fail(v_661) && success?(is-true(success?(1-proj-2-tuple(v_661))))) then (if not-caught-fail(v_662) then (if not-caught-fail(v_663) then (if (not-caught-fail(v_671) && success?(is-true(success?(1-proj-3-tuple(v_671))))) then (v_662,5-proj-7-tuple(v_651),v_663,2-proj-3-tuple(v_671),3-proj-3-tuple(v_671)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {201}event SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true);
        {202}insert statestore(alice,charlie,statepack_d(hs_672));
        {203}out(pub, message_c_674)
    ) | (
        {205}event LeakS(phase0,alice);
        {206}out(pub, key_s(alice))
    ) | (
        {207}phase 1;
        {208}event LeakS(phase1,alice);
        {209}out(pub, key_s(alice))
    )
) | (
    {210}let v_677: key = catch-fail(dhexp(key_s(bob),g)) in
    {211}let s_678: keypair = (if not-caught-fail(v_677) then keypairpack(v_677,key_s(bob)) else fail-any) in
    {212}out(pub, getpublickey(s_678));
    (
        {213}let e_679: keypair = keypairpack(empty,empty) in
        {214}let rs_680: key = empty in
        {215}let re_681: key = empty in
        {216}let v_682: bitstring = catch-fail(hash(somename,empty)) in
        {217}let v_683: key = catch-fail(v_682) in
        {218}let v_684: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {219}let v_685: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_682) then (if not-caught-fail(v_683) then (if not-caught-fail(v_684) then symmetricstatepack(v_684,v_683,v_682) else fail-any) else fail-any) else fail-any))) in
        {220}let v_686: symmetricstate = catch-fail((if success?((if not-caught-fail(v_682) then (if not-caught-fail(v_683) then (if not-caught-fail(v_684) then symmetricstatepack(v_684,v_683,v_682) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_685) && success?(is-true(success?(1-proj-3-tuple(v_685))))) then symmetricstatepack(1-proj-3-tuple(v_685),2-proj-3-tuple(v_685),hash(3-proj-3-tuple(v_685),empty)) else fail-any) else fail-any)) in
        {221}let v_687: bitstring = catch-fail(symmetricstateunpack(v_686)) in
        {222}let v_688: symmetricstate = catch-fail((if success?(getpublickey(s_678)) then (if (not-caught-fail(v_687) && success?(is-true(success?(1-proj-3-tuple(v_687))))) then symmetricstatepack(1-proj-3-tuple(v_687),2-proj-3-tuple(v_687),hash(3-proj-3-tuple(v_687),getpublickey(s_678))) else fail-any) else fail-any)) in
        {223}let hs_689: handshakestate = (if not-caught-fail(v_686) then (if not-caught-fail(v_688) then handshakestatepack(v_688,s_678,e_679,rs_680,re_681,empty,false) else fail-any) else fail-any) in
        {224}insert statestore(bob,alice,statepack_a(hs_689))
    ) | (
        {253}get statestore(=bob,=alice,statepack_a(hs_690: handshakestate)) in
        {225}in(pub, message_a_691: bitstring);
        {226}let v_692: bitstring = catch-fail(handshakestateunpack(hs_690)) in
        {227}let v_693: bitstring = catch-fail(deconcat3(message_a_691)) in
        {228}let v_694: bool = catch-fail(true) in
        {229}let v_695: key = catch-fail(1-proj-3-tuple(v_693)) in
        {230}let v_696: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_692))) in
        {231}let v_697: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_692)) then (if (not-caught-fail(v_696) && success?(is-true(success?(1-proj-3-tuple(v_696))))) then symmetricstatepack(1-proj-3-tuple(v_696),2-proj-3-tuple(v_696),hash(3-proj-3-tuple(v_696),v_695)) else fail-any) else fail-any)) in
        {232}let v_698: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_692))) in
        {233}let v_699: bitstring = catch-fail(symmetricstateunpack(v_697)) in
        {234}let v_700: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_699),(if success?(2-proj-7-tuple(v_692)) then (if (not-caught-fail(v_698) && success?(is-true(success?(1-proj-2-tuple(v_698))))) then dhexp(2-proj-2-tuple(v_698),v_695) else fail-any) else fail-any))) in
        {235}let v_701: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_699),(if success?(2-proj-7-tuple(v_692)) then (if (not-caught-fail(v_698) && success?(is-true(success?(1-proj-2-tuple(v_698))))) then dhexp(2-proj-2-tuple(v_698),v_695) else fail-any) else fail-any))) in
        {236}let v_702: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_699),(if success?(2-proj-7-tuple(v_692)) then (if (not-caught-fail(v_698) && success?(is-true(success?(1-proj-2-tuple(v_698))))) then dhexp(2-proj-2-tuple(v_698),v_695) else fail-any) else fail-any))) in
        {237}let v_703: bitstring = catch-fail((if (success?((if success?(2-proj-7-tuple(v_692)) then (if (not-caught-fail(v_698) && success?(is-true(success?(1-proj-2-tuple(v_698))))) then dhexp(2-proj-2-tuple(v_698),v_695) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_699))) then (if not-caught-fail(v_700) then (if not-caught-fail(v_701) then (if not-caught-fail(v_702) then (v_700,v_701,v_702) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {238}let v_704: symmetricstate = catch-fail((if success?((if success?(2-proj-7-tuple(v_692)) then (if (not-caught-fail(v_698) && success?(is-true(success?(1-proj-2-tuple(v_698))))) then dhexp(2-proj-2-tuple(v_698),v_695) else fail-any) else fail-any)) then (if (not-caught-fail(v_699) && success?(is-true(success?(1-proj-3-tuple(v_699))))) then (if (not-caught-fail(v_703) && success?(is-true(success?(1-proj-3-tuple(v_703))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_703)) then cipherstatepack(2-proj-3-tuple(v_703),minnonce) else fail-any),1-proj-3-tuple(v_703),3-proj-3-tuple(v_699)) else fail-any) else fail-any) else fail-any)) in
        {239}let v_705: bitstring = catch-fail(symmetricstateunpack(v_704)) in
        {240}let v_706: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_705))) in
        {241}let v_707: aead = catch-fail(decrypt(1-proj-2-tuple(v_706),2-proj-2-tuple(v_706),3-proj-3-tuple(v_705),3-proj-3-tuple(v_693))) in
        {242}let v_708: bitstring = catch-fail(aeadunpack(v_707)) in
        {243}let v_709: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_705))) in
        {244}let v_710: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_706))) && success?(1-proj-3-tuple(v_705))) then (if (not-caught-fail(v_709) && success?(is-true(success?(1-proj-2-tuple(v_709))))) then cipherstatepack(1-proj-2-tuple(v_709),increment_nonce(2-proj-2-tuple(v_706))) else fail-any) else fail-any)) in
        {245}let v_711: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_693)) && (success?(3-proj-3-tuple(v_705)) && success?(1-proj-3-tuple(v_705)))) then (if (not-caught-fail(v_706) && success?(is-true(success?(1-proj-2-tuple(v_706))))) then (if not-caught-fail(v_707) then (if (not-caught-fail(v_708) && success?(is-true(success?(1-proj-3-tuple(v_708))))) then (if not-caught-fail(v_710) then (v_710,3-proj-3-tuple(v_708),1-proj-3-tuple(v_708)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {246}let v_712: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_711),2-proj-3-tuple(v_705),3-proj-3-tuple(v_705)))) in
        {247}let v_713: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_693)) && success?(symmetricstatepack(1-proj-3-tuple(v_711),2-proj-3-tuple(v_705),3-proj-3-tuple(v_705)))) then (if (not-caught-fail(v_712) && success?(is-true(success?(1-proj-3-tuple(v_712))))) then symmetricstatepack(1-proj-3-tuple(v_712),2-proj-3-tuple(v_712),hash(3-proj-3-tuple(v_712),3-proj-3-tuple(v_693))) else fail-any) else fail-any)) in
        {248}let v_714: bitstring = catch-fail((if success?(3-proj-3-tuple(v_693)) then (if (not-caught-fail(v_705) && success?(is-true(success?(1-proj-3-tuple(v_705))))) then (if (not-caught-fail(v_711) && success?(is-true(success?(1-proj-3-tuple(v_711))))) then (if not-caught-fail(v_713) then (v_713,2-proj-3-tuple(v_711),3-proj-3-tuple(v_711)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {249}let v_715: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_714),2-proj-7-tuple(v_692),3-proj-7-tuple(v_692),4-proj-7-tuple(v_692),v_695,6-proj-7-tuple(v_692),7-proj-7-tuple(v_692))) in
        {250}let (hs_716: handshakestate,re_717: key,plaintext_a: bitstring,valid_718: bool) = (if (not-caught-fail(v_692) && success?(is-true(success?(1-proj-7-tuple(v_692))))) then (if (not-caught-fail(v_693) && success?(is-true(success?(1-proj-3-tuple(v_693))))) then (if not-caught-fail(v_694) then (if not-caught-fail(v_695) then (if not-caught-fail(v_697) then (if not-caught-fail(v_704) then (if (not-caught-fail(v_714) && success?(is-true(success?(1-proj-3-tuple(v_714))))) then (if (v_694 && 3-proj-3-tuple(v_714)) then (if not-caught-fail(v_715) then (v_715,getpublickey(3-proj-7-tuple(v_692)),2-proj-3-tuple(v_714),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {251}event RecvMsg(bob,alice,stage_a,plaintext_a,valid_718);
        {252}insert statestore(bob,alice,statepack_b(hs_716))
    ) | (
        {283}get statestore(=bob,=alice,statepack_b(hs_719: handshakestate)) in
        {254}let v_720: bitstring = catch-fail(handshakestateunpack(hs_719)) in
        {255}let v_721: bitstring = catch-fail((empty,empty,empty)) in
        {256}let v_722: key = catch-fail(dhexp(key_e(bob,alice),g)) in
        {257}let v_723: keypair = catch-fail((if not-caught-fail(v_722) then keypairpack(v_722,key_e(bob,alice)) else fail-any)) in
        {258}let v_724: bitstring = catch-fail(getpublickey(v_723)) in
        {259}let v_725: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_720))) in
        {260}let v_726: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_720)) then (if (not-caught-fail(v_725) && success?(is-true(success?(1-proj-3-tuple(v_725))))) then symmetricstatepack(1-proj-3-tuple(v_725),2-proj-3-tuple(v_725),hash(3-proj-3-tuple(v_725),v_724)) else fail-any) else fail-any)) in
        {261}let v_727: bitstring = catch-fail(keypairunpack(v_723)) in
        {262}let v_728: bitstring = catch-fail(symmetricstateunpack(v_726)) in
        {263}let v_729: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_728),(if success?(5-proj-7-tuple(v_720)) then (if (not-caught-fail(v_727) && success?(is-true(success?(1-proj-2-tuple(v_727))))) then dhexp(2-proj-2-tuple(v_727),5-proj-7-tuple(v_720)) else fail-any) else fail-any))) in
        {264}let v_730: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_728),(if success?(5-proj-7-tuple(v_720)) then (if (not-caught-fail(v_727) && success?(is-true(success?(1-proj-2-tuple(v_727))))) then dhexp(2-proj-2-tuple(v_727),5-proj-7-tuple(v_720)) else fail-any) else fail-any))) in
        {265}let v_731: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_728),(if success?(5-proj-7-tuple(v_720)) then (if (not-caught-fail(v_727) && success?(is-true(success?(1-proj-2-tuple(v_727))))) then dhexp(2-proj-2-tuple(v_727),5-proj-7-tuple(v_720)) else fail-any) else fail-any))) in
        {266}let v_732: bitstring = catch-fail((if (success?((if success?(5-proj-7-tuple(v_720)) then (if (not-caught-fail(v_727) && success?(is-true(success?(1-proj-2-tuple(v_727))))) then dhexp(2-proj-2-tuple(v_727),5-proj-7-tuple(v_720)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_728))) then (if not-caught-fail(v_729) then (if not-caught-fail(v_730) then (if not-caught-fail(v_731) then (v_729,v_730,v_731) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {267}let v_733: symmetricstate = catch-fail((if success?((if success?(5-proj-7-tuple(v_720)) then (if (not-caught-fail(v_727) && success?(is-true(success?(1-proj-2-tuple(v_727))))) then dhexp(2-proj-2-tuple(v_727),5-proj-7-tuple(v_720)) else fail-any) else fail-any)) then (if (not-caught-fail(v_728) && success?(is-true(success?(1-proj-3-tuple(v_728))))) then (if (not-caught-fail(v_732) && success?(is-true(success?(1-proj-3-tuple(v_732))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_732)) then cipherstatepack(2-proj-3-tuple(v_732),minnonce) else fail-any),1-proj-3-tuple(v_732),3-proj-3-tuple(v_728)) else fail-any) else fail-any) else fail-any)) in
        {268}let v_734: bitstring = catch-fail(symmetricstateunpack(v_733)) in
        {269}let v_735: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_734))) in
        {270}let v_736: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_735),2-proj-2-tuple(v_735),3-proj-3-tuple(v_734),msg_b(bob,alice))) in
        {271}let v_737: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_734))) in
        {272}let v_738: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_735))) && success?(1-proj-3-tuple(v_734))) then (if (not-caught-fail(v_737) && success?(is-true(success?(1-proj-2-tuple(v_737))))) then cipherstatepack(1-proj-2-tuple(v_737),increment_nonce(2-proj-2-tuple(v_735))) else fail-any) else fail-any)) in
        {273}let v_739: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_734)) && success?(1-proj-3-tuple(v_734))) then (if (not-caught-fail(v_735) && success?(is-true(success?(1-proj-2-tuple(v_735))))) then (if not-caught-fail(v_736) then (if not-caught-fail(v_738) then (v_738,v_736) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {274}let v_740: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_739),2-proj-3-tuple(v_734),3-proj-3-tuple(v_734)))) in
        {275}let v_741: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_739)) && success?(symmetricstatepack(1-proj-2-tuple(v_739),2-proj-3-tuple(v_734),3-proj-3-tuple(v_734)))) then (if (not-caught-fail(v_740) && success?(is-true(success?(1-proj-3-tuple(v_740))))) then symmetricstatepack(1-proj-3-tuple(v_740),2-proj-3-tuple(v_740),hash(3-proj-3-tuple(v_740),2-proj-2-tuple(v_739))) else fail-any) else fail-any)) in
        {276}let v_742: bitstring = catch-fail((if (not-caught-fail(v_734) && success?(is-true(success?(1-proj-3-tuple(v_734))))) then (if (not-caught-fail(v_739) && success?(is-true(success?(1-proj-2-tuple(v_739))))) then (if not-caught-fail(v_741) then (v_741,2-proj-2-tuple(v_739)) else fail-any) else fail-any) else fail-any)) in
        {277}let v_743: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_742),2-proj-7-tuple(v_720),v_723,4-proj-7-tuple(v_720),5-proj-7-tuple(v_720),6-proj-7-tuple(v_720),7-proj-7-tuple(v_720))) in
        {278}let v_744: bitstring = catch-fail(concat3(v_724,2-proj-3-tuple(v_721),2-proj-2-tuple(v_742))) in
        {279}let (hs_745: handshakestate,re_746: key,message_b_747: bitstring) = (if (not-caught-fail(v_720) && success?(is-true(success?(1-proj-7-tuple(v_720))))) then (if (not-caught-fail(v_721) && success?(is-true(success?(1-proj-3-tuple(v_721))))) then (if not-caught-fail(v_723) then (if not-caught-fail(v_724) then (if not-caught-fail(v_726) then (if not-caught-fail(v_733) then (if (not-caught-fail(v_742) && success?(is-true(success?(1-proj-2-tuple(v_742))))) then (if not-caught-fail(v_743) then (if not-caught-fail(v_744) then (v_743,5-proj-7-tuple(v_720),v_744) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {280}event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true);
        {281}insert statestore(bob,alice,statepack_c(hs_745));
        {282}out(pub, message_b_747)
    ) | (
        {311}get statestore(=bob,=alice,statepack_c(hs_748: handshakestate)) in
        {284}in(pub, message_c_749: bitstring);
        {285}let v_750: bitstring = catch-fail(handshakestateunpack(hs_748)) in
        {286}let v_751: bitstring = catch-fail(deconcat3(message_c_749)) in
        {287}let v_752: bool = catch-fail(true) in
        {288}let v_753: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_750))) in
        {289}let v_754: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_753))) in
        {290}let v_755: aead = catch-fail(decrypt(1-proj-2-tuple(v_754),2-proj-2-tuple(v_754),3-proj-3-tuple(v_753),3-proj-3-tuple(v_751))) in
        {291}let v_756: bitstring = catch-fail(aeadunpack(v_755)) in
        {292}let v_757: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_753))) in
        {293}let v_758: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_754))) && success?(1-proj-3-tuple(v_753))) then (if (not-caught-fail(v_757) && success?(is-true(success?(1-proj-2-tuple(v_757))))) then cipherstatepack(1-proj-2-tuple(v_757),increment_nonce(2-proj-2-tuple(v_754))) else fail-any) else fail-any)) in
        {294}let v_759: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_751)) && (success?(3-proj-3-tuple(v_753)) && success?(1-proj-3-tuple(v_753)))) then (if (not-caught-fail(v_754) && success?(is-true(success?(1-proj-2-tuple(v_754))))) then (if not-caught-fail(v_755) then (if (not-caught-fail(v_756) && success?(is-true(success?(1-proj-3-tuple(v_756))))) then (if not-caught-fail(v_758) then (v_758,3-proj-3-tuple(v_756),1-proj-3-tuple(v_756)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {295}let v_760: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_759),2-proj-3-tuple(v_753),3-proj-3-tuple(v_753)))) in
        {296}let v_761: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_751)) && success?(symmetricstatepack(1-proj-3-tuple(v_759),2-proj-3-tuple(v_753),3-proj-3-tuple(v_753)))) then (if (not-caught-fail(v_760) && success?(is-true(success?(1-proj-3-tuple(v_760))))) then symmetricstatepack(1-proj-3-tuple(v_760),2-proj-3-tuple(v_760),hash(3-proj-3-tuple(v_760),3-proj-3-tuple(v_751))) else fail-any) else fail-any)) in
        {297}let v_762: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_751)) && success?(1-proj-7-tuple(v_750))) then (if (not-caught-fail(v_753) && success?(is-true(success?(1-proj-3-tuple(v_753))))) then (if (not-caught-fail(v_759) && success?(is-true(success?(1-proj-3-tuple(v_759))))) then (if not-caught-fail(v_761) then (v_761,2-proj-3-tuple(v_759),3-proj-3-tuple(v_759)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {298}let v_763: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_762),2-proj-7-tuple(v_750),3-proj-7-tuple(v_750),4-proj-7-tuple(v_750),5-proj-7-tuple(v_750),6-proj-7-tuple(v_750),7-proj-7-tuple(v_750))) in
        {299}let v_764: bitstring = catch-fail(symmetricstateunpack(1-proj-3-tuple(v_762))) in
        {300}let v_765: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_764),zero)) in
        {301}let v_766: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_764),zero)) in
        {302}let v_767: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_764),zero)) in
        {303}let v_768: bitstring = catch-fail((if success?(2-proj-3-tuple(v_764)) then (if not-caught-fail(v_765) then (if not-caught-fail(v_766) then (if not-caught-fail(v_767) then (v_765,v_766,v_767) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {304}let v_769: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_768)) then cipherstatepack(1-proj-3-tuple(v_768),minnonce) else fail-any)) in
        {305}let v_770: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_768)) then cipherstatepack(2-proj-3-tuple(v_768),minnonce) else fail-any)) in
        {306}let v_771: bitstring = catch-fail((if success?(1-proj-3-tuple(v_762)) then (if (not-caught-fail(v_764) && success?(is-true(success?(1-proj-3-tuple(v_764))))) then (if (not-caught-fail(v_768) && success?(is-true(success?(1-proj-3-tuple(v_768))))) then (if not-caught-fail(v_769) then (if not-caught-fail(v_770) then (1-proj-3-tuple(v_762),v_769,v_770) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {307}let (hs_772: handshakestate,re_773: key,plaintext_c: bitstring,valid_774: bool,cs1_775: cipherstate,cs2_776: cipherstate) = (if (not-caught-fail(v_750) && success?(is-true(success?(1-proj-7-tuple(v_750))))) then (if (not-caught-fail(v_751) && success?(is-true(success?(1-proj-3-tuple(v_751))))) then (if not-caught-fail(v_752) then (if (not-caught-fail(v_762) && success?(is-true(success?(1-proj-3-tuple(v_762))))) then (if (v_752 && 3-proj-3-tuple(v_762)) then (if not-caught-fail(v_763) then (if (not-caught-fail(v_771) && success?(is-true(success?(1-proj-3-tuple(v_771))))) then (v_763,getpublickey(3-proj-7-tuple(v_750)),2-proj-3-tuple(v_762),true,2-proj-3-tuple(v_771),3-proj-3-tuple(v_771)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {308}event RecvMsg(bob,alice,stage_c,plaintext_c,valid_774);
        {309}insert statestore(bob,alice,statepack_d(hs_772));
        {310}event RecvEnd(valid_774)
    ) | (
        {312}event LeakS(phase0,bob);
        {313}out(pub, key_s(bob))
    ) | (
        {314}phase 1;
        {315}event LeakS(phase1,bob);
        {316}out(pub, key_s(bob))
    )
) | (
    {317}let v_777: key = catch-fail(dhexp(key_s(bob),g)) in
    {318}let s_778: keypair = (if not-caught-fail(v_777) then keypairpack(v_777,key_s(bob)) else fail-any) in
    {319}out(pub, getpublickey(s_778));
    (
        {320}let e_779: keypair = keypairpack(empty,empty) in
        {321}let rs_780: key = empty in
        {322}let re_781: key = empty in
        {323}let v_782: bitstring = catch-fail(hash(somename,empty)) in
        {324}let v_783: key = catch-fail(v_782) in
        {325}let v_784: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {326}let v_785: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_782) then (if not-caught-fail(v_783) then (if not-caught-fail(v_784) then symmetricstatepack(v_784,v_783,v_782) else fail-any) else fail-any) else fail-any))) in
        {327}let v_786: symmetricstate = catch-fail((if success?((if not-caught-fail(v_782) then (if not-caught-fail(v_783) then (if not-caught-fail(v_784) then symmetricstatepack(v_784,v_783,v_782) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_785) && success?(is-true(success?(1-proj-3-tuple(v_785))))) then symmetricstatepack(1-proj-3-tuple(v_785),2-proj-3-tuple(v_785),hash(3-proj-3-tuple(v_785),empty)) else fail-any) else fail-any)) in
        {328}let v_787: bitstring = catch-fail(symmetricstateunpack(v_786)) in
        {329}let v_788: symmetricstate = catch-fail((if success?(getpublickey(s_778)) then (if (not-caught-fail(v_787) && success?(is-true(success?(1-proj-3-tuple(v_787))))) then symmetricstatepack(1-proj-3-tuple(v_787),2-proj-3-tuple(v_787),hash(3-proj-3-tuple(v_787),getpublickey(s_778))) else fail-any) else fail-any)) in
        {330}let hs_789: handshakestate = (if not-caught-fail(v_786) then (if not-caught-fail(v_788) then handshakestatepack(v_788,s_778,e_779,rs_780,re_781,empty,false) else fail-any) else fail-any) in
        {331}insert statestore(bob,charlie,statepack_a(hs_789))
    ) | (
        {360}get statestore(=bob,=charlie,statepack_a(hs_790: handshakestate)) in
        {332}in(pub, message_a_791: bitstring);
        {333}let v_792: bitstring = catch-fail(handshakestateunpack(hs_790)) in
        {334}let v_793: bitstring = catch-fail(deconcat3(message_a_791)) in
        {335}let v_794: bool = catch-fail(true) in
        {336}let v_795: key = catch-fail(1-proj-3-tuple(v_793)) in
        {337}let v_796: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_792))) in
        {338}let v_797: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_792)) then (if (not-caught-fail(v_796) && success?(is-true(success?(1-proj-3-tuple(v_796))))) then symmetricstatepack(1-proj-3-tuple(v_796),2-proj-3-tuple(v_796),hash(3-proj-3-tuple(v_796),v_795)) else fail-any) else fail-any)) in
        {339}let v_798: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_792))) in
        {340}let v_799: bitstring = catch-fail(symmetricstateunpack(v_797)) in
        {341}let v_800: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_799),(if success?(2-proj-7-tuple(v_792)) then (if (not-caught-fail(v_798) && success?(is-true(success?(1-proj-2-tuple(v_798))))) then dhexp(2-proj-2-tuple(v_798),v_795) else fail-any) else fail-any))) in
        {342}let v_801: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_799),(if success?(2-proj-7-tuple(v_792)) then (if (not-caught-fail(v_798) && success?(is-true(success?(1-proj-2-tuple(v_798))))) then dhexp(2-proj-2-tuple(v_798),v_795) else fail-any) else fail-any))) in
        {343}let v_802: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_799),(if success?(2-proj-7-tuple(v_792)) then (if (not-caught-fail(v_798) && success?(is-true(success?(1-proj-2-tuple(v_798))))) then dhexp(2-proj-2-tuple(v_798),v_795) else fail-any) else fail-any))) in
        {344}let v_803: bitstring = catch-fail((if (success?((if success?(2-proj-7-tuple(v_792)) then (if (not-caught-fail(v_798) && success?(is-true(success?(1-proj-2-tuple(v_798))))) then dhexp(2-proj-2-tuple(v_798),v_795) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_799))) then (if not-caught-fail(v_800) then (if not-caught-fail(v_801) then (if not-caught-fail(v_802) then (v_800,v_801,v_802) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {345}let v_804: symmetricstate = catch-fail((if success?((if success?(2-proj-7-tuple(v_792)) then (if (not-caught-fail(v_798) && success?(is-true(success?(1-proj-2-tuple(v_798))))) then dhexp(2-proj-2-tuple(v_798),v_795) else fail-any) else fail-any)) then (if (not-caught-fail(v_799) && success?(is-true(success?(1-proj-3-tuple(v_799))))) then (if (not-caught-fail(v_803) && success?(is-true(success?(1-proj-3-tuple(v_803))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_803)) then cipherstatepack(2-proj-3-tuple(v_803),minnonce) else fail-any),1-proj-3-tuple(v_803),3-proj-3-tuple(v_799)) else fail-any) else fail-any) else fail-any)) in
        {346}let v_805: bitstring = catch-fail(symmetricstateunpack(v_804)) in
        {347}let v_806: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_805))) in
        {348}let v_807: aead = catch-fail(decrypt(1-proj-2-tuple(v_806),2-proj-2-tuple(v_806),3-proj-3-tuple(v_805),3-proj-3-tuple(v_793))) in
        {349}let v_808: bitstring = catch-fail(aeadunpack(v_807)) in
        {350}let v_809: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_805))) in
        {351}let v_810: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_806))) && success?(1-proj-3-tuple(v_805))) then (if (not-caught-fail(v_809) && success?(is-true(success?(1-proj-2-tuple(v_809))))) then cipherstatepack(1-proj-2-tuple(v_809),increment_nonce(2-proj-2-tuple(v_806))) else fail-any) else fail-any)) in
        {352}let v_811: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_793)) && (success?(3-proj-3-tuple(v_805)) && success?(1-proj-3-tuple(v_805)))) then (if (not-caught-fail(v_806) && success?(is-true(success?(1-proj-2-tuple(v_806))))) then (if not-caught-fail(v_807) then (if (not-caught-fail(v_808) && success?(is-true(success?(1-proj-3-tuple(v_808))))) then (if not-caught-fail(v_810) then (v_810,3-proj-3-tuple(v_808),1-proj-3-tuple(v_808)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {353}let v_812: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_811),2-proj-3-tuple(v_805),3-proj-3-tuple(v_805)))) in
        {354}let v_813: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_793)) && success?(symmetricstatepack(1-proj-3-tuple(v_811),2-proj-3-tuple(v_805),3-proj-3-tuple(v_805)))) then (if (not-caught-fail(v_812) && success?(is-true(success?(1-proj-3-tuple(v_812))))) then symmetricstatepack(1-proj-3-tuple(v_812),2-proj-3-tuple(v_812),hash(3-proj-3-tuple(v_812),3-proj-3-tuple(v_793))) else fail-any) else fail-any)) in
        {355}let v_814: bitstring = catch-fail((if success?(3-proj-3-tuple(v_793)) then (if (not-caught-fail(v_805) && success?(is-true(success?(1-proj-3-tuple(v_805))))) then (if (not-caught-fail(v_811) && success?(is-true(success?(1-proj-3-tuple(v_811))))) then (if not-caught-fail(v_813) then (v_813,2-proj-3-tuple(v_811),3-proj-3-tuple(v_811)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {356}let v_815: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_814),2-proj-7-tuple(v_792),3-proj-7-tuple(v_792),4-proj-7-tuple(v_792),v_795,6-proj-7-tuple(v_792),7-proj-7-tuple(v_792))) in
        {357}let (hs_816: handshakestate,re_817: key,plaintext_a_818: bitstring,valid_819: bool) = (if (not-caught-fail(v_792) && success?(is-true(success?(1-proj-7-tuple(v_792))))) then (if (not-caught-fail(v_793) && success?(is-true(success?(1-proj-3-tuple(v_793))))) then (if not-caught-fail(v_794) then (if not-caught-fail(v_795) then (if not-caught-fail(v_797) then (if not-caught-fail(v_804) then (if (not-caught-fail(v_814) && success?(is-true(success?(1-proj-3-tuple(v_814))))) then (if (v_794 && 3-proj-3-tuple(v_814)) then (if not-caught-fail(v_815) then (v_815,getpublickey(3-proj-7-tuple(v_792)),2-proj-3-tuple(v_814),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {358}event RecvMsg(bob,charlie,stage_a,plaintext_a_818,valid_819);
        {359}insert statestore(bob,charlie,statepack_b(hs_816))
    ) | (
        {390}get statestore(=bob,=charlie,statepack_b(hs_820: handshakestate)) in
        {361}let v_821: bitstring = catch-fail(handshakestateunpack(hs_820)) in
        {362}let v_822: bitstring = catch-fail((empty,empty,empty)) in
        {363}let v_823: key = catch-fail(dhexp(key_e(bob,charlie),g)) in
        {364}let v_824: keypair = catch-fail((if not-caught-fail(v_823) then keypairpack(v_823,key_e(bob,charlie)) else fail-any)) in
        {365}let v_825: bitstring = catch-fail(getpublickey(v_824)) in
        {366}let v_826: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_821))) in
        {367}let v_827: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_821)) then (if (not-caught-fail(v_826) && success?(is-true(success?(1-proj-3-tuple(v_826))))) then symmetricstatepack(1-proj-3-tuple(v_826),2-proj-3-tuple(v_826),hash(3-proj-3-tuple(v_826),v_825)) else fail-any) else fail-any)) in
        {368}let v_828: bitstring = catch-fail(keypairunpack(v_824)) in
        {369}let v_829: bitstring = catch-fail(symmetricstateunpack(v_827)) in
        {370}let v_830: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_829),(if success?(5-proj-7-tuple(v_821)) then (if (not-caught-fail(v_828) && success?(is-true(success?(1-proj-2-tuple(v_828))))) then dhexp(2-proj-2-tuple(v_828),5-proj-7-tuple(v_821)) else fail-any) else fail-any))) in
        {371}let v_831: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_829),(if success?(5-proj-7-tuple(v_821)) then (if (not-caught-fail(v_828) && success?(is-true(success?(1-proj-2-tuple(v_828))))) then dhexp(2-proj-2-tuple(v_828),5-proj-7-tuple(v_821)) else fail-any) else fail-any))) in
        {372}let v_832: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_829),(if success?(5-proj-7-tuple(v_821)) then (if (not-caught-fail(v_828) && success?(is-true(success?(1-proj-2-tuple(v_828))))) then dhexp(2-proj-2-tuple(v_828),5-proj-7-tuple(v_821)) else fail-any) else fail-any))) in
        {373}let v_833: bitstring = catch-fail((if (success?((if success?(5-proj-7-tuple(v_821)) then (if (not-caught-fail(v_828) && success?(is-true(success?(1-proj-2-tuple(v_828))))) then dhexp(2-proj-2-tuple(v_828),5-proj-7-tuple(v_821)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_829))) then (if not-caught-fail(v_830) then (if not-caught-fail(v_831) then (if not-caught-fail(v_832) then (v_830,v_831,v_832) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {374}let v_834: symmetricstate = catch-fail((if success?((if success?(5-proj-7-tuple(v_821)) then (if (not-caught-fail(v_828) && success?(is-true(success?(1-proj-2-tuple(v_828))))) then dhexp(2-proj-2-tuple(v_828),5-proj-7-tuple(v_821)) else fail-any) else fail-any)) then (if (not-caught-fail(v_829) && success?(is-true(success?(1-proj-3-tuple(v_829))))) then (if (not-caught-fail(v_833) && success?(is-true(success?(1-proj-3-tuple(v_833))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_833)) then cipherstatepack(2-proj-3-tuple(v_833),minnonce) else fail-any),1-proj-3-tuple(v_833),3-proj-3-tuple(v_829)) else fail-any) else fail-any) else fail-any)) in
        {375}let v_835: bitstring = catch-fail(symmetricstateunpack(v_834)) in
        {376}let v_836: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_835))) in
        {377}let v_837: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_836),2-proj-2-tuple(v_836),3-proj-3-tuple(v_835),msg_b(bob,charlie))) in
        {378}let v_838: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_835))) in
        {379}let v_839: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_836))) && success?(1-proj-3-tuple(v_835))) then (if (not-caught-fail(v_838) && success?(is-true(success?(1-proj-2-tuple(v_838))))) then cipherstatepack(1-proj-2-tuple(v_838),increment_nonce(2-proj-2-tuple(v_836))) else fail-any) else fail-any)) in
        {380}let v_840: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_835)) && success?(1-proj-3-tuple(v_835))) then (if (not-caught-fail(v_836) && success?(is-true(success?(1-proj-2-tuple(v_836))))) then (if not-caught-fail(v_837) then (if not-caught-fail(v_839) then (v_839,v_837) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {381}let v_841: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_840),2-proj-3-tuple(v_835),3-proj-3-tuple(v_835)))) in
        {382}let v_842: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_840)) && success?(symmetricstatepack(1-proj-2-tuple(v_840),2-proj-3-tuple(v_835),3-proj-3-tuple(v_835)))) then (if (not-caught-fail(v_841) && success?(is-true(success?(1-proj-3-tuple(v_841))))) then symmetricstatepack(1-proj-3-tuple(v_841),2-proj-3-tuple(v_841),hash(3-proj-3-tuple(v_841),2-proj-2-tuple(v_840))) else fail-any) else fail-any)) in
        {383}let v_843: bitstring = catch-fail((if (not-caught-fail(v_835) && success?(is-true(success?(1-proj-3-tuple(v_835))))) then (if (not-caught-fail(v_840) && success?(is-true(success?(1-proj-2-tuple(v_840))))) then (if not-caught-fail(v_842) then (v_842,2-proj-2-tuple(v_840)) else fail-any) else fail-any) else fail-any)) in
        {384}let v_844: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_843),2-proj-7-tuple(v_821),v_824,4-proj-7-tuple(v_821),5-proj-7-tuple(v_821),6-proj-7-tuple(v_821),7-proj-7-tuple(v_821))) in
        {385}let v_845: bitstring = catch-fail(concat3(v_825,2-proj-3-tuple(v_822),2-proj-2-tuple(v_843))) in
        {386}let (hs_846: handshakestate,re_847: key,message_b_848: bitstring) = (if (not-caught-fail(v_821) && success?(is-true(success?(1-proj-7-tuple(v_821))))) then (if (not-caught-fail(v_822) && success?(is-true(success?(1-proj-3-tuple(v_822))))) then (if not-caught-fail(v_824) then (if not-caught-fail(v_825) then (if not-caught-fail(v_827) then (if not-caught-fail(v_834) then (if (not-caught-fail(v_843) && success?(is-true(success?(1-proj-2-tuple(v_843))))) then (if not-caught-fail(v_844) then (if not-caught-fail(v_845) then (v_844,5-proj-7-tuple(v_821),v_845) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {387}event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true);
        {388}insert statestore(bob,charlie,statepack_c(hs_846));
        {389}out(pub, message_b_848)
    ) | (
        {418}get statestore(=bob,=charlie,statepack_c(hs_849: handshakestate)) in
        {391}in(pub, message_c_850: bitstring);
        {392}let v_851: bitstring = catch-fail(handshakestateunpack(hs_849)) in
        {393}let v_852: bitstring = catch-fail(deconcat3(message_c_850)) in
        {394}let v_853: bool = catch-fail(true) in
        {395}let v_854: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_851))) in
        {396}let v_855: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_854))) in
        {397}let v_856: aead = catch-fail(decrypt(1-proj-2-tuple(v_855),2-proj-2-tuple(v_855),3-proj-3-tuple(v_854),3-proj-3-tuple(v_852))) in
        {398}let v_857: bitstring = catch-fail(aeadunpack(v_856)) in
        {399}let v_858: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_854))) in
        {400}let v_859: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_855))) && success?(1-proj-3-tuple(v_854))) then (if (not-caught-fail(v_858) && success?(is-true(success?(1-proj-2-tuple(v_858))))) then cipherstatepack(1-proj-2-tuple(v_858),increment_nonce(2-proj-2-tuple(v_855))) else fail-any) else fail-any)) in
        {401}let v_860: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_852)) && (success?(3-proj-3-tuple(v_854)) && success?(1-proj-3-tuple(v_854)))) then (if (not-caught-fail(v_855) && success?(is-true(success?(1-proj-2-tuple(v_855))))) then (if not-caught-fail(v_856) then (if (not-caught-fail(v_857) && success?(is-true(success?(1-proj-3-tuple(v_857))))) then (if not-caught-fail(v_859) then (v_859,3-proj-3-tuple(v_857),1-proj-3-tuple(v_857)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {402}let v_861: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_860),2-proj-3-tuple(v_854),3-proj-3-tuple(v_854)))) in
        {403}let v_862: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_852)) && success?(symmetricstatepack(1-proj-3-tuple(v_860),2-proj-3-tuple(v_854),3-proj-3-tuple(v_854)))) then (if (not-caught-fail(v_861) && success?(is-true(success?(1-proj-3-tuple(v_861))))) then symmetricstatepack(1-proj-3-tuple(v_861),2-proj-3-tuple(v_861),hash(3-proj-3-tuple(v_861),3-proj-3-tuple(v_852))) else fail-any) else fail-any)) in
        {404}let v_863: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_852)) && success?(1-proj-7-tuple(v_851))) then (if (not-caught-fail(v_854) && success?(is-true(success?(1-proj-3-tuple(v_854))))) then (if (not-caught-fail(v_860) && success?(is-true(success?(1-proj-3-tuple(v_860))))) then (if not-caught-fail(v_862) then (v_862,2-proj-3-tuple(v_860),3-proj-3-tuple(v_860)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {405}let v_864: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_863),2-proj-7-tuple(v_851),3-proj-7-tuple(v_851),4-proj-7-tuple(v_851),5-proj-7-tuple(v_851),6-proj-7-tuple(v_851),7-proj-7-tuple(v_851))) in
        {406}let v_865: bitstring = catch-fail(symmetricstateunpack(1-proj-3-tuple(v_863))) in
        {407}let v_866: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_865),zero)) in
        {408}let v_867: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_865),zero)) in
        {409}let v_868: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_865),zero)) in
        {410}let v_869: bitstring = catch-fail((if success?(2-proj-3-tuple(v_865)) then (if not-caught-fail(v_866) then (if not-caught-fail(v_867) then (if not-caught-fail(v_868) then (v_866,v_867,v_868) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {411}let v_870: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_869)) then cipherstatepack(1-proj-3-tuple(v_869),minnonce) else fail-any)) in
        {412}let v_871: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_869)) then cipherstatepack(2-proj-3-tuple(v_869),minnonce) else fail-any)) in
        {413}let v_872: bitstring = catch-fail((if success?(1-proj-3-tuple(v_863)) then (if (not-caught-fail(v_865) && success?(is-true(success?(1-proj-3-tuple(v_865))))) then (if (not-caught-fail(v_869) && success?(is-true(success?(1-proj-3-tuple(v_869))))) then (if not-caught-fail(v_870) then (if not-caught-fail(v_871) then (1-proj-3-tuple(v_863),v_870,v_871) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {414}let (hs_873: handshakestate,re_874: key,plaintext_c_875: bitstring,valid_876: bool,cs1_877: cipherstate,cs2_878: cipherstate) = (if (not-caught-fail(v_851) && success?(is-true(success?(1-proj-7-tuple(v_851))))) then (if (not-caught-fail(v_852) && success?(is-true(success?(1-proj-3-tuple(v_852))))) then (if not-caught-fail(v_853) then (if (not-caught-fail(v_863) && success?(is-true(success?(1-proj-3-tuple(v_863))))) then (if (v_853 && 3-proj-3-tuple(v_863)) then (if not-caught-fail(v_864) then (if (not-caught-fail(v_872) && success?(is-true(success?(1-proj-3-tuple(v_872))))) then (v_864,getpublickey(3-proj-7-tuple(v_851)),2-proj-3-tuple(v_863),true,2-proj-3-tuple(v_872),3-proj-3-tuple(v_872)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {415}event RecvMsg(bob,charlie,stage_c,plaintext_c_875,valid_876);
        {416}insert statestore(bob,charlie,statepack_d(hs_873));
        {417}event RecvEnd(valid_876)
    ) | (
        {419}event LeakS(phase0,bob);
        {420}out(pub, key_s(bob))
    ) | (
        {421}phase 1;
        {422}event LeakS(phase1,bob);
        {423}out(pub, key_s(bob))
    )
) | (
    {424}out(pub, (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)))
)

-- Query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)); not attacker_p1(msg_a(alice,bob)); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)); not attacker_p1(msg_b(bob,alice)); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice)); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob))); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)); not attacker_p1(msg_c(alice,bob)); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)); not event(RecvEnd(true))
Completing...
200 rules inserted. The rule base contains 200 rules. 154 rules in the queue.
400 rules inserted. The rule base contains 395 rules. 97 rules in the queue.
600 rules inserted. The rule base contains 586 rules. 219 rules in the queue.
800 rules inserted. The rule base contains 776 rules. 274 rules in the queue.
1000 rules inserted. The rule base contains 934 rules. 184 rules in the queue.
1200 rules inserted. The rule base contains 1125 rules. 260 rules in the queue.
1400 rules inserted. The rule base contains 1322 rules. 298 rules in the queue.
1600 rules inserted. The rule base contains 1439 rules. 289 rules in the queue.
1800 rules inserted. The rule base contains 1581 rules. 285 rules in the queue.
2000 rules inserted. The rule base contains 1754 rules. 279 rules in the queue.
2200 rules inserted. The rule base contains 1854 rules. 243 rules in the queue.
2400 rules inserted. The rule base contains 1953 rules. 279 rules in the queue.
2600 rules inserted. The rule base contains 2075 rules. 359 rules in the queue.
2800 rules inserted. The rule base contains 2109 rules. 340 rules in the queue.
3000 rules inserted. The rule base contains 2257 rules. 430 rules in the queue.
3200 rules inserted. The rule base contains 2329 rules. 456 rules in the queue.
3400 rules inserted. The rule base contains 2520 rules. 809 rules in the queue.
3600 rules inserted. The rule base contains 2573 rules. 811 rules in the queue.
3800 rules inserted. The rule base contains 2748 rules. 989 rules in the queue.
4000 rules inserted. The rule base contains 2917 rules. 1138 rules in the queue.
4200 rules inserted. The rule base contains 3108 rules. 1273 rules in the queue.
4400 rules inserted. The rule base contains 3199 rules. 1242 rules in the queue.
4600 rules inserted. The rule base contains 3374 rules. 1195 rules in the queue.
4800 rules inserted. The rule base contains 3561 rules. 1061 rules in the queue.
5000 rules inserted. The rule base contains 3709 rules. 1036 rules in the queue.
5200 rules inserted. The rule base contains 3898 rules. 923 rules in the queue.
5400 rules inserted. The rule base contains 4082 rules. 814 rules in the queue.
5600 rules inserted. The rule base contains 4232 rules. 816 rules in the queue.
5800 rules inserted. The rule base contains 4401 rules. 804 rules in the queue.
6000 rules inserted. The rule base contains 4552 rules. 799 rules in the queue.
6200 rules inserted. The rule base contains 4749 rules. 823 rules in the queue.
6400 rules inserted. The rule base contains 4853 rules. 807 rules in the queue.
6600 rules inserted. The rule base contains 4970 rules. 862 rules in the queue.
6800 rules inserted. The rule base contains 5054 rules. 905 rules in the queue.
7000 rules inserted. The rule base contains 5221 rules. 934 rules in the queue.
7200 rules inserted. The rule base contains 5314 rules. 944 rules in the queue.
7400 rules inserted. The rule base contains 5429 rules. 924 rules in the queue.
7600 rules inserted. The rule base contains 5545 rules. 932 rules in the queue.
7800 rules inserted. The rule base contains 5659 rules. 910 rules in the queue.
8000 rules inserted. The rule base contains 5751 rules. 918 rules in the queue.
8200 rules inserted. The rule base contains 5867 rules. 962 rules in the queue.
8400 rules inserted. The rule base contains 6067 rules. 963 rules in the queue.
8600 rules inserted. The rule base contains 6183 rules. 972 rules in the queue.
8800 rules inserted. The rule base contains 6379 rules. 975 rules in the queue.
9000 rules inserted. The rule base contains 6510 rules. 938 rules in the queue.
9200 rules inserted. The rule base contains 6668 rules. 941 rules in the queue.
9400 rules inserted. The rule base contains 6845 rules. 954 rules in the queue.
9600 rules inserted. The rule base contains 7006 rules. 951 rules in the queue.
9800 rules inserted. The rule base contains 7187 rules. 965 rules in the queue.
10000 rules inserted. The rule base contains 7324 rules. 942 rules in the queue.
10200 rules inserted. The rule base contains 7482 rules. 976 rules in the queue.
10400 rules inserted. The rule base contains 7672 rules. 1007 rules in the queue.
10600 rules inserted. The rule base contains 7817 rules. 1041 rules in the queue.
10800 rules inserted. The rule base contains 8009 rules. 1046 rules in the queue.
11000 rules inserted. The rule base contains 8130 rules. 1072 rules in the queue.
11200 rules inserted. The rule base contains 8330 rules. 1090 rules in the queue.
11400 rules inserted. The rule base contains 8507 rules. 1106 rules in the queue.
11600 rules inserted. The rule base contains 8635 rules. 1142 rules in the queue.
11800 rules inserted. The rule base contains 8834 rules. 1152 rules in the queue.
12000 rules inserted. The rule base contains 8978 rules. 1158 rules in the queue.
12200 rules inserted. The rule base contains 9075 rules. 1247 rules in the queue.
12400 rules inserted. The rule base contains 9246 rules. 1264 rules in the queue.
12600 rules inserted. The rule base contains 9299 rules. 1335 rules in the queue.
12800 rules inserted. The rule base contains 9499 rules. 1382 rules in the queue.
13000 rules inserted. The rule base contains 9653 rules. 1389 rules in the queue.
13200 rules inserted. The rule base contains 9725 rules. 1332 rules in the queue.
13400 rules inserted. The rule base contains 9889 rules. 1267 rules in the queue.
13600 rules inserted. The rule base contains 10071 rules. 1218 rules in the queue.
13800 rules inserted. The rule base contains 10144 rules. 1183 rules in the queue.
14000 rules inserted. The rule base contains 10299 rules. 1127 rules in the queue.
14200 rules inserted. The rule base contains 10493 rules. 1089 rules in the queue.
14400 rules inserted. The rule base contains 10622 rules. 1039 rules in the queue.
14600 rules inserted. The rule base contains 10684 rules. 1010 rules in the queue.
14800 rules inserted. The rule base contains 10711 rules. 919 rules in the queue.
15000 rules inserted. The rule base contains 10772 rules. 894 rules in the queue.
15200 rules inserted. The rule base contains 10811 rules. 795 rules in the queue.
15400 rules inserted. The rule base contains 10655 rules. 777 rules in the queue.
15600 rules inserted. The rule base contains 10818 rules. 725 rules in the queue.
15800 rules inserted. The rule base contains 10657 rules. 670 rules in the queue.
16000 rules inserted. The rule base contains 10804 rules. 621 rules in the queue.
16200 rules inserted. The rule base contains 10366 rules. 399 rules in the queue.
16400 rules inserted. The rule base contains 10385 rules. 336 rules in the queue.
16600 rules inserted. The rule base contains 6427 rules. 267 rules in the queue.
16800 rules inserted. The rule base contains 6445 rules. 275 rules in the queue.
17000 rules inserted. The rule base contains 6485 rules. 259 rules in the queue.
17200 rules inserted. The rule base contains 6431 rules. 236 rules in the queue.
17400 rules inserted. The rule base contains 6443 rules. 225 rules in the queue.
17600 rules inserted. The rule base contains 6474 rules. 223 rules in the queue.
17800 rules inserted. The rule base contains 6490 rules. 219 rules in the queue.
18000 rules inserted. The rule base contains 6507 rules. 178 rules in the queue.
18200 rules inserted. The rule base contains 6486 rules. 94 rules in the queue.
18400 rules inserted. The rule base contains 5804 rules. 16 rules in the queue.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true))
goal reachable: attacker(m_21055923) -> end(RecvMsg(bob,alice,stage_a,m_21055923,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21055967).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21055967.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21055967).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21055967)).

16. The attacker has some term b_21055953.
attacker(b_21055953).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21055953.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21055967).
Using the function concat3 the attacker may obtain concat3(g,b_21055953,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21055967)).
attacker(concat3(g,b_21055953,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21055967))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21055953,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21055967)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21055953,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21055967))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21055953,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21055967)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21055967,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21055967,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21057192,~M_21057193,~M_21057194)) with ~M_21057192 = key_s(charlie), ~M_21057193 = key_e(charlie,alice), ~M_21057194 = key_e(charlie,bob) at {424} in copy a_21055972

out(pub, ~M_21057403) with ~M_21057403 = dhexp(key_s(bob),g) at {319} in copy a_21055972

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21055972

out(pub, ~M_21057750) with ~M_21057750 = dhexp(key_s(bob),g) at {212} in copy a_21055972

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21055972

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21055972

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21055972

out(pub, (~M_21058383,~M_21058384,~M_21058385)) with ~M_21058383 = key_s(charlie), ~M_21058384 = key_e(charlie,alice), ~M_21058385 = key_e(charlie,bob) at {424} in copy a_21055971

out(pub, ~M_21058594) with ~M_21058594 = dhexp(key_s(bob),g) at {319} in copy a_21055971

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21055971

out(pub, ~M_21058941) with ~M_21058941 = dhexp(key_s(bob),g) at {212} in copy a_21055971

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21055971

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21055971

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21055971

out(pub, (~M_21059574,~M_21059575,~M_21059576)) with ~M_21059574 = key_s(charlie), ~M_21059575 = key_e(charlie,alice), ~M_21059576 = key_e(charlie,bob) at {424} in copy a_21055970

out(pub, ~M_21059785) with ~M_21059785 = dhexp(key_s(bob),g) at {319} in copy a_21055970

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21055970

out(pub, ~M_21060132) with ~M_21060132 = dhexp(key_s(bob),g) at {212} in copy a_21055970

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21055970

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21055970

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21055970

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21055972

in(pub, concat3(g,a_21055969,encrypt(hmac_hash2(hash(somename,empty),~M_21057403),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21057403),g),a_21055968))) with encrypt(hmac_hash2(hash(somename,empty),~M_21057403),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21057403),g),a_21055968) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21055968) at {225} in copy a_21055972

event RecvMsg(bob,alice,stage_a,a_21055968,true) at {251} in copy a_21055972 (goal)

The event RecvMsg(bob,alice,stage_a,a_21055968,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_21061770) -> end(RecvMsg(bob,alice,stage_a,m_21061770,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21061815).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21061815.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21061815).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21061815)).

16. The attacker has some term b_21061801.
attacker(b_21061801).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21061801.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21061815).
Using the function concat3 the attacker may obtain concat3(g,b_21061801,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21061815)).
attacker(concat3(g,b_21061801,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21061815))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21061801,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21061815)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21061801,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21061815))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21061801,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21061815)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21061815,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21061815,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21063044,~M_21063045,~M_21063046)) with ~M_21063044 = key_s(charlie), ~M_21063045 = key_e(charlie,alice), ~M_21063046 = key_e(charlie,bob) at {424} in copy a_21061820

out(pub, ~M_21063255) with ~M_21063255 = dhexp(key_s(bob),g) at {319} in copy a_21061820

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21061820

out(pub, ~M_21063602) with ~M_21063602 = dhexp(key_s(bob),g) at {212} in copy a_21061820

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21061820

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21061820

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21061820

out(pub, (~M_21064235,~M_21064236,~M_21064237)) with ~M_21064235 = key_s(charlie), ~M_21064236 = key_e(charlie,alice), ~M_21064237 = key_e(charlie,bob) at {424} in copy a_21061819

out(pub, ~M_21064446) with ~M_21064446 = dhexp(key_s(bob),g) at {319} in copy a_21061819

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21061819

out(pub, ~M_21064793) with ~M_21064793 = dhexp(key_s(bob),g) at {212} in copy a_21061819

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21061819

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21061819

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21061819

out(pub, (~M_21065426,~M_21065427,~M_21065428)) with ~M_21065426 = key_s(charlie), ~M_21065427 = key_e(charlie,alice), ~M_21065428 = key_e(charlie,bob) at {424} in copy a_21061818

out(pub, ~M_21065637) with ~M_21065637 = dhexp(key_s(bob),g) at {319} in copy a_21061818

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21061818

out(pub, ~M_21065984) with ~M_21065984 = dhexp(key_s(bob),g) at {212} in copy a_21061818

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21061818

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21061818

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21061818

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21061820

in(pub, concat3(g,a_21061817,encrypt(hmac_hash2(hash(somename,empty),~M_21063255),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21063255),g),a_21061816))) with encrypt(hmac_hash2(hash(somename,empty),~M_21063255),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21063255),g),a_21061816) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21061816) at {225} in copy a_21061820

event RecvMsg(bob,alice,stage_a,a_21061816,true) at {251} in copy a_21061820 (goal)

The event RecvMsg(bob,alice,stage_a,a_21061816,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_21067622) -> end(RecvMsg(bob,alice,stage_a,m_21067622,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21067667).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21067667.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21067667).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21067667)).

16. The attacker has some term b_21067653.
attacker(b_21067653).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21067653.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21067667).
Using the function concat3 the attacker may obtain concat3(g,b_21067653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21067667)).
attacker(concat3(g,b_21067653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21067667))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21067653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21067667)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21067653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21067667))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21067653,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21067667)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21067667,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21067667,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21068896,~M_21068897,~M_21068898)) with ~M_21068896 = key_s(charlie), ~M_21068897 = key_e(charlie,alice), ~M_21068898 = key_e(charlie,bob) at {424} in copy a_21067672

out(pub, ~M_21069107) with ~M_21069107 = dhexp(key_s(bob),g) at {319} in copy a_21067672

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21067672

out(pub, ~M_21069454) with ~M_21069454 = dhexp(key_s(bob),g) at {212} in copy a_21067672

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21067672

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21067672

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21067672

out(pub, (~M_21070087,~M_21070088,~M_21070089)) with ~M_21070087 = key_s(charlie), ~M_21070088 = key_e(charlie,alice), ~M_21070089 = key_e(charlie,bob) at {424} in copy a_21067671

out(pub, ~M_21070298) with ~M_21070298 = dhexp(key_s(bob),g) at {319} in copy a_21067671

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21067671

out(pub, ~M_21070645) with ~M_21070645 = dhexp(key_s(bob),g) at {212} in copy a_21067671

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21067671

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21067671

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21067671

out(pub, (~M_21071278,~M_21071279,~M_21071280)) with ~M_21071278 = key_s(charlie), ~M_21071279 = key_e(charlie,alice), ~M_21071280 = key_e(charlie,bob) at {424} in copy a_21067670

out(pub, ~M_21071489) with ~M_21071489 = dhexp(key_s(bob),g) at {319} in copy a_21067670

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21067670

out(pub, ~M_21071836) with ~M_21071836 = dhexp(key_s(bob),g) at {212} in copy a_21067670

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21067670

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21067670

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21067670

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21067672

in(pub, concat3(g,a_21067669,encrypt(hmac_hash2(hash(somename,empty),~M_21069107),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21069107),g),a_21067668))) with encrypt(hmac_hash2(hash(somename,empty),~M_21069107),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21069107),g),a_21067668) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21067668) at {225} in copy a_21067672

event RecvMsg(bob,alice,stage_a,a_21067668,true) at {251} in copy a_21067672 (goal)

The event RecvMsg(bob,alice,stage_a,a_21067668,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_21073474) -> end(RecvMsg(bob,alice,stage_a,m_21073474,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21073518).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21073518.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21073518).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21073518)).

16. The attacker has some term b_21073504.
attacker(b_21073504).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21073504.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21073518).
Using the function concat3 the attacker may obtain concat3(g,b_21073504,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21073518)).
attacker(concat3(g,b_21073504,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21073518))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21073504,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21073518)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21073504,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21073518))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21073504,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21073518)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21073518,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21073518,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21074747,~M_21074748,~M_21074749)) with ~M_21074747 = key_s(charlie), ~M_21074748 = key_e(charlie,alice), ~M_21074749 = key_e(charlie,bob) at {424} in copy a_21073523

out(pub, ~M_21074958) with ~M_21074958 = dhexp(key_s(bob),g) at {319} in copy a_21073523

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21073523

out(pub, ~M_21075305) with ~M_21075305 = dhexp(key_s(bob),g) at {212} in copy a_21073523

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21073523

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21073523

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21073523

out(pub, (~M_21075938,~M_21075939,~M_21075940)) with ~M_21075938 = key_s(charlie), ~M_21075939 = key_e(charlie,alice), ~M_21075940 = key_e(charlie,bob) at {424} in copy a_21073522

out(pub, ~M_21076149) with ~M_21076149 = dhexp(key_s(bob),g) at {319} in copy a_21073522

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21073522

out(pub, ~M_21076496) with ~M_21076496 = dhexp(key_s(bob),g) at {212} in copy a_21073522

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21073522

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21073522

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21073522

out(pub, (~M_21077129,~M_21077130,~M_21077131)) with ~M_21077129 = key_s(charlie), ~M_21077130 = key_e(charlie,alice), ~M_21077131 = key_e(charlie,bob) at {424} in copy a_21073521

out(pub, ~M_21077340) with ~M_21077340 = dhexp(key_s(bob),g) at {319} in copy a_21073521

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21073521

out(pub, ~M_21077687) with ~M_21077687 = dhexp(key_s(bob),g) at {212} in copy a_21073521

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21073521

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21073521

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21073521

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21073523

in(pub, concat3(g,a_21073520,encrypt(hmac_hash2(hash(somename,empty),~M_21074958),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21074958),g),a_21073519))) with encrypt(hmac_hash2(hash(somename,empty),~M_21074958),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21074958),g),a_21073519) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21073519) at {225} in copy a_21073523

event RecvMsg(bob,alice,stage_a,a_21073519,true) at {251} in copy a_21073523 (goal)

The event RecvMsg(bob,alice,stage_a,a_21073519,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_21079325) -> end(RecvMsg(bob,alice,stage_a,m_21079325,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_21079369).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know m_21079369.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21079369).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21079369)).

16. The attacker has some term b_21079355.
attacker(b_21079355).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21079355.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21079369).
Using the function concat3 the attacker may obtain concat3(g,b_21079355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21079369)).
attacker(concat3(g,b_21079355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21079369))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21079355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21079369)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21079355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21079369))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21079355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),m_21079369)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_21079369,true) may be executed at {251}.
end(RecvMsg(bob,alice,stage_a,m_21079369,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21080598,~M_21080599,~M_21080600)) with ~M_21080598 = key_s(charlie), ~M_21080599 = key_e(charlie,alice), ~M_21080600 = key_e(charlie,bob) at {424} in copy a_21079374

out(pub, ~M_21080809) with ~M_21080809 = dhexp(key_s(bob),g) at {319} in copy a_21079374

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21079374

out(pub, ~M_21081156) with ~M_21081156 = dhexp(key_s(bob),g) at {212} in copy a_21079374

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21079374

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21079374

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21079374

out(pub, (~M_21081789,~M_21081790,~M_21081791)) with ~M_21081789 = key_s(charlie), ~M_21081790 = key_e(charlie,alice), ~M_21081791 = key_e(charlie,bob) at {424} in copy a_21079373

out(pub, ~M_21082000) with ~M_21082000 = dhexp(key_s(bob),g) at {319} in copy a_21079373

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21079373

out(pub, ~M_21082347) with ~M_21082347 = dhexp(key_s(bob),g) at {212} in copy a_21079373

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21079373

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21079373

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21079373

out(pub, (~M_21082980,~M_21082981,~M_21082982)) with ~M_21082980 = key_s(charlie), ~M_21082981 = key_e(charlie,alice), ~M_21082982 = key_e(charlie,bob) at {424} in copy a_21079372

out(pub, ~M_21083191) with ~M_21083191 = dhexp(key_s(bob),g) at {319} in copy a_21079372

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21079372

out(pub, ~M_21083538) with ~M_21083538 = dhexp(key_s(bob),g) at {212} in copy a_21079372

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21079372

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21079372

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21079372

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21079374

in(pub, concat3(g,a_21079371,encrypt(hmac_hash2(hash(somename,empty),~M_21080809),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21080809),g),a_21079370))) with encrypt(hmac_hash2(hash(somename,empty),~M_21080809),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21080809),g),a_21079370) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21079370) at {225} in copy a_21079374

event RecvMsg(bob,alice,stage_a,a_21079370,true) at {251} in copy a_21079374 (goal)

The event RecvMsg(bob,alice,stage_a,a_21079370,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query not attacker_p1(msg_a(alice,bob))
goal reachable: begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 5, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

7. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

8. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

9. By 1, the attacker may have the channel pub.
By 8, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

10. Using the function empty the attacker may obtain empty.
attacker(empty).

11. Using the function somename the attacker may obtain somename.
attacker(somename).

12. By 11, the attacker may know somename.
By 10, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

13. By 12, the attacker may know hash(somename,empty).
By 10, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

14. By 13, the attacker may know hash(hash(somename,empty),empty).
By 9, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 7, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

16. By 15, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
So the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

17. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

18. The event LeakS(phase0,bob) may be executed at {312}.
So the message key_s(bob) may be sent on channel pub at output {313}.
mess(pub,key_s(bob)).

19. By 1, the attacker may have the channel pub.
By 18, the message key_s(bob) may be sent on this channel.
So the attacker may obtain the message key_s(bob) by listening on this channel.
attacker(key_s(bob)).

20. By 19, the attacker may know key_s(bob).
By 7, the attacker may know dhexp(key_e(alice,bob),g).
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
attacker(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

21. By 12, the attacker may know hash(somename,empty).
By 20, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

22. By 21, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
So the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
attacker_p1(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
By 17, the attacker may know minnonce in phase 1.
By 16, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
By 6, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

24. By 23, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


Could not find a trace corresponding to this derivation.
RESULT not attacker_p1(msg_a(alice,bob)) cannot be proved.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob))
goal reachable: begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)) is true.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice)))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 5, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

7. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

8. By 7, the attacker may know dhexp(key_e(alice,bob),g).
So the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),g)).

9. Using the function g the attacker may obtain g in phase 1.
attacker_p1(g).

10. Using the function pub the attacker may obtain pub in phase 1.
attacker_p1(pub).

11. The event LeakS(phase1,bob) may be executed at {315}.
So the message key_s(bob) may be sent on channel pub in phase 1 at output {316}.
mess_p1(pub,key_s(bob)).

12. By 10, the attacker may have the channel pub in phase 1.
By 11, the message key_s(bob) in phase 1 may be sent on this channel.
So the attacker may obtain the message key_s(bob) in phase 1 by listening on this channel.
attacker_p1(key_s(bob)).

13. By 12, the attacker may know key_s(bob) in phase 1.
By 9, the attacker may know g in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_s(bob),g) in phase 1.
attacker_p1(dhexp(key_s(bob),g)).

14. Using the function empty the attacker may obtain empty in phase 1.
attacker_p1(empty).

15. Using the function somename the attacker may obtain somename in phase 1.
attacker_p1(somename).

16. By 15, the attacker may know somename in phase 1.
By 14, the attacker may know empty in phase 1.
Using the function hash the attacker may obtain hash(somename,empty) in phase 1.
attacker_p1(hash(somename,empty)).

17. By 16, the attacker may know hash(somename,empty) in phase 1.
By 14, the attacker may know empty in phase 1.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty) in phase 1.
attacker_p1(hash(hash(somename,empty),empty)).

18. By 17, the attacker may know hash(hash(somename,empty),empty) in phase 1.
By 13, the attacker may know dhexp(key_s(bob),g) in phase 1.
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

19. By 18, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)) in phase 1.
By 8, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

20. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

21. By 12, the attacker may know key_s(bob) in phase 1.
By 8, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

22. By 16, the attacker may know hash(somename,empty) in phase 1.
By 21, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
attacker_p1(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
By 20, the attacker may know minnonce in phase 1.
By 19, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
By 6, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

24. By 23, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


Could not find a trace corresponding to this derivation.
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))) cannot be proved.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase1,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 5, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

7. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

8. By 7, the attacker may know dhexp(key_e(alice,bob),g).
So the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),g)).

9. Using the function g the attacker may obtain g in phase 1.
attacker_p1(g).

10. Using the function pub the attacker may obtain pub in phase 1.
attacker_p1(pub).

11. The event LeakS(phase1,bob) may be executed at {315}.
So the message key_s(bob) may be sent on channel pub in phase 1 at output {316}.
mess_p1(pub,key_s(bob)).

12. By 10, the attacker may have the channel pub in phase 1.
By 11, the message key_s(bob) in phase 1 may be sent on this channel.
So the attacker may obtain the message key_s(bob) in phase 1 by listening on this channel.
attacker_p1(key_s(bob)).

13. By 12, the attacker may know key_s(bob) in phase 1.
By 9, the attacker may know g in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_s(bob),g) in phase 1.
attacker_p1(dhexp(key_s(bob),g)).

14. Using the function empty the attacker may obtain empty in phase 1.
attacker_p1(empty).

15. Using the function somename the attacker may obtain somename in phase 1.
attacker_p1(somename).

16. By 15, the attacker may know somename in phase 1.
By 14, the attacker may know empty in phase 1.
Using the function hash the attacker may obtain hash(somename,empty) in phase 1.
attacker_p1(hash(somename,empty)).

17. By 16, the attacker may know hash(somename,empty) in phase 1.
By 14, the attacker may know empty in phase 1.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty) in phase 1.
attacker_p1(hash(hash(somename,empty),empty)).

18. By 17, the attacker may know hash(hash(somename,empty),empty) in phase 1.
By 13, the attacker may know dhexp(key_s(bob),g) in phase 1.
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

19. By 18, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)) in phase 1.
By 8, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

20. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

21. By 12, the attacker may know key_s(bob) in phase 1.
By 8, the attacker may know dhexp(key_e(alice,bob),g) in phase 1.
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
attacker_p1(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

22. By 16, the attacker may know hash(somename,empty) in phase 1.
By 21, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)) in phase 1.
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
attacker_p1(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))) in phase 1.
By 20, the attacker may know minnonce in phase 1.
By 19, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)) in phase 1.
By 6, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

24. By 23, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


Could not find a trace corresponding to this derivation.
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) cannot be proved.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_21101449) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_21101449,true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 1 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {43}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

3. We assume as hypothesis that
attacker(m_21101558).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

8. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 7 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 4, the attacker may have the channel pub.
By 8, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

10. By 9, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

11. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

12. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 11 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

13. By 4, the attacker may have the channel pub.
By 12, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

14. By 13, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

15. Using the function empty the attacker may obtain empty.
attacker(empty).

16. Using the function somename the attacker may obtain somename.
attacker(somename).

17. By 16, the attacker may know somename.
By 15, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

18. By 17, the attacker may know hash(somename,empty).
By 15, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

19. By 18, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

20. By 19, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 14, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

21. By 20, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
By 10, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

22. By 21, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g))).

23. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

24. The event LeakS(phase0,bob) may be executed at {312}.
So the message key_s(bob) may be sent on channel pub at output {313}.
mess(pub,key_s(bob)).

25. By 4, the attacker may have the channel pub.
By 24, the message key_s(bob) may be sent on this channel.
So the attacker may obtain the message key_s(bob) by listening on this channel.
attacker(key_s(bob)).

26. By 25, the attacker may know key_s(bob).
By 14, the attacker may know dhexp(key_e(alice,bob),g).
Using the function dhexp the attacker may obtain dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
attacker(dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).

27. By 17, the attacker may know hash(somename,empty).
By 26, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

28. By 27, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
By 26, the attacker may know dhexp(key_e(alice,bob),dhexp(key_s(bob),g)).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g)))).

29. By 28, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))).
By 23, the attacker may know minnonce.
By 22, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)).
By 3, the attacker may know m_21101558.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21101558).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21101558)).

30. The attacker has some term b_21101545.
attacker(b_21101545).

31. By 6, the attacker may know dhexp(key_s(bob),g).
By 30, the attacker may know b_21101545.
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21101558).
Using the function concat3 the attacker may obtain concat3(dhexp(key_s(bob),g),b_21101545,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21101558)).
attacker(concat3(dhexp(key_s(bob),g),b_21101545,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21101558))).

32. By 4, the attacker may have the channel pub.
By 31, the attacker may have the message concat3(dhexp(key_s(bob),g),b_21101545,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21101558)).
So the attacker may send this message on this channel.
mess(pub,concat3(dhexp(key_s(bob),g),b_21101545,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21101558))).

33. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {74}.
The message concat3(dhexp(key_s(bob),g),b_21101545,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),m_21101558)) that may be sent on channel pub by 32 may be received at input {46}.
We have dhexp(key_s(bob),g) <> caught-fail.
So event RecvMsg(alice,bob,stage_b,m_21101558,true) may be executed at {72}.
end(RecvMsg(alice,bob,stage_b,m_21101558,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21105221,~M_21105222,~M_21105223)) with ~M_21105221 = key_s(charlie), ~M_21105222 = key_e(charlie,alice), ~M_21105223 = key_e(charlie,bob) at {424} in copy a_21101569

out(pub, ~M_21105432) with ~M_21105432 = dhexp(key_s(bob),g) at {319} in copy a_21101569

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21101569

out(pub, ~M_21105779) with ~M_21105779 = dhexp(key_s(bob),g) at {212} in copy a_21101569

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21101569

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21101569

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21101569

out(pub, (~M_21106412,~M_21106413,~M_21106414)) with ~M_21106412 = key_s(charlie), ~M_21106413 = key_e(charlie,alice), ~M_21106414 = key_e(charlie,bob) at {424} in copy a_21101568

out(pub, ~M_21106623) with ~M_21106623 = dhexp(key_s(bob),g) at {319} in copy a_21101568

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21101568

out(pub, ~M_21106970) with ~M_21106970 = dhexp(key_s(bob),g) at {212} in copy a_21101568

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21101568

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21101568

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21101568

out(pub, (~M_21107603,~M_21107604,~M_21107605)) with ~M_21107603 = key_s(charlie), ~M_21107604 = key_e(charlie,alice), ~M_21107605 = key_e(charlie,bob) at {424} in copy a_21101567

out(pub, ~M_21107814) with ~M_21107814 = dhexp(key_s(bob),g) at {319} in copy a_21101567

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21101567

out(pub, ~M_21108161) with ~M_21108161 = dhexp(key_s(bob),g) at {212} in copy a_21101567

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21101567

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21101567

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21101567

out(pub, (~M_21108794,~M_21108795,~M_21108796)) with ~M_21108794 = key_s(charlie), ~M_21108795 = key_e(charlie,alice), ~M_21108796 = key_e(charlie,bob) at {424} in copy a_21101566

out(pub, ~M_21109005) with ~M_21109005 = dhexp(key_s(bob),g) at {319} in copy a_21101566

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21101566

out(pub, ~M_21109352) with ~M_21109352 = dhexp(key_s(bob),g) at {212} in copy a_21101566

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21101566

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21101566

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21101566

out(pub, (~M_21109985,~M_21109986,~M_21109987)) with ~M_21109985 = key_s(charlie), ~M_21109986 = key_e(charlie,alice), ~M_21109987 = key_e(charlie,bob) at {424} in copy a_21101565

out(pub, ~M_21110196) with ~M_21110196 = dhexp(key_s(bob),g) at {319} in copy a_21101565

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21101565

out(pub, ~M_21110543) with ~M_21110543 = dhexp(key_s(bob),g) at {212} in copy a_21101565

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21101565

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21101565

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21101565

out(pub, (~M_21111176,~M_21111177,~M_21111178)) with ~M_21111176 = key_s(charlie), ~M_21111177 = key_e(charlie,alice), ~M_21111178 = key_e(charlie,bob) at {424} in copy a_21101564

out(pub, ~M_21111387) with ~M_21111387 = dhexp(key_s(bob),g) at {319} in copy a_21101564

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21101564

out(pub, ~M_21111734) with ~M_21111734 = dhexp(key_s(bob),g) at {212} in copy a_21101564

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21101564

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21101564

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21101564

out(pub, (~M_21112367,~M_21112368,~M_21112369)) with ~M_21112367 = key_s(charlie), ~M_21112368 = key_e(charlie,alice), ~M_21112369 = key_e(charlie,bob) at {424} in copy a_21101563

out(pub, ~M_21112578) with ~M_21112578 = dhexp(key_s(bob),g) at {319} in copy a_21101563

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21101563

out(pub, ~M_21112925) with ~M_21112925 = dhexp(key_s(bob),g) at {212} in copy a_21101563

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21101563

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21101563

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21101563

out(pub, (~M_21113558,~M_21113559,~M_21113560)) with ~M_21113558 = key_s(charlie), ~M_21113559 = key_e(charlie,alice), ~M_21113560 = key_e(charlie,bob) at {424} in copy a_21101562

out(pub, ~M_21113769) with ~M_21113769 = dhexp(key_s(bob),g) at {319} in copy a_21101562

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21101562

out(pub, ~M_21114116) with ~M_21114116 = dhexp(key_s(bob),g) at {212} in copy a_21101562

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21101562

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21101562

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21101562

out(pub, (~M_21114749,~M_21114750,~M_21114751)) with ~M_21114749 = key_s(charlie), ~M_21114750 = key_e(charlie,alice), ~M_21114751 = key_e(charlie,bob) at {424} in copy a_21101561

out(pub, ~M_21114960) with ~M_21114960 = dhexp(key_s(bob),g) at {319} in copy a_21101561

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21101561

out(pub, ~M_21115307) with ~M_21115307 = dhexp(key_s(bob),g) at {212} in copy a_21101561

event LeakS(phase0,bob) at {312} in copy a_21101561

out(pub, ~M_21115309) with ~M_21115309 = key_s(bob) at {313} in copy a_21101561

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21101561

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21101561

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21101561

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {45} in copy a_21101563

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {42} in copy a_21101563

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {43} in copy a_21101563

out(pub, concat3(~M_21116886,empty,~M_21116888)) with ~M_21116886 = dhexp(key_e(alice,bob),g), ~M_21116888 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {44} in copy a_21101563

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {45} in copy a_21101565

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {42} in copy a_21101565

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {43} in copy a_21101565

out(pub, concat3(~M_21117834,empty,~M_21117836)) with ~M_21117834 = dhexp(key_e(alice,bob),g), ~M_21117836 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {44} in copy a_21101565

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {45} in copy a_21101568

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {42} in copy a_21101568

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {43} in copy a_21101568

out(pub, concat3(~M_21118794,empty,~M_21118796)) with ~M_21118794 = dhexp(key_e(alice,bob),g), ~M_21118796 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {44} in copy a_21101568

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) at {74} in copy a_21101569

in(pub, concat3(~M_21105432,a_21101560,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_21115309,~M_21116886)),dhexp(~M_21115309,~M_21116886)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21105432),~M_21116886),~M_21116888),~M_21105432),a_21101559))) with ~M_21105432 = dhexp(key_s(bob),g), encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_21115309,~M_21116886)),dhexp(~M_21115309,~M_21116886)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21105432),~M_21116886),~M_21116888),~M_21105432),a_21101559) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_s(bob),g)),a_21101559) at {46} in copy a_21101569

event RecvMsg(alice,bob,stage_b,a_21101559,true) at {72} in copy a_21101569 (goal)

The event RecvMsg(alice,bob,stage_b,a_21101559,true) is executed.
A trace has been found.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_21119786) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_21119786,true))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,alice),true))
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)) is true.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase0,bob)) && attacker(m_21119792) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_21119792,true))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,alice),true))
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) is true.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 1 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {43}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

4. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

5. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 4 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

6. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 3 may be read at get {360}.
The message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) that may be sent on channel pub by 5 may be received at input {332}.
We have dhexp(key_e(alice,bob),g) <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false))) may be inserted in a table at insert {359}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false)))).

7. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false))) that may be in a table by 6 may be read at get {390}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {387}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {389}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

8. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {74}.
The message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) that may be sent on channel pub by 7 may be received at input {46}.
We have dhexp(key_e(bob,charlie),g) <> caught-fail.
So event RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true) may be executed at {72}.
end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true)).


Could not find a trace corresponding to this derivation.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)) cannot be proved.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 1 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {43}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

4. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

5. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 4 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

6. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 3 may be read at get {360}.
The message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) that may be sent on channel pub by 5 may be received at input {332}.
We have dhexp(key_e(alice,bob),g) <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false))) may be inserted in a table at insert {359}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false)))).

7. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,dhexp(key_e(alice,bob),g),empty,false))) that may be in a table by 6 may be read at get {390}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {387}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {389}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

8. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {74}.
The message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),dhexp(key_e(bob,charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) that may be sent on channel pub by 7 may be received at input {46}.
We have dhexp(key_e(bob,charlie),g) <> caught-fail.
So event RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true) may be executed at {72}.
end(RecvMsg(alice,bob,stage_b,msg_b(bob,charlie),true)).


Could not find a trace corresponding to this derivation.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) cannot be proved.
Starting query not attacker_p1(msg_b(bob,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

3. The attacker has some term plaintext_a_21385588.
attacker(plaintext_a_21385588).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_21385588.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)).

16. The attacker has some term b_21385584.
attacker(b_21385584).

17. By 4, the attacker may know g.
By 16, the attacker may know b_21385584.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588).
Using the function concat3 the attacker may obtain concat3(g,b_21385584,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)).
attacker(concat3(g,b_21385584,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588))).

18. By 1, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21385584,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21385584,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 2 may be read at get {253}.
The message concat3(g,b_21385584,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 1, the attacker may have the channel pub.
By 20, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

22. By 21, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

23. By 22, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

24. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

25. The attacker has some term plaintext_a_21385510.
attacker(plaintext_a_21385510).

26. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 25, the attacker may know plaintext_a_21385510.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)).

27. The attacker has some term b_21385506.
attacker(b_21385506).

28. By 4, the attacker may know g.
By 27, the attacker may know b_21385506.
By 26, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510).
Using the function concat3 the attacker may obtain concat3(g,b_21385506,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)).
attacker(concat3(g,b_21385506,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(g,b_21385506,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21385506,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 24 may be read at get {253}.
The message concat3(g,b_21385506,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)) that may be sent on channel pub by 29 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 30 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385510)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g))).

36. By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)).
So the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g))).

37. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

38. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

41. By 40, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
By 37, the attacker may know minnonce in phase 1.
By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)) in phase 1.
By 23, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

42. By 41, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21385588)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


Could not find a trace corresponding to this derivation.
RESULT not attacker_p1(msg_b(bob,alice)) cannot be proved.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

3. The attacker has some term plaintext_a_21406848.
attacker(plaintext_a_21406848).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_21406848.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)).

16. The attacker has some term b_21406844.
attacker(b_21406844).

17. By 4, the attacker may know g.
By 16, the attacker may know b_21406844.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848).
Using the function concat3 the attacker may obtain concat3(g,b_21406844,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)).
attacker(concat3(g,b_21406844,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848))).

18. By 1, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21406844,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21406844,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 2 may be read at get {253}.
The message concat3(g,b_21406844,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 1, the attacker may have the channel pub.
By 20, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

22. By 21, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

23. By 22, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

24. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

25. The attacker has some term plaintext_a_21406770.
attacker(plaintext_a_21406770).

26. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 25, the attacker may know plaintext_a_21406770.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)).

27. The attacker has some term b_21406766.
attacker(b_21406766).

28. By 4, the attacker may know g.
By 27, the attacker may know b_21406766.
By 26, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770).
Using the function concat3 the attacker may obtain concat3(g,b_21406766,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)).
attacker(concat3(g,b_21406766,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(g,b_21406766,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21406766,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 24 may be read at get {253}.
The message concat3(g,b_21406766,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)) that may be sent on channel pub by 29 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 30 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406770)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g))).

36. By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)).
So the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g))).

37. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

38. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

41. By 40, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
By 37, the attacker may know minnonce in phase 1.
By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)) in phase 1.
By 23, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

42. By 41, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21406848)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


Could not find a trace corresponding to this derivation.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice)) cannot be proved.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob)))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

3. The attacker has some term plaintext_a_21428109.
attacker(plaintext_a_21428109).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_21428109.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)).

16. The attacker has some term b_21428105.
attacker(b_21428105).

17. By 4, the attacker may know g.
By 16, the attacker may know b_21428105.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109).
Using the function concat3 the attacker may obtain concat3(g,b_21428105,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)).
attacker(concat3(g,b_21428105,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109))).

18. By 1, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21428105,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21428105,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 2 may be read at get {253}.
The message concat3(g,b_21428105,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 1, the attacker may have the channel pub.
By 20, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

22. By 21, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

23. By 22, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

24. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

25. The attacker has some term plaintext_a_21428031.
attacker(plaintext_a_21428031).

26. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 25, the attacker may know plaintext_a_21428031.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)).

27. The attacker has some term b_21428027.
attacker(b_21428027).

28. By 4, the attacker may know g.
By 27, the attacker may know b_21428027.
By 26, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031).
Using the function concat3 the attacker may obtain concat3(g,b_21428027,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)).
attacker(concat3(g,b_21428027,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(g,b_21428027,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21428027,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 24 may be read at get {253}.
The message concat3(g,b_21428027,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)) that may be sent on channel pub by 29 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 30 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428031)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g))).

36. By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)).
So the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g))).

37. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

38. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

41. By 40, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
By 37, the attacker may know minnonce in phase 1.
By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)) in phase 1.
By 23, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

42. By 41, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21428109)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


Could not find a trace corresponding to this derivation.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob))) cannot be proved.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

3. The attacker has some term plaintext_a_21449369.
attacker(plaintext_a_21449369).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 3, the attacker may know plaintext_a_21449369.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)).

16. The attacker has some term b_21449365.
attacker(b_21449365).

17. By 4, the attacker may know g.
By 16, the attacker may know b_21449365.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369).
Using the function concat3 the attacker may obtain concat3(g,b_21449365,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)).
attacker(concat3(g,b_21449365,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369))).

18. By 1, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21449365,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21449365,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 2 may be read at get {253}.
The message concat3(g,b_21449365,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 1, the attacker may have the channel pub.
By 20, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

22. By 21, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

23. By 22, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

24. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

25. The attacker has some term plaintext_a_21449291.
attacker(plaintext_a_21449291).

26. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 25, the attacker may know plaintext_a_21449291.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)).

27. The attacker has some term b_21449287.
attacker(b_21449287).

28. By 4, the attacker may know g.
By 27, the attacker may know b_21449287.
By 26, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291).
Using the function concat3 the attacker may obtain concat3(g,b_21449287,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)).
attacker(concat3(g,b_21449287,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(g,b_21449287,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21449287,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 24 may be read at get {253}.
The message concat3(g,b_21449287,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)) that may be sent on channel pub by 29 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 30 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449291)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g))).

36. By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)).
So the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g))).

37. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

38. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

39. By 38, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

40. By 39, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

41. By 40, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)) in phase 1.
By 37, the attacker may know minnonce in phase 1.
By 36, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)) in phase 1.
By 23, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

42. By 41, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21449369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


Could not find a trace corresponding to this derivation.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) cannot be proved.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true))
goal reachable: attacker(m_21470517) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21470517,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21470700.
attacker(plaintext_a_21470700).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21470700.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)).

16. The attacker has some term b_21470696.
attacker(b_21470696).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21470696.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700).
Using the function concat3 the attacker may obtain concat3(g,b_21470696,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)).
attacker(concat3(g,b_21470696,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21470696,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21470696,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21470696,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21470735).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21470629.
attacker(b_21470629).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21470629.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700).
Using the function concat3 the attacker may obtain concat3(g,b_21470629,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)).
attacker(concat3(g,b_21470629,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21470629,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21470629,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21470629,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21470557.
attacker(plaintext_a_21470557).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21470557.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)).

33. The attacker has some term b_21470553.
attacker(b_21470553).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21470553.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557).
Using the function concat3 the attacker may obtain concat3(g,b_21470553,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)).
attacker(concat3(g,b_21470553,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21470553,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21470553,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21470553,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470557)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21470735.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21470735).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21470735)).

47. The attacker has some term b_21470721.
attacker(b_21470721).

48. The attacker has some term a_21470720.
attacker(a_21470720).

49. By 48, the attacker may know a_21470720.
By 47, the attacker may know b_21470721.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21470735).
Using the function concat3 the attacker may obtain concat3(a_21470720,b_21470721,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21470735)).
attacker(concat3(a_21470720,b_21470721,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21470735))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21470720,b_21470721,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21470735)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21470720,b_21470721,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21470735))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21470720,b_21470721,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21470700)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21470735)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21470735,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21470735,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21475221,~M_21475222,~M_21475223)) with ~M_21475221 = key_s(charlie), ~M_21475222 = key_e(charlie,alice), ~M_21475223 = key_e(charlie,bob) at {424} in copy a_21470754

out(pub, ~M_21475432) with ~M_21475432 = dhexp(key_s(bob),g) at {319} in copy a_21470754

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470754

out(pub, ~M_21475779) with ~M_21475779 = dhexp(key_s(bob),g) at {212} in copy a_21470754

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470754

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470754

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470754

out(pub, (~M_21476412,~M_21476413,~M_21476414)) with ~M_21476412 = key_s(charlie), ~M_21476413 = key_e(charlie,alice), ~M_21476414 = key_e(charlie,bob) at {424} in copy a_21470753

out(pub, ~M_21476623) with ~M_21476623 = dhexp(key_s(bob),g) at {319} in copy a_21470753

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470753

out(pub, ~M_21476970) with ~M_21476970 = dhexp(key_s(bob),g) at {212} in copy a_21470753

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470753

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470753

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470753

out(pub, (~M_21477603,~M_21477604,~M_21477605)) with ~M_21477603 = key_s(charlie), ~M_21477604 = key_e(charlie,alice), ~M_21477605 = key_e(charlie,bob) at {424} in copy a_21470752

out(pub, ~M_21477814) with ~M_21477814 = dhexp(key_s(bob),g) at {319} in copy a_21470752

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470752

out(pub, ~M_21478161) with ~M_21478161 = dhexp(key_s(bob),g) at {212} in copy a_21470752

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470752

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470752

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470752

out(pub, (~M_21478794,~M_21478795,~M_21478796)) with ~M_21478794 = key_s(charlie), ~M_21478795 = key_e(charlie,alice), ~M_21478796 = key_e(charlie,bob) at {424} in copy a_21470751

out(pub, ~M_21479005) with ~M_21479005 = dhexp(key_s(bob),g) at {319} in copy a_21470751

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470751

out(pub, ~M_21479352) with ~M_21479352 = dhexp(key_s(bob),g) at {212} in copy a_21470751

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470751

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470751

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470751

out(pub, (~M_21479985,~M_21479986,~M_21479987)) with ~M_21479985 = key_s(charlie), ~M_21479986 = key_e(charlie,alice), ~M_21479987 = key_e(charlie,bob) at {424} in copy a_21470750

out(pub, ~M_21480196) with ~M_21480196 = dhexp(key_s(bob),g) at {319} in copy a_21470750

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470750

out(pub, ~M_21480543) with ~M_21480543 = dhexp(key_s(bob),g) at {212} in copy a_21470750

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470750

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470750

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470750

out(pub, (~M_21481176,~M_21481177,~M_21481178)) with ~M_21481176 = key_s(charlie), ~M_21481177 = key_e(charlie,alice), ~M_21481178 = key_e(charlie,bob) at {424} in copy a_21470748

out(pub, ~M_21481387) with ~M_21481387 = dhexp(key_s(bob),g) at {319} in copy a_21470748

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470748

out(pub, ~M_21481734) with ~M_21481734 = dhexp(key_s(bob),g) at {212} in copy a_21470748

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470748

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470748

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470748

out(pub, (~M_21482367,~M_21482368,~M_21482369)) with ~M_21482367 = key_s(charlie), ~M_21482368 = key_e(charlie,alice), ~M_21482369 = key_e(charlie,bob) at {424} in copy a_21470747

out(pub, ~M_21482578) with ~M_21482578 = dhexp(key_s(bob),g) at {319} in copy a_21470747

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470747

out(pub, ~M_21482925) with ~M_21482925 = dhexp(key_s(bob),g) at {212} in copy a_21470747

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470747

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470747

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470747

out(pub, (~M_21483558,~M_21483559,~M_21483560)) with ~M_21483558 = key_s(charlie), ~M_21483559 = key_e(charlie,alice), ~M_21483560 = key_e(charlie,bob) at {424} in copy a_21470746

out(pub, ~M_21483769) with ~M_21483769 = dhexp(key_s(bob),g) at {319} in copy a_21470746

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470746

out(pub, ~M_21484116) with ~M_21484116 = dhexp(key_s(bob),g) at {212} in copy a_21470746

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470746

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470746

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470746

out(pub, (~M_21484749,~M_21484750,~M_21484751)) with ~M_21484749 = key_s(charlie), ~M_21484750 = key_e(charlie,alice), ~M_21484751 = key_e(charlie,bob) at {424} in copy a_21470744

out(pub, ~M_21484960) with ~M_21484960 = dhexp(key_s(bob),g) at {319} in copy a_21470744

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470744

out(pub, ~M_21485307) with ~M_21485307 = dhexp(key_s(bob),g) at {212} in copy a_21470744

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470744

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470744

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470744

out(pub, (~M_21485940,~M_21485941,~M_21485942)) with ~M_21485940 = key_s(charlie), ~M_21485941 = key_e(charlie,alice), ~M_21485942 = key_e(charlie,bob) at {424} in copy a_21470743

out(pub, ~M_21486151) with ~M_21486151 = dhexp(key_s(bob),g) at {319} in copy a_21470743

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470743

out(pub, ~M_21486498) with ~M_21486498 = dhexp(key_s(bob),g) at {212} in copy a_21470743

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470743

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470743

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470743

out(pub, (~M_21487131,~M_21487132,~M_21487133)) with ~M_21487131 = key_s(charlie), ~M_21487132 = key_e(charlie,alice), ~M_21487133 = key_e(charlie,bob) at {424} in copy a_21470742

out(pub, ~M_21487342) with ~M_21487342 = dhexp(key_s(bob),g) at {319} in copy a_21470742

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21470742

out(pub, ~M_21487689) with ~M_21487689 = dhexp(key_s(bob),g) at {212} in copy a_21470742

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21470742

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21470742

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21470742

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21470743

in(pub, concat3(g,a_21470741,encrypt(hmac_hash2(hash(somename,empty),~M_21475432),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),a_21470740))) with encrypt(hmac_hash2(hash(somename,empty),~M_21475432),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),a_21470740) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470740) at {225} in copy a_21470743

event RecvMsg(bob,alice,stage_a,a_21470740,true) at {251} in copy a_21470743

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470740))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21470743

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470740))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21470744

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21470744

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470740)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470740)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21470744

out(pub, concat3(~M_21490247,empty,~M_21490249)) with ~M_21490247 = dhexp(key_e(bob,alice),g), ~M_21490249 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470740)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21470744

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21470747

in(pub, concat3(g,a_21470745,encrypt(hmac_hash2(hash(somename,empty),~M_21475432),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),a_21470739))) with encrypt(hmac_hash2(hash(somename,empty),~M_21475432),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),a_21470739) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739) at {225} in copy a_21470747

event RecvMsg(bob,alice,stage_a,a_21470739,true) at {251} in copy a_21470747

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21470747

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21470748

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21470748

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21470748

out(pub, concat3(~M_21492181,empty,~M_21492183)) with ~M_21492181 = dhexp(key_e(bob,alice),g), ~M_21492183 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21470748

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21470752

in(pub, concat3(g,a_21470749,encrypt(hmac_hash2(hash(somename,empty),~M_21475432),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),a_21470739))) with encrypt(hmac_hash2(hash(somename,empty),~M_21475432),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),a_21470739) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739) at {225} in copy a_21470752

event RecvMsg(bob,alice,stage_a,a_21470739,true) at {251} in copy a_21470752

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21470752

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21470753

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21470753

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21470753

out(pub, concat3(~M_21494127,empty,~M_21494129)) with ~M_21494127 = dhexp(key_e(bob,alice),g), ~M_21494129 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21470753

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21470754

in(pub, concat3(a_21470737,a_21470738,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21475432),~M_21490247),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),encrypt(hmac_hash2(hash(somename,empty),~M_21475432),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),a_21470739)),~M_21490247),~M_21492183),a_21470736))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21475432),~M_21490247),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),encrypt(hmac_hash2(hash(somename,empty),~M_21475432),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21475432),g),a_21470739)),~M_21490247),~M_21492183),a_21470736) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21470739)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21470736) at {284} in copy a_21470754

event RecvMsg(bob,alice,stage_c,a_21470736,true) at {308} in copy a_21470754 (goal)

The event RecvMsg(bob,alice,stage_c,a_21470736,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_21495005) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21495005,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21495189.
attacker(plaintext_a_21495189).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21495189.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)).

16. The attacker has some term b_21495185.
attacker(b_21495185).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21495185.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189).
Using the function concat3 the attacker may obtain concat3(g,b_21495185,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)).
attacker(concat3(g,b_21495185,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21495185,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21495185,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21495185,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21495224).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21495118.
attacker(b_21495118).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21495118.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189).
Using the function concat3 the attacker may obtain concat3(g,b_21495118,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)).
attacker(concat3(g,b_21495118,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21495118,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21495118,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21495118,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21495046.
attacker(plaintext_a_21495046).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21495046.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)).

33. The attacker has some term b_21495042.
attacker(b_21495042).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21495042.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046).
Using the function concat3 the attacker may obtain concat3(g,b_21495042,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)).
attacker(concat3(g,b_21495042,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21495042,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21495042,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21495042,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495046)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21495224.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21495224).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21495224)).

47. The attacker has some term b_21495210.
attacker(b_21495210).

48. The attacker has some term a_21495209.
attacker(a_21495209).

49. By 48, the attacker may know a_21495209.
By 47, the attacker may know b_21495210.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21495224).
Using the function concat3 the attacker may obtain concat3(a_21495209,b_21495210,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21495224)).
attacker(concat3(a_21495209,b_21495210,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21495224))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21495209,b_21495210,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21495224)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21495209,b_21495210,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21495224))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21495209,b_21495210,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21495189)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21495224)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21495224,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21495224,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21499710,~M_21499711,~M_21499712)) with ~M_21499710 = key_s(charlie), ~M_21499711 = key_e(charlie,alice), ~M_21499712 = key_e(charlie,bob) at {424} in copy a_21495243

out(pub, ~M_21499921) with ~M_21499921 = dhexp(key_s(bob),g) at {319} in copy a_21495243

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495243

out(pub, ~M_21500268) with ~M_21500268 = dhexp(key_s(bob),g) at {212} in copy a_21495243

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495243

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495243

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495243

out(pub, (~M_21500901,~M_21500902,~M_21500903)) with ~M_21500901 = key_s(charlie), ~M_21500902 = key_e(charlie,alice), ~M_21500903 = key_e(charlie,bob) at {424} in copy a_21495242

out(pub, ~M_21501112) with ~M_21501112 = dhexp(key_s(bob),g) at {319} in copy a_21495242

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495242

out(pub, ~M_21501459) with ~M_21501459 = dhexp(key_s(bob),g) at {212} in copy a_21495242

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495242

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495242

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495242

out(pub, (~M_21502092,~M_21502093,~M_21502094)) with ~M_21502092 = key_s(charlie), ~M_21502093 = key_e(charlie,alice), ~M_21502094 = key_e(charlie,bob) at {424} in copy a_21495241

out(pub, ~M_21502303) with ~M_21502303 = dhexp(key_s(bob),g) at {319} in copy a_21495241

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495241

out(pub, ~M_21502650) with ~M_21502650 = dhexp(key_s(bob),g) at {212} in copy a_21495241

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495241

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495241

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495241

out(pub, (~M_21503283,~M_21503284,~M_21503285)) with ~M_21503283 = key_s(charlie), ~M_21503284 = key_e(charlie,alice), ~M_21503285 = key_e(charlie,bob) at {424} in copy a_21495240

out(pub, ~M_21503494) with ~M_21503494 = dhexp(key_s(bob),g) at {319} in copy a_21495240

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495240

out(pub, ~M_21503841) with ~M_21503841 = dhexp(key_s(bob),g) at {212} in copy a_21495240

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495240

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495240

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495240

out(pub, (~M_21504474,~M_21504475,~M_21504476)) with ~M_21504474 = key_s(charlie), ~M_21504475 = key_e(charlie,alice), ~M_21504476 = key_e(charlie,bob) at {424} in copy a_21495239

out(pub, ~M_21504685) with ~M_21504685 = dhexp(key_s(bob),g) at {319} in copy a_21495239

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495239

out(pub, ~M_21505032) with ~M_21505032 = dhexp(key_s(bob),g) at {212} in copy a_21495239

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495239

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495239

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495239

out(pub, (~M_21505665,~M_21505666,~M_21505667)) with ~M_21505665 = key_s(charlie), ~M_21505666 = key_e(charlie,alice), ~M_21505667 = key_e(charlie,bob) at {424} in copy a_21495237

out(pub, ~M_21505876) with ~M_21505876 = dhexp(key_s(bob),g) at {319} in copy a_21495237

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495237

out(pub, ~M_21506223) with ~M_21506223 = dhexp(key_s(bob),g) at {212} in copy a_21495237

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495237

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495237

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495237

out(pub, (~M_21506856,~M_21506857,~M_21506858)) with ~M_21506856 = key_s(charlie), ~M_21506857 = key_e(charlie,alice), ~M_21506858 = key_e(charlie,bob) at {424} in copy a_21495236

out(pub, ~M_21507067) with ~M_21507067 = dhexp(key_s(bob),g) at {319} in copy a_21495236

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495236

out(pub, ~M_21507414) with ~M_21507414 = dhexp(key_s(bob),g) at {212} in copy a_21495236

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495236

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495236

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495236

out(pub, (~M_21508047,~M_21508048,~M_21508049)) with ~M_21508047 = key_s(charlie), ~M_21508048 = key_e(charlie,alice), ~M_21508049 = key_e(charlie,bob) at {424} in copy a_21495235

out(pub, ~M_21508258) with ~M_21508258 = dhexp(key_s(bob),g) at {319} in copy a_21495235

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495235

out(pub, ~M_21508605) with ~M_21508605 = dhexp(key_s(bob),g) at {212} in copy a_21495235

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495235

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495235

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495235

out(pub, (~M_21509238,~M_21509239,~M_21509240)) with ~M_21509238 = key_s(charlie), ~M_21509239 = key_e(charlie,alice), ~M_21509240 = key_e(charlie,bob) at {424} in copy a_21495233

out(pub, ~M_21509449) with ~M_21509449 = dhexp(key_s(bob),g) at {319} in copy a_21495233

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495233

out(pub, ~M_21509796) with ~M_21509796 = dhexp(key_s(bob),g) at {212} in copy a_21495233

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495233

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495233

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495233

out(pub, (~M_21510429,~M_21510430,~M_21510431)) with ~M_21510429 = key_s(charlie), ~M_21510430 = key_e(charlie,alice), ~M_21510431 = key_e(charlie,bob) at {424} in copy a_21495232

out(pub, ~M_21510640) with ~M_21510640 = dhexp(key_s(bob),g) at {319} in copy a_21495232

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495232

out(pub, ~M_21510987) with ~M_21510987 = dhexp(key_s(bob),g) at {212} in copy a_21495232

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495232

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495232

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495232

out(pub, (~M_21511620,~M_21511621,~M_21511622)) with ~M_21511620 = key_s(charlie), ~M_21511621 = key_e(charlie,alice), ~M_21511622 = key_e(charlie,bob) at {424} in copy a_21495231

out(pub, ~M_21511831) with ~M_21511831 = dhexp(key_s(bob),g) at {319} in copy a_21495231

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21495231

out(pub, ~M_21512178) with ~M_21512178 = dhexp(key_s(bob),g) at {212} in copy a_21495231

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21495231

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21495231

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21495231

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21495232

in(pub, concat3(g,a_21495230,encrypt(hmac_hash2(hash(somename,empty),~M_21499921),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),a_21495229))) with encrypt(hmac_hash2(hash(somename,empty),~M_21499921),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),a_21495229) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495229) at {225} in copy a_21495232

event RecvMsg(bob,alice,stage_a,a_21495229,true) at {251} in copy a_21495232

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495229))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21495232

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495229))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21495233

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21495233

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495229)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495229)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21495233

out(pub, concat3(~M_21514736,empty,~M_21514738)) with ~M_21514736 = dhexp(key_e(bob,alice),g), ~M_21514738 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495229)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21495233

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21495236

in(pub, concat3(g,a_21495234,encrypt(hmac_hash2(hash(somename,empty),~M_21499921),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),a_21495228))) with encrypt(hmac_hash2(hash(somename,empty),~M_21499921),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),a_21495228) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228) at {225} in copy a_21495236

event RecvMsg(bob,alice,stage_a,a_21495228,true) at {251} in copy a_21495236

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21495236

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21495237

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21495237

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21495237

out(pub, concat3(~M_21516670,empty,~M_21516672)) with ~M_21516670 = dhexp(key_e(bob,alice),g), ~M_21516672 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21495237

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21495241

in(pub, concat3(g,a_21495238,encrypt(hmac_hash2(hash(somename,empty),~M_21499921),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),a_21495228))) with encrypt(hmac_hash2(hash(somename,empty),~M_21499921),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),a_21495228) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228) at {225} in copy a_21495241

event RecvMsg(bob,alice,stage_a,a_21495228,true) at {251} in copy a_21495241

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21495241

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21495242

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21495242

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21495242

out(pub, concat3(~M_21518616,empty,~M_21518618)) with ~M_21518616 = dhexp(key_e(bob,alice),g), ~M_21518618 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21495242

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21495243

in(pub, concat3(a_21495226,a_21495227,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21499921),~M_21514736),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),encrypt(hmac_hash2(hash(somename,empty),~M_21499921),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),a_21495228)),~M_21514736),~M_21516672),a_21495225))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21499921),~M_21514736),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),encrypt(hmac_hash2(hash(somename,empty),~M_21499921),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21499921),g),a_21495228)),~M_21514736),~M_21516672),a_21495225) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21495228)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21495225) at {284} in copy a_21495243

event RecvMsg(bob,alice,stage_c,a_21495225,true) at {308} in copy a_21495243 (goal)

The event RecvMsg(bob,alice,stage_c,a_21495225,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_21519494) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21519494,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21519678.
attacker(plaintext_a_21519678).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21519678.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)).

16. The attacker has some term b_21519674.
attacker(b_21519674).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21519674.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678).
Using the function concat3 the attacker may obtain concat3(g,b_21519674,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)).
attacker(concat3(g,b_21519674,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21519674,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21519674,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21519674,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21519713).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21519607.
attacker(b_21519607).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21519607.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678).
Using the function concat3 the attacker may obtain concat3(g,b_21519607,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)).
attacker(concat3(g,b_21519607,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21519607,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21519607,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21519607,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21519535.
attacker(plaintext_a_21519535).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21519535.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)).

33. The attacker has some term b_21519531.
attacker(b_21519531).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21519531.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535).
Using the function concat3 the attacker may obtain concat3(g,b_21519531,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)).
attacker(concat3(g,b_21519531,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21519531,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21519531,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21519531,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519535)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21519713.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21519713).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21519713)).

47. The attacker has some term b_21519699.
attacker(b_21519699).

48. The attacker has some term a_21519698.
attacker(a_21519698).

49. By 48, the attacker may know a_21519698.
By 47, the attacker may know b_21519699.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21519713).
Using the function concat3 the attacker may obtain concat3(a_21519698,b_21519699,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21519713)).
attacker(concat3(a_21519698,b_21519699,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21519713))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21519698,b_21519699,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21519713)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21519698,b_21519699,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21519713))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21519698,b_21519699,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21519678)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21519713)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21519713,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21519713,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21524199,~M_21524200,~M_21524201)) with ~M_21524199 = key_s(charlie), ~M_21524200 = key_e(charlie,alice), ~M_21524201 = key_e(charlie,bob) at {424} in copy a_21519732

out(pub, ~M_21524410) with ~M_21524410 = dhexp(key_s(bob),g) at {319} in copy a_21519732

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519732

out(pub, ~M_21524757) with ~M_21524757 = dhexp(key_s(bob),g) at {212} in copy a_21519732

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519732

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519732

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519732

out(pub, (~M_21525390,~M_21525391,~M_21525392)) with ~M_21525390 = key_s(charlie), ~M_21525391 = key_e(charlie,alice), ~M_21525392 = key_e(charlie,bob) at {424} in copy a_21519731

out(pub, ~M_21525601) with ~M_21525601 = dhexp(key_s(bob),g) at {319} in copy a_21519731

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519731

out(pub, ~M_21525948) with ~M_21525948 = dhexp(key_s(bob),g) at {212} in copy a_21519731

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519731

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519731

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519731

out(pub, (~M_21526581,~M_21526582,~M_21526583)) with ~M_21526581 = key_s(charlie), ~M_21526582 = key_e(charlie,alice), ~M_21526583 = key_e(charlie,bob) at {424} in copy a_21519730

out(pub, ~M_21526792) with ~M_21526792 = dhexp(key_s(bob),g) at {319} in copy a_21519730

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519730

out(pub, ~M_21527139) with ~M_21527139 = dhexp(key_s(bob),g) at {212} in copy a_21519730

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519730

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519730

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519730

out(pub, (~M_21527772,~M_21527773,~M_21527774)) with ~M_21527772 = key_s(charlie), ~M_21527773 = key_e(charlie,alice), ~M_21527774 = key_e(charlie,bob) at {424} in copy a_21519729

out(pub, ~M_21527983) with ~M_21527983 = dhexp(key_s(bob),g) at {319} in copy a_21519729

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519729

out(pub, ~M_21528330) with ~M_21528330 = dhexp(key_s(bob),g) at {212} in copy a_21519729

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519729

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519729

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519729

out(pub, (~M_21528963,~M_21528964,~M_21528965)) with ~M_21528963 = key_s(charlie), ~M_21528964 = key_e(charlie,alice), ~M_21528965 = key_e(charlie,bob) at {424} in copy a_21519728

out(pub, ~M_21529174) with ~M_21529174 = dhexp(key_s(bob),g) at {319} in copy a_21519728

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519728

out(pub, ~M_21529521) with ~M_21529521 = dhexp(key_s(bob),g) at {212} in copy a_21519728

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519728

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519728

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519728

out(pub, (~M_21530154,~M_21530155,~M_21530156)) with ~M_21530154 = key_s(charlie), ~M_21530155 = key_e(charlie,alice), ~M_21530156 = key_e(charlie,bob) at {424} in copy a_21519726

out(pub, ~M_21530365) with ~M_21530365 = dhexp(key_s(bob),g) at {319} in copy a_21519726

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519726

out(pub, ~M_21530712) with ~M_21530712 = dhexp(key_s(bob),g) at {212} in copy a_21519726

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519726

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519726

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519726

out(pub, (~M_21531345,~M_21531346,~M_21531347)) with ~M_21531345 = key_s(charlie), ~M_21531346 = key_e(charlie,alice), ~M_21531347 = key_e(charlie,bob) at {424} in copy a_21519725

out(pub, ~M_21531556) with ~M_21531556 = dhexp(key_s(bob),g) at {319} in copy a_21519725

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519725

out(pub, ~M_21531903) with ~M_21531903 = dhexp(key_s(bob),g) at {212} in copy a_21519725

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519725

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519725

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519725

out(pub, (~M_21532536,~M_21532537,~M_21532538)) with ~M_21532536 = key_s(charlie), ~M_21532537 = key_e(charlie,alice), ~M_21532538 = key_e(charlie,bob) at {424} in copy a_21519724

out(pub, ~M_21532747) with ~M_21532747 = dhexp(key_s(bob),g) at {319} in copy a_21519724

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519724

out(pub, ~M_21533094) with ~M_21533094 = dhexp(key_s(bob),g) at {212} in copy a_21519724

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519724

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519724

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519724

out(pub, (~M_21533727,~M_21533728,~M_21533729)) with ~M_21533727 = key_s(charlie), ~M_21533728 = key_e(charlie,alice), ~M_21533729 = key_e(charlie,bob) at {424} in copy a_21519722

out(pub, ~M_21533938) with ~M_21533938 = dhexp(key_s(bob),g) at {319} in copy a_21519722

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519722

out(pub, ~M_21534285) with ~M_21534285 = dhexp(key_s(bob),g) at {212} in copy a_21519722

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519722

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519722

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519722

out(pub, (~M_21534918,~M_21534919,~M_21534920)) with ~M_21534918 = key_s(charlie), ~M_21534919 = key_e(charlie,alice), ~M_21534920 = key_e(charlie,bob) at {424} in copy a_21519721

out(pub, ~M_21535129) with ~M_21535129 = dhexp(key_s(bob),g) at {319} in copy a_21519721

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519721

out(pub, ~M_21535476) with ~M_21535476 = dhexp(key_s(bob),g) at {212} in copy a_21519721

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519721

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519721

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519721

out(pub, (~M_21536109,~M_21536110,~M_21536111)) with ~M_21536109 = key_s(charlie), ~M_21536110 = key_e(charlie,alice), ~M_21536111 = key_e(charlie,bob) at {424} in copy a_21519720

out(pub, ~M_21536320) with ~M_21536320 = dhexp(key_s(bob),g) at {319} in copy a_21519720

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21519720

out(pub, ~M_21536667) with ~M_21536667 = dhexp(key_s(bob),g) at {212} in copy a_21519720

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21519720

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21519720

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21519720

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21519721

in(pub, concat3(g,a_21519719,encrypt(hmac_hash2(hash(somename,empty),~M_21524410),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),a_21519718))) with encrypt(hmac_hash2(hash(somename,empty),~M_21524410),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),a_21519718) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519718) at {225} in copy a_21519721

event RecvMsg(bob,alice,stage_a,a_21519718,true) at {251} in copy a_21519721

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519718))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21519721

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519718))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21519722

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21519722

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519718)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519718)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21519722

out(pub, concat3(~M_21539225,empty,~M_21539227)) with ~M_21539225 = dhexp(key_e(bob,alice),g), ~M_21539227 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519718)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21519722

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21519725

in(pub, concat3(g,a_21519723,encrypt(hmac_hash2(hash(somename,empty),~M_21524410),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),a_21519717))) with encrypt(hmac_hash2(hash(somename,empty),~M_21524410),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),a_21519717) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717) at {225} in copy a_21519725

event RecvMsg(bob,alice,stage_a,a_21519717,true) at {251} in copy a_21519725

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21519725

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21519726

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21519726

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21519726

out(pub, concat3(~M_21541159,empty,~M_21541161)) with ~M_21541159 = dhexp(key_e(bob,alice),g), ~M_21541161 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21519726

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21519730

in(pub, concat3(g,a_21519727,encrypt(hmac_hash2(hash(somename,empty),~M_21524410),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),a_21519717))) with encrypt(hmac_hash2(hash(somename,empty),~M_21524410),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),a_21519717) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717) at {225} in copy a_21519730

event RecvMsg(bob,alice,stage_a,a_21519717,true) at {251} in copy a_21519730

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21519730

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21519731

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21519731

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21519731

out(pub, concat3(~M_21543105,empty,~M_21543107)) with ~M_21543105 = dhexp(key_e(bob,alice),g), ~M_21543107 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21519731

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21519732

in(pub, concat3(a_21519715,a_21519716,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21524410),~M_21539225),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),encrypt(hmac_hash2(hash(somename,empty),~M_21524410),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),a_21519717)),~M_21539225),~M_21541161),a_21519714))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21524410),~M_21539225),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),encrypt(hmac_hash2(hash(somename,empty),~M_21524410),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21524410),g),a_21519717)),~M_21539225),~M_21541161),a_21519714) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21519717)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21519714) at {284} in copy a_21519732

event RecvMsg(bob,alice,stage_c,a_21519714,true) at {308} in copy a_21519732 (goal)

The event RecvMsg(bob,alice,stage_c,a_21519714,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_21543983) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21543983,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21544166.
attacker(plaintext_a_21544166).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21544166.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)).

16. The attacker has some term b_21544162.
attacker(b_21544162).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21544162.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166).
Using the function concat3 the attacker may obtain concat3(g,b_21544162,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)).
attacker(concat3(g,b_21544162,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21544162,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21544162,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21544162,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21544201).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21544095.
attacker(b_21544095).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21544095.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166).
Using the function concat3 the attacker may obtain concat3(g,b_21544095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)).
attacker(concat3(g,b_21544095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21544095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21544095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21544095,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21544023.
attacker(plaintext_a_21544023).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21544023.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)).

33. The attacker has some term b_21544019.
attacker(b_21544019).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21544019.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023).
Using the function concat3 the attacker may obtain concat3(g,b_21544019,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)).
attacker(concat3(g,b_21544019,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21544019,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21544019,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21544019,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544023)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21544201.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21544201).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21544201)).

47. The attacker has some term b_21544187.
attacker(b_21544187).

48. The attacker has some term a_21544186.
attacker(a_21544186).

49. By 48, the attacker may know a_21544186.
By 47, the attacker may know b_21544187.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21544201).
Using the function concat3 the attacker may obtain concat3(a_21544186,b_21544187,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21544201)).
attacker(concat3(a_21544186,b_21544187,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21544201))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21544186,b_21544187,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21544201)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21544186,b_21544187,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21544201))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21544186,b_21544187,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21544166)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21544201)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21544201,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21544201,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21548687,~M_21548688,~M_21548689)) with ~M_21548687 = key_s(charlie), ~M_21548688 = key_e(charlie,alice), ~M_21548689 = key_e(charlie,bob) at {424} in copy a_21544220

out(pub, ~M_21548898) with ~M_21548898 = dhexp(key_s(bob),g) at {319} in copy a_21544220

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544220

out(pub, ~M_21549245) with ~M_21549245 = dhexp(key_s(bob),g) at {212} in copy a_21544220

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544220

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544220

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544220

out(pub, (~M_21549878,~M_21549879,~M_21549880)) with ~M_21549878 = key_s(charlie), ~M_21549879 = key_e(charlie,alice), ~M_21549880 = key_e(charlie,bob) at {424} in copy a_21544219

out(pub, ~M_21550089) with ~M_21550089 = dhexp(key_s(bob),g) at {319} in copy a_21544219

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544219

out(pub, ~M_21550436) with ~M_21550436 = dhexp(key_s(bob),g) at {212} in copy a_21544219

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544219

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544219

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544219

out(pub, (~M_21551069,~M_21551070,~M_21551071)) with ~M_21551069 = key_s(charlie), ~M_21551070 = key_e(charlie,alice), ~M_21551071 = key_e(charlie,bob) at {424} in copy a_21544218

out(pub, ~M_21551280) with ~M_21551280 = dhexp(key_s(bob),g) at {319} in copy a_21544218

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544218

out(pub, ~M_21551627) with ~M_21551627 = dhexp(key_s(bob),g) at {212} in copy a_21544218

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544218

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544218

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544218

out(pub, (~M_21552260,~M_21552261,~M_21552262)) with ~M_21552260 = key_s(charlie), ~M_21552261 = key_e(charlie,alice), ~M_21552262 = key_e(charlie,bob) at {424} in copy a_21544217

out(pub, ~M_21552471) with ~M_21552471 = dhexp(key_s(bob),g) at {319} in copy a_21544217

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544217

out(pub, ~M_21552818) with ~M_21552818 = dhexp(key_s(bob),g) at {212} in copy a_21544217

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544217

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544217

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544217

out(pub, (~M_21553451,~M_21553452,~M_21553453)) with ~M_21553451 = key_s(charlie), ~M_21553452 = key_e(charlie,alice), ~M_21553453 = key_e(charlie,bob) at {424} in copy a_21544216

out(pub, ~M_21553662) with ~M_21553662 = dhexp(key_s(bob),g) at {319} in copy a_21544216

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544216

out(pub, ~M_21554009) with ~M_21554009 = dhexp(key_s(bob),g) at {212} in copy a_21544216

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544216

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544216

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544216

out(pub, (~M_21554642,~M_21554643,~M_21554644)) with ~M_21554642 = key_s(charlie), ~M_21554643 = key_e(charlie,alice), ~M_21554644 = key_e(charlie,bob) at {424} in copy a_21544214

out(pub, ~M_21554853) with ~M_21554853 = dhexp(key_s(bob),g) at {319} in copy a_21544214

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544214

out(pub, ~M_21555200) with ~M_21555200 = dhexp(key_s(bob),g) at {212} in copy a_21544214

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544214

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544214

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544214

out(pub, (~M_21555833,~M_21555834,~M_21555835)) with ~M_21555833 = key_s(charlie), ~M_21555834 = key_e(charlie,alice), ~M_21555835 = key_e(charlie,bob) at {424} in copy a_21544213

out(pub, ~M_21556044) with ~M_21556044 = dhexp(key_s(bob),g) at {319} in copy a_21544213

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544213

out(pub, ~M_21556391) with ~M_21556391 = dhexp(key_s(bob),g) at {212} in copy a_21544213

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544213

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544213

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544213

out(pub, (~M_21557024,~M_21557025,~M_21557026)) with ~M_21557024 = key_s(charlie), ~M_21557025 = key_e(charlie,alice), ~M_21557026 = key_e(charlie,bob) at {424} in copy a_21544212

out(pub, ~M_21557235) with ~M_21557235 = dhexp(key_s(bob),g) at {319} in copy a_21544212

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544212

out(pub, ~M_21557582) with ~M_21557582 = dhexp(key_s(bob),g) at {212} in copy a_21544212

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544212

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544212

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544212

out(pub, (~M_21558215,~M_21558216,~M_21558217)) with ~M_21558215 = key_s(charlie), ~M_21558216 = key_e(charlie,alice), ~M_21558217 = key_e(charlie,bob) at {424} in copy a_21544210

out(pub, ~M_21558426) with ~M_21558426 = dhexp(key_s(bob),g) at {319} in copy a_21544210

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544210

out(pub, ~M_21558773) with ~M_21558773 = dhexp(key_s(bob),g) at {212} in copy a_21544210

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544210

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544210

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544210

out(pub, (~M_21559406,~M_21559407,~M_21559408)) with ~M_21559406 = key_s(charlie), ~M_21559407 = key_e(charlie,alice), ~M_21559408 = key_e(charlie,bob) at {424} in copy a_21544209

out(pub, ~M_21559617) with ~M_21559617 = dhexp(key_s(bob),g) at {319} in copy a_21544209

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544209

out(pub, ~M_21559964) with ~M_21559964 = dhexp(key_s(bob),g) at {212} in copy a_21544209

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544209

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544209

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544209

out(pub, (~M_21560597,~M_21560598,~M_21560599)) with ~M_21560597 = key_s(charlie), ~M_21560598 = key_e(charlie,alice), ~M_21560599 = key_e(charlie,bob) at {424} in copy a_21544208

out(pub, ~M_21560808) with ~M_21560808 = dhexp(key_s(bob),g) at {319} in copy a_21544208

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21544208

out(pub, ~M_21561155) with ~M_21561155 = dhexp(key_s(bob),g) at {212} in copy a_21544208

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21544208

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21544208

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21544208

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21544209

in(pub, concat3(g,a_21544207,encrypt(hmac_hash2(hash(somename,empty),~M_21548898),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),a_21544206))) with encrypt(hmac_hash2(hash(somename,empty),~M_21548898),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),a_21544206) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544206) at {225} in copy a_21544209

event RecvMsg(bob,alice,stage_a,a_21544206,true) at {251} in copy a_21544209

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544206))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21544209

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544206))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21544210

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21544210

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544206)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544206)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21544210

out(pub, concat3(~M_21563713,empty,~M_21563715)) with ~M_21563713 = dhexp(key_e(bob,alice),g), ~M_21563715 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544206)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21544210

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21544213

in(pub, concat3(g,a_21544211,encrypt(hmac_hash2(hash(somename,empty),~M_21548898),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),a_21544205))) with encrypt(hmac_hash2(hash(somename,empty),~M_21548898),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),a_21544205) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205) at {225} in copy a_21544213

event RecvMsg(bob,alice,stage_a,a_21544205,true) at {251} in copy a_21544213

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21544213

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21544214

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21544214

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21544214

out(pub, concat3(~M_21565647,empty,~M_21565649)) with ~M_21565647 = dhexp(key_e(bob,alice),g), ~M_21565649 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21544214

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21544218

in(pub, concat3(g,a_21544215,encrypt(hmac_hash2(hash(somename,empty),~M_21548898),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),a_21544205))) with encrypt(hmac_hash2(hash(somename,empty),~M_21548898),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),a_21544205) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205) at {225} in copy a_21544218

event RecvMsg(bob,alice,stage_a,a_21544205,true) at {251} in copy a_21544218

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21544218

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21544219

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21544219

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21544219

out(pub, concat3(~M_21567593,empty,~M_21567595)) with ~M_21567593 = dhexp(key_e(bob,alice),g), ~M_21567595 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21544219

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21544220

in(pub, concat3(a_21544203,a_21544204,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21548898),~M_21563713),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),encrypt(hmac_hash2(hash(somename,empty),~M_21548898),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),a_21544205)),~M_21563713),~M_21565649),a_21544202))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21548898),~M_21563713),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),encrypt(hmac_hash2(hash(somename,empty),~M_21548898),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21548898),g),a_21544205)),~M_21563713),~M_21565649),a_21544202) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21544205)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21544202) at {284} in copy a_21544220

event RecvMsg(bob,alice,stage_c,a_21544202,true) at {308} in copy a_21544220 (goal)

The event RecvMsg(bob,alice,stage_c,a_21544202,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_21568471) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_21568471,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21568654.
attacker(plaintext_a_21568654).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21568654.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)).

16. The attacker has some term b_21568650.
attacker(b_21568650).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21568650.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654).
Using the function concat3 the attacker may obtain concat3(g,b_21568650,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)).
attacker(concat3(g,b_21568650,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21568650,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21568650,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))).

19. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {253}.
The message concat3(g,b_21568650,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)) that may be sent on channel pub by 18 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) may be inserted in a table at insert {281}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false)))).

21. We assume as hypothesis that
attacker(m_21568689).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21568583.
attacker(b_21568583).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21568583.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654).
Using the function concat3 the attacker may obtain concat3(g,b_21568583,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)).
attacker(concat3(g,b_21568583,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21568583,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21568583,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))).

26. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {253}.
The message concat3(g,b_21568583,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)) that may be sent on channel pub by 25 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {224}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21568511.
attacker(plaintext_a_21568511).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21568511.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)).

33. The attacker has some term b_21568507.
attacker(b_21568507).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21568507.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511).
Using the function concat3 the attacker may obtain concat3(g,b_21568507,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)).
attacker(concat3(g,b_21568507,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21568507,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21568507,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {253}.
The message concat3(g,b_21568507,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)) that may be sent on channel pub by 35 may be received at input {225}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {252}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {283}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {280}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {282}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568511)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 21, the attacker may know m_21568689.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21568689).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21568689)).

47. The attacker has some term b_21568675.
attacker(b_21568675).

48. The attacker has some term a_21568674.
attacker(a_21568674).

49. By 48, the attacker may know a_21568674.
By 47, the attacker may know b_21568675.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21568689).
Using the function concat3 the attacker may obtain concat3(a_21568674,b_21568675,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21568689)).
attacker(concat3(a_21568674,b_21568675,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21568689))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21568674,b_21568675,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21568689)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21568674,b_21568675,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21568689))).

51. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) that may be in a table by 20 may be read at get {311}.
The message concat3(a_21568674,b_21568675,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21568654)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_21568689)) that may be sent on channel pub by 50 may be received at input {284}.
So event RecvMsg(bob,alice,stage_c,m_21568689,true) may be executed at {308}.
end(RecvMsg(bob,alice,stage_c,m_21568689,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21573175,~M_21573176,~M_21573177)) with ~M_21573175 = key_s(charlie), ~M_21573176 = key_e(charlie,alice), ~M_21573177 = key_e(charlie,bob) at {424} in copy a_21568708

out(pub, ~M_21573386) with ~M_21573386 = dhexp(key_s(bob),g) at {319} in copy a_21568708

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568708

out(pub, ~M_21573733) with ~M_21573733 = dhexp(key_s(bob),g) at {212} in copy a_21568708

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568708

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568708

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568708

out(pub, (~M_21574366,~M_21574367,~M_21574368)) with ~M_21574366 = key_s(charlie), ~M_21574367 = key_e(charlie,alice), ~M_21574368 = key_e(charlie,bob) at {424} in copy a_21568707

out(pub, ~M_21574577) with ~M_21574577 = dhexp(key_s(bob),g) at {319} in copy a_21568707

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568707

out(pub, ~M_21574924) with ~M_21574924 = dhexp(key_s(bob),g) at {212} in copy a_21568707

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568707

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568707

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568707

out(pub, (~M_21575557,~M_21575558,~M_21575559)) with ~M_21575557 = key_s(charlie), ~M_21575558 = key_e(charlie,alice), ~M_21575559 = key_e(charlie,bob) at {424} in copy a_21568706

out(pub, ~M_21575768) with ~M_21575768 = dhexp(key_s(bob),g) at {319} in copy a_21568706

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568706

out(pub, ~M_21576115) with ~M_21576115 = dhexp(key_s(bob),g) at {212} in copy a_21568706

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568706

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568706

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568706

out(pub, (~M_21576748,~M_21576749,~M_21576750)) with ~M_21576748 = key_s(charlie), ~M_21576749 = key_e(charlie,alice), ~M_21576750 = key_e(charlie,bob) at {424} in copy a_21568705

out(pub, ~M_21576959) with ~M_21576959 = dhexp(key_s(bob),g) at {319} in copy a_21568705

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568705

out(pub, ~M_21577306) with ~M_21577306 = dhexp(key_s(bob),g) at {212} in copy a_21568705

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568705

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568705

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568705

out(pub, (~M_21577939,~M_21577940,~M_21577941)) with ~M_21577939 = key_s(charlie), ~M_21577940 = key_e(charlie,alice), ~M_21577941 = key_e(charlie,bob) at {424} in copy a_21568704

out(pub, ~M_21578150) with ~M_21578150 = dhexp(key_s(bob),g) at {319} in copy a_21568704

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568704

out(pub, ~M_21578497) with ~M_21578497 = dhexp(key_s(bob),g) at {212} in copy a_21568704

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568704

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568704

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568704

out(pub, (~M_21579130,~M_21579131,~M_21579132)) with ~M_21579130 = key_s(charlie), ~M_21579131 = key_e(charlie,alice), ~M_21579132 = key_e(charlie,bob) at {424} in copy a_21568702

out(pub, ~M_21579341) with ~M_21579341 = dhexp(key_s(bob),g) at {319} in copy a_21568702

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568702

out(pub, ~M_21579688) with ~M_21579688 = dhexp(key_s(bob),g) at {212} in copy a_21568702

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568702

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568702

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568702

out(pub, (~M_21580321,~M_21580322,~M_21580323)) with ~M_21580321 = key_s(charlie), ~M_21580322 = key_e(charlie,alice), ~M_21580323 = key_e(charlie,bob) at {424} in copy a_21568701

out(pub, ~M_21580532) with ~M_21580532 = dhexp(key_s(bob),g) at {319} in copy a_21568701

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568701

out(pub, ~M_21580879) with ~M_21580879 = dhexp(key_s(bob),g) at {212} in copy a_21568701

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568701

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568701

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568701

out(pub, (~M_21581512,~M_21581513,~M_21581514)) with ~M_21581512 = key_s(charlie), ~M_21581513 = key_e(charlie,alice), ~M_21581514 = key_e(charlie,bob) at {424} in copy a_21568700

out(pub, ~M_21581723) with ~M_21581723 = dhexp(key_s(bob),g) at {319} in copy a_21568700

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568700

out(pub, ~M_21582070) with ~M_21582070 = dhexp(key_s(bob),g) at {212} in copy a_21568700

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568700

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568700

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568700

out(pub, (~M_21582703,~M_21582704,~M_21582705)) with ~M_21582703 = key_s(charlie), ~M_21582704 = key_e(charlie,alice), ~M_21582705 = key_e(charlie,bob) at {424} in copy a_21568698

out(pub, ~M_21582914) with ~M_21582914 = dhexp(key_s(bob),g) at {319} in copy a_21568698

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568698

out(pub, ~M_21583261) with ~M_21583261 = dhexp(key_s(bob),g) at {212} in copy a_21568698

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568698

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568698

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568698

out(pub, (~M_21583894,~M_21583895,~M_21583896)) with ~M_21583894 = key_s(charlie), ~M_21583895 = key_e(charlie,alice), ~M_21583896 = key_e(charlie,bob) at {424} in copy a_21568697

out(pub, ~M_21584105) with ~M_21584105 = dhexp(key_s(bob),g) at {319} in copy a_21568697

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568697

out(pub, ~M_21584452) with ~M_21584452 = dhexp(key_s(bob),g) at {212} in copy a_21568697

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568697

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568697

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568697

out(pub, (~M_21585085,~M_21585086,~M_21585087)) with ~M_21585085 = key_s(charlie), ~M_21585086 = key_e(charlie,alice), ~M_21585087 = key_e(charlie,bob) at {424} in copy a_21568696

out(pub, ~M_21585296) with ~M_21585296 = dhexp(key_s(bob),g) at {319} in copy a_21568696

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21568696

out(pub, ~M_21585643) with ~M_21585643 = dhexp(key_s(bob),g) at {212} in copy a_21568696

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21568696

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21568696

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21568696

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21568697

in(pub, concat3(g,a_21568695,encrypt(hmac_hash2(hash(somename,empty),~M_21573386),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),a_21568694))) with encrypt(hmac_hash2(hash(somename,empty),~M_21573386),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),a_21568694) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568694) at {225} in copy a_21568697

event RecvMsg(bob,alice,stage_a,a_21568694,true) at {251} in copy a_21568697

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568694))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21568697

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568694))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21568698

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21568698

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568694)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568694)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21568698

out(pub, concat3(~M_21588201,empty,~M_21588203)) with ~M_21588201 = dhexp(key_e(bob,alice),g), ~M_21588203 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568694)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21568698

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21568701

in(pub, concat3(g,a_21568699,encrypt(hmac_hash2(hash(somename,empty),~M_21573386),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),a_21568693))) with encrypt(hmac_hash2(hash(somename,empty),~M_21573386),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),a_21568693) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693) at {225} in copy a_21568701

event RecvMsg(bob,alice,stage_a,a_21568693,true) at {251} in copy a_21568701

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21568701

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21568702

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21568702

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21568702

out(pub, concat3(~M_21590135,empty,~M_21590137)) with ~M_21590135 = dhexp(key_e(bob,alice),g), ~M_21590137 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21568702

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {253} in copy a_21568706

in(pub, concat3(g,a_21568703,encrypt(hmac_hash2(hash(somename,empty),~M_21573386),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),a_21568693))) with encrypt(hmac_hash2(hash(somename,empty),~M_21573386),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),a_21568693) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693) at {225} in copy a_21568706

event RecvMsg(bob,alice,stage_a,a_21568693,true) at {251} in copy a_21568706

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {252} in copy a_21568706

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {283} in copy a_21568707

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {280} in copy a_21568707

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {281} in copy a_21568707

out(pub, concat3(~M_21592081,empty,~M_21592083)) with ~M_21592081 = dhexp(key_e(bob,alice),g), ~M_21592083 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {282} in copy a_21568707

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),empty,g,empty,false))) at {311} in copy a_21568708

in(pub, concat3(a_21568691,a_21568692,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21573386),~M_21588201),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),encrypt(hmac_hash2(hash(somename,empty),~M_21573386),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),a_21568693)),~M_21588201),~M_21590137),a_21568690))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21573386),~M_21588201),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),encrypt(hmac_hash2(hash(somename,empty),~M_21573386),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21573386),g),a_21568693)),~M_21588201),~M_21590137),a_21568690) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21568693)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_21568690) at {284} in copy a_21568708

event RecvMsg(bob,alice,stage_c,a_21568690,true) at {308} in copy a_21568708 (goal)

The event RecvMsg(bob,alice,stage_c,a_21568690,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query not attacker_p1(msg_c(alice,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 2 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {43}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true)))).

4. The attacker has some term plaintext_b_21593119.
attacker(plaintext_b_21593119).

5. Using the function g the attacker may obtain g.
attacker(g).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 6 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 1, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) may be inserted in a table at insert {15}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true)))).

11. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 10 may be read at get {45}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {42}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {44}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

12. By 1, the attacker may have the channel pub.
By 11, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

13. By 12, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),dhexp(key_s(bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

14. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

15. By 1, the attacker may have the channel pub.
By 14, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

16. Using the function empty the attacker may obtain empty.
attacker(empty).

17. Using the function somename the attacker may obtain somename.
attacker(somename).

18. By 17, the attacker may know somename.
By 16, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

19. By 18, the attacker may know hash(somename,empty).
By 16, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

20. By 19, the attacker may know hash(hash(somename,empty),empty).
By 15, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

21. By 20, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g))).

22. By 21, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

23. By 22, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 5, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

24. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

25. The event LeakS(phase0,bob) may be executed at {312}.
So the message key_s(bob) may be sent on channel pub at output {313}.
mess(pub,key_s(bob)).

26. By 1, the attacker may have the channel pub.
By 25, the message key_s(bob) may be sent on this channel.
So the attacker may obtain the message key_s(bob) by listening on this channel.
attacker(key_s(bob)).

27. By 26, the attacker may know key_s(bob).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function dhexp the attacker may obtain dhexp(key_s(bob),dhexp(key_e(alice,bob),g)).
attacker(dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).

28. By 18, the attacker may know hash(somename,empty).
By 27, the attacker may know dhexp(key_s(bob),dhexp(key_e(alice,bob),g)).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g)))).

29. By 28, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))).
By 13, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g))).

30. By 29, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
By 24, the attacker may know minnonce.
By 23, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 4, the attacker may know plaintext_b_21593119.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)).

31. The attacker has some term b_21593115.
attacker(b_21593115).

32. By 5, the attacker may know g.
By 31, the attacker may know b_21593115.
By 30, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119).
Using the function concat3 the attacker may obtain concat3(g,b_21593115,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)).
attacker(concat3(g,b_21593115,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119))).

33. By 1, the attacker may have the channel pub.
By 32, the attacker may have the message concat3(g,b_21593115,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21593115,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119))).

34. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),empty,empty,true))) that may be in a table by 3 may be read at get {74}.
The message concat3(g,b_21593115,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)) that may be sent on channel pub by 33 may be received at input {46}.
We have g <> caught-fail.
So the entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true))) may be inserted in a table at insert {73}.
table(statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true)))).

35. The entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119))),keypairpack(empty,empty),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),dhexp(key_s(bob),g),g,empty,true))) that may be in a table by 34 may be read at get {100}.
The event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) may be executed at {97}.
So the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob))) may be sent on channel pub at output {99}.
mess(pub,concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob)))).

36. By 1, the attacker may have the channel pub.
By 35, the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob))) by listening on this channel.
attacker(concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob)))).

37. By 36, the attacker may know concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob))).

38. By 37, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob)).
So the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob)) in phase 1.
attacker_p1(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob))).

39. By 23, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 30, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119))).

40. By 39, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)).
So the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)) in phase 1.
attacker_p1(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119))).

41. Using the function minnonce the attacker may obtain minnonce in phase 1.
attacker_p1(minnonce).

42. By 41, the attacker may know minnonce in phase 1.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce) in phase 1.
attacker_p1(increment_nonce(minnonce)).

43. By 29, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)).
So the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)) in phase 1.
attacker_p1(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g))).

44. By 43, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)) in phase 1.
By 42, the attacker may know increment_nonce(minnonce) in phase 1.
By 40, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)) in phase 1.
By 38, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob)) in phase 1.
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob)) in phase 1.
attacker_p1(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob))).

45. By 44, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),dhexp(key_e(alice,bob),g))),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_21593119)),msg_c(alice,bob)) in phase 1.
Using the function 3-proj-aeadpack the attacker may obtain msg_c(alice,bob) in phase 1.
attacker_p1(msg_c(alice,bob)).


Could not find a trace corresponding to this derivation.
RESULT not attacker_p1(msg_c(alice,bob)) cannot be proved.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)) is true.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice)))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))) is true.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(LeakS(phase0,bob)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) is true.
Starting query not event(RecvEnd(true))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) -> end(RecvEnd(true))

1. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

2. The attacker has some term plaintext_a_21628502.
attacker(plaintext_a_21628502).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(bob),g) may be sent on channel pub at output {212}.
mess(pub,dhexp(key_s(bob),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(bob),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(bob),g) by listening on this channel.
attacker(dhexp(key_s(bob),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)).
By 3, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g))).

15. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 2, the attacker may know plaintext_a_21628502.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)).

16. The attacker has some term b_21628498.
attacker(b_21628498).

17. By 3, the attacker may know g.
By 16, the attacker may know b_21628498.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502).
Using the function concat3 the attacker may obtain concat3(g,b_21628498,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)).
attacker(concat3(g,b_21628498,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))).

18. By 4, the attacker may have the channel pub.
By 17, the attacker may have the message concat3(g,b_21628498,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21628498,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))).

19. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 1 may be read at get {360}.
The message concat3(g,b_21628498,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)) that may be sent on channel pub by 18 may be received at input {332}.
We have g <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {359}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

20. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 19 may be read at get {390}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {387}.
So the entry statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),empty,g,empty,false))) may be inserted in a table at insert {388}.
table(statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),empty,g,empty,false)))).

21. The attacker has some term plaintext_c_21628527.
attacker(plaintext_c_21628527).

22. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

23. The attacker has some term b_21628431.
attacker(b_21628431).

24. By 3, the attacker may know g.
By 23, the attacker may know b_21628431.
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502).
Using the function concat3 the attacker may obtain concat3(g,b_21628431,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)).
attacker(concat3(g,b_21628431,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))).

25. By 4, the attacker may have the channel pub.
By 24, the attacker may have the message concat3(g,b_21628431,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21628431,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))).

26. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 22 may be read at get {360}.
The message concat3(g,b_21628431,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)) that may be sent on channel pub by 25 may be received at input {332}.
We have g <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {359}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

27. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 26 may be read at get {390}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {387}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {389}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

28. By 4, the attacker may have the channel pub.
By 27, the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

29. By 28, the attacker may know concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).

30. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false)))).

31. The attacker has some term plaintext_a_21628359.
attacker(plaintext_a_21628359).

32. By 14, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)).
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 31, the attacker may know plaintext_a_21628359.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)).

33. The attacker has some term b_21628355.
attacker(b_21628355).

34. By 3, the attacker may know g.
By 33, the attacker may know b_21628355.
By 32, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359).
Using the function concat3 the attacker may obtain concat3(g,b_21628355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)).
attacker(concat3(g,b_21628355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359))).

35. By 4, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(g,b_21628355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_21628355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359))).

36. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) that may be in a table by 30 may be read at get {360}.
The message concat3(g,b_21628355,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)) that may be sent on channel pub by 35 may be received at input {332}.
We have g <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) may be inserted in a table at insert {359}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false)))).

37. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) that may be in a table by 36 may be read at get {390}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {387}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {389}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

38. By 4, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628359)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,charlie),g).
attacker(dhexp(key_e(bob,charlie),g)).

40. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g).
By 15, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)).
By 39, the attacker may know dhexp(key_e(bob,charlie),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)).
By 29, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

43. By 13, the attacker may know minnonce.
Using the function increment_nonce the attacker may obtain increment_nonce(minnonce).
attacker(increment_nonce(minnonce)).

44. By 9, the attacker may know hash(somename,empty).
By 6, the attacker may know dhexp(key_s(bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g))).

45. By 44, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)).
By 39, the attacker may know dhexp(key_e(bob,charlie),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g))).

46. By 45, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)).
By 43, the attacker may know increment_nonce(minnonce).
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
By 21, the attacker may know plaintext_c_21628527.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_21628527).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_21628527)).

47. The attacker has some term b_21628523.
attacker(b_21628523).

48. The attacker has some term a_21628522.
attacker(a_21628522).

49. By 48, the attacker may know a_21628522.
By 47, the attacker may know b_21628523.
By 46, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_21628527).
Using the function concat3 the attacker may obtain concat3(a_21628522,b_21628523,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_21628527)).
attacker(concat3(a_21628522,b_21628523,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_21628527))).

50. By 4, the attacker may have the channel pub.
By 49, the attacker may have the message concat3(a_21628522,b_21628523,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_21628527)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_21628522,b_21628523,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_21628527))).

51. The entry statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),empty,g,empty,false))) that may be in a table by 20 may be read at get {418}.
The message concat3(a_21628522,b_21628523,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),plaintext_a_21628502)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_21628527)) that may be sent on channel pub by 50 may be received at input {391}.
So event RecvEnd(true) may be executed at {417}.
end(RecvEnd(true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_21633022,~M_21633023,~M_21633024)) with ~M_21633022 = key_s(charlie), ~M_21633023 = key_e(charlie,alice), ~M_21633024 = key_e(charlie,bob) at {424} in copy a_21628555

out(pub, ~M_21633233) with ~M_21633233 = dhexp(key_s(bob),g) at {319} in copy a_21628555

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628555

out(pub, ~M_21633580) with ~M_21633580 = dhexp(key_s(bob),g) at {212} in copy a_21628555

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628555

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628555

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628555

out(pub, (~M_21634213,~M_21634214,~M_21634215)) with ~M_21634213 = key_s(charlie), ~M_21634214 = key_e(charlie,alice), ~M_21634215 = key_e(charlie,bob) at {424} in copy a_21628554

out(pub, ~M_21634424) with ~M_21634424 = dhexp(key_s(bob),g) at {319} in copy a_21628554

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628554

out(pub, ~M_21634771) with ~M_21634771 = dhexp(key_s(bob),g) at {212} in copy a_21628554

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628554

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628554

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628554

out(pub, (~M_21635404,~M_21635405,~M_21635406)) with ~M_21635404 = key_s(charlie), ~M_21635405 = key_e(charlie,alice), ~M_21635406 = key_e(charlie,bob) at {424} in copy a_21628553

out(pub, ~M_21635615) with ~M_21635615 = dhexp(key_s(bob),g) at {319} in copy a_21628553

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628553

out(pub, ~M_21635962) with ~M_21635962 = dhexp(key_s(bob),g) at {212} in copy a_21628553

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628553

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628553

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628553

out(pub, (~M_21636595,~M_21636596,~M_21636597)) with ~M_21636595 = key_s(charlie), ~M_21636596 = key_e(charlie,alice), ~M_21636597 = key_e(charlie,bob) at {424} in copy a_21628552

out(pub, ~M_21636806) with ~M_21636806 = dhexp(key_s(bob),g) at {319} in copy a_21628552

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628552

out(pub, ~M_21637153) with ~M_21637153 = dhexp(key_s(bob),g) at {212} in copy a_21628552

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628552

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628552

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628552

out(pub, (~M_21637786,~M_21637787,~M_21637788)) with ~M_21637786 = key_s(charlie), ~M_21637787 = key_e(charlie,alice), ~M_21637788 = key_e(charlie,bob) at {424} in copy a_21628551

out(pub, ~M_21637997) with ~M_21637997 = dhexp(key_s(bob),g) at {319} in copy a_21628551

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628551

out(pub, ~M_21638344) with ~M_21638344 = dhexp(key_s(bob),g) at {212} in copy a_21628551

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628551

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628551

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628551

out(pub, (~M_21638977,~M_21638978,~M_21638979)) with ~M_21638977 = key_s(charlie), ~M_21638978 = key_e(charlie,alice), ~M_21638979 = key_e(charlie,bob) at {424} in copy a_21628549

out(pub, ~M_21639188) with ~M_21639188 = dhexp(key_s(bob),g) at {319} in copy a_21628549

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628549

out(pub, ~M_21639535) with ~M_21639535 = dhexp(key_s(bob),g) at {212} in copy a_21628549

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628549

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628549

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628549

out(pub, (~M_21640168,~M_21640169,~M_21640170)) with ~M_21640168 = key_s(charlie), ~M_21640169 = key_e(charlie,alice), ~M_21640170 = key_e(charlie,bob) at {424} in copy a_21628548

out(pub, ~M_21640379) with ~M_21640379 = dhexp(key_s(bob),g) at {319} in copy a_21628548

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628548

out(pub, ~M_21640726) with ~M_21640726 = dhexp(key_s(bob),g) at {212} in copy a_21628548

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628548

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628548

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628548

out(pub, (~M_21641359,~M_21641360,~M_21641361)) with ~M_21641359 = key_s(charlie), ~M_21641360 = key_e(charlie,alice), ~M_21641361 = key_e(charlie,bob) at {424} in copy a_21628547

out(pub, ~M_21641570) with ~M_21641570 = dhexp(key_s(bob),g) at {319} in copy a_21628547

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628547

out(pub, ~M_21641917) with ~M_21641917 = dhexp(key_s(bob),g) at {212} in copy a_21628547

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628547

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628547

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628547

out(pub, (~M_21642550,~M_21642551,~M_21642552)) with ~M_21642550 = key_s(charlie), ~M_21642551 = key_e(charlie,alice), ~M_21642552 = key_e(charlie,bob) at {424} in copy a_21628545

out(pub, ~M_21642761) with ~M_21642761 = dhexp(key_s(bob),g) at {319} in copy a_21628545

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628545

out(pub, ~M_21643108) with ~M_21643108 = dhexp(key_s(bob),g) at {212} in copy a_21628545

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628545

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628545

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628545

out(pub, (~M_21643741,~M_21643742,~M_21643743)) with ~M_21643741 = key_s(charlie), ~M_21643742 = key_e(charlie,alice), ~M_21643743 = key_e(charlie,bob) at {424} in copy a_21628544

out(pub, ~M_21643952) with ~M_21643952 = dhexp(key_s(bob),g) at {319} in copy a_21628544

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628544

out(pub, ~M_21644299) with ~M_21644299 = dhexp(key_s(bob),g) at {212} in copy a_21628544

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628544

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628544

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628544

out(pub, (~M_21644932,~M_21644933,~M_21644934)) with ~M_21644932 = key_s(charlie), ~M_21644933 = key_e(charlie,alice), ~M_21644934 = key_e(charlie,bob) at {424} in copy a_21628543

out(pub, ~M_21645143) with ~M_21645143 = dhexp(key_s(bob),g) at {319} in copy a_21628543

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {331} in copy a_21628543

out(pub, ~M_21645490) with ~M_21645490 = dhexp(key_s(bob),g) at {212} in copy a_21628543

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {224} in copy a_21628543

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,true))) at {119} in copy a_21628543

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(bob),g),empty,empty,true))) at {15} in copy a_21628543

get statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {360} in copy a_21628544

in(pub, concat3(g,a_21628542,encrypt(hmac_hash2(hash(somename,empty),~M_21633233),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),a_21628541))) with encrypt(hmac_hash2(hash(somename,empty),~M_21633233),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),a_21628541) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628541) at {332} in copy a_21628544

event RecvMsg(bob,charlie,stage_a,a_21628541,true) at {358} in copy a_21628544

insert statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628541))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {359} in copy a_21628544

get statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628541))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {390} in copy a_21628545

event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) at {387} in copy a_21628545

insert statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628541)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628541)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),empty,g,empty,false))) at {388} in copy a_21628545

out(pub, concat3(~M_21648051,empty,~M_21648053)) with ~M_21648051 = dhexp(key_e(bob,charlie),g), ~M_21648053 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628541)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)) at {389} in copy a_21628545

get statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {360} in copy a_21628548

in(pub, concat3(g,a_21628546,encrypt(hmac_hash2(hash(somename,empty),~M_21633233),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),a_21628539))) with encrypt(hmac_hash2(hash(somename,empty),~M_21633233),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),a_21628539) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539) at {332} in copy a_21628548

event RecvMsg(bob,charlie,stage_a,a_21628539,true) at {358} in copy a_21628548

insert statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {359} in copy a_21628548

get statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {390} in copy a_21628549

event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) at {387} in copy a_21628549

insert statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),empty,g,empty,false))) at {388} in copy a_21628549

out(pub, concat3(~M_21649985,empty,~M_21649987)) with ~M_21649985 = dhexp(key_e(bob,charlie),g), ~M_21649987 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)) at {389} in copy a_21628549

get statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,empty,empty,false))) at {360} in copy a_21628553

in(pub, concat3(g,a_21628550,encrypt(hmac_hash2(hash(somename,empty),~M_21633233),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),a_21628539))) with encrypt(hmac_hash2(hash(somename,empty),~M_21633233),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),a_21628539) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539) at {332} in copy a_21628553

event RecvMsg(bob,charlie,stage_a,a_21628539,true) at {358} in copy a_21628553

insert statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {359} in copy a_21628553

get statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(empty,empty),empty,g,empty,false))) at {390} in copy a_21628554

event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) at {387} in copy a_21628554

insert statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),empty,g,empty,false))) at {388} in copy a_21628554

out(pub, concat3(~M_21651931,empty,~M_21651933)) with ~M_21651931 = dhexp(key_e(bob,charlie),g), ~M_21651933 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)) at {389} in copy a_21628554

get statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),empty,g,empty,false))) at {418} in copy a_21628555

in(pub, concat3(a_21628537,a_21628538,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21633233),~M_21648051),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),encrypt(hmac_hash2(hash(somename,empty),~M_21633233),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),a_21628539)),~M_21648051),~M_21649987),a_21628540))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_21633233),~M_21648051),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),encrypt(hmac_hash2(hash(somename,empty),~M_21633233),minnonce,hash(hash(hash(hash(somename,empty),empty),~M_21633233),g),a_21628539)),~M_21648051),~M_21649987),a_21628540) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),a_21628540) at {391} in copy a_21628555

event RecvMsg(bob,charlie,stage_c,a_21628540,true) at {415} in copy a_21628555

insert statestore(bob,charlie,statepack_d(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(increment_nonce(minnonce))),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),increment_nonce(minnonce),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_s(bob),g)),dhexp(key_e(bob,charlie),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_s(bob),g)),minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(bob),g)),g),a_21628539)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),a_21628540))),keypairpack(dhexp(key_s(bob),g),key_s(bob)),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),empty,g,empty,false))) at {416} in copy a_21628555

event RecvEnd(true) at {417} in copy a_21628555 (goal)

The event RecvEnd(true) is executed.
A trace has been found.
RESULT not event(RecvEnd(true)) is false.
