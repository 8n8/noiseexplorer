File "K1N.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1N.noise.active.pv", line 270, characters 7-8:
Warning: identifier ck rebound.
File "K1N.noise.active.pv", line 271, characters 7-8:
Warning: identifier cs rebound.
File "K1N.noise.active.pv", line 271, character 36:
Warning: identifier h rebound.
File "K1N.noise.active.pv", line 280, characters 7-8:
Warning: identifier cs rebound.
File "K1N.noise.active.pv", line 281, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 286, characters 7-8:
Warning: identifier cs rebound.
File "K1N.noise.active.pv", line 287, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 301, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 306, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 312, character 6:
Warning: identifier e rebound.
File "K1N.noise.active.pv", line 313, characters 6-7:
Warning: identifier ne rebound.
File "K1N.noise.active.pv", line 314, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 316, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 316, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1N.noise.active.pv", line 317, characters 6-7:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 324, character 6:
Warning: identifier e rebound.
File "K1N.noise.active.pv", line 325, characters 6-7:
Warning: identifier ne rebound.
File "K1N.noise.active.pv", line 326, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 328, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 329, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 329, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1N.noise.active.pv", line 330, characters 6-7:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 337, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 338, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 338, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1N.noise.active.pv", line 339, characters 6-7:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 348, characters 6-7:
Warning: identifier re rebound.
File "K1N.noise.active.pv", line 349, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 351, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 353, characters 7-8:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 361, characters 6-7:
Warning: identifier re rebound.
File "K1N.noise.active.pv", line 362, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 364, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 365, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 367, characters 7-8:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 375, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 376, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 378, characters 7-8:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 499, characters 8-9:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 337, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 338, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 338, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1N.noise.active.pv", line 339, characters 6-7:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1N.noise.active.pv", line 280, characters 7-8:
Warning: identifier cs rebound.
File "K1N.noise.active.pv", line 281, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 492, characters 8-9:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 361, characters 6-7:
Warning: identifier re rebound.
File "K1N.noise.active.pv", line 362, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 364, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 365, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 367, characters 7-8:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1N.noise.active.pv", line 286, characters 7-8:
Warning: identifier cs rebound.
File "K1N.noise.active.pv", line 287, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 484, characters 8-9:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 312, character 6:
Warning: identifier e rebound.
File "K1N.noise.active.pv", line 313, characters 6-7:
Warning: identifier ne rebound.
File "K1N.noise.active.pv", line 314, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 316, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 316, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1N.noise.active.pv", line 317, characters 6-7:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 280, characters 7-8:
Warning: identifier cs rebound.
File "K1N.noise.active.pv", line 281, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 301, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 542, characters 8-9:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 375, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 376, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 378, characters 7-8:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1N.noise.active.pv", line 286, characters 7-8:
Warning: identifier cs rebound.
File "K1N.noise.active.pv", line 287, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 534, characters 8-9:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 324, character 6:
Warning: identifier e rebound.
File "K1N.noise.active.pv", line 325, characters 6-7:
Warning: identifier ne rebound.
File "K1N.noise.active.pv", line 326, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 328, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 329, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 329, characters 26-36:
Warning: identifier ciphertext2 rebound.
File "K1N.noise.active.pv", line 330, characters 6-7:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 261, characters 7-8:
Warning: identifier ck rebound.
File "K1N.noise.active.pv", line 280, characters 7-8:
Warning: identifier cs rebound.
File "K1N.noise.active.pv", line 281, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 527, characters 8-9:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 348, characters 6-7:
Warning: identifier re rebound.
File "K1N.noise.active.pv", line 349, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 351, characters 7-8:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 353, characters 7-8:
Warning: identifier hs rebound.
File "K1N.noise.active.pv", line 286, characters 7-8:
Warning: identifier cs rebound.
File "K1N.noise.active.pv", line 287, characters 6-7:
Warning: identifier ss rebound.
File "K1N.noise.active.pv", line 306, characters 6-7:
Warning: identifier ss rebound.
Linear part:
dhexp(b_49,dhexp(a_48,g)) = dhexp(a_48,dhexp(b_49,g))
Completing equations...
Completed equations:
dhexp(b_49,dhexp(a_48,g)) = dhexp(a_48,dhexp(b_49,g))
Convergent part:
Completing equations...
Completed equations:
Process:
{1}!
(
    {2}let v_409: key = catch-fail(dhexp(key_s(alice),g)) in
    {3}let s_410: keypair = (if not-caught-fail(v_409) then keypairpack(v_409,key_s(alice)) else fail-any) in
    {4}out(pub, getpublickey(s_410));
    (
        {5}let e_411: keypair = keypairpack(empty,empty) in
        {6}let rs_412: key = empty in
        {7}let re_413: key = empty in
        {8}let v_414: bitstring = catch-fail(hash(somename,empty)) in
        {9}let v_415: key = catch-fail(v_414) in
        {10}let v_416: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {11}let v_417: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_414) then (if not-caught-fail(v_415) then (if not-caught-fail(v_416) then symmetricstatepack(v_416,v_415,v_414) else fail-any) else fail-any) else fail-any))) in
        {12}let v_418: symmetricstate = catch-fail((if success?((if not-caught-fail(v_414) then (if not-caught-fail(v_415) then (if not-caught-fail(v_416) then symmetricstatepack(v_416,v_415,v_414) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_417) && success?(is-true(success?(1-proj-3-tuple(v_417))))) then symmetricstatepack(1-proj-3-tuple(v_417),2-proj-3-tuple(v_417),hash(3-proj-3-tuple(v_417),empty)) else fail-any) else fail-any)) in
        {13}let v_419: bitstring = catch-fail(symmetricstateunpack(v_418)) in
        {14}let v_420: symmetricstate = catch-fail((if success?(getpublickey(s_410)) then (if (not-caught-fail(v_419) && success?(is-true(success?(1-proj-3-tuple(v_419))))) then symmetricstatepack(1-proj-3-tuple(v_419),2-proj-3-tuple(v_419),hash(3-proj-3-tuple(v_419),getpublickey(s_410))) else fail-any) else fail-any)) in
        {15}let hs: handshakestate = (if not-caught-fail(v_418) then (if not-caught-fail(v_420) then handshakestatepack(v_420,s_410,e_411,rs_412,re_413,empty,true) else fail-any) else fail-any) in
        {16}insert statestore(alice,bob,statepack_a(hs))
    ) | (
        {39}get statestore(=alice,=bob,statepack_a(hs_421: handshakestate)) in
        {17}let v_422: bitstring = catch-fail(handshakestateunpack(hs_421)) in
        {18}let v_423: bitstring = catch-fail((empty,empty,empty)) in
        {19}let v_424: key = catch-fail(dhexp(key_e(alice,bob),g)) in
        {20}let v_425: keypair = catch-fail((if not-caught-fail(v_424) then keypairpack(v_424,key_e(alice,bob)) else fail-any)) in
        {21}let v_426: bitstring = catch-fail(getpublickey(v_425)) in
        {22}let v_427: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_422))) in
        {23}let v_428: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_422)) then (if (not-caught-fail(v_427) && success?(is-true(success?(1-proj-3-tuple(v_427))))) then symmetricstatepack(1-proj-3-tuple(v_427),2-proj-3-tuple(v_427),hash(3-proj-3-tuple(v_427),v_426)) else fail-any) else fail-any)) in
        {24}let v_429: bitstring = catch-fail(symmetricstateunpack(v_428)) in
        {25}let v_430: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_429))) in
        {26}let v_431: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_430),2-proj-2-tuple(v_430),3-proj-3-tuple(v_429),msg_a(alice,bob))) in
        {27}let v_432: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_429))) in
        {28}let v_433: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_430))) && success?(1-proj-3-tuple(v_429))) then (if (not-caught-fail(v_432) && success?(is-true(success?(1-proj-2-tuple(v_432))))) then cipherstatepack(1-proj-2-tuple(v_432),increment_nonce(2-proj-2-tuple(v_430))) else fail-any) else fail-any)) in
        {29}let v_434: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_429)) && success?(1-proj-3-tuple(v_429))) then (if (not-caught-fail(v_430) && success?(is-true(success?(1-proj-2-tuple(v_430))))) then (if not-caught-fail(v_431) then (if not-caught-fail(v_433) then (v_433,v_431) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {30}let v_435: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_434),2-proj-3-tuple(v_429),3-proj-3-tuple(v_429)))) in
        {31}let v_436: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_434)) && success?(symmetricstatepack(1-proj-2-tuple(v_434),2-proj-3-tuple(v_429),3-proj-3-tuple(v_429)))) then (if (not-caught-fail(v_435) && success?(is-true(success?(1-proj-3-tuple(v_435))))) then symmetricstatepack(1-proj-3-tuple(v_435),2-proj-3-tuple(v_435),hash(3-proj-3-tuple(v_435),2-proj-2-tuple(v_434))) else fail-any) else fail-any)) in
        {32}let v_437: bitstring = catch-fail((if (not-caught-fail(v_429) && success?(is-true(success?(1-proj-3-tuple(v_429))))) then (if (not-caught-fail(v_434) && success?(is-true(success?(1-proj-2-tuple(v_434))))) then (if not-caught-fail(v_436) then (v_436,2-proj-2-tuple(v_434)) else fail-any) else fail-any) else fail-any)) in
        {33}let v_438: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_437),2-proj-7-tuple(v_422),v_425,4-proj-7-tuple(v_422),5-proj-7-tuple(v_422),6-proj-7-tuple(v_422),7-proj-7-tuple(v_422))) in
        {34}let v_439: bitstring = catch-fail(concat3(v_426,2-proj-3-tuple(v_423),2-proj-2-tuple(v_437))) in
        {35}let (hs_440: handshakestate,re_441: key,message_a: bitstring) = (if (not-caught-fail(v_422) && success?(is-true(success?(1-proj-7-tuple(v_422))))) then (if (not-caught-fail(v_423) && success?(is-true(success?(1-proj-3-tuple(v_423))))) then (if not-caught-fail(v_425) then (if not-caught-fail(v_426) then (if not-caught-fail(v_428) then (if (not-caught-fail(v_437) && success?(is-true(success?(1-proj-2-tuple(v_437))))) then (if not-caught-fail(v_438) then (if not-caught-fail(v_439) then (v_438,5-proj-7-tuple(v_422),v_439) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {36}event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true);
        {37}insert statestore(alice,bob,statepack_b(hs_440));
        {38}out(pub, message_a)
    ) | (
        {68}get statestore(=alice,=bob,statepack_b(hs_442: handshakestate)) in
        {40}in(pub, message_b: bitstring);
        {41}let v_443: bitstring = catch-fail(handshakestateunpack(hs_442)) in
        {42}let v_444: bitstring = catch-fail(deconcat3(message_b)) in
        {43}let v_445: bool = catch-fail(true) in
        {44}let v_446: key = catch-fail(1-proj-3-tuple(v_444)) in
        {45}let v_447: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_443))) in
        {46}let v_448: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_443)) then (if (not-caught-fail(v_447) && success?(is-true(success?(1-proj-3-tuple(v_447))))) then symmetricstatepack(1-proj-3-tuple(v_447),2-proj-3-tuple(v_447),hash(3-proj-3-tuple(v_447),v_446)) else fail-any) else fail-any)) in
        {47}let v_449: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_443))) in
        {48}let v_450: bitstring = catch-fail(symmetricstateunpack(v_448)) in
        {49}let v_451: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_450),(if success?(3-proj-7-tuple(v_443)) then (if (not-caught-fail(v_449) && success?(is-true(success?(1-proj-2-tuple(v_449))))) then dhexp(2-proj-2-tuple(v_449),v_446) else fail-any) else fail-any))) in
        {50}let v_452: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_450),(if success?(3-proj-7-tuple(v_443)) then (if (not-caught-fail(v_449) && success?(is-true(success?(1-proj-2-tuple(v_449))))) then dhexp(2-proj-2-tuple(v_449),v_446) else fail-any) else fail-any))) in
        {51}let v_453: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_450),(if success?(3-proj-7-tuple(v_443)) then (if (not-caught-fail(v_449) && success?(is-true(success?(1-proj-2-tuple(v_449))))) then dhexp(2-proj-2-tuple(v_449),v_446) else fail-any) else fail-any))) in
        {52}let v_454: bitstring = catch-fail((if (success?((if success?(3-proj-7-tuple(v_443)) then (if (not-caught-fail(v_449) && success?(is-true(success?(1-proj-2-tuple(v_449))))) then dhexp(2-proj-2-tuple(v_449),v_446) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_450))) then (if not-caught-fail(v_451) then (if not-caught-fail(v_452) then (if not-caught-fail(v_453) then (v_451,v_452,v_453) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {53}let v_455: symmetricstate = catch-fail((if success?((if success?(3-proj-7-tuple(v_443)) then (if (not-caught-fail(v_449) && success?(is-true(success?(1-proj-2-tuple(v_449))))) then dhexp(2-proj-2-tuple(v_449),v_446) else fail-any) else fail-any)) then (if (not-caught-fail(v_450) && success?(is-true(success?(1-proj-3-tuple(v_450))))) then (if (not-caught-fail(v_454) && success?(is-true(success?(1-proj-3-tuple(v_454))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_454)) then cipherstatepack(2-proj-3-tuple(v_454),minnonce) else fail-any),1-proj-3-tuple(v_454),3-proj-3-tuple(v_450)) else fail-any) else fail-any) else fail-any)) in
        {54}let v_456: bitstring = catch-fail(symmetricstateunpack(v_455)) in
        {55}let v_457: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_456))) in
        {56}let v_458: aead = catch-fail(decrypt(1-proj-2-tuple(v_457),2-proj-2-tuple(v_457),3-proj-3-tuple(v_456),3-proj-3-tuple(v_444))) in
        {57}let v_459: bitstring = catch-fail(aeadunpack(v_458)) in
        {58}let v_460: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_456))) in
        {59}let v_461: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_457))) && success?(1-proj-3-tuple(v_456))) then (if (not-caught-fail(v_460) && success?(is-true(success?(1-proj-2-tuple(v_460))))) then cipherstatepack(1-proj-2-tuple(v_460),increment_nonce(2-proj-2-tuple(v_457))) else fail-any) else fail-any)) in
        {60}let v_462: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_444)) && (success?(3-proj-3-tuple(v_456)) && success?(1-proj-3-tuple(v_456)))) then (if (not-caught-fail(v_457) && success?(is-true(success?(1-proj-2-tuple(v_457))))) then (if not-caught-fail(v_458) then (if (not-caught-fail(v_459) && success?(is-true(success?(1-proj-3-tuple(v_459))))) then (if not-caught-fail(v_461) then (v_461,3-proj-3-tuple(v_459),1-proj-3-tuple(v_459)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {61}let v_463: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_462),2-proj-3-tuple(v_456),3-proj-3-tuple(v_456)))) in
        {62}let v_464: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_444)) && success?(symmetricstatepack(1-proj-3-tuple(v_462),2-proj-3-tuple(v_456),3-proj-3-tuple(v_456)))) then (if (not-caught-fail(v_463) && success?(is-true(success?(1-proj-3-tuple(v_463))))) then symmetricstatepack(1-proj-3-tuple(v_463),2-proj-3-tuple(v_463),hash(3-proj-3-tuple(v_463),3-proj-3-tuple(v_444))) else fail-any) else fail-any)) in
        {63}let v_465: bitstring = catch-fail((if success?(3-proj-3-tuple(v_444)) then (if (not-caught-fail(v_456) && success?(is-true(success?(1-proj-3-tuple(v_456))))) then (if (not-caught-fail(v_462) && success?(is-true(success?(1-proj-3-tuple(v_462))))) then (if not-caught-fail(v_464) then (v_464,2-proj-3-tuple(v_462),3-proj-3-tuple(v_462)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {64}let v_466: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_465),2-proj-7-tuple(v_443),3-proj-7-tuple(v_443),4-proj-7-tuple(v_443),v_446,6-proj-7-tuple(v_443),7-proj-7-tuple(v_443))) in
        {65}let (hs_467: handshakestate,re_468: key,plaintext_b: bitstring,valid: bool) = (if (not-caught-fail(v_443) && success?(is-true(success?(1-proj-7-tuple(v_443))))) then (if (not-caught-fail(v_444) && success?(is-true(success?(1-proj-3-tuple(v_444))))) then (if not-caught-fail(v_445) then (if not-caught-fail(v_446) then (if not-caught-fail(v_448) then (if not-caught-fail(v_455) then (if (not-caught-fail(v_465) && success?(is-true(success?(1-proj-3-tuple(v_465))))) then (if (v_445 && 3-proj-3-tuple(v_465)) then (if not-caught-fail(v_466) then (v_466,getpublickey(3-proj-7-tuple(v_443)),2-proj-3-tuple(v_465),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {66}event RecvMsg(alice,bob,stage_b,plaintext_b,valid);
        {67}insert statestore(alice,bob,statepack_c(hs_467))
    ) | (
        {101}get statestore(=alice,=bob,statepack_c(hs_469: handshakestate)) in
        {69}let v_470: bitstring = catch-fail(handshakestateunpack(hs_469)) in
        {70}let v_471: bitstring = catch-fail((empty,empty,empty)) in
        {71}let v_472: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_470))) in
        {72}let v_473: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_470))) in
        {73}let v_474: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_473),(if (success?(5-proj-7-tuple(v_470)) && success?(2-proj-7-tuple(v_470))) then (if (not-caught-fail(v_472) && success?(is-true(success?(1-proj-2-tuple(v_472))))) then dhexp(2-proj-2-tuple(v_472),5-proj-7-tuple(v_470)) else fail-any) else fail-any))) in
        {74}let v_475: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_473),(if (success?(5-proj-7-tuple(v_470)) && success?(2-proj-7-tuple(v_470))) then (if (not-caught-fail(v_472) && success?(is-true(success?(1-proj-2-tuple(v_472))))) then dhexp(2-proj-2-tuple(v_472),5-proj-7-tuple(v_470)) else fail-any) else fail-any))) in
        {75}let v_476: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_473),(if (success?(5-proj-7-tuple(v_470)) && success?(2-proj-7-tuple(v_470))) then (if (not-caught-fail(v_472) && success?(is-true(success?(1-proj-2-tuple(v_472))))) then dhexp(2-proj-2-tuple(v_472),5-proj-7-tuple(v_470)) else fail-any) else fail-any))) in
        {76}let v_477: bitstring = catch-fail((if (success?((if (success?(5-proj-7-tuple(v_470)) && success?(2-proj-7-tuple(v_470))) then (if (not-caught-fail(v_472) && success?(is-true(success?(1-proj-2-tuple(v_472))))) then dhexp(2-proj-2-tuple(v_472),5-proj-7-tuple(v_470)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_473))) then (if not-caught-fail(v_474) then (if not-caught-fail(v_475) then (if not-caught-fail(v_476) then (v_474,v_475,v_476) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {77}let v_478: symmetricstate = catch-fail((if (success?((if (success?(5-proj-7-tuple(v_470)) && success?(2-proj-7-tuple(v_470))) then (if (not-caught-fail(v_472) && success?(is-true(success?(1-proj-2-tuple(v_472))))) then dhexp(2-proj-2-tuple(v_472),5-proj-7-tuple(v_470)) else fail-any) else fail-any)) && success?(1-proj-7-tuple(v_470))) then (if (not-caught-fail(v_473) && success?(is-true(success?(1-proj-3-tuple(v_473))))) then (if (not-caught-fail(v_477) && success?(is-true(success?(1-proj-3-tuple(v_477))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_477)) then cipherstatepack(2-proj-3-tuple(v_477),minnonce) else fail-any),1-proj-3-tuple(v_477),3-proj-3-tuple(v_473)) else fail-any) else fail-any) else fail-any)) in
        {78}let v_479: bitstring = catch-fail(symmetricstateunpack(v_478)) in
        {79}let v_480: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_479))) in
        {80}let v_481: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_480),2-proj-2-tuple(v_480),3-proj-3-tuple(v_479),msg_c(alice,bob))) in
        {81}let v_482: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_479))) in
        {82}let v_483: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_480))) && success?(1-proj-3-tuple(v_479))) then (if (not-caught-fail(v_482) && success?(is-true(success?(1-proj-2-tuple(v_482))))) then cipherstatepack(1-proj-2-tuple(v_482),increment_nonce(2-proj-2-tuple(v_480))) else fail-any) else fail-any)) in
        {83}let v_484: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_479)) && success?(1-proj-3-tuple(v_479))) then (if (not-caught-fail(v_480) && success?(is-true(success?(1-proj-2-tuple(v_480))))) then (if not-caught-fail(v_481) then (if not-caught-fail(v_483) then (v_483,v_481) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {84}let v_485: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_484),2-proj-3-tuple(v_479),3-proj-3-tuple(v_479)))) in
        {85}let v_486: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_484)) && success?(symmetricstatepack(1-proj-2-tuple(v_484),2-proj-3-tuple(v_479),3-proj-3-tuple(v_479)))) then (if (not-caught-fail(v_485) && success?(is-true(success?(1-proj-3-tuple(v_485))))) then symmetricstatepack(1-proj-3-tuple(v_485),2-proj-3-tuple(v_485),hash(3-proj-3-tuple(v_485),2-proj-2-tuple(v_484))) else fail-any) else fail-any)) in
        {86}let v_487: bitstring = catch-fail((if (not-caught-fail(v_479) && success?(is-true(success?(1-proj-3-tuple(v_479))))) then (if (not-caught-fail(v_484) && success?(is-true(success?(1-proj-2-tuple(v_484))))) then (if not-caught-fail(v_486) then (v_486,2-proj-2-tuple(v_484)) else fail-any) else fail-any) else fail-any)) in
        {87}let v_488: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_487),2-proj-7-tuple(v_470),3-proj-7-tuple(v_470),4-proj-7-tuple(v_470),5-proj-7-tuple(v_470),6-proj-7-tuple(v_470),7-proj-7-tuple(v_470))) in
        {88}let v_489: bitstring = catch-fail(concat3(1-proj-3-tuple(v_471),2-proj-3-tuple(v_471),2-proj-2-tuple(v_487))) in
        {89}let v_490: bitstring = catch-fail(symmetricstateunpack(1-proj-2-tuple(v_487))) in
        {90}let v_491: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_490),zero)) in
        {91}let v_492: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_490),zero)) in
        {92}let v_493: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_490),zero)) in
        {93}let v_494: bitstring = catch-fail((if success?(2-proj-3-tuple(v_490)) then (if not-caught-fail(v_491) then (if not-caught-fail(v_492) then (if not-caught-fail(v_493) then (v_491,v_492,v_493) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {94}let v_495: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_494)) then cipherstatepack(1-proj-3-tuple(v_494),minnonce) else fail-any)) in
        {95}let v_496: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_494)) then cipherstatepack(2-proj-3-tuple(v_494),minnonce) else fail-any)) in
        {96}let v_497: bitstring = catch-fail((if success?(1-proj-2-tuple(v_487)) then (if (not-caught-fail(v_490) && success?(is-true(success?(1-proj-3-tuple(v_490))))) then (if (not-caught-fail(v_494) && success?(is-true(success?(1-proj-3-tuple(v_494))))) then (if not-caught-fail(v_495) then (if not-caught-fail(v_496) then (1-proj-2-tuple(v_487),v_495,v_496) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {97}let (hs_498: handshakestate,re_499: key,message_c: bitstring,cs1: cipherstate,cs2: cipherstate) = (if (not-caught-fail(v_470) && success?(is-true(success?(1-proj-7-tuple(v_470))))) then (if (not-caught-fail(v_471) && success?(is-true(success?(1-proj-3-tuple(v_471))))) then (if not-caught-fail(v_478) then (if (not-caught-fail(v_487) && success?(is-true(success?(1-proj-2-tuple(v_487))))) then (if not-caught-fail(v_488) then (if not-caught-fail(v_489) then (if (not-caught-fail(v_497) && success?(is-true(success?(1-proj-3-tuple(v_497))))) then (v_488,5-proj-7-tuple(v_470),v_489,2-proj-3-tuple(v_497),3-proj-3-tuple(v_497)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {98}event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true);
        {99}insert statestore(alice,bob,statepack_d(hs_498));
        {100}out(pub, message_c)
    ) | (
        {102}event LeakS(phase0,alice);
        {103}out(pub, key_s(alice))
    ) | (
        {104}phase 1;
        {105}event LeakS(phase1,alice);
        {106}out(pub, key_s(alice))
    )
) | (
    {107}let v_500: key = catch-fail(dhexp(key_s(alice),g)) in
    {108}let s_501: keypair = (if not-caught-fail(v_500) then keypairpack(v_500,key_s(alice)) else fail-any) in
    {109}out(pub, getpublickey(s_501));
    (
        {110}let e_502: keypair = keypairpack(empty,empty) in
        {111}let rs_503: key = empty in
        {112}let re_504: key = empty in
        {113}let v_505: bitstring = catch-fail(hash(somename,empty)) in
        {114}let v_506: key = catch-fail(v_505) in
        {115}let v_507: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {116}let v_508: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_505) then (if not-caught-fail(v_506) then (if not-caught-fail(v_507) then symmetricstatepack(v_507,v_506,v_505) else fail-any) else fail-any) else fail-any))) in
        {117}let v_509: symmetricstate = catch-fail((if success?((if not-caught-fail(v_505) then (if not-caught-fail(v_506) then (if not-caught-fail(v_507) then symmetricstatepack(v_507,v_506,v_505) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_508) && success?(is-true(success?(1-proj-3-tuple(v_508))))) then symmetricstatepack(1-proj-3-tuple(v_508),2-proj-3-tuple(v_508),hash(3-proj-3-tuple(v_508),empty)) else fail-any) else fail-any)) in
        {118}let v_510: bitstring = catch-fail(symmetricstateunpack(v_509)) in
        {119}let v_511: symmetricstate = catch-fail((if success?(getpublickey(s_501)) then (if (not-caught-fail(v_510) && success?(is-true(success?(1-proj-3-tuple(v_510))))) then symmetricstatepack(1-proj-3-tuple(v_510),2-proj-3-tuple(v_510),hash(3-proj-3-tuple(v_510),getpublickey(s_501))) else fail-any) else fail-any)) in
        {120}let hs_512: handshakestate = (if not-caught-fail(v_509) then (if not-caught-fail(v_511) then handshakestatepack(v_511,s_501,e_502,rs_503,re_504,empty,true) else fail-any) else fail-any) in
        {121}insert statestore(alice,charlie,statepack_a(hs_512))
    ) | (
        {144}get statestore(=alice,=charlie,statepack_a(hs_513: handshakestate)) in
        {122}let v_514: bitstring = catch-fail(handshakestateunpack(hs_513)) in
        {123}let v_515: bitstring = catch-fail((empty,empty,empty)) in
        {124}let v_516: key = catch-fail(dhexp(key_e(alice,charlie),g)) in
        {125}let v_517: keypair = catch-fail((if not-caught-fail(v_516) then keypairpack(v_516,key_e(alice,charlie)) else fail-any)) in
        {126}let v_518: bitstring = catch-fail(getpublickey(v_517)) in
        {127}let v_519: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_514))) in
        {128}let v_520: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_514)) then (if (not-caught-fail(v_519) && success?(is-true(success?(1-proj-3-tuple(v_519))))) then symmetricstatepack(1-proj-3-tuple(v_519),2-proj-3-tuple(v_519),hash(3-proj-3-tuple(v_519),v_518)) else fail-any) else fail-any)) in
        {129}let v_521: bitstring = catch-fail(symmetricstateunpack(v_520)) in
        {130}let v_522: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_521))) in
        {131}let v_523: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_522),2-proj-2-tuple(v_522),3-proj-3-tuple(v_521),msg_a(alice,charlie))) in
        {132}let v_524: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_521))) in
        {133}let v_525: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_522))) && success?(1-proj-3-tuple(v_521))) then (if (not-caught-fail(v_524) && success?(is-true(success?(1-proj-2-tuple(v_524))))) then cipherstatepack(1-proj-2-tuple(v_524),increment_nonce(2-proj-2-tuple(v_522))) else fail-any) else fail-any)) in
        {134}let v_526: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_521)) && success?(1-proj-3-tuple(v_521))) then (if (not-caught-fail(v_522) && success?(is-true(success?(1-proj-2-tuple(v_522))))) then (if not-caught-fail(v_523) then (if not-caught-fail(v_525) then (v_525,v_523) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {135}let v_527: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_526),2-proj-3-tuple(v_521),3-proj-3-tuple(v_521)))) in
        {136}let v_528: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_526)) && success?(symmetricstatepack(1-proj-2-tuple(v_526),2-proj-3-tuple(v_521),3-proj-3-tuple(v_521)))) then (if (not-caught-fail(v_527) && success?(is-true(success?(1-proj-3-tuple(v_527))))) then symmetricstatepack(1-proj-3-tuple(v_527),2-proj-3-tuple(v_527),hash(3-proj-3-tuple(v_527),2-proj-2-tuple(v_526))) else fail-any) else fail-any)) in
        {137}let v_529: bitstring = catch-fail((if (not-caught-fail(v_521) && success?(is-true(success?(1-proj-3-tuple(v_521))))) then (if (not-caught-fail(v_526) && success?(is-true(success?(1-proj-2-tuple(v_526))))) then (if not-caught-fail(v_528) then (v_528,2-proj-2-tuple(v_526)) else fail-any) else fail-any) else fail-any)) in
        {138}let v_530: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_529),2-proj-7-tuple(v_514),v_517,4-proj-7-tuple(v_514),5-proj-7-tuple(v_514),6-proj-7-tuple(v_514),7-proj-7-tuple(v_514))) in
        {139}let v_531: bitstring = catch-fail(concat3(v_518,2-proj-3-tuple(v_515),2-proj-2-tuple(v_529))) in
        {140}let (hs_532: handshakestate,re_533: key,message_a_534: bitstring) = (if (not-caught-fail(v_514) && success?(is-true(success?(1-proj-7-tuple(v_514))))) then (if (not-caught-fail(v_515) && success?(is-true(success?(1-proj-3-tuple(v_515))))) then (if not-caught-fail(v_517) then (if not-caught-fail(v_518) then (if not-caught-fail(v_520) then (if (not-caught-fail(v_529) && success?(is-true(success?(1-proj-2-tuple(v_529))))) then (if not-caught-fail(v_530) then (if not-caught-fail(v_531) then (v_530,5-proj-7-tuple(v_514),v_531) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {141}event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true);
        {142}insert statestore(alice,charlie,statepack_b(hs_532));
        {143}out(pub, message_a_534)
    ) | (
        {173}get statestore(=alice,=charlie,statepack_b(hs_535: handshakestate)) in
        {145}in(pub, message_b_536: bitstring);
        {146}let v_537: bitstring = catch-fail(handshakestateunpack(hs_535)) in
        {147}let v_538: bitstring = catch-fail(deconcat3(message_b_536)) in
        {148}let v_539: bool = catch-fail(true) in
        {149}let v_540: key = catch-fail(1-proj-3-tuple(v_538)) in
        {150}let v_541: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_537))) in
        {151}let v_542: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_537)) then (if (not-caught-fail(v_541) && success?(is-true(success?(1-proj-3-tuple(v_541))))) then symmetricstatepack(1-proj-3-tuple(v_541),2-proj-3-tuple(v_541),hash(3-proj-3-tuple(v_541),v_540)) else fail-any) else fail-any)) in
        {152}let v_543: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_537))) in
        {153}let v_544: bitstring = catch-fail(symmetricstateunpack(v_542)) in
        {154}let v_545: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_544),(if success?(3-proj-7-tuple(v_537)) then (if (not-caught-fail(v_543) && success?(is-true(success?(1-proj-2-tuple(v_543))))) then dhexp(2-proj-2-tuple(v_543),v_540) else fail-any) else fail-any))) in
        {155}let v_546: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_544),(if success?(3-proj-7-tuple(v_537)) then (if (not-caught-fail(v_543) && success?(is-true(success?(1-proj-2-tuple(v_543))))) then dhexp(2-proj-2-tuple(v_543),v_540) else fail-any) else fail-any))) in
        {156}let v_547: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_544),(if success?(3-proj-7-tuple(v_537)) then (if (not-caught-fail(v_543) && success?(is-true(success?(1-proj-2-tuple(v_543))))) then dhexp(2-proj-2-tuple(v_543),v_540) else fail-any) else fail-any))) in
        {157}let v_548: bitstring = catch-fail((if (success?((if success?(3-proj-7-tuple(v_537)) then (if (not-caught-fail(v_543) && success?(is-true(success?(1-proj-2-tuple(v_543))))) then dhexp(2-proj-2-tuple(v_543),v_540) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_544))) then (if not-caught-fail(v_545) then (if not-caught-fail(v_546) then (if not-caught-fail(v_547) then (v_545,v_546,v_547) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {158}let v_549: symmetricstate = catch-fail((if success?((if success?(3-proj-7-tuple(v_537)) then (if (not-caught-fail(v_543) && success?(is-true(success?(1-proj-2-tuple(v_543))))) then dhexp(2-proj-2-tuple(v_543),v_540) else fail-any) else fail-any)) then (if (not-caught-fail(v_544) && success?(is-true(success?(1-proj-3-tuple(v_544))))) then (if (not-caught-fail(v_548) && success?(is-true(success?(1-proj-3-tuple(v_548))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_548)) then cipherstatepack(2-proj-3-tuple(v_548),minnonce) else fail-any),1-proj-3-tuple(v_548),3-proj-3-tuple(v_544)) else fail-any) else fail-any) else fail-any)) in
        {159}let v_550: bitstring = catch-fail(symmetricstateunpack(v_549)) in
        {160}let v_551: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_550))) in
        {161}let v_552: aead = catch-fail(decrypt(1-proj-2-tuple(v_551),2-proj-2-tuple(v_551),3-proj-3-tuple(v_550),3-proj-3-tuple(v_538))) in
        {162}let v_553: bitstring = catch-fail(aeadunpack(v_552)) in
        {163}let v_554: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_550))) in
        {164}let v_555: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_551))) && success?(1-proj-3-tuple(v_550))) then (if (not-caught-fail(v_554) && success?(is-true(success?(1-proj-2-tuple(v_554))))) then cipherstatepack(1-proj-2-tuple(v_554),increment_nonce(2-proj-2-tuple(v_551))) else fail-any) else fail-any)) in
        {165}let v_556: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_538)) && (success?(3-proj-3-tuple(v_550)) && success?(1-proj-3-tuple(v_550)))) then (if (not-caught-fail(v_551) && success?(is-true(success?(1-proj-2-tuple(v_551))))) then (if not-caught-fail(v_552) then (if (not-caught-fail(v_553) && success?(is-true(success?(1-proj-3-tuple(v_553))))) then (if not-caught-fail(v_555) then (v_555,3-proj-3-tuple(v_553),1-proj-3-tuple(v_553)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {166}let v_557: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_556),2-proj-3-tuple(v_550),3-proj-3-tuple(v_550)))) in
        {167}let v_558: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_538)) && success?(symmetricstatepack(1-proj-3-tuple(v_556),2-proj-3-tuple(v_550),3-proj-3-tuple(v_550)))) then (if (not-caught-fail(v_557) && success?(is-true(success?(1-proj-3-tuple(v_557))))) then symmetricstatepack(1-proj-3-tuple(v_557),2-proj-3-tuple(v_557),hash(3-proj-3-tuple(v_557),3-proj-3-tuple(v_538))) else fail-any) else fail-any)) in
        {168}let v_559: bitstring = catch-fail((if success?(3-proj-3-tuple(v_538)) then (if (not-caught-fail(v_550) && success?(is-true(success?(1-proj-3-tuple(v_550))))) then (if (not-caught-fail(v_556) && success?(is-true(success?(1-proj-3-tuple(v_556))))) then (if not-caught-fail(v_558) then (v_558,2-proj-3-tuple(v_556),3-proj-3-tuple(v_556)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {169}let v_560: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_559),2-proj-7-tuple(v_537),3-proj-7-tuple(v_537),4-proj-7-tuple(v_537),v_540,6-proj-7-tuple(v_537),7-proj-7-tuple(v_537))) in
        {170}let (hs_561: handshakestate,re_562: key,plaintext_b_563: bitstring,valid_564: bool) = (if (not-caught-fail(v_537) && success?(is-true(success?(1-proj-7-tuple(v_537))))) then (if (not-caught-fail(v_538) && success?(is-true(success?(1-proj-3-tuple(v_538))))) then (if not-caught-fail(v_539) then (if not-caught-fail(v_540) then (if not-caught-fail(v_542) then (if not-caught-fail(v_549) then (if (not-caught-fail(v_559) && success?(is-true(success?(1-proj-3-tuple(v_559))))) then (if (v_539 && 3-proj-3-tuple(v_559)) then (if not-caught-fail(v_560) then (v_560,getpublickey(3-proj-7-tuple(v_537)),2-proj-3-tuple(v_559),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {171}event RecvMsg(alice,charlie,stage_b,plaintext_b_563,valid_564);
        {172}insert statestore(alice,charlie,statepack_c(hs_561))
    ) | (
        {206}get statestore(=alice,=charlie,statepack_c(hs_565: handshakestate)) in
        {174}let v_566: bitstring = catch-fail(handshakestateunpack(hs_565)) in
        {175}let v_567: bitstring = catch-fail((empty,empty,empty)) in
        {176}let v_568: bitstring = catch-fail(keypairunpack(2-proj-7-tuple(v_566))) in
        {177}let v_569: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_566))) in
        {178}let v_570: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_569),(if (success?(5-proj-7-tuple(v_566)) && success?(2-proj-7-tuple(v_566))) then (if (not-caught-fail(v_568) && success?(is-true(success?(1-proj-2-tuple(v_568))))) then dhexp(2-proj-2-tuple(v_568),5-proj-7-tuple(v_566)) else fail-any) else fail-any))) in
        {179}let v_571: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_569),(if (success?(5-proj-7-tuple(v_566)) && success?(2-proj-7-tuple(v_566))) then (if (not-caught-fail(v_568) && success?(is-true(success?(1-proj-2-tuple(v_568))))) then dhexp(2-proj-2-tuple(v_568),5-proj-7-tuple(v_566)) else fail-any) else fail-any))) in
        {180}let v_572: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_569),(if (success?(5-proj-7-tuple(v_566)) && success?(2-proj-7-tuple(v_566))) then (if (not-caught-fail(v_568) && success?(is-true(success?(1-proj-2-tuple(v_568))))) then dhexp(2-proj-2-tuple(v_568),5-proj-7-tuple(v_566)) else fail-any) else fail-any))) in
        {181}let v_573: bitstring = catch-fail((if (success?((if (success?(5-proj-7-tuple(v_566)) && success?(2-proj-7-tuple(v_566))) then (if (not-caught-fail(v_568) && success?(is-true(success?(1-proj-2-tuple(v_568))))) then dhexp(2-proj-2-tuple(v_568),5-proj-7-tuple(v_566)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_569))) then (if not-caught-fail(v_570) then (if not-caught-fail(v_571) then (if not-caught-fail(v_572) then (v_570,v_571,v_572) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {182}let v_574: symmetricstate = catch-fail((if (success?((if (success?(5-proj-7-tuple(v_566)) && success?(2-proj-7-tuple(v_566))) then (if (not-caught-fail(v_568) && success?(is-true(success?(1-proj-2-tuple(v_568))))) then dhexp(2-proj-2-tuple(v_568),5-proj-7-tuple(v_566)) else fail-any) else fail-any)) && success?(1-proj-7-tuple(v_566))) then (if (not-caught-fail(v_569) && success?(is-true(success?(1-proj-3-tuple(v_569))))) then (if (not-caught-fail(v_573) && success?(is-true(success?(1-proj-3-tuple(v_573))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_573)) then cipherstatepack(2-proj-3-tuple(v_573),minnonce) else fail-any),1-proj-3-tuple(v_573),3-proj-3-tuple(v_569)) else fail-any) else fail-any) else fail-any)) in
        {183}let v_575: bitstring = catch-fail(symmetricstateunpack(v_574)) in
        {184}let v_576: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_575))) in
        {185}let v_577: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_576),2-proj-2-tuple(v_576),3-proj-3-tuple(v_575),msg_c(alice,charlie))) in
        {186}let v_578: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_575))) in
        {187}let v_579: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_576))) && success?(1-proj-3-tuple(v_575))) then (if (not-caught-fail(v_578) && success?(is-true(success?(1-proj-2-tuple(v_578))))) then cipherstatepack(1-proj-2-tuple(v_578),increment_nonce(2-proj-2-tuple(v_576))) else fail-any) else fail-any)) in
        {188}let v_580: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_575)) && success?(1-proj-3-tuple(v_575))) then (if (not-caught-fail(v_576) && success?(is-true(success?(1-proj-2-tuple(v_576))))) then (if not-caught-fail(v_577) then (if not-caught-fail(v_579) then (v_579,v_577) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {189}let v_581: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_580),2-proj-3-tuple(v_575),3-proj-3-tuple(v_575)))) in
        {190}let v_582: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_580)) && success?(symmetricstatepack(1-proj-2-tuple(v_580),2-proj-3-tuple(v_575),3-proj-3-tuple(v_575)))) then (if (not-caught-fail(v_581) && success?(is-true(success?(1-proj-3-tuple(v_581))))) then symmetricstatepack(1-proj-3-tuple(v_581),2-proj-3-tuple(v_581),hash(3-proj-3-tuple(v_581),2-proj-2-tuple(v_580))) else fail-any) else fail-any)) in
        {191}let v_583: bitstring = catch-fail((if (not-caught-fail(v_575) && success?(is-true(success?(1-proj-3-tuple(v_575))))) then (if (not-caught-fail(v_580) && success?(is-true(success?(1-proj-2-tuple(v_580))))) then (if not-caught-fail(v_582) then (v_582,2-proj-2-tuple(v_580)) else fail-any) else fail-any) else fail-any)) in
        {192}let v_584: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_583),2-proj-7-tuple(v_566),3-proj-7-tuple(v_566),4-proj-7-tuple(v_566),5-proj-7-tuple(v_566),6-proj-7-tuple(v_566),7-proj-7-tuple(v_566))) in
        {193}let v_585: bitstring = catch-fail(concat3(1-proj-3-tuple(v_567),2-proj-3-tuple(v_567),2-proj-2-tuple(v_583))) in
        {194}let v_586: bitstring = catch-fail(symmetricstateunpack(1-proj-2-tuple(v_583))) in
        {195}let v_587: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_586),zero)) in
        {196}let v_588: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_586),zero)) in
        {197}let v_589: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_586),zero)) in
        {198}let v_590: bitstring = catch-fail((if success?(2-proj-3-tuple(v_586)) then (if not-caught-fail(v_587) then (if not-caught-fail(v_588) then (if not-caught-fail(v_589) then (v_587,v_588,v_589) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {199}let v_591: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_590)) then cipherstatepack(1-proj-3-tuple(v_590),minnonce) else fail-any)) in
        {200}let v_592: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_590)) then cipherstatepack(2-proj-3-tuple(v_590),minnonce) else fail-any)) in
        {201}let v_593: bitstring = catch-fail((if success?(1-proj-2-tuple(v_583)) then (if (not-caught-fail(v_586) && success?(is-true(success?(1-proj-3-tuple(v_586))))) then (if (not-caught-fail(v_590) && success?(is-true(success?(1-proj-3-tuple(v_590))))) then (if not-caught-fail(v_591) then (if not-caught-fail(v_592) then (1-proj-2-tuple(v_583),v_591,v_592) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {202}let (hs_594: handshakestate,re_595: key,message_c_596: bitstring,cs1_597: cipherstate,cs2_598: cipherstate) = (if (not-caught-fail(v_566) && success?(is-true(success?(1-proj-7-tuple(v_566))))) then (if (not-caught-fail(v_567) && success?(is-true(success?(1-proj-3-tuple(v_567))))) then (if not-caught-fail(v_574) then (if (not-caught-fail(v_583) && success?(is-true(success?(1-proj-2-tuple(v_583))))) then (if not-caught-fail(v_584) then (if not-caught-fail(v_585) then (if (not-caught-fail(v_593) && success?(is-true(success?(1-proj-3-tuple(v_593))))) then (v_584,5-proj-7-tuple(v_566),v_585,2-proj-3-tuple(v_593),3-proj-3-tuple(v_593)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {203}event SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true);
        {204}insert statestore(alice,charlie,statepack_d(hs_594));
        {205}out(pub, message_c_596)
    ) | (
        {207}event LeakS(phase0,alice);
        {208}out(pub, key_s(alice))
    ) | (
        {209}phase 1;
        {210}event LeakS(phase1,alice);
        {211}out(pub, key_s(alice))
    )
) | (
    {212}let s_599: keypair = keypairpack(empty,empty) in
    (
        {213}let e_600: keypair = keypairpack(empty,empty) in
        {214}let v_601: key = catch-fail(dhexp(key_s(alice),g)) in
        {215}let rs_602: key = getpublickey((if not-caught-fail(v_601) then keypairpack(v_601,key_s(alice)) else fail-any)) in
        {216}let re_603: key = empty in
        {217}let v_604: bitstring = catch-fail(hash(somename,empty)) in
        {218}let v_605: key = catch-fail(v_604) in
        {219}let v_606: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {220}let v_607: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_604) then (if not-caught-fail(v_605) then (if not-caught-fail(v_606) then symmetricstatepack(v_606,v_605,v_604) else fail-any) else fail-any) else fail-any))) in
        {221}let v_608: symmetricstate = catch-fail((if success?((if not-caught-fail(v_604) then (if not-caught-fail(v_605) then (if not-caught-fail(v_606) then symmetricstatepack(v_606,v_605,v_604) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_607) && success?(is-true(success?(1-proj-3-tuple(v_607))))) then symmetricstatepack(1-proj-3-tuple(v_607),2-proj-3-tuple(v_607),hash(3-proj-3-tuple(v_607),empty)) else fail-any) else fail-any)) in
        {222}let v_609: bitstring = catch-fail(symmetricstateunpack(v_608)) in
        {223}let v_610: symmetricstate = catch-fail((if (not-caught-fail(v_609) && success?(is-true(success?(1-proj-3-tuple(v_609))))) then symmetricstatepack(1-proj-3-tuple(v_609),2-proj-3-tuple(v_609),hash(3-proj-3-tuple(v_609),rs_602)) else fail-any)) in
        {224}let hs_611: handshakestate = (if not-caught-fail(v_608) then (if not-caught-fail(v_610) then handshakestatepack(v_610,s_599,e_600,rs_602,re_603,empty,false) else fail-any) else fail-any) in
        {225}insert statestore(bob,alice,statepack_a(hs_611))
    ) | (
        {247}get statestore(=bob,=alice,statepack_a(hs_612: handshakestate)) in
        {226}in(pub, message_a_613: bitstring);
        {227}let v_614: bitstring = catch-fail(handshakestateunpack(hs_612)) in
        {228}let v_615: bitstring = catch-fail(deconcat3(message_a_613)) in
        {229}let v_616: bool = catch-fail(true) in
        {230}let v_617: key = catch-fail(1-proj-3-tuple(v_615)) in
        {231}let v_618: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_614))) in
        {232}let v_619: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_614)) then (if (not-caught-fail(v_618) && success?(is-true(success?(1-proj-3-tuple(v_618))))) then symmetricstatepack(1-proj-3-tuple(v_618),2-proj-3-tuple(v_618),hash(3-proj-3-tuple(v_618),v_617)) else fail-any) else fail-any)) in
        {233}let v_620: bitstring = catch-fail(symmetricstateunpack(v_619)) in
        {234}let v_621: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_620))) in
        {235}let v_622: aead = catch-fail(decrypt(1-proj-2-tuple(v_621),2-proj-2-tuple(v_621),3-proj-3-tuple(v_620),3-proj-3-tuple(v_615))) in
        {236}let v_623: bitstring = catch-fail(aeadunpack(v_622)) in
        {237}let v_624: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_620))) in
        {238}let v_625: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_621))) && success?(1-proj-3-tuple(v_620))) then (if (not-caught-fail(v_624) && success?(is-true(success?(1-proj-2-tuple(v_624))))) then cipherstatepack(1-proj-2-tuple(v_624),increment_nonce(2-proj-2-tuple(v_621))) else fail-any) else fail-any)) in
        {239}let v_626: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_615)) && (success?(3-proj-3-tuple(v_620)) && success?(1-proj-3-tuple(v_620)))) then (if (not-caught-fail(v_621) && success?(is-true(success?(1-proj-2-tuple(v_621))))) then (if not-caught-fail(v_622) then (if (not-caught-fail(v_623) && success?(is-true(success?(1-proj-3-tuple(v_623))))) then (if not-caught-fail(v_625) then (v_625,3-proj-3-tuple(v_623),1-proj-3-tuple(v_623)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {240}let v_627: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_626),2-proj-3-tuple(v_620),3-proj-3-tuple(v_620)))) in
        {241}let v_628: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_615)) && success?(symmetricstatepack(1-proj-3-tuple(v_626),2-proj-3-tuple(v_620),3-proj-3-tuple(v_620)))) then (if (not-caught-fail(v_627) && success?(is-true(success?(1-proj-3-tuple(v_627))))) then symmetricstatepack(1-proj-3-tuple(v_627),2-proj-3-tuple(v_627),hash(3-proj-3-tuple(v_627),3-proj-3-tuple(v_615))) else fail-any) else fail-any)) in
        {242}let v_629: bitstring = catch-fail((if success?(3-proj-3-tuple(v_615)) then (if (not-caught-fail(v_620) && success?(is-true(success?(1-proj-3-tuple(v_620))))) then (if (not-caught-fail(v_626) && success?(is-true(success?(1-proj-3-tuple(v_626))))) then (if not-caught-fail(v_628) then (v_628,2-proj-3-tuple(v_626),3-proj-3-tuple(v_626)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {243}let v_630: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_629),2-proj-7-tuple(v_614),3-proj-7-tuple(v_614),4-proj-7-tuple(v_614),v_617,6-proj-7-tuple(v_614),7-proj-7-tuple(v_614))) in
        {244}let (hs_631: handshakestate,re_632: key,plaintext_a: bitstring,valid_633: bool) = (if (not-caught-fail(v_614) && success?(is-true(success?(1-proj-7-tuple(v_614))))) then (if (not-caught-fail(v_615) && success?(is-true(success?(1-proj-3-tuple(v_615))))) then (if not-caught-fail(v_616) then (if not-caught-fail(v_617) then (if not-caught-fail(v_619) then (if (not-caught-fail(v_629) && success?(is-true(success?(1-proj-3-tuple(v_629))))) then (if (v_616 && 3-proj-3-tuple(v_629)) then (if not-caught-fail(v_630) then (v_630,getpublickey(3-proj-7-tuple(v_614)),2-proj-3-tuple(v_629),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {245}event RecvMsg(bob,alice,stage_a,plaintext_a,valid_633);
        {246}insert statestore(bob,alice,statepack_b(hs_631))
    ) | (
        {277}get statestore(=bob,=alice,statepack_b(hs_634: handshakestate)) in
        {248}let v_635: bitstring = catch-fail(handshakestateunpack(hs_634)) in
        {249}let v_636: bitstring = catch-fail((empty,empty,empty)) in
        {250}let v_637: key = catch-fail(dhexp(key_e(bob,alice),g)) in
        {251}let v_638: keypair = catch-fail((if not-caught-fail(v_637) then keypairpack(v_637,key_e(bob,alice)) else fail-any)) in
        {252}let v_639: bitstring = catch-fail(getpublickey(v_638)) in
        {253}let v_640: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_635))) in
        {254}let v_641: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_635)) then (if (not-caught-fail(v_640) && success?(is-true(success?(1-proj-3-tuple(v_640))))) then symmetricstatepack(1-proj-3-tuple(v_640),2-proj-3-tuple(v_640),hash(3-proj-3-tuple(v_640),v_639)) else fail-any) else fail-any)) in
        {255}let v_642: bitstring = catch-fail(keypairunpack(v_638)) in
        {256}let v_643: bitstring = catch-fail(symmetricstateunpack(v_641)) in
        {257}let v_644: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_643),(if success?(5-proj-7-tuple(v_635)) then (if (not-caught-fail(v_642) && success?(is-true(success?(1-proj-2-tuple(v_642))))) then dhexp(2-proj-2-tuple(v_642),5-proj-7-tuple(v_635)) else fail-any) else fail-any))) in
        {258}let v_645: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_643),(if success?(5-proj-7-tuple(v_635)) then (if (not-caught-fail(v_642) && success?(is-true(success?(1-proj-2-tuple(v_642))))) then dhexp(2-proj-2-tuple(v_642),5-proj-7-tuple(v_635)) else fail-any) else fail-any))) in
        {259}let v_646: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_643),(if success?(5-proj-7-tuple(v_635)) then (if (not-caught-fail(v_642) && success?(is-true(success?(1-proj-2-tuple(v_642))))) then dhexp(2-proj-2-tuple(v_642),5-proj-7-tuple(v_635)) else fail-any) else fail-any))) in
        {260}let v_647: bitstring = catch-fail((if (success?((if success?(5-proj-7-tuple(v_635)) then (if (not-caught-fail(v_642) && success?(is-true(success?(1-proj-2-tuple(v_642))))) then dhexp(2-proj-2-tuple(v_642),5-proj-7-tuple(v_635)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_643))) then (if not-caught-fail(v_644) then (if not-caught-fail(v_645) then (if not-caught-fail(v_646) then (v_644,v_645,v_646) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {261}let v_648: symmetricstate = catch-fail((if success?((if success?(5-proj-7-tuple(v_635)) then (if (not-caught-fail(v_642) && success?(is-true(success?(1-proj-2-tuple(v_642))))) then dhexp(2-proj-2-tuple(v_642),5-proj-7-tuple(v_635)) else fail-any) else fail-any)) then (if (not-caught-fail(v_643) && success?(is-true(success?(1-proj-3-tuple(v_643))))) then (if (not-caught-fail(v_647) && success?(is-true(success?(1-proj-3-tuple(v_647))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_647)) then cipherstatepack(2-proj-3-tuple(v_647),minnonce) else fail-any),1-proj-3-tuple(v_647),3-proj-3-tuple(v_643)) else fail-any) else fail-any) else fail-any)) in
        {262}let v_649: bitstring = catch-fail(symmetricstateunpack(v_648)) in
        {263}let v_650: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_649))) in
        {264}let v_651: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_650),2-proj-2-tuple(v_650),3-proj-3-tuple(v_649),msg_b(bob,alice))) in
        {265}let v_652: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_649))) in
        {266}let v_653: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_650))) && success?(1-proj-3-tuple(v_649))) then (if (not-caught-fail(v_652) && success?(is-true(success?(1-proj-2-tuple(v_652))))) then cipherstatepack(1-proj-2-tuple(v_652),increment_nonce(2-proj-2-tuple(v_650))) else fail-any) else fail-any)) in
        {267}let v_654: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_649)) && success?(1-proj-3-tuple(v_649))) then (if (not-caught-fail(v_650) && success?(is-true(success?(1-proj-2-tuple(v_650))))) then (if not-caught-fail(v_651) then (if not-caught-fail(v_653) then (v_653,v_651) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {268}let v_655: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_654),2-proj-3-tuple(v_649),3-proj-3-tuple(v_649)))) in
        {269}let v_656: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_654)) && success?(symmetricstatepack(1-proj-2-tuple(v_654),2-proj-3-tuple(v_649),3-proj-3-tuple(v_649)))) then (if (not-caught-fail(v_655) && success?(is-true(success?(1-proj-3-tuple(v_655))))) then symmetricstatepack(1-proj-3-tuple(v_655),2-proj-3-tuple(v_655),hash(3-proj-3-tuple(v_655),2-proj-2-tuple(v_654))) else fail-any) else fail-any)) in
        {270}let v_657: bitstring = catch-fail((if (not-caught-fail(v_649) && success?(is-true(success?(1-proj-3-tuple(v_649))))) then (if (not-caught-fail(v_654) && success?(is-true(success?(1-proj-2-tuple(v_654))))) then (if not-caught-fail(v_656) then (v_656,2-proj-2-tuple(v_654)) else fail-any) else fail-any) else fail-any)) in
        {271}let v_658: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_657),2-proj-7-tuple(v_635),v_638,4-proj-7-tuple(v_635),5-proj-7-tuple(v_635),6-proj-7-tuple(v_635),7-proj-7-tuple(v_635))) in
        {272}let v_659: bitstring = catch-fail(concat3(v_639,2-proj-3-tuple(v_636),2-proj-2-tuple(v_657))) in
        {273}let (hs_660: handshakestate,re_661: key,message_b_662: bitstring) = (if (not-caught-fail(v_635) && success?(is-true(success?(1-proj-7-tuple(v_635))))) then (if (not-caught-fail(v_636) && success?(is-true(success?(1-proj-3-tuple(v_636))))) then (if not-caught-fail(v_638) then (if not-caught-fail(v_639) then (if not-caught-fail(v_641) then (if not-caught-fail(v_648) then (if (not-caught-fail(v_657) && success?(is-true(success?(1-proj-2-tuple(v_657))))) then (if not-caught-fail(v_658) then (if not-caught-fail(v_659) then (v_658,5-proj-7-tuple(v_635),v_659) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {274}event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true);
        {275}insert statestore(bob,alice,statepack_c(hs_660));
        {276}out(pub, message_b_662)
    ) | (
        {312}get statestore(=bob,=alice,statepack_c(hs_663: handshakestate)) in
        {278}in(pub, message_c_664: bitstring);
        {279}let v_665: bitstring = catch-fail(handshakestateunpack(hs_663)) in
        {280}let v_666: bitstring = catch-fail(deconcat3(message_c_664)) in
        {281}let v_667: bool = catch-fail(true) in
        {282}let v_668: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_665))) in
        {283}let v_669: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_665))) in
        {284}let v_670: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_669),(if (success?(4-proj-7-tuple(v_665)) && success?(3-proj-7-tuple(v_665))) then (if (not-caught-fail(v_668) && success?(is-true(success?(1-proj-2-tuple(v_668))))) then dhexp(2-proj-2-tuple(v_668),4-proj-7-tuple(v_665)) else fail-any) else fail-any))) in
        {285}let v_671: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_669),(if (success?(4-proj-7-tuple(v_665)) && success?(3-proj-7-tuple(v_665))) then (if (not-caught-fail(v_668) && success?(is-true(success?(1-proj-2-tuple(v_668))))) then dhexp(2-proj-2-tuple(v_668),4-proj-7-tuple(v_665)) else fail-any) else fail-any))) in
        {286}let v_672: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_669),(if (success?(4-proj-7-tuple(v_665)) && success?(3-proj-7-tuple(v_665))) then (if (not-caught-fail(v_668) && success?(is-true(success?(1-proj-2-tuple(v_668))))) then dhexp(2-proj-2-tuple(v_668),4-proj-7-tuple(v_665)) else fail-any) else fail-any))) in
        {287}let v_673: bitstring = catch-fail((if (success?((if (success?(4-proj-7-tuple(v_665)) && success?(3-proj-7-tuple(v_665))) then (if (not-caught-fail(v_668) && success?(is-true(success?(1-proj-2-tuple(v_668))))) then dhexp(2-proj-2-tuple(v_668),4-proj-7-tuple(v_665)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_669))) then (if not-caught-fail(v_670) then (if not-caught-fail(v_671) then (if not-caught-fail(v_672) then (v_670,v_671,v_672) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {288}let v_674: symmetricstate = catch-fail((if (success?((if (success?(4-proj-7-tuple(v_665)) && success?(3-proj-7-tuple(v_665))) then (if (not-caught-fail(v_668) && success?(is-true(success?(1-proj-2-tuple(v_668))))) then dhexp(2-proj-2-tuple(v_668),4-proj-7-tuple(v_665)) else fail-any) else fail-any)) && success?(1-proj-7-tuple(v_665))) then (if (not-caught-fail(v_669) && success?(is-true(success?(1-proj-3-tuple(v_669))))) then (if (not-caught-fail(v_673) && success?(is-true(success?(1-proj-3-tuple(v_673))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_673)) then cipherstatepack(2-proj-3-tuple(v_673),minnonce) else fail-any),1-proj-3-tuple(v_673),3-proj-3-tuple(v_669)) else fail-any) else fail-any) else fail-any)) in
        {289}let v_675: bitstring = catch-fail(symmetricstateunpack(v_674)) in
        {290}let v_676: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_675))) in
        {291}let v_677: aead = catch-fail(decrypt(1-proj-2-tuple(v_676),2-proj-2-tuple(v_676),3-proj-3-tuple(v_675),3-proj-3-tuple(v_666))) in
        {292}let v_678: bitstring = catch-fail(aeadunpack(v_677)) in
        {293}let v_679: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_675))) in
        {294}let v_680: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_676))) && success?(1-proj-3-tuple(v_675))) then (if (not-caught-fail(v_679) && success?(is-true(success?(1-proj-2-tuple(v_679))))) then cipherstatepack(1-proj-2-tuple(v_679),increment_nonce(2-proj-2-tuple(v_676))) else fail-any) else fail-any)) in
        {295}let v_681: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_666)) && (success?(3-proj-3-tuple(v_675)) && success?(1-proj-3-tuple(v_675)))) then (if (not-caught-fail(v_676) && success?(is-true(success?(1-proj-2-tuple(v_676))))) then (if not-caught-fail(v_677) then (if (not-caught-fail(v_678) && success?(is-true(success?(1-proj-3-tuple(v_678))))) then (if not-caught-fail(v_680) then (v_680,3-proj-3-tuple(v_678),1-proj-3-tuple(v_678)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {296}let v_682: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_681),2-proj-3-tuple(v_675),3-proj-3-tuple(v_675)))) in
        {297}let v_683: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_666)) && success?(symmetricstatepack(1-proj-3-tuple(v_681),2-proj-3-tuple(v_675),3-proj-3-tuple(v_675)))) then (if (not-caught-fail(v_682) && success?(is-true(success?(1-proj-3-tuple(v_682))))) then symmetricstatepack(1-proj-3-tuple(v_682),2-proj-3-tuple(v_682),hash(3-proj-3-tuple(v_682),3-proj-3-tuple(v_666))) else fail-any) else fail-any)) in
        {298}let v_684: bitstring = catch-fail((if success?(3-proj-3-tuple(v_666)) then (if (not-caught-fail(v_675) && success?(is-true(success?(1-proj-3-tuple(v_675))))) then (if (not-caught-fail(v_681) && success?(is-true(success?(1-proj-3-tuple(v_681))))) then (if not-caught-fail(v_683) then (v_683,2-proj-3-tuple(v_681),3-proj-3-tuple(v_681)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {299}let v_685: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_684),2-proj-7-tuple(v_665),3-proj-7-tuple(v_665),4-proj-7-tuple(v_665),5-proj-7-tuple(v_665),6-proj-7-tuple(v_665),7-proj-7-tuple(v_665))) in
        {300}let v_686: bitstring = catch-fail(symmetricstateunpack(1-proj-3-tuple(v_684))) in
        {301}let v_687: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_686),zero)) in
        {302}let v_688: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_686),zero)) in
        {303}let v_689: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_686),zero)) in
        {304}let v_690: bitstring = catch-fail((if success?(2-proj-3-tuple(v_686)) then (if not-caught-fail(v_687) then (if not-caught-fail(v_688) then (if not-caught-fail(v_689) then (v_687,v_688,v_689) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {305}let v_691: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_690)) then cipherstatepack(1-proj-3-tuple(v_690),minnonce) else fail-any)) in
        {306}let v_692: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_690)) then cipherstatepack(2-proj-3-tuple(v_690),minnonce) else fail-any)) in
        {307}let v_693: bitstring = catch-fail((if success?(1-proj-3-tuple(v_684)) then (if (not-caught-fail(v_686) && success?(is-true(success?(1-proj-3-tuple(v_686))))) then (if (not-caught-fail(v_690) && success?(is-true(success?(1-proj-3-tuple(v_690))))) then (if not-caught-fail(v_691) then (if not-caught-fail(v_692) then (1-proj-3-tuple(v_684),v_691,v_692) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {308}let (hs_694: handshakestate,re_695: key,plaintext_c: bitstring,valid_696: bool,cs1_697: cipherstate,cs2_698: cipherstate) = (if (not-caught-fail(v_665) && success?(is-true(success?(1-proj-7-tuple(v_665))))) then (if (not-caught-fail(v_666) && success?(is-true(success?(1-proj-3-tuple(v_666))))) then (if not-caught-fail(v_667) then (if not-caught-fail(v_674) then (if (not-caught-fail(v_684) && success?(is-true(success?(1-proj-3-tuple(v_684))))) then (if (v_667 && 3-proj-3-tuple(v_684)) then (if not-caught-fail(v_685) then (if (not-caught-fail(v_693) && success?(is-true(success?(1-proj-3-tuple(v_693))))) then (v_685,getpublickey(3-proj-7-tuple(v_665)),2-proj-3-tuple(v_684),true,2-proj-3-tuple(v_693),3-proj-3-tuple(v_693)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {309}event RecvMsg(bob,alice,stage_c,plaintext_c,valid_696);
        {310}insert statestore(bob,alice,statepack_d(hs_694));
        {311}event RecvEnd(valid_696)
    ) | (
        {313}event LeakS(phase0,bob);
        {314}out(pub, key_s(bob))
    ) | (
        {315}phase 1;
        {316}event LeakS(phase1,bob);
        {317}out(pub, key_s(bob))
    )
) | (
    {318}let s_699: keypair = keypairpack(empty,empty) in
    (
        {319}let e_700: keypair = keypairpack(empty,empty) in
        {320}let v_701: key = catch-fail(dhexp(key_s(charlie),g)) in
        {321}let rs_702: key = getpublickey((if not-caught-fail(v_701) then keypairpack(v_701,key_s(charlie)) else fail-any)) in
        {322}let re_703: key = empty in
        {323}let v_704: bitstring = catch-fail(hash(somename,empty)) in
        {324}let v_705: key = catch-fail(v_704) in
        {325}let v_706: cipherstate = catch-fail(cipherstatepack(empty,minnonce)) in
        {326}let v_707: bitstring = catch-fail(symmetricstateunpack((if not-caught-fail(v_704) then (if not-caught-fail(v_705) then (if not-caught-fail(v_706) then symmetricstatepack(v_706,v_705,v_704) else fail-any) else fail-any) else fail-any))) in
        {327}let v_708: symmetricstate = catch-fail((if success?((if not-caught-fail(v_704) then (if not-caught-fail(v_705) then (if not-caught-fail(v_706) then symmetricstatepack(v_706,v_705,v_704) else fail-any) else fail-any) else fail-any)) then (if (not-caught-fail(v_707) && success?(is-true(success?(1-proj-3-tuple(v_707))))) then symmetricstatepack(1-proj-3-tuple(v_707),2-proj-3-tuple(v_707),hash(3-proj-3-tuple(v_707),empty)) else fail-any) else fail-any)) in
        {328}let v_709: bitstring = catch-fail(symmetricstateunpack(v_708)) in
        {329}let v_710: symmetricstate = catch-fail((if (not-caught-fail(v_709) && success?(is-true(success?(1-proj-3-tuple(v_709))))) then symmetricstatepack(1-proj-3-tuple(v_709),2-proj-3-tuple(v_709),hash(3-proj-3-tuple(v_709),rs_702)) else fail-any)) in
        {330}let hs_711: handshakestate = (if not-caught-fail(v_708) then (if not-caught-fail(v_710) then handshakestatepack(v_710,s_699,e_700,rs_702,re_703,empty,false) else fail-any) else fail-any) in
        {331}insert statestore(bob,charlie,statepack_a(hs_711))
    ) | (
        {353}get statestore(=bob,=charlie,statepack_a(hs_712: handshakestate)) in
        {332}in(pub, message_a_713: bitstring);
        {333}let v_714: bitstring = catch-fail(handshakestateunpack(hs_712)) in
        {334}let v_715: bitstring = catch-fail(deconcat3(message_a_713)) in
        {335}let v_716: bool = catch-fail(true) in
        {336}let v_717: key = catch-fail(1-proj-3-tuple(v_715)) in
        {337}let v_718: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_714))) in
        {338}let v_719: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_714)) then (if (not-caught-fail(v_718) && success?(is-true(success?(1-proj-3-tuple(v_718))))) then symmetricstatepack(1-proj-3-tuple(v_718),2-proj-3-tuple(v_718),hash(3-proj-3-tuple(v_718),v_717)) else fail-any) else fail-any)) in
        {339}let v_720: bitstring = catch-fail(symmetricstateunpack(v_719)) in
        {340}let v_721: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_720))) in
        {341}let v_722: aead = catch-fail(decrypt(1-proj-2-tuple(v_721),2-proj-2-tuple(v_721),3-proj-3-tuple(v_720),3-proj-3-tuple(v_715))) in
        {342}let v_723: bitstring = catch-fail(aeadunpack(v_722)) in
        {343}let v_724: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_720))) in
        {344}let v_725: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_721))) && success?(1-proj-3-tuple(v_720))) then (if (not-caught-fail(v_724) && success?(is-true(success?(1-proj-2-tuple(v_724))))) then cipherstatepack(1-proj-2-tuple(v_724),increment_nonce(2-proj-2-tuple(v_721))) else fail-any) else fail-any)) in
        {345}let v_726: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_715)) && (success?(3-proj-3-tuple(v_720)) && success?(1-proj-3-tuple(v_720)))) then (if (not-caught-fail(v_721) && success?(is-true(success?(1-proj-2-tuple(v_721))))) then (if not-caught-fail(v_722) then (if (not-caught-fail(v_723) && success?(is-true(success?(1-proj-3-tuple(v_723))))) then (if not-caught-fail(v_725) then (v_725,3-proj-3-tuple(v_723),1-proj-3-tuple(v_723)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {346}let v_727: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_726),2-proj-3-tuple(v_720),3-proj-3-tuple(v_720)))) in
        {347}let v_728: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_715)) && success?(symmetricstatepack(1-proj-3-tuple(v_726),2-proj-3-tuple(v_720),3-proj-3-tuple(v_720)))) then (if (not-caught-fail(v_727) && success?(is-true(success?(1-proj-3-tuple(v_727))))) then symmetricstatepack(1-proj-3-tuple(v_727),2-proj-3-tuple(v_727),hash(3-proj-3-tuple(v_727),3-proj-3-tuple(v_715))) else fail-any) else fail-any)) in
        {348}let v_729: bitstring = catch-fail((if success?(3-proj-3-tuple(v_715)) then (if (not-caught-fail(v_720) && success?(is-true(success?(1-proj-3-tuple(v_720))))) then (if (not-caught-fail(v_726) && success?(is-true(success?(1-proj-3-tuple(v_726))))) then (if not-caught-fail(v_728) then (v_728,2-proj-3-tuple(v_726),3-proj-3-tuple(v_726)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {349}let v_730: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_729),2-proj-7-tuple(v_714),3-proj-7-tuple(v_714),4-proj-7-tuple(v_714),v_717,6-proj-7-tuple(v_714),7-proj-7-tuple(v_714))) in
        {350}let (hs_731: handshakestate,re_732: key,plaintext_a_733: bitstring,valid_734: bool) = (if (not-caught-fail(v_714) && success?(is-true(success?(1-proj-7-tuple(v_714))))) then (if (not-caught-fail(v_715) && success?(is-true(success?(1-proj-3-tuple(v_715))))) then (if not-caught-fail(v_716) then (if not-caught-fail(v_717) then (if not-caught-fail(v_719) then (if (not-caught-fail(v_729) && success?(is-true(success?(1-proj-3-tuple(v_729))))) then (if (v_716 && 3-proj-3-tuple(v_729)) then (if not-caught-fail(v_730) then (v_730,getpublickey(3-proj-7-tuple(v_714)),2-proj-3-tuple(v_729),true) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {351}event RecvMsg(bob,charlie,stage_a,plaintext_a_733,valid_734);
        {352}insert statestore(bob,charlie,statepack_b(hs_731))
    ) | (
        {383}get statestore(=bob,=charlie,statepack_b(hs_735: handshakestate)) in
        {354}let v_736: bitstring = catch-fail(handshakestateunpack(hs_735)) in
        {355}let v_737: bitstring = catch-fail((empty,empty,empty)) in
        {356}let v_738: key = catch-fail(dhexp(key_e(bob,charlie),g)) in
        {357}let v_739: keypair = catch-fail((if not-caught-fail(v_738) then keypairpack(v_738,key_e(bob,charlie)) else fail-any)) in
        {358}let v_740: bitstring = catch-fail(getpublickey(v_739)) in
        {359}let v_741: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_736))) in
        {360}let v_742: symmetricstate = catch-fail((if success?(1-proj-7-tuple(v_736)) then (if (not-caught-fail(v_741) && success?(is-true(success?(1-proj-3-tuple(v_741))))) then symmetricstatepack(1-proj-3-tuple(v_741),2-proj-3-tuple(v_741),hash(3-proj-3-tuple(v_741),v_740)) else fail-any) else fail-any)) in
        {361}let v_743: bitstring = catch-fail(keypairunpack(v_739)) in
        {362}let v_744: bitstring = catch-fail(symmetricstateunpack(v_742)) in
        {363}let v_745: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_744),(if success?(5-proj-7-tuple(v_736)) then (if (not-caught-fail(v_743) && success?(is-true(success?(1-proj-2-tuple(v_743))))) then dhexp(2-proj-2-tuple(v_743),5-proj-7-tuple(v_736)) else fail-any) else fail-any))) in
        {364}let v_746: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_744),(if success?(5-proj-7-tuple(v_736)) then (if (not-caught-fail(v_743) && success?(is-true(success?(1-proj-2-tuple(v_743))))) then dhexp(2-proj-2-tuple(v_743),5-proj-7-tuple(v_736)) else fail-any) else fail-any))) in
        {365}let v_747: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_744),(if success?(5-proj-7-tuple(v_736)) then (if (not-caught-fail(v_743) && success?(is-true(success?(1-proj-2-tuple(v_743))))) then dhexp(2-proj-2-tuple(v_743),5-proj-7-tuple(v_736)) else fail-any) else fail-any))) in
        {366}let v_748: bitstring = catch-fail((if (success?((if success?(5-proj-7-tuple(v_736)) then (if (not-caught-fail(v_743) && success?(is-true(success?(1-proj-2-tuple(v_743))))) then dhexp(2-proj-2-tuple(v_743),5-proj-7-tuple(v_736)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_744))) then (if not-caught-fail(v_745) then (if not-caught-fail(v_746) then (if not-caught-fail(v_747) then (v_745,v_746,v_747) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {367}let v_749: symmetricstate = catch-fail((if success?((if success?(5-proj-7-tuple(v_736)) then (if (not-caught-fail(v_743) && success?(is-true(success?(1-proj-2-tuple(v_743))))) then dhexp(2-proj-2-tuple(v_743),5-proj-7-tuple(v_736)) else fail-any) else fail-any)) then (if (not-caught-fail(v_744) && success?(is-true(success?(1-proj-3-tuple(v_744))))) then (if (not-caught-fail(v_748) && success?(is-true(success?(1-proj-3-tuple(v_748))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_748)) then cipherstatepack(2-proj-3-tuple(v_748),minnonce) else fail-any),1-proj-3-tuple(v_748),3-proj-3-tuple(v_744)) else fail-any) else fail-any) else fail-any)) in
        {368}let v_750: bitstring = catch-fail(symmetricstateunpack(v_749)) in
        {369}let v_751: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_750))) in
        {370}let v_752: bitstring = catch-fail(encrypt(1-proj-2-tuple(v_751),2-proj-2-tuple(v_751),3-proj-3-tuple(v_750),msg_b(bob,charlie))) in
        {371}let v_753: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_750))) in
        {372}let v_754: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_751))) && success?(1-proj-3-tuple(v_750))) then (if (not-caught-fail(v_753) && success?(is-true(success?(1-proj-2-tuple(v_753))))) then cipherstatepack(1-proj-2-tuple(v_753),increment_nonce(2-proj-2-tuple(v_751))) else fail-any) else fail-any)) in
        {373}let v_755: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_750)) && success?(1-proj-3-tuple(v_750))) then (if (not-caught-fail(v_751) && success?(is-true(success?(1-proj-2-tuple(v_751))))) then (if not-caught-fail(v_752) then (if not-caught-fail(v_754) then (v_754,v_752) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {374}let v_756: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-2-tuple(v_755),2-proj-3-tuple(v_750),3-proj-3-tuple(v_750)))) in
        {375}let v_757: symmetricstate = catch-fail((if (success?(2-proj-2-tuple(v_755)) && success?(symmetricstatepack(1-proj-2-tuple(v_755),2-proj-3-tuple(v_750),3-proj-3-tuple(v_750)))) then (if (not-caught-fail(v_756) && success?(is-true(success?(1-proj-3-tuple(v_756))))) then symmetricstatepack(1-proj-3-tuple(v_756),2-proj-3-tuple(v_756),hash(3-proj-3-tuple(v_756),2-proj-2-tuple(v_755))) else fail-any) else fail-any)) in
        {376}let v_758: bitstring = catch-fail((if (not-caught-fail(v_750) && success?(is-true(success?(1-proj-3-tuple(v_750))))) then (if (not-caught-fail(v_755) && success?(is-true(success?(1-proj-2-tuple(v_755))))) then (if not-caught-fail(v_757) then (v_757,2-proj-2-tuple(v_755)) else fail-any) else fail-any) else fail-any)) in
        {377}let v_759: handshakestate = catch-fail(handshakestatepack(1-proj-2-tuple(v_758),2-proj-7-tuple(v_736),v_739,4-proj-7-tuple(v_736),5-proj-7-tuple(v_736),6-proj-7-tuple(v_736),7-proj-7-tuple(v_736))) in
        {378}let v_760: bitstring = catch-fail(concat3(v_740,2-proj-3-tuple(v_737),2-proj-2-tuple(v_758))) in
        {379}let (hs_761: handshakestate,re_762: key,message_b_763: bitstring) = (if (not-caught-fail(v_736) && success?(is-true(success?(1-proj-7-tuple(v_736))))) then (if (not-caught-fail(v_737) && success?(is-true(success?(1-proj-3-tuple(v_737))))) then (if not-caught-fail(v_739) then (if not-caught-fail(v_740) then (if not-caught-fail(v_742) then (if not-caught-fail(v_749) then (if (not-caught-fail(v_758) && success?(is-true(success?(1-proj-2-tuple(v_758))))) then (if not-caught-fail(v_759) then (if not-caught-fail(v_760) then (v_759,5-proj-7-tuple(v_736),v_760) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {380}event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true);
        {381}insert statestore(bob,charlie,statepack_c(hs_761));
        {382}out(pub, message_b_763)
    ) | (
        {418}get statestore(=bob,=charlie,statepack_c(hs_764: handshakestate)) in
        {384}in(pub, message_c_765: bitstring);
        {385}let v_766: bitstring = catch-fail(handshakestateunpack(hs_764)) in
        {386}let v_767: bitstring = catch-fail(deconcat3(message_c_765)) in
        {387}let v_768: bool = catch-fail(true) in
        {388}let v_769: bitstring = catch-fail(keypairunpack(3-proj-7-tuple(v_766))) in
        {389}let v_770: bitstring = catch-fail(symmetricstateunpack(1-proj-7-tuple(v_766))) in
        {390}let v_771: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_770),(if (success?(4-proj-7-tuple(v_766)) && success?(3-proj-7-tuple(v_766))) then (if (not-caught-fail(v_769) && success?(is-true(success?(1-proj-2-tuple(v_769))))) then dhexp(2-proj-2-tuple(v_769),4-proj-7-tuple(v_766)) else fail-any) else fail-any))) in
        {391}let v_772: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_770),(if (success?(4-proj-7-tuple(v_766)) && success?(3-proj-7-tuple(v_766))) then (if (not-caught-fail(v_769) && success?(is-true(success?(1-proj-2-tuple(v_769))))) then dhexp(2-proj-2-tuple(v_769),4-proj-7-tuple(v_766)) else fail-any) else fail-any))) in
        {392}let v_773: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_770),(if (success?(4-proj-7-tuple(v_766)) && success?(3-proj-7-tuple(v_766))) then (if (not-caught-fail(v_769) && success?(is-true(success?(1-proj-2-tuple(v_769))))) then dhexp(2-proj-2-tuple(v_769),4-proj-7-tuple(v_766)) else fail-any) else fail-any))) in
        {393}let v_774: bitstring = catch-fail((if (success?((if (success?(4-proj-7-tuple(v_766)) && success?(3-proj-7-tuple(v_766))) then (if (not-caught-fail(v_769) && success?(is-true(success?(1-proj-2-tuple(v_769))))) then dhexp(2-proj-2-tuple(v_769),4-proj-7-tuple(v_766)) else fail-any) else fail-any)) && success?(2-proj-3-tuple(v_770))) then (if not-caught-fail(v_771) then (if not-caught-fail(v_772) then (if not-caught-fail(v_773) then (v_771,v_772,v_773) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {394}let v_775: symmetricstate = catch-fail((if (success?((if (success?(4-proj-7-tuple(v_766)) && success?(3-proj-7-tuple(v_766))) then (if (not-caught-fail(v_769) && success?(is-true(success?(1-proj-2-tuple(v_769))))) then dhexp(2-proj-2-tuple(v_769),4-proj-7-tuple(v_766)) else fail-any) else fail-any)) && success?(1-proj-7-tuple(v_766))) then (if (not-caught-fail(v_770) && success?(is-true(success?(1-proj-3-tuple(v_770))))) then (if (not-caught-fail(v_774) && success?(is-true(success?(1-proj-3-tuple(v_774))))) then symmetricstatepack((if success?(2-proj-3-tuple(v_774)) then cipherstatepack(2-proj-3-tuple(v_774),minnonce) else fail-any),1-proj-3-tuple(v_774),3-proj-3-tuple(v_770)) else fail-any) else fail-any) else fail-any)) in
        {395}let v_776: bitstring = catch-fail(symmetricstateunpack(v_775)) in
        {396}let v_777: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_776))) in
        {397}let v_778: aead = catch-fail(decrypt(1-proj-2-tuple(v_777),2-proj-2-tuple(v_777),3-proj-3-tuple(v_776),3-proj-3-tuple(v_767))) in
        {398}let v_779: bitstring = catch-fail(aeadunpack(v_778)) in
        {399}let v_780: bitstring = catch-fail(cipherstateunpack(1-proj-3-tuple(v_776))) in
        {400}let v_781: cipherstate = catch-fail((if (success?(increment_nonce(2-proj-2-tuple(v_777))) && success?(1-proj-3-tuple(v_776))) then (if (not-caught-fail(v_780) && success?(is-true(success?(1-proj-2-tuple(v_780))))) then cipherstatepack(1-proj-2-tuple(v_780),increment_nonce(2-proj-2-tuple(v_777))) else fail-any) else fail-any)) in
        {401}let v_782: bitstring = catch-fail((if (success?(3-proj-3-tuple(v_767)) && (success?(3-proj-3-tuple(v_776)) && success?(1-proj-3-tuple(v_776)))) then (if (not-caught-fail(v_777) && success?(is-true(success?(1-proj-2-tuple(v_777))))) then (if not-caught-fail(v_778) then (if (not-caught-fail(v_779) && success?(is-true(success?(1-proj-3-tuple(v_779))))) then (if not-caught-fail(v_781) then (v_781,3-proj-3-tuple(v_779),1-proj-3-tuple(v_779)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {402}let v_783: bitstring = catch-fail(symmetricstateunpack(symmetricstatepack(1-proj-3-tuple(v_782),2-proj-3-tuple(v_776),3-proj-3-tuple(v_776)))) in
        {403}let v_784: symmetricstate = catch-fail((if (success?(3-proj-3-tuple(v_767)) && success?(symmetricstatepack(1-proj-3-tuple(v_782),2-proj-3-tuple(v_776),3-proj-3-tuple(v_776)))) then (if (not-caught-fail(v_783) && success?(is-true(success?(1-proj-3-tuple(v_783))))) then symmetricstatepack(1-proj-3-tuple(v_783),2-proj-3-tuple(v_783),hash(3-proj-3-tuple(v_783),3-proj-3-tuple(v_767))) else fail-any) else fail-any)) in
        {404}let v_785: bitstring = catch-fail((if success?(3-proj-3-tuple(v_767)) then (if (not-caught-fail(v_776) && success?(is-true(success?(1-proj-3-tuple(v_776))))) then (if (not-caught-fail(v_782) && success?(is-true(success?(1-proj-3-tuple(v_782))))) then (if not-caught-fail(v_784) then (v_784,2-proj-3-tuple(v_782),3-proj-3-tuple(v_782)) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {405}let v_786: handshakestate = catch-fail(handshakestatepack(1-proj-3-tuple(v_785),2-proj-7-tuple(v_766),3-proj-7-tuple(v_766),4-proj-7-tuple(v_766),5-proj-7-tuple(v_766),6-proj-7-tuple(v_766),7-proj-7-tuple(v_766))) in
        {406}let v_787: bitstring = catch-fail(symmetricstateunpack(1-proj-3-tuple(v_785))) in
        {407}let v_788: key = catch-fail(hmac_hash1(2-proj-3-tuple(v_787),zero)) in
        {408}let v_789: key = catch-fail(hmac_hash2(2-proj-3-tuple(v_787),zero)) in
        {409}let v_790: key = catch-fail(hmac_hash3(2-proj-3-tuple(v_787),zero)) in
        {410}let v_791: bitstring = catch-fail((if success?(2-proj-3-tuple(v_787)) then (if not-caught-fail(v_788) then (if not-caught-fail(v_789) then (if not-caught-fail(v_790) then (v_788,v_789,v_790) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {411}let v_792: cipherstate = catch-fail((if success?(1-proj-3-tuple(v_791)) then cipherstatepack(1-proj-3-tuple(v_791),minnonce) else fail-any)) in
        {412}let v_793: cipherstate = catch-fail((if success?(2-proj-3-tuple(v_791)) then cipherstatepack(2-proj-3-tuple(v_791),minnonce) else fail-any)) in
        {413}let v_794: bitstring = catch-fail((if success?(1-proj-3-tuple(v_785)) then (if (not-caught-fail(v_787) && success?(is-true(success?(1-proj-3-tuple(v_787))))) then (if (not-caught-fail(v_791) && success?(is-true(success?(1-proj-3-tuple(v_791))))) then (if not-caught-fail(v_792) then (if not-caught-fail(v_793) then (1-proj-3-tuple(v_785),v_792,v_793) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) in
        {414}let (hs_795: handshakestate,re_796: key,plaintext_c_797: bitstring,valid_798: bool,cs1_799: cipherstate,cs2_800: cipherstate) = (if (not-caught-fail(v_766) && success?(is-true(success?(1-proj-7-tuple(v_766))))) then (if (not-caught-fail(v_767) && success?(is-true(success?(1-proj-3-tuple(v_767))))) then (if not-caught-fail(v_768) then (if not-caught-fail(v_775) then (if (not-caught-fail(v_785) && success?(is-true(success?(1-proj-3-tuple(v_785))))) then (if (v_768 && 3-proj-3-tuple(v_785)) then (if not-caught-fail(v_786) then (if (not-caught-fail(v_794) && success?(is-true(success?(1-proj-3-tuple(v_794))))) then (v_786,getpublickey(3-proj-7-tuple(v_766)),2-proj-3-tuple(v_785),true,2-proj-3-tuple(v_794),3-proj-3-tuple(v_794)) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
        {415}event RecvMsg(bob,charlie,stage_c,plaintext_c_797,valid_798);
        {416}insert statestore(bob,charlie,statepack_d(hs_795));
        {417}event RecvEnd(valid_798)
    ) | (
        {419}event LeakS(phase0,bob);
        {420}out(pub, key_s(bob))
    ) | (
        {421}phase 1;
        {422}event LeakS(phase1,bob);
        {423}out(pub, key_s(bob))
    )
) | (
    {424}out(pub, (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)))
)

-- Query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)); not attacker_p1(msg_a(alice,bob)); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))); attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)); event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)); not attacker_p1(msg_b(bob,alice)); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice)); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob))); attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)); event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)); not attacker_p1(msg_c(alice,bob)); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))); attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)); not event(RecvEnd(true))
Completing...
200 rules inserted. The rule base contains 200 rules. 155 rules in the queue.
400 rules inserted. The rule base contains 388 rules. 34 rules in the queue.
600 rules inserted. The rule base contains 568 rules. 104 rules in the queue.
800 rules inserted. The rule base contains 765 rules. 179 rules in the queue.
1000 rules inserted. The rule base contains 899 rules. 140 rules in the queue.
1200 rules inserted. The rule base contains 1044 rules. 145 rules in the queue.
1400 rules inserted. The rule base contains 1170 rules. 161 rules in the queue.
1600 rules inserted. The rule base contains 1230 rules. 305 rules in the queue.
1800 rules inserted. The rule base contains 1426 rules. 279 rules in the queue.
2000 rules inserted. The rule base contains 1578 rules. 412 rules in the queue.
2200 rules inserted. The rule base contains 1772 rules. 433 rules in the queue.
2400 rules inserted. The rule base contains 1940 rules. 435 rules in the queue.
2600 rules inserted. The rule base contains 2131 rules. 423 rules in the queue.
2800 rules inserted. The rule base contains 2302 rules. 495 rules in the queue.
3000 rules inserted. The rule base contains 2422 rules. 498 rules in the queue.
3200 rules inserted. The rule base contains 2577 rules. 532 rules in the queue.
3400 rules inserted. The rule base contains 2713 rules. 520 rules in the queue.
3600 rules inserted. The rule base contains 2835 rules. 524 rules in the queue.
3800 rules inserted. The rule base contains 2918 rules. 510 rules in the queue.
4000 rules inserted. The rule base contains 3088 rules. 509 rules in the queue.
4200 rules inserted. The rule base contains 3242 rules. 491 rules in the queue.
4400 rules inserted. The rule base contains 3368 rules. 481 rules in the queue.
4600 rules inserted. The rule base contains 3523 rules. 480 rules in the queue.
4800 rules inserted. The rule base contains 3623 rules. 500 rules in the queue.
5000 rules inserted. The rule base contains 3737 rules. 508 rules in the queue.
5200 rules inserted. The rule base contains 3882 rules. 543 rules in the queue.
5400 rules inserted. The rule base contains 4027 rules. 544 rules in the queue.
5600 rules inserted. The rule base contains 4122 rules. 562 rules in the queue.
5800 rules inserted. The rule base contains 4308 rules. 532 rules in the queue.
6000 rules inserted. The rule base contains 4443 rules. 494 rules in the queue.
6200 rules inserted. The rule base contains 4640 rules. 482 rules in the queue.
6400 rules inserted. The rule base contains 4783 rules. 455 rules in the queue.
6600 rules inserted. The rule base contains 4925 rules. 471 rules in the queue.
6800 rules inserted. The rule base contains 5065 rules. 491 rules in the queue.
7000 rules inserted. The rule base contains 5148 rules. 479 rules in the queue.
7200 rules inserted. The rule base contains 5264 rules. 433 rules in the queue.
7400 rules inserted. The rule base contains 5288 rules. 411 rules in the queue.
7600 rules inserted. The rule base contains 5301 rules. 381 rules in the queue.
7800 rules inserted. The rule base contains 5222 rules. 354 rules in the queue.
8000 rules inserted. The rule base contains 5232 rules. 424 rules in the queue.
8200 rules inserted. The rule base contains 5301 rules. 412 rules in the queue.
8400 rules inserted. The rule base contains 5450 rules. 408 rules in the queue.
8600 rules inserted. The rule base contains 5355 rules. 387 rules in the queue.
8800 rules inserted. The rule base contains 5476 rules. 436 rules in the queue.
9000 rules inserted. The rule base contains 5181 rules. 403 rules in the queue.
9200 rules inserted. The rule base contains 5342 rules. 391 rules in the queue.
9400 rules inserted. The rule base contains 5370 rules. 351 rules in the queue.
9600 rules inserted. The rule base contains 5433 rules. 321 rules in the queue.
9800 rules inserted. The rule base contains 5421 rules. 271 rules in the queue.
10000 rules inserted. The rule base contains 5335 rules. 220 rules in the queue.
10200 rules inserted. The rule base contains 5173 rules. 95 rules in the queue.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true))
goal reachable: attacker(m_33654422) -> end(RecvMsg(bob,alice,stage_a,m_33654422,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_33654460).

3. The attacker has some term a_33654445.
attacker(a_33654445).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 3, the attacker may know a_33654445.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445).
By 2, the attacker may know m_33654460.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445),m_33654460).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445),m_33654460)).

15. The attacker has some term b_33654446.
attacker(b_33654446).

16. By 3, the attacker may know a_33654445.
By 15, the attacker may know b_33654446.
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445),m_33654460).
Using the function concat3 the attacker may obtain concat3(a_33654445,b_33654446,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445),m_33654460)).
attacker(concat3(a_33654445,b_33654446,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445),m_33654460))).

17. By 4, the attacker may have the channel pub.
By 16, the attacker may have the message concat3(a_33654445,b_33654446,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445),m_33654460)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_33654445,b_33654446,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445),m_33654460))).

18. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {247}.
The message concat3(a_33654445,b_33654446,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654445),m_33654460)) that may be sent on channel pub by 17 may be received at input {226}.
We have a_33654445 <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_33654460,true) may be executed at {245}.
end(RecvMsg(bob,alice,stage_a,m_33654460,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33655684,~M_33655685,~M_33655686)) with ~M_33655684 = key_s(charlie), ~M_33655685 = key_e(charlie,alice), ~M_33655686 = key_e(charlie,bob) at {424} in copy a_33654466

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33654466

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33654466

out(pub, ~M_33656387) with ~M_33656387 = dhexp(key_s(alice),g) at {109} in copy a_33654466

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33654466

out(pub, ~M_33656728) with ~M_33656728 = dhexp(key_s(alice),g) at {4} in copy a_33654466

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33654466

out(pub, (~M_33656869,~M_33656870,~M_33656871)) with ~M_33656869 = key_s(charlie), ~M_33656870 = key_e(charlie,alice), ~M_33656871 = key_e(charlie,bob) at {424} in copy a_33654465

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33654465

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33654465

out(pub, ~M_33657572) with ~M_33657572 = dhexp(key_s(alice),g) at {109} in copy a_33654465

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33654465

out(pub, ~M_33657913) with ~M_33657913 = dhexp(key_s(alice),g) at {4} in copy a_33654465

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33654465

out(pub, (~M_33658054,~M_33658055,~M_33658056)) with ~M_33658054 = key_s(charlie), ~M_33658055 = key_e(charlie,alice), ~M_33658056 = key_e(charlie,bob) at {424} in copy a_33654464

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33654464

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33654464

out(pub, ~M_33658757) with ~M_33658757 = dhexp(key_s(alice),g) at {109} in copy a_33654464

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33654464

out(pub, ~M_33659098) with ~M_33659098 = dhexp(key_s(alice),g) at {4} in copy a_33654464

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33654464

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33654466

in(pub, concat3(a_33654462,a_33654463,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33656387),a_33654462),a_33654461))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33656387),a_33654462),a_33654461) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33654462),a_33654461) at {226} in copy a_33654466

event RecvMsg(bob,alice,stage_a,a_33654461,true) at {245} in copy a_33654466 (goal)

The event RecvMsg(bob,alice,stage_a,a_33654461,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_33659877) -> end(RecvMsg(bob,alice,stage_a,m_33659877,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_33659916).

3. The attacker has some term a_33659901.
attacker(a_33659901).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 3, the attacker may know a_33659901.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901).
By 2, the attacker may know m_33659916.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901),m_33659916).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901),m_33659916)).

15. The attacker has some term b_33659902.
attacker(b_33659902).

16. By 3, the attacker may know a_33659901.
By 15, the attacker may know b_33659902.
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901),m_33659916).
Using the function concat3 the attacker may obtain concat3(a_33659901,b_33659902,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901),m_33659916)).
attacker(concat3(a_33659901,b_33659902,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901),m_33659916))).

17. By 4, the attacker may have the channel pub.
By 16, the attacker may have the message concat3(a_33659901,b_33659902,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901),m_33659916)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_33659901,b_33659902,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901),m_33659916))).

18. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {247}.
The message concat3(a_33659901,b_33659902,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659901),m_33659916)) that may be sent on channel pub by 17 may be received at input {226}.
We have a_33659901 <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_33659916,true) may be executed at {245}.
end(RecvMsg(bob,alice,stage_a,m_33659916,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33661144,~M_33661145,~M_33661146)) with ~M_33661144 = key_s(charlie), ~M_33661145 = key_e(charlie,alice), ~M_33661146 = key_e(charlie,bob) at {424} in copy a_33659922

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33659922

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33659922

out(pub, ~M_33661847) with ~M_33661847 = dhexp(key_s(alice),g) at {109} in copy a_33659922

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33659922

out(pub, ~M_33662188) with ~M_33662188 = dhexp(key_s(alice),g) at {4} in copy a_33659922

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33659922

out(pub, (~M_33662329,~M_33662330,~M_33662331)) with ~M_33662329 = key_s(charlie), ~M_33662330 = key_e(charlie,alice), ~M_33662331 = key_e(charlie,bob) at {424} in copy a_33659921

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33659921

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33659921

out(pub, ~M_33663032) with ~M_33663032 = dhexp(key_s(alice),g) at {109} in copy a_33659921

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33659921

out(pub, ~M_33663373) with ~M_33663373 = dhexp(key_s(alice),g) at {4} in copy a_33659921

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33659921

out(pub, (~M_33663514,~M_33663515,~M_33663516)) with ~M_33663514 = key_s(charlie), ~M_33663515 = key_e(charlie,alice), ~M_33663516 = key_e(charlie,bob) at {424} in copy a_33659920

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33659920

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33659920

out(pub, ~M_33664217) with ~M_33664217 = dhexp(key_s(alice),g) at {109} in copy a_33659920

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33659920

out(pub, ~M_33664558) with ~M_33664558 = dhexp(key_s(alice),g) at {4} in copy a_33659920

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33659920

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33659922

in(pub, concat3(a_33659918,a_33659919,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33661847),a_33659918),a_33659917))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33661847),a_33659918),a_33659917) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33659918),a_33659917) at {226} in copy a_33659922

event RecvMsg(bob,alice,stage_a,a_33659917,true) at {245} in copy a_33659922 (goal)

The event RecvMsg(bob,alice,stage_a,a_33659917,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_33665337) -> end(RecvMsg(bob,alice,stage_a,m_33665337,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_33665376).

3. The attacker has some term a_33665361.
attacker(a_33665361).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 3, the attacker may know a_33665361.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361).
By 2, the attacker may know m_33665376.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361),m_33665376).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361),m_33665376)).

15. The attacker has some term b_33665362.
attacker(b_33665362).

16. By 3, the attacker may know a_33665361.
By 15, the attacker may know b_33665362.
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361),m_33665376).
Using the function concat3 the attacker may obtain concat3(a_33665361,b_33665362,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361),m_33665376)).
attacker(concat3(a_33665361,b_33665362,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361),m_33665376))).

17. By 4, the attacker may have the channel pub.
By 16, the attacker may have the message concat3(a_33665361,b_33665362,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361),m_33665376)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_33665361,b_33665362,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361),m_33665376))).

18. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {247}.
The message concat3(a_33665361,b_33665362,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665361),m_33665376)) that may be sent on channel pub by 17 may be received at input {226}.
We have a_33665361 <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_33665376,true) may be executed at {245}.
end(RecvMsg(bob,alice,stage_a,m_33665376,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33666604,~M_33666605,~M_33666606)) with ~M_33666604 = key_s(charlie), ~M_33666605 = key_e(charlie,alice), ~M_33666606 = key_e(charlie,bob) at {424} in copy a_33665382

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33665382

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33665382

out(pub, ~M_33667307) with ~M_33667307 = dhexp(key_s(alice),g) at {109} in copy a_33665382

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33665382

out(pub, ~M_33667648) with ~M_33667648 = dhexp(key_s(alice),g) at {4} in copy a_33665382

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33665382

out(pub, (~M_33667789,~M_33667790,~M_33667791)) with ~M_33667789 = key_s(charlie), ~M_33667790 = key_e(charlie,alice), ~M_33667791 = key_e(charlie,bob) at {424} in copy a_33665381

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33665381

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33665381

out(pub, ~M_33668492) with ~M_33668492 = dhexp(key_s(alice),g) at {109} in copy a_33665381

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33665381

out(pub, ~M_33668833) with ~M_33668833 = dhexp(key_s(alice),g) at {4} in copy a_33665381

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33665381

out(pub, (~M_33668974,~M_33668975,~M_33668976)) with ~M_33668974 = key_s(charlie), ~M_33668975 = key_e(charlie,alice), ~M_33668976 = key_e(charlie,bob) at {424} in copy a_33665380

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33665380

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33665380

out(pub, ~M_33669677) with ~M_33669677 = dhexp(key_s(alice),g) at {109} in copy a_33665380

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33665380

out(pub, ~M_33670018) with ~M_33670018 = dhexp(key_s(alice),g) at {4} in copy a_33665380

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33665380

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33665382

in(pub, concat3(a_33665378,a_33665379,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33667307),a_33665378),a_33665377))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33667307),a_33665378),a_33665377) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33665378),a_33665377) at {226} in copy a_33665382

event RecvMsg(bob,alice,stage_a,a_33665377,true) at {245} in copy a_33665382 (goal)

The event RecvMsg(bob,alice,stage_a,a_33665377,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,c_881,stage_a,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_33670797) -> end(RecvMsg(bob,alice,stage_a,m_33670797,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_33670835).

3. The attacker has some term a_33670820.
attacker(a_33670820).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 3, the attacker may know a_33670820.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820).
By 2, the attacker may know m_33670835.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820),m_33670835).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820),m_33670835)).

15. The attacker has some term b_33670821.
attacker(b_33670821).

16. By 3, the attacker may know a_33670820.
By 15, the attacker may know b_33670821.
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820),m_33670835).
Using the function concat3 the attacker may obtain concat3(a_33670820,b_33670821,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820),m_33670835)).
attacker(concat3(a_33670820,b_33670821,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820),m_33670835))).

17. By 4, the attacker may have the channel pub.
By 16, the attacker may have the message concat3(a_33670820,b_33670821,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820),m_33670835)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_33670820,b_33670821,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820),m_33670835))).

18. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {247}.
The message concat3(a_33670820,b_33670821,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670820),m_33670835)) that may be sent on channel pub by 17 may be received at input {226}.
We have a_33670820 <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_33670835,true) may be executed at {245}.
end(RecvMsg(bob,alice,stage_a,m_33670835,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33672063,~M_33672064,~M_33672065)) with ~M_33672063 = key_s(charlie), ~M_33672064 = key_e(charlie,alice), ~M_33672065 = key_e(charlie,bob) at {424} in copy a_33670841

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33670841

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33670841

out(pub, ~M_33672766) with ~M_33672766 = dhexp(key_s(alice),g) at {109} in copy a_33670841

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33670841

out(pub, ~M_33673107) with ~M_33673107 = dhexp(key_s(alice),g) at {4} in copy a_33670841

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33670841

out(pub, (~M_33673248,~M_33673249,~M_33673250)) with ~M_33673248 = key_s(charlie), ~M_33673249 = key_e(charlie,alice), ~M_33673250 = key_e(charlie,bob) at {424} in copy a_33670840

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33670840

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33670840

out(pub, ~M_33673951) with ~M_33673951 = dhexp(key_s(alice),g) at {109} in copy a_33670840

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33670840

out(pub, ~M_33674292) with ~M_33674292 = dhexp(key_s(alice),g) at {4} in copy a_33670840

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33670840

out(pub, (~M_33674433,~M_33674434,~M_33674435)) with ~M_33674433 = key_s(charlie), ~M_33674434 = key_e(charlie,alice), ~M_33674435 = key_e(charlie,bob) at {424} in copy a_33670839

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33670839

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33670839

out(pub, ~M_33675136) with ~M_33675136 = dhexp(key_s(alice),g) at {109} in copy a_33670839

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33670839

out(pub, ~M_33675477) with ~M_33675477 = dhexp(key_s(alice),g) at {4} in copy a_33670839

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33670839

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33670841

in(pub, concat3(a_33670837,a_33670838,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33672766),a_33670837),a_33670836))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33672766),a_33670837),a_33670836) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33670837),a_33670836) at {226} in copy a_33670841

event RecvMsg(bob,alice,stage_a,a_33670836,true) at {245} in copy a_33670841 (goal)

The event RecvMsg(bob,alice,stage_a,a_33670836,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_33676256) -> end(RecvMsg(bob,alice,stage_a,m_33676256,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. We assume as hypothesis that
attacker(m_33676294).

3. The attacker has some term a_33676279.
attacker(a_33676279).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

6. By 4, the attacker may have the channel pub.
By 5, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 3, the attacker may know a_33676279.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279).
By 2, the attacker may know m_33676294.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279),m_33676294).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279),m_33676294)).

15. The attacker has some term b_33676280.
attacker(b_33676280).

16. By 3, the attacker may know a_33676279.
By 15, the attacker may know b_33676280.
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279),m_33676294).
Using the function concat3 the attacker may obtain concat3(a_33676279,b_33676280,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279),m_33676294)).
attacker(concat3(a_33676279,b_33676280,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279),m_33676294))).

17. By 4, the attacker may have the channel pub.
By 16, the attacker may have the message concat3(a_33676279,b_33676280,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279),m_33676294)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_33676279,b_33676280,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279),m_33676294))).

18. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {247}.
The message concat3(a_33676279,b_33676280,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676279),m_33676294)) that may be sent on channel pub by 17 may be received at input {226}.
We have a_33676279 <> caught-fail.
So event RecvMsg(bob,alice,stage_a,m_33676294,true) may be executed at {245}.
end(RecvMsg(bob,alice,stage_a,m_33676294,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33677522,~M_33677523,~M_33677524)) with ~M_33677522 = key_s(charlie), ~M_33677523 = key_e(charlie,alice), ~M_33677524 = key_e(charlie,bob) at {424} in copy a_33676300

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33676300

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33676300

out(pub, ~M_33678225) with ~M_33678225 = dhexp(key_s(alice),g) at {109} in copy a_33676300

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33676300

out(pub, ~M_33678566) with ~M_33678566 = dhexp(key_s(alice),g) at {4} in copy a_33676300

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33676300

out(pub, (~M_33678707,~M_33678708,~M_33678709)) with ~M_33678707 = key_s(charlie), ~M_33678708 = key_e(charlie,alice), ~M_33678709 = key_e(charlie,bob) at {424} in copy a_33676299

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33676299

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33676299

out(pub, ~M_33679410) with ~M_33679410 = dhexp(key_s(alice),g) at {109} in copy a_33676299

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33676299

out(pub, ~M_33679751) with ~M_33679751 = dhexp(key_s(alice),g) at {4} in copy a_33676299

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33676299

out(pub, (~M_33679892,~M_33679893,~M_33679894)) with ~M_33679892 = key_s(charlie), ~M_33679893 = key_e(charlie,alice), ~M_33679894 = key_e(charlie,bob) at {424} in copy a_33676298

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33676298

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33676298

out(pub, ~M_33680595) with ~M_33680595 = dhexp(key_s(alice),g) at {109} in copy a_33676298

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33676298

out(pub, ~M_33680936) with ~M_33680936 = dhexp(key_s(alice),g) at {4} in copy a_33676298

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33676298

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33676300

in(pub, concat3(a_33676296,a_33676297,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33678225),a_33676296),a_33676295))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33678225),a_33676296),a_33676295) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33676296),a_33676295) at {226} in copy a_33676300

event RecvMsg(bob,alice,stage_a,a_33676295,true) at {245} in copy a_33676300 (goal)

The event RecvMsg(bob,alice,stage_a,a_33676295,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_a,m,true)) ==> event(SendMsg(alice,bob,stage_a,m,true)) || event(LeakS(phase0,alice)) is false.
Starting query not attacker_p1(msg_a(alice,bob))
goal reachable: begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 1, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

15. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

16. By 9, the attacker may know empty.
By 15, the attacker may know minnonce.
By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 5, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

17. By 16, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob).
attacker(msg_a(alice,bob)).

18. By 17, the attacker may know msg_a(alice,bob).
So the attacker may know msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33683003,~M_33683004,~M_33683005)) with ~M_33683003 = key_s(charlie), ~M_33683004 = key_e(charlie,alice), ~M_33683005 = key_e(charlie,bob) at {424} in copy a_33681769

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33681769

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33681769

out(pub, ~M_33683706) with ~M_33683706 = dhexp(key_s(alice),g) at {109} in copy a_33681769

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33681769

out(pub, ~M_33684047) with ~M_33684047 = dhexp(key_s(alice),g) at {4} in copy a_33681769

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33681769

out(pub, (~M_33684188,~M_33684189,~M_33684190)) with ~M_33684188 = key_s(charlie), ~M_33684189 = key_e(charlie,alice), ~M_33684190 = key_e(charlie,bob) at {424} in copy a_33681768

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33681768

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33681768

out(pub, ~M_33684891) with ~M_33684891 = dhexp(key_s(alice),g) at {109} in copy a_33681768

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33681768

out(pub, ~M_33685232) with ~M_33685232 = dhexp(key_s(alice),g) at {4} in copy a_33681768

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33681768

out(pub, (~M_33685373,~M_33685374,~M_33685375)) with ~M_33685373 = key_s(charlie), ~M_33685374 = key_e(charlie,alice), ~M_33685375 = key_e(charlie,bob) at {424} in copy a_33681767

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33681767

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33681767

out(pub, ~M_33686076) with ~M_33686076 = dhexp(key_s(alice),g) at {109} in copy a_33681767

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33681767

out(pub, ~M_33686417) with ~M_33686417 = dhexp(key_s(alice),g) at {4} in copy a_33681767

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33681767

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33681769

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33681769

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33681769

out(pub, concat3(~M_33687115,empty,~M_33687117)) with ~M_33687115 = dhexp(key_e(alice,bob),g), ~M_33687117 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33681769

The attacker has the message 3-proj-aeadpack(decrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33683706),~M_33687115),~M_33687117)) = msg_a(alice,bob) in phase 1.
A trace has been found.
RESULT not attacker_p1(msg_a(alice,bob)) is false.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob))
goal reachable: begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 1, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

15. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

16. By 9, the attacker may know empty.
By 15, the attacker may know minnonce.
By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 5, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

17. By 16, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob).
attacker(msg_a(alice,bob)).

18. By 17, the attacker may know msg_a(alice,bob).
So the attacker may know msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33688407,~M_33688408,~M_33688409)) with ~M_33688407 = key_s(charlie), ~M_33688408 = key_e(charlie,alice), ~M_33688409 = key_e(charlie,bob) at {424} in copy a_33687173

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33687173

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33687173

out(pub, ~M_33689110) with ~M_33689110 = dhexp(key_s(alice),g) at {109} in copy a_33687173

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33687173

out(pub, ~M_33689451) with ~M_33689451 = dhexp(key_s(alice),g) at {4} in copy a_33687173

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33687173

out(pub, (~M_33689592,~M_33689593,~M_33689594)) with ~M_33689592 = key_s(charlie), ~M_33689593 = key_e(charlie,alice), ~M_33689594 = key_e(charlie,bob) at {424} in copy a_33687172

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33687172

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33687172

out(pub, ~M_33690295) with ~M_33690295 = dhexp(key_s(alice),g) at {109} in copy a_33687172

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33687172

out(pub, ~M_33690636) with ~M_33690636 = dhexp(key_s(alice),g) at {4} in copy a_33687172

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33687172

out(pub, (~M_33690777,~M_33690778,~M_33690779)) with ~M_33690777 = key_s(charlie), ~M_33690778 = key_e(charlie,alice), ~M_33690779 = key_e(charlie,bob) at {424} in copy a_33687171

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33687171

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33687171

out(pub, ~M_33691480) with ~M_33691480 = dhexp(key_s(alice),g) at {109} in copy a_33687171

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33687171

out(pub, ~M_33691821) with ~M_33691821 = dhexp(key_s(alice),g) at {4} in copy a_33687171

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33687171

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33687173

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33687173

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33687173

out(pub, concat3(~M_33692519,empty,~M_33692521)) with ~M_33692519 = dhexp(key_e(alice,bob),g), ~M_33692521 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33687173

The attacker has the message 3-proj-aeadpack(decrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33689110),~M_33692519),~M_33692521)) = msg_a(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)) is false.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice)))
goal reachable: begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 1, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

15. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

16. By 9, the attacker may know empty.
By 15, the attacker may know minnonce.
By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 5, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

17. By 16, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob).
attacker(msg_a(alice,bob)).

18. By 17, the attacker may know msg_a(alice,bob).
So the attacker may know msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33693812,~M_33693813,~M_33693814)) with ~M_33693812 = key_s(charlie), ~M_33693813 = key_e(charlie,alice), ~M_33693814 = key_e(charlie,bob) at {424} in copy a_33692578

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33692578

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33692578

out(pub, ~M_33694515) with ~M_33694515 = dhexp(key_s(alice),g) at {109} in copy a_33692578

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33692578

out(pub, ~M_33694856) with ~M_33694856 = dhexp(key_s(alice),g) at {4} in copy a_33692578

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33692578

out(pub, (~M_33694997,~M_33694998,~M_33694999)) with ~M_33694997 = key_s(charlie), ~M_33694998 = key_e(charlie,alice), ~M_33694999 = key_e(charlie,bob) at {424} in copy a_33692577

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33692577

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33692577

out(pub, ~M_33695700) with ~M_33695700 = dhexp(key_s(alice),g) at {109} in copy a_33692577

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33692577

out(pub, ~M_33696041) with ~M_33696041 = dhexp(key_s(alice),g) at {4} in copy a_33692577

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33692577

out(pub, (~M_33696182,~M_33696183,~M_33696184)) with ~M_33696182 = key_s(charlie), ~M_33696183 = key_e(charlie,alice), ~M_33696184 = key_e(charlie,bob) at {424} in copy a_33692576

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33692576

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33692576

out(pub, ~M_33696885) with ~M_33696885 = dhexp(key_s(alice),g) at {109} in copy a_33692576

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33692576

out(pub, ~M_33697226) with ~M_33697226 = dhexp(key_s(alice),g) at {4} in copy a_33692576

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33692576

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33692578

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33692578

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33692578

out(pub, concat3(~M_33697924,empty,~M_33697926)) with ~M_33697924 = dhexp(key_e(alice,bob),g), ~M_33697926 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33692578

The attacker has the message 3-proj-aeadpack(decrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33694515),~M_33697924),~M_33697926)) = msg_a(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))) is false.
Starting query attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob))
goal reachable: begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_a(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

4. By 1, the attacker may have the channel pub.
By 3, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

5. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

6. By 4, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

7. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

8. By 1, the attacker may have the channel pub.
By 7, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 6, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

15. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

16. By 9, the attacker may know empty.
By 15, the attacker may know minnonce.
By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 5, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

17. By 16, the attacker may know aeadpack(true,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function 3-proj-aeadpack the attacker may obtain msg_a(alice,bob).
attacker(msg_a(alice,bob)).

18. By 17, the attacker may know msg_a(alice,bob).
So the attacker may know msg_a(alice,bob) in phase 1.
attacker_p1(msg_a(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33699216,~M_33699217,~M_33699218)) with ~M_33699216 = key_s(charlie), ~M_33699217 = key_e(charlie,alice), ~M_33699218 = key_e(charlie,bob) at {424} in copy a_33697982

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33697982

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33697982

out(pub, ~M_33699919) with ~M_33699919 = dhexp(key_s(alice),g) at {109} in copy a_33697982

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33697982

out(pub, ~M_33700260) with ~M_33700260 = dhexp(key_s(alice),g) at {4} in copy a_33697982

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33697982

out(pub, (~M_33700401,~M_33700402,~M_33700403)) with ~M_33700401 = key_s(charlie), ~M_33700402 = key_e(charlie,alice), ~M_33700403 = key_e(charlie,bob) at {424} in copy a_33697981

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33697981

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33697981

out(pub, ~M_33701104) with ~M_33701104 = dhexp(key_s(alice),g) at {109} in copy a_33697981

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33697981

out(pub, ~M_33701445) with ~M_33701445 = dhexp(key_s(alice),g) at {4} in copy a_33697981

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33697981

out(pub, (~M_33701586,~M_33701587,~M_33701588)) with ~M_33701586 = key_s(charlie), ~M_33701587 = key_e(charlie,alice), ~M_33701588 = key_e(charlie,bob) at {424} in copy a_33697980

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33697980

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33697980

out(pub, ~M_33702289) with ~M_33702289 = dhexp(key_s(alice),g) at {109} in copy a_33697980

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33697980

out(pub, ~M_33702630) with ~M_33702630 = dhexp(key_s(alice),g) at {4} in copy a_33697980

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33697980

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33697982

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33697982

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33697982

out(pub, concat3(~M_33703328,empty,~M_33703330)) with ~M_33703328 = dhexp(key_e(alice,bob),g), ~M_33703330 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33697982

The attacker has the message 3-proj-aeadpack(decrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33699919),~M_33703328),~M_33703330)) = msg_a(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_a(alice,bob)) ==> event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true))
goal reachable: attacker(m_33703332) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_33703332,true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 1 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) may be inserted in a table at insert {37}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true)))).

3. We assume as hypothesis that
attacker(m_33703438).

4. Using the function g the attacker may obtain g.
attacker(g).

5. Using the function pub the attacker may obtain pub.
attacker(pub).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 5, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

11. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

12. By 5, the attacker may have the channel pub.
By 11, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

13. Using the function empty the attacker may obtain empty.
attacker(empty).

14. Using the function somename the attacker may obtain somename.
attacker(somename).

15. By 14, the attacker may know somename.
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

16. By 15, the attacker may know hash(somename,empty).
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

17. By 16, the attacker may know hash(hash(somename,empty),empty).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

18. By 17, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

20. By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

21. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

22. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 21, the attacker may know minnonce.
By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 3, the attacker may know m_33703438.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33703438).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33703438)).

24. The attacker has some term b_33703425.
attacker(b_33703425).

25. By 4, the attacker may know g.
By 24, the attacker may know b_33703425.
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33703438).
Using the function concat3 the attacker may obtain concat3(g,b_33703425,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33703438)).
attacker(concat3(g,b_33703425,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33703438))).

26. By 5, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(g,b_33703425,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33703438)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_33703425,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33703438))).

27. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) that may be in a table by 2 may be read at get {68}.
The message concat3(g,b_33703425,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33703438)) that may be sent on channel pub by 26 may be received at input {40}.
We have g <> caught-fail.
So event RecvMsg(alice,bob,stage_b,m_33703438,true) may be executed at {66}.
end(RecvMsg(alice,bob,stage_b,m_33703438,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33705888,~M_33705889,~M_33705890)) with ~M_33705888 = key_s(charlie), ~M_33705889 = key_e(charlie,alice), ~M_33705890 = key_e(charlie,bob) at {424} in copy a_33703446

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33703446

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33703446

out(pub, ~M_33706591) with ~M_33706591 = dhexp(key_s(alice),g) at {109} in copy a_33703446

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33703446

out(pub, ~M_33706932) with ~M_33706932 = dhexp(key_s(alice),g) at {4} in copy a_33703446

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33703446

out(pub, (~M_33707073,~M_33707074,~M_33707075)) with ~M_33707073 = key_s(charlie), ~M_33707074 = key_e(charlie,alice), ~M_33707075 = key_e(charlie,bob) at {424} in copy a_33703445

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33703445

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33703445

out(pub, ~M_33707776) with ~M_33707776 = dhexp(key_s(alice),g) at {109} in copy a_33703445

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33703445

out(pub, ~M_33708117) with ~M_33708117 = dhexp(key_s(alice),g) at {4} in copy a_33703445

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33703445

out(pub, (~M_33708258,~M_33708259,~M_33708260)) with ~M_33708258 = key_s(charlie), ~M_33708259 = key_e(charlie,alice), ~M_33708260 = key_e(charlie,bob) at {424} in copy a_33703444

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33703444

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33703444

out(pub, ~M_33708961) with ~M_33708961 = dhexp(key_s(alice),g) at {109} in copy a_33703444

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33703444

out(pub, ~M_33709302) with ~M_33709302 = dhexp(key_s(alice),g) at {4} in copy a_33703444

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33703444

out(pub, (~M_33709443,~M_33709444,~M_33709445)) with ~M_33709443 = key_s(charlie), ~M_33709444 = key_e(charlie,alice), ~M_33709445 = key_e(charlie,bob) at {424} in copy a_33703443

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33703443

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33703443

out(pub, ~M_33710146) with ~M_33710146 = dhexp(key_s(alice),g) at {109} in copy a_33703443

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33703443

out(pub, ~M_33710487) with ~M_33710487 = dhexp(key_s(alice),g) at {4} in copy a_33703443

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33703443

out(pub, (~M_33710628,~M_33710629,~M_33710630)) with ~M_33710628 = key_s(charlie), ~M_33710629 = key_e(charlie,alice), ~M_33710630 = key_e(charlie,bob) at {424} in copy a_33703442

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33703442

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33703442

out(pub, ~M_33711331) with ~M_33711331 = dhexp(key_s(alice),g) at {109} in copy a_33703442

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33703442

out(pub, ~M_33711672) with ~M_33711672 = dhexp(key_s(alice),g) at {4} in copy a_33703442

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33703442

out(pub, (~M_33711813,~M_33711814,~M_33711815)) with ~M_33711813 = key_s(charlie), ~M_33711814 = key_e(charlie,alice), ~M_33711815 = key_e(charlie,bob) at {424} in copy a_33703441

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33703441

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33703441

out(pub, ~M_33712516) with ~M_33712516 = dhexp(key_s(alice),g) at {109} in copy a_33703441

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33703441

out(pub, ~M_33712857) with ~M_33712857 = dhexp(key_s(alice),g) at {4} in copy a_33703441

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33703441

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33703443

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33703443

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33703443

out(pub, concat3(~M_33713555,empty,~M_33713557)) with ~M_33713555 = dhexp(key_e(alice,bob),g), ~M_33713557 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33703443

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33703445

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33703445

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33703445

out(pub, concat3(~M_33714116,empty,~M_33714118)) with ~M_33714116 = dhexp(key_e(alice,bob),g), ~M_33714118 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33703445

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {68} in copy a_33703446

in(pub, concat3(g,a_33703440,encrypt(hmac_hash2(hash(somename,empty),~M_33713555),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33706591),~M_33713555),~M_33713557),g),a_33703439))) with encrypt(hmac_hash2(hash(somename,empty),~M_33713555),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33706591),~M_33713555),~M_33713557),g),a_33703439) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_33703439) at {40} in copy a_33703446

event RecvMsg(alice,bob,stage_b,a_33703439,true) at {66} in copy a_33703446 (goal)

The event RecvMsg(alice,bob,stage_b,a_33703439,true) is executed.
A trace has been found.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_33715107) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_33715107,true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 1 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) may be inserted in a table at insert {37}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true)))).

3. We assume as hypothesis that
attacker(m_33715214).

4. Using the function g the attacker may obtain g.
attacker(g).

5. Using the function pub the attacker may obtain pub.
attacker(pub).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 5, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

11. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

12. By 5, the attacker may have the channel pub.
By 11, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

13. Using the function empty the attacker may obtain empty.
attacker(empty).

14. Using the function somename the attacker may obtain somename.
attacker(somename).

15. By 14, the attacker may know somename.
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

16. By 15, the attacker may know hash(somename,empty).
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

17. By 16, the attacker may know hash(hash(somename,empty),empty).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

18. By 17, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

20. By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

21. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

22. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 21, the attacker may know minnonce.
By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 3, the attacker may know m_33715214.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33715214).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33715214)).

24. The attacker has some term b_33715201.
attacker(b_33715201).

25. By 4, the attacker may know g.
By 24, the attacker may know b_33715201.
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33715214).
Using the function concat3 the attacker may obtain concat3(g,b_33715201,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33715214)).
attacker(concat3(g,b_33715201,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33715214))).

26. By 5, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(g,b_33715201,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33715214)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_33715201,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33715214))).

27. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) that may be in a table by 2 may be read at get {68}.
The message concat3(g,b_33715201,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33715214)) that may be sent on channel pub by 26 may be received at input {40}.
We have g <> caught-fail.
So event RecvMsg(alice,bob,stage_b,m_33715214,true) may be executed at {66}.
end(RecvMsg(alice,bob,stage_b,m_33715214,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33717664,~M_33717665,~M_33717666)) with ~M_33717664 = key_s(charlie), ~M_33717665 = key_e(charlie,alice), ~M_33717666 = key_e(charlie,bob) at {424} in copy a_33715222

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33715222

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33715222

out(pub, ~M_33718367) with ~M_33718367 = dhexp(key_s(alice),g) at {109} in copy a_33715222

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33715222

out(pub, ~M_33718708) with ~M_33718708 = dhexp(key_s(alice),g) at {4} in copy a_33715222

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33715222

out(pub, (~M_33718849,~M_33718850,~M_33718851)) with ~M_33718849 = key_s(charlie), ~M_33718850 = key_e(charlie,alice), ~M_33718851 = key_e(charlie,bob) at {424} in copy a_33715221

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33715221

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33715221

out(pub, ~M_33719552) with ~M_33719552 = dhexp(key_s(alice),g) at {109} in copy a_33715221

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33715221

out(pub, ~M_33719893) with ~M_33719893 = dhexp(key_s(alice),g) at {4} in copy a_33715221

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33715221

out(pub, (~M_33720034,~M_33720035,~M_33720036)) with ~M_33720034 = key_s(charlie), ~M_33720035 = key_e(charlie,alice), ~M_33720036 = key_e(charlie,bob) at {424} in copy a_33715220

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33715220

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33715220

out(pub, ~M_33720737) with ~M_33720737 = dhexp(key_s(alice),g) at {109} in copy a_33715220

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33715220

out(pub, ~M_33721078) with ~M_33721078 = dhexp(key_s(alice),g) at {4} in copy a_33715220

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33715220

out(pub, (~M_33721219,~M_33721220,~M_33721221)) with ~M_33721219 = key_s(charlie), ~M_33721220 = key_e(charlie,alice), ~M_33721221 = key_e(charlie,bob) at {424} in copy a_33715219

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33715219

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33715219

out(pub, ~M_33721922) with ~M_33721922 = dhexp(key_s(alice),g) at {109} in copy a_33715219

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33715219

out(pub, ~M_33722263) with ~M_33722263 = dhexp(key_s(alice),g) at {4} in copy a_33715219

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33715219

out(pub, (~M_33722404,~M_33722405,~M_33722406)) with ~M_33722404 = key_s(charlie), ~M_33722405 = key_e(charlie,alice), ~M_33722406 = key_e(charlie,bob) at {424} in copy a_33715218

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33715218

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33715218

out(pub, ~M_33723107) with ~M_33723107 = dhexp(key_s(alice),g) at {109} in copy a_33715218

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33715218

out(pub, ~M_33723448) with ~M_33723448 = dhexp(key_s(alice),g) at {4} in copy a_33715218

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33715218

out(pub, (~M_33723589,~M_33723590,~M_33723591)) with ~M_33723589 = key_s(charlie), ~M_33723590 = key_e(charlie,alice), ~M_33723591 = key_e(charlie,bob) at {424} in copy a_33715217

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33715217

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33715217

out(pub, ~M_33724292) with ~M_33724292 = dhexp(key_s(alice),g) at {109} in copy a_33715217

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33715217

out(pub, ~M_33724633) with ~M_33724633 = dhexp(key_s(alice),g) at {4} in copy a_33715217

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33715217

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33715219

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33715219

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33715219

out(pub, concat3(~M_33725331,empty,~M_33725333)) with ~M_33725331 = dhexp(key_e(alice,bob),g), ~M_33725333 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33715219

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33715221

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33715221

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33715221

out(pub, concat3(~M_33725892,empty,~M_33725894)) with ~M_33725892 = dhexp(key_e(alice,bob),g), ~M_33725894 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33715221

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {68} in copy a_33715222

in(pub, concat3(g,a_33715216,encrypt(hmac_hash2(hash(somename,empty),~M_33725331),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33718367),~M_33725331),~M_33725333),g),a_33715215))) with encrypt(hmac_hash2(hash(somename,empty),~M_33725331),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33718367),~M_33725331),~M_33725333),g),a_33715215) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_33715215) at {40} in copy a_33715222

event RecvMsg(alice,bob,stage_b,a_33715215,true) at {66} in copy a_33715222 (goal)

The event RecvMsg(alice,bob,stage_b,a_33715215,true) is executed.
A trace has been found.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_33726883) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_33726883,true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 1 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) may be inserted in a table at insert {37}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true)))).

3. We assume as hypothesis that
attacker(m_33726990).

4. Using the function g the attacker may obtain g.
attacker(g).

5. Using the function pub the attacker may obtain pub.
attacker(pub).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 5, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

11. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

12. By 5, the attacker may have the channel pub.
By 11, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

13. Using the function empty the attacker may obtain empty.
attacker(empty).

14. Using the function somename the attacker may obtain somename.
attacker(somename).

15. By 14, the attacker may know somename.
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

16. By 15, the attacker may know hash(somename,empty).
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

17. By 16, the attacker may know hash(hash(somename,empty),empty).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

18. By 17, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

20. By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

21. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

22. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 21, the attacker may know minnonce.
By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 3, the attacker may know m_33726990.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33726990).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33726990)).

24. The attacker has some term b_33726977.
attacker(b_33726977).

25. By 4, the attacker may know g.
By 24, the attacker may know b_33726977.
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33726990).
Using the function concat3 the attacker may obtain concat3(g,b_33726977,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33726990)).
attacker(concat3(g,b_33726977,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33726990))).

26. By 5, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(g,b_33726977,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33726990)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_33726977,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33726990))).

27. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) that may be in a table by 2 may be read at get {68}.
The message concat3(g,b_33726977,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33726990)) that may be sent on channel pub by 26 may be received at input {40}.
We have g <> caught-fail.
So event RecvMsg(alice,bob,stage_b,m_33726990,true) may be executed at {66}.
end(RecvMsg(alice,bob,stage_b,m_33726990,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33729440,~M_33729441,~M_33729442)) with ~M_33729440 = key_s(charlie), ~M_33729441 = key_e(charlie,alice), ~M_33729442 = key_e(charlie,bob) at {424} in copy a_33726998

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33726998

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33726998

out(pub, ~M_33730143) with ~M_33730143 = dhexp(key_s(alice),g) at {109} in copy a_33726998

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33726998

out(pub, ~M_33730484) with ~M_33730484 = dhexp(key_s(alice),g) at {4} in copy a_33726998

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33726998

out(pub, (~M_33730625,~M_33730626,~M_33730627)) with ~M_33730625 = key_s(charlie), ~M_33730626 = key_e(charlie,alice), ~M_33730627 = key_e(charlie,bob) at {424} in copy a_33726997

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33726997

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33726997

out(pub, ~M_33731328) with ~M_33731328 = dhexp(key_s(alice),g) at {109} in copy a_33726997

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33726997

out(pub, ~M_33731669) with ~M_33731669 = dhexp(key_s(alice),g) at {4} in copy a_33726997

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33726997

out(pub, (~M_33731810,~M_33731811,~M_33731812)) with ~M_33731810 = key_s(charlie), ~M_33731811 = key_e(charlie,alice), ~M_33731812 = key_e(charlie,bob) at {424} in copy a_33726996

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33726996

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33726996

out(pub, ~M_33732513) with ~M_33732513 = dhexp(key_s(alice),g) at {109} in copy a_33726996

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33726996

out(pub, ~M_33732854) with ~M_33732854 = dhexp(key_s(alice),g) at {4} in copy a_33726996

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33726996

out(pub, (~M_33732995,~M_33732996,~M_33732997)) with ~M_33732995 = key_s(charlie), ~M_33732996 = key_e(charlie,alice), ~M_33732997 = key_e(charlie,bob) at {424} in copy a_33726995

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33726995

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33726995

out(pub, ~M_33733698) with ~M_33733698 = dhexp(key_s(alice),g) at {109} in copy a_33726995

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33726995

out(pub, ~M_33734039) with ~M_33734039 = dhexp(key_s(alice),g) at {4} in copy a_33726995

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33726995

out(pub, (~M_33734180,~M_33734181,~M_33734182)) with ~M_33734180 = key_s(charlie), ~M_33734181 = key_e(charlie,alice), ~M_33734182 = key_e(charlie,bob) at {424} in copy a_33726994

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33726994

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33726994

out(pub, ~M_33734883) with ~M_33734883 = dhexp(key_s(alice),g) at {109} in copy a_33726994

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33726994

out(pub, ~M_33735224) with ~M_33735224 = dhexp(key_s(alice),g) at {4} in copy a_33726994

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33726994

out(pub, (~M_33735365,~M_33735366,~M_33735367)) with ~M_33735365 = key_s(charlie), ~M_33735366 = key_e(charlie,alice), ~M_33735367 = key_e(charlie,bob) at {424} in copy a_33726993

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33726993

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33726993

out(pub, ~M_33736068) with ~M_33736068 = dhexp(key_s(alice),g) at {109} in copy a_33726993

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33726993

out(pub, ~M_33736409) with ~M_33736409 = dhexp(key_s(alice),g) at {4} in copy a_33726993

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33726993

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33726995

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33726995

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33726995

out(pub, concat3(~M_33737107,empty,~M_33737109)) with ~M_33737107 = dhexp(key_e(alice,bob),g), ~M_33737109 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33726995

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33726997

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33726997

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33726997

out(pub, concat3(~M_33737668,empty,~M_33737670)) with ~M_33737668 = dhexp(key_e(alice,bob),g), ~M_33737670 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33726997

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {68} in copy a_33726998

in(pub, concat3(g,a_33726992,encrypt(hmac_hash2(hash(somename,empty),~M_33737107),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33730143),~M_33737107),~M_33737109),g),a_33726991))) with encrypt(hmac_hash2(hash(somename,empty),~M_33737107),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33730143),~M_33737107),~M_33737109),g),a_33726991) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_33726991) at {40} in copy a_33726998

event RecvMsg(alice,bob,stage_b,a_33726991,true) at {66} in copy a_33726998 (goal)

The event RecvMsg(alice,bob,stage_b,a_33726991,true) is executed.
A trace has been found.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,c_881,stage_b,m,true)) || event(LeakS(phase0,bob)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice))
goal reachable: attacker(m_33738659) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_33738659,true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 1 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) may be inserted in a table at insert {37}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true)))).

3. We assume as hypothesis that
attacker(m_33738765).

4. Using the function g the attacker may obtain g.
attacker(g).

5. Using the function pub the attacker may obtain pub.
attacker(pub).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 5, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

11. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

12. By 5, the attacker may have the channel pub.
By 11, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

13. Using the function empty the attacker may obtain empty.
attacker(empty).

14. Using the function somename the attacker may obtain somename.
attacker(somename).

15. By 14, the attacker may know somename.
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

16. By 15, the attacker may know hash(somename,empty).
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

17. By 16, the attacker may know hash(hash(somename,empty),empty).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

18. By 17, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

20. By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

21. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

22. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 21, the attacker may know minnonce.
By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 3, the attacker may know m_33738765.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33738765).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33738765)).

24. The attacker has some term b_33738752.
attacker(b_33738752).

25. By 4, the attacker may know g.
By 24, the attacker may know b_33738752.
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33738765).
Using the function concat3 the attacker may obtain concat3(g,b_33738752,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33738765)).
attacker(concat3(g,b_33738752,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33738765))).

26. By 5, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(g,b_33738752,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33738765)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_33738752,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33738765))).

27. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) that may be in a table by 2 may be read at get {68}.
The message concat3(g,b_33738752,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33738765)) that may be sent on channel pub by 26 may be received at input {40}.
We have g <> caught-fail.
So event RecvMsg(alice,bob,stage_b,m_33738765,true) may be executed at {66}.
end(RecvMsg(alice,bob,stage_b,m_33738765,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33741215,~M_33741216,~M_33741217)) with ~M_33741215 = key_s(charlie), ~M_33741216 = key_e(charlie,alice), ~M_33741217 = key_e(charlie,bob) at {424} in copy a_33738773

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33738773

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33738773

out(pub, ~M_33741918) with ~M_33741918 = dhexp(key_s(alice),g) at {109} in copy a_33738773

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33738773

out(pub, ~M_33742259) with ~M_33742259 = dhexp(key_s(alice),g) at {4} in copy a_33738773

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33738773

out(pub, (~M_33742400,~M_33742401,~M_33742402)) with ~M_33742400 = key_s(charlie), ~M_33742401 = key_e(charlie,alice), ~M_33742402 = key_e(charlie,bob) at {424} in copy a_33738772

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33738772

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33738772

out(pub, ~M_33743103) with ~M_33743103 = dhexp(key_s(alice),g) at {109} in copy a_33738772

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33738772

out(pub, ~M_33743444) with ~M_33743444 = dhexp(key_s(alice),g) at {4} in copy a_33738772

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33738772

out(pub, (~M_33743585,~M_33743586,~M_33743587)) with ~M_33743585 = key_s(charlie), ~M_33743586 = key_e(charlie,alice), ~M_33743587 = key_e(charlie,bob) at {424} in copy a_33738771

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33738771

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33738771

out(pub, ~M_33744288) with ~M_33744288 = dhexp(key_s(alice),g) at {109} in copy a_33738771

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33738771

out(pub, ~M_33744629) with ~M_33744629 = dhexp(key_s(alice),g) at {4} in copy a_33738771

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33738771

out(pub, (~M_33744770,~M_33744771,~M_33744772)) with ~M_33744770 = key_s(charlie), ~M_33744771 = key_e(charlie,alice), ~M_33744772 = key_e(charlie,bob) at {424} in copy a_33738770

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33738770

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33738770

out(pub, ~M_33745473) with ~M_33745473 = dhexp(key_s(alice),g) at {109} in copy a_33738770

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33738770

out(pub, ~M_33745814) with ~M_33745814 = dhexp(key_s(alice),g) at {4} in copy a_33738770

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33738770

out(pub, (~M_33745955,~M_33745956,~M_33745957)) with ~M_33745955 = key_s(charlie), ~M_33745956 = key_e(charlie,alice), ~M_33745957 = key_e(charlie,bob) at {424} in copy a_33738769

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33738769

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33738769

out(pub, ~M_33746658) with ~M_33746658 = dhexp(key_s(alice),g) at {109} in copy a_33738769

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33738769

out(pub, ~M_33746999) with ~M_33746999 = dhexp(key_s(alice),g) at {4} in copy a_33738769

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33738769

out(pub, (~M_33747140,~M_33747141,~M_33747142)) with ~M_33747140 = key_s(charlie), ~M_33747141 = key_e(charlie,alice), ~M_33747142 = key_e(charlie,bob) at {424} in copy a_33738768

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33738768

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33738768

out(pub, ~M_33747843) with ~M_33747843 = dhexp(key_s(alice),g) at {109} in copy a_33738768

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33738768

out(pub, ~M_33748184) with ~M_33748184 = dhexp(key_s(alice),g) at {4} in copy a_33738768

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33738768

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33738770

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33738770

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33738770

out(pub, concat3(~M_33748882,empty,~M_33748884)) with ~M_33748882 = dhexp(key_e(alice,bob),g), ~M_33748884 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33738770

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33738772

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33738772

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33738772

out(pub, concat3(~M_33749443,empty,~M_33749445)) with ~M_33749443 = dhexp(key_e(alice,bob),g), ~M_33749445 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33738772

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {68} in copy a_33738773

in(pub, concat3(g,a_33738767,encrypt(hmac_hash2(hash(somename,empty),~M_33748882),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33741918),~M_33748882),~M_33748884),g),a_33738766))) with encrypt(hmac_hash2(hash(somename,empty),~M_33748882),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33741918),~M_33748882),~M_33748884),g),a_33738766) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_33738766) at {40} in copy a_33738773

event RecvMsg(alice,bob,stage_b,a_33738766,true) at {66} in copy a_33738773 (goal)

The event RecvMsg(alice,bob,stage_b,a_33738766,true) is executed.
A trace has been found.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) || event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob))
goal reachable: attacker(m_33750434) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(alice,bob,stage_b,m_33750434,true))

1. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 1 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) may be inserted in a table at insert {37}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true)))).

3. We assume as hypothesis that
attacker(m_33750540).

4. Using the function g the attacker may obtain g.
attacker(g).

5. Using the function pub the attacker may obtain pub.
attacker(pub).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 5, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

11. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

12. By 5, the attacker may have the channel pub.
By 11, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

13. Using the function empty the attacker may obtain empty.
attacker(empty).

14. Using the function somename the attacker may obtain somename.
attacker(somename).

15. By 14, the attacker may know somename.
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

16. By 15, the attacker may know hash(somename,empty).
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

17. By 16, the attacker may know hash(hash(somename,empty),empty).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

18. By 17, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

20. By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

21. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

22. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 21, the attacker may know minnonce.
By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 3, the attacker may know m_33750540.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33750540).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33750540)).

24. The attacker has some term b_33750527.
attacker(b_33750527).

25. By 4, the attacker may know g.
By 24, the attacker may know b_33750527.
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33750540).
Using the function concat3 the attacker may obtain concat3(g,b_33750527,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33750540)).
attacker(concat3(g,b_33750527,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33750540))).

26. By 5, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(g,b_33750527,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33750540)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_33750527,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33750540))).

27. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) that may be in a table by 2 may be read at get {68}.
The message concat3(g,b_33750527,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),m_33750540)) that may be sent on channel pub by 26 may be received at input {40}.
We have g <> caught-fail.
So event RecvMsg(alice,bob,stage_b,m_33750540,true) may be executed at {66}.
end(RecvMsg(alice,bob,stage_b,m_33750540,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33752990,~M_33752991,~M_33752992)) with ~M_33752990 = key_s(charlie), ~M_33752991 = key_e(charlie,alice), ~M_33752992 = key_e(charlie,bob) at {424} in copy a_33750548

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33750548

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33750548

out(pub, ~M_33753693) with ~M_33753693 = dhexp(key_s(alice),g) at {109} in copy a_33750548

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33750548

out(pub, ~M_33754034) with ~M_33754034 = dhexp(key_s(alice),g) at {4} in copy a_33750548

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33750548

out(pub, (~M_33754175,~M_33754176,~M_33754177)) with ~M_33754175 = key_s(charlie), ~M_33754176 = key_e(charlie,alice), ~M_33754177 = key_e(charlie,bob) at {424} in copy a_33750547

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33750547

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33750547

out(pub, ~M_33754878) with ~M_33754878 = dhexp(key_s(alice),g) at {109} in copy a_33750547

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33750547

out(pub, ~M_33755219) with ~M_33755219 = dhexp(key_s(alice),g) at {4} in copy a_33750547

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33750547

out(pub, (~M_33755360,~M_33755361,~M_33755362)) with ~M_33755360 = key_s(charlie), ~M_33755361 = key_e(charlie,alice), ~M_33755362 = key_e(charlie,bob) at {424} in copy a_33750546

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33750546

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33750546

out(pub, ~M_33756063) with ~M_33756063 = dhexp(key_s(alice),g) at {109} in copy a_33750546

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33750546

out(pub, ~M_33756404) with ~M_33756404 = dhexp(key_s(alice),g) at {4} in copy a_33750546

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33750546

out(pub, (~M_33756545,~M_33756546,~M_33756547)) with ~M_33756545 = key_s(charlie), ~M_33756546 = key_e(charlie,alice), ~M_33756547 = key_e(charlie,bob) at {424} in copy a_33750545

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33750545

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33750545

out(pub, ~M_33757248) with ~M_33757248 = dhexp(key_s(alice),g) at {109} in copy a_33750545

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33750545

out(pub, ~M_33757589) with ~M_33757589 = dhexp(key_s(alice),g) at {4} in copy a_33750545

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33750545

out(pub, (~M_33757730,~M_33757731,~M_33757732)) with ~M_33757730 = key_s(charlie), ~M_33757731 = key_e(charlie,alice), ~M_33757732 = key_e(charlie,bob) at {424} in copy a_33750544

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33750544

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33750544

out(pub, ~M_33758433) with ~M_33758433 = dhexp(key_s(alice),g) at {109} in copy a_33750544

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33750544

out(pub, ~M_33758774) with ~M_33758774 = dhexp(key_s(alice),g) at {4} in copy a_33750544

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33750544

out(pub, (~M_33758915,~M_33758916,~M_33758917)) with ~M_33758915 = key_s(charlie), ~M_33758916 = key_e(charlie,alice), ~M_33758917 = key_e(charlie,bob) at {424} in copy a_33750543

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33750543

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33750543

out(pub, ~M_33759618) with ~M_33759618 = dhexp(key_s(alice),g) at {109} in copy a_33750543

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33750543

out(pub, ~M_33759959) with ~M_33759959 = dhexp(key_s(alice),g) at {4} in copy a_33750543

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33750543

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33750545

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33750545

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33750545

out(pub, concat3(~M_33760657,empty,~M_33760659)) with ~M_33760657 = dhexp(key_e(alice,bob),g), ~M_33760659 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33750545

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_33750547

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_33750547

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_33750547

out(pub, concat3(~M_33761218,empty,~M_33761220)) with ~M_33761218 = dhexp(key_e(alice,bob),g), ~M_33761220 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_33750547

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {68} in copy a_33750548

in(pub, concat3(g,a_33750542,encrypt(hmac_hash2(hash(somename,empty),~M_33760657),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33753693),~M_33760657),~M_33760659),g),a_33750541))) with encrypt(hmac_hash2(hash(somename,empty),~M_33760657),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33753693),~M_33760657),~M_33760659),g),a_33750541) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_33750541) at {40} in copy a_33750548

event RecvMsg(alice,bob,stage_b,a_33750541,true) at {66} in copy a_33750548 (goal)

The event RecvMsg(alice,bob,stage_b,a_33750541,true) is executed.
A trace has been found.
RESULT event(RecvMsg(alice,bob,stage_b,m,true)) ==> event(SendMsg(bob,alice,stage_b,m,true)) || event(LeakS(phase0,bob)) is false.
Starting query not attacker_p1(msg_b(bob,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

3. The attacker has some term plaintext_a_33762357.
attacker(plaintext_a_33762357).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
By 3, the attacker may know plaintext_a_33762357.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)).

15. The attacker has some term b_33762353.
attacker(b_33762353).

16. By 4, the attacker may know g.
By 15, the attacker may know b_33762353.
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357).
Using the function concat3 the attacker may obtain concat3(g,b_33762353,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)).
attacker(concat3(g,b_33762353,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357))).

17. By 1, the attacker may have the channel pub.
By 16, the attacker may have the message concat3(g,b_33762353,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_33762353,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357))).

18. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 2 may be read at get {247}.
The message concat3(g,b_33762353,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)) that may be sent on channel pub by 17 may be received at input {226}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

19. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 18 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

20. By 1, the attacker may have the channel pub.
By 19, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 20, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

23. The attacker has some term plaintext_a_33762290.
attacker(plaintext_a_33762290).

24. The attacker has some term re_33762306.
attacker(re_33762306).

25. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 24, the attacker may know re_33762306.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306)).

26. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 25, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306).
By 23, the attacker may know plaintext_a_33762290.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)).

27. The attacker has some term b_33762286.
attacker(b_33762286).

28. By 24, the attacker may know re_33762306.
By 27, the attacker may know b_33762286.
By 26, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290).
Using the function concat3 the attacker may obtain concat3(re_33762306,b_33762286,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)).
attacker(concat3(re_33762306,b_33762286,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(re_33762306,b_33762286,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)).
So the attacker may send this message on this channel.
mess(pub,concat3(re_33762306,b_33762286,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 22 may be read at get {247}.
The message concat3(re_33762306,b_33762286,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)) that may be sent on channel pub by 29 may be received at input {226}.
We have re_33762306 <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33762306,empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33762306,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33762306,empty,false))) that may be in a table by 30 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33762306)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33762306)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33762306)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33762306)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33762306)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33762306)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33762306),plaintext_a_33762290)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g))).

36. By 9, the attacker may know hash(somename,empty).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g))).

37. By 36, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)).
By 13, the attacker may know minnonce.
By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)).
By 21, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

38. By 37, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33762357)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice).
attacker(msg_b(bob,alice)).

39. By 38, the attacker may know msg_b(bob,alice).
So the attacker may know msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33765259,~M_33765260,~M_33765261)) with ~M_33765259 = key_s(charlie), ~M_33765260 = key_e(charlie,alice), ~M_33765261 = key_e(charlie,bob) at {424} in copy a_33762401

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33762401

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33762401

out(pub, ~M_33765962) with ~M_33765962 = dhexp(key_s(alice),g) at {109} in copy a_33762401

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33762401

out(pub, ~M_33766303) with ~M_33766303 = dhexp(key_s(alice),g) at {4} in copy a_33762401

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33762401

out(pub, (~M_33766444,~M_33766445,~M_33766446)) with ~M_33766444 = key_s(charlie), ~M_33766445 = key_e(charlie,alice), ~M_33766446 = key_e(charlie,bob) at {424} in copy a_33762400

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33762400

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33762400

out(pub, ~M_33767147) with ~M_33767147 = dhexp(key_s(alice),g) at {109} in copy a_33762400

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33762400

out(pub, ~M_33767488) with ~M_33767488 = dhexp(key_s(alice),g) at {4} in copy a_33762400

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33762400

out(pub, (~M_33767629,~M_33767630,~M_33767631)) with ~M_33767629 = key_s(charlie), ~M_33767630 = key_e(charlie,alice), ~M_33767631 = key_e(charlie,bob) at {424} in copy a_33762399

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33762399

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33762399

out(pub, ~M_33768332) with ~M_33768332 = dhexp(key_s(alice),g) at {109} in copy a_33762399

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33762399

out(pub, ~M_33768673) with ~M_33768673 = dhexp(key_s(alice),g) at {4} in copy a_33762399

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33762399

out(pub, (~M_33768814,~M_33768815,~M_33768816)) with ~M_33768814 = key_s(charlie), ~M_33768815 = key_e(charlie,alice), ~M_33768816 = key_e(charlie,bob) at {424} in copy a_33762398

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33762398

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33762398

out(pub, ~M_33769517) with ~M_33769517 = dhexp(key_s(alice),g) at {109} in copy a_33762398

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33762398

out(pub, ~M_33769858) with ~M_33769858 = dhexp(key_s(alice),g) at {4} in copy a_33762398

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33762398

out(pub, (~M_33769999,~M_33770000,~M_33770001)) with ~M_33769999 = key_s(charlie), ~M_33770000 = key_e(charlie,alice), ~M_33770001 = key_e(charlie,bob) at {424} in copy a_33762396

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33762396

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33762396

out(pub, ~M_33770702) with ~M_33770702 = dhexp(key_s(alice),g) at {109} in copy a_33762396

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33762396

out(pub, ~M_33771043) with ~M_33771043 = dhexp(key_s(alice),g) at {4} in copy a_33762396

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33762396

out(pub, (~M_33771184,~M_33771185,~M_33771186)) with ~M_33771184 = key_s(charlie), ~M_33771185 = key_e(charlie,alice), ~M_33771186 = key_e(charlie,bob) at {424} in copy a_33762395

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33762395

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33762395

out(pub, ~M_33771887) with ~M_33771887 = dhexp(key_s(alice),g) at {109} in copy a_33762395

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33762395

out(pub, ~M_33772228) with ~M_33772228 = dhexp(key_s(alice),g) at {4} in copy a_33762395

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33762395

out(pub, (~M_33772369,~M_33772370,~M_33772371)) with ~M_33772369 = key_s(charlie), ~M_33772370 = key_e(charlie,alice), ~M_33772371 = key_e(charlie,bob) at {424} in copy a_33762394

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33762394

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33762394

out(pub, ~M_33773072) with ~M_33773072 = dhexp(key_s(alice),g) at {109} in copy a_33762394

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33762394

out(pub, ~M_33773413) with ~M_33773413 = dhexp(key_s(alice),g) at {4} in copy a_33762394

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33762394

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33762395

in(pub, concat3(a_33762391,a_33762393,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33765962),a_33762391),a_33762392))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33765962),a_33762391),a_33762392) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),a_33762392) at {226} in copy a_33762395

event RecvMsg(bob,alice,stage_a,a_33762392,true) at {245} in copy a_33762395

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),a_33762392))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33762391,empty,false))) at {246} in copy a_33762395

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),a_33762392))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33762391,empty,false))) at {277} in copy a_33762396

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33762396

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33762391)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),a_33762391)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),a_33762392)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33762391)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),a_33762392)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),a_33762391,empty,false))) at {275} in copy a_33762396

out(pub, concat3(~M_33775113,empty,~M_33775115)) with ~M_33775113 = dhexp(key_e(bob,alice),g), ~M_33775115 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33762391)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33762391),a_33762392)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33762396

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33762400

in(pub, concat3(g,a_33762397,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33765962),g),a_33762390))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33765962),g),a_33762390) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33762390) at {226} in copy a_33762400

event RecvMsg(bob,alice,stage_a,a_33762390,true) at {245} in copy a_33762400

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33762390))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {246} in copy a_33762400

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33762390))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_33762401

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33762401

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33762390)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33762390)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {275} in copy a_33762401

out(pub, concat3(~M_33776693,empty,~M_33776695)) with ~M_33776693 = dhexp(key_e(bob,alice),g), ~M_33776695 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33762390)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33762401

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hash(somename,empty),~M_33775113),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33765962),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33765962),g),a_33762390)),~M_33775113),~M_33776695)) = msg_b(bob,alice) in phase 1.
A trace has been found.
RESULT not attacker_p1(msg_b(bob,alice)) is false.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

3. The attacker has some term plaintext_a_33776845.
attacker(plaintext_a_33776845).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
By 3, the attacker may know plaintext_a_33776845.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)).

15. The attacker has some term b_33776841.
attacker(b_33776841).

16. By 4, the attacker may know g.
By 15, the attacker may know b_33776841.
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845).
Using the function concat3 the attacker may obtain concat3(g,b_33776841,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)).
attacker(concat3(g,b_33776841,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845))).

17. By 1, the attacker may have the channel pub.
By 16, the attacker may have the message concat3(g,b_33776841,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_33776841,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845))).

18. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 2 may be read at get {247}.
The message concat3(g,b_33776841,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)) that may be sent on channel pub by 17 may be received at input {226}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

19. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 18 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

20. By 1, the attacker may have the channel pub.
By 19, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 20, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

23. The attacker has some term plaintext_a_33776778.
attacker(plaintext_a_33776778).

24. The attacker has some term re_33776794.
attacker(re_33776794).

25. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 24, the attacker may know re_33776794.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794)).

26. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 25, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794).
By 23, the attacker may know plaintext_a_33776778.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)).

27. The attacker has some term b_33776774.
attacker(b_33776774).

28. By 24, the attacker may know re_33776794.
By 27, the attacker may know b_33776774.
By 26, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778).
Using the function concat3 the attacker may obtain concat3(re_33776794,b_33776774,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)).
attacker(concat3(re_33776794,b_33776774,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(re_33776794,b_33776774,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)).
So the attacker may send this message on this channel.
mess(pub,concat3(re_33776794,b_33776774,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 22 may be read at get {247}.
The message concat3(re_33776794,b_33776774,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)) that may be sent on channel pub by 29 may be received at input {226}.
We have re_33776794 <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33776794,empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33776794,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33776794,empty,false))) that may be in a table by 30 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33776794)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33776794)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33776794)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33776794)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33776794)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33776794)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33776794),plaintext_a_33776778)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g))).

36. By 9, the attacker may know hash(somename,empty).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g))).

37. By 36, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)).
By 13, the attacker may know minnonce.
By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)).
By 21, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

38. By 37, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33776845)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice).
attacker(msg_b(bob,alice)).

39. By 38, the attacker may know msg_b(bob,alice).
So the attacker may know msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33779747,~M_33779748,~M_33779749)) with ~M_33779747 = key_s(charlie), ~M_33779748 = key_e(charlie,alice), ~M_33779749 = key_e(charlie,bob) at {424} in copy a_33776889

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33776889

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33776889

out(pub, ~M_33780450) with ~M_33780450 = dhexp(key_s(alice),g) at {109} in copy a_33776889

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33776889

out(pub, ~M_33780791) with ~M_33780791 = dhexp(key_s(alice),g) at {4} in copy a_33776889

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33776889

out(pub, (~M_33780932,~M_33780933,~M_33780934)) with ~M_33780932 = key_s(charlie), ~M_33780933 = key_e(charlie,alice), ~M_33780934 = key_e(charlie,bob) at {424} in copy a_33776888

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33776888

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33776888

out(pub, ~M_33781635) with ~M_33781635 = dhexp(key_s(alice),g) at {109} in copy a_33776888

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33776888

out(pub, ~M_33781976) with ~M_33781976 = dhexp(key_s(alice),g) at {4} in copy a_33776888

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33776888

out(pub, (~M_33782117,~M_33782118,~M_33782119)) with ~M_33782117 = key_s(charlie), ~M_33782118 = key_e(charlie,alice), ~M_33782119 = key_e(charlie,bob) at {424} in copy a_33776887

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33776887

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33776887

out(pub, ~M_33782820) with ~M_33782820 = dhexp(key_s(alice),g) at {109} in copy a_33776887

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33776887

out(pub, ~M_33783161) with ~M_33783161 = dhexp(key_s(alice),g) at {4} in copy a_33776887

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33776887

out(pub, (~M_33783302,~M_33783303,~M_33783304)) with ~M_33783302 = key_s(charlie), ~M_33783303 = key_e(charlie,alice), ~M_33783304 = key_e(charlie,bob) at {424} in copy a_33776886

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33776886

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33776886

out(pub, ~M_33784005) with ~M_33784005 = dhexp(key_s(alice),g) at {109} in copy a_33776886

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33776886

out(pub, ~M_33784346) with ~M_33784346 = dhexp(key_s(alice),g) at {4} in copy a_33776886

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33776886

out(pub, (~M_33784487,~M_33784488,~M_33784489)) with ~M_33784487 = key_s(charlie), ~M_33784488 = key_e(charlie,alice), ~M_33784489 = key_e(charlie,bob) at {424} in copy a_33776884

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33776884

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33776884

out(pub, ~M_33785190) with ~M_33785190 = dhexp(key_s(alice),g) at {109} in copy a_33776884

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33776884

out(pub, ~M_33785531) with ~M_33785531 = dhexp(key_s(alice),g) at {4} in copy a_33776884

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33776884

out(pub, (~M_33785672,~M_33785673,~M_33785674)) with ~M_33785672 = key_s(charlie), ~M_33785673 = key_e(charlie,alice), ~M_33785674 = key_e(charlie,bob) at {424} in copy a_33776883

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33776883

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33776883

out(pub, ~M_33786375) with ~M_33786375 = dhexp(key_s(alice),g) at {109} in copy a_33776883

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33776883

out(pub, ~M_33786716) with ~M_33786716 = dhexp(key_s(alice),g) at {4} in copy a_33776883

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33776883

out(pub, (~M_33786857,~M_33786858,~M_33786859)) with ~M_33786857 = key_s(charlie), ~M_33786858 = key_e(charlie,alice), ~M_33786859 = key_e(charlie,bob) at {424} in copy a_33776882

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33776882

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33776882

out(pub, ~M_33787560) with ~M_33787560 = dhexp(key_s(alice),g) at {109} in copy a_33776882

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33776882

out(pub, ~M_33787901) with ~M_33787901 = dhexp(key_s(alice),g) at {4} in copy a_33776882

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33776882

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33776883

in(pub, concat3(a_33776879,a_33776881,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33780450),a_33776879),a_33776880))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33780450),a_33776879),a_33776880) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),a_33776880) at {226} in copy a_33776883

event RecvMsg(bob,alice,stage_a,a_33776880,true) at {245} in copy a_33776883

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),a_33776880))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33776879,empty,false))) at {246} in copy a_33776883

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),a_33776880))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33776879,empty,false))) at {277} in copy a_33776884

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33776884

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33776879)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),a_33776879)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),a_33776880)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33776879)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),a_33776880)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),a_33776879,empty,false))) at {275} in copy a_33776884

out(pub, concat3(~M_33789601,empty,~M_33789603)) with ~M_33789601 = dhexp(key_e(bob,alice),g), ~M_33789603 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33776879)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33776879),a_33776880)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33776884

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33776888

in(pub, concat3(g,a_33776885,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33780450),g),a_33776878))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33780450),g),a_33776878) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33776878) at {226} in copy a_33776888

event RecvMsg(bob,alice,stage_a,a_33776878,true) at {245} in copy a_33776888

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33776878))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {246} in copy a_33776888

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33776878))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_33776889

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33776889

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33776878)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33776878)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {275} in copy a_33776889

out(pub, concat3(~M_33791181,empty,~M_33791183)) with ~M_33791181 = dhexp(key_e(bob,alice),g), ~M_33791183 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33776878)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33776889

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hash(somename,empty),~M_33789601),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33780450),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33780450),g),a_33776878)),~M_33789601),~M_33791183)) = msg_b(bob,alice) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || event(LeakS(phase1,alice)) is false.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob)))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

3. The attacker has some term plaintext_a_33791334.
attacker(plaintext_a_33791334).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
By 3, the attacker may know plaintext_a_33791334.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)).

15. The attacker has some term b_33791330.
attacker(b_33791330).

16. By 4, the attacker may know g.
By 15, the attacker may know b_33791330.
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334).
Using the function concat3 the attacker may obtain concat3(g,b_33791330,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)).
attacker(concat3(g,b_33791330,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334))).

17. By 1, the attacker may have the channel pub.
By 16, the attacker may have the message concat3(g,b_33791330,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_33791330,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334))).

18. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 2 may be read at get {247}.
The message concat3(g,b_33791330,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)) that may be sent on channel pub by 17 may be received at input {226}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

19. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 18 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

20. By 1, the attacker may have the channel pub.
By 19, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 20, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

23. The attacker has some term plaintext_a_33791267.
attacker(plaintext_a_33791267).

24. The attacker has some term re_33791283.
attacker(re_33791283).

25. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 24, the attacker may know re_33791283.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283)).

26. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 25, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283).
By 23, the attacker may know plaintext_a_33791267.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)).

27. The attacker has some term b_33791263.
attacker(b_33791263).

28. By 24, the attacker may know re_33791283.
By 27, the attacker may know b_33791263.
By 26, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267).
Using the function concat3 the attacker may obtain concat3(re_33791283,b_33791263,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)).
attacker(concat3(re_33791283,b_33791263,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(re_33791283,b_33791263,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)).
So the attacker may send this message on this channel.
mess(pub,concat3(re_33791283,b_33791263,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 22 may be read at get {247}.
The message concat3(re_33791283,b_33791263,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)) that may be sent on channel pub by 29 may be received at input {226}.
We have re_33791283 <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33791283,empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33791283,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33791283,empty,false))) that may be in a table by 30 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33791283)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33791283)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33791283)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33791283)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33791283)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33791283)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33791283),plaintext_a_33791267)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g))).

36. By 9, the attacker may know hash(somename,empty).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g))).

37. By 36, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)).
By 13, the attacker may know minnonce.
By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)).
By 21, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

38. By 37, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33791334)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice).
attacker(msg_b(bob,alice)).

39. By 38, the attacker may know msg_b(bob,alice).
So the attacker may know msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33794236,~M_33794237,~M_33794238)) with ~M_33794236 = key_s(charlie), ~M_33794237 = key_e(charlie,alice), ~M_33794238 = key_e(charlie,bob) at {424} in copy a_33791378

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33791378

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33791378

out(pub, ~M_33794939) with ~M_33794939 = dhexp(key_s(alice),g) at {109} in copy a_33791378

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33791378

out(pub, ~M_33795280) with ~M_33795280 = dhexp(key_s(alice),g) at {4} in copy a_33791378

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33791378

out(pub, (~M_33795421,~M_33795422,~M_33795423)) with ~M_33795421 = key_s(charlie), ~M_33795422 = key_e(charlie,alice), ~M_33795423 = key_e(charlie,bob) at {424} in copy a_33791377

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33791377

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33791377

out(pub, ~M_33796124) with ~M_33796124 = dhexp(key_s(alice),g) at {109} in copy a_33791377

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33791377

out(pub, ~M_33796465) with ~M_33796465 = dhexp(key_s(alice),g) at {4} in copy a_33791377

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33791377

out(pub, (~M_33796606,~M_33796607,~M_33796608)) with ~M_33796606 = key_s(charlie), ~M_33796607 = key_e(charlie,alice), ~M_33796608 = key_e(charlie,bob) at {424} in copy a_33791376

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33791376

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33791376

out(pub, ~M_33797309) with ~M_33797309 = dhexp(key_s(alice),g) at {109} in copy a_33791376

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33791376

out(pub, ~M_33797650) with ~M_33797650 = dhexp(key_s(alice),g) at {4} in copy a_33791376

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33791376

out(pub, (~M_33797791,~M_33797792,~M_33797793)) with ~M_33797791 = key_s(charlie), ~M_33797792 = key_e(charlie,alice), ~M_33797793 = key_e(charlie,bob) at {424} in copy a_33791375

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33791375

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33791375

out(pub, ~M_33798494) with ~M_33798494 = dhexp(key_s(alice),g) at {109} in copy a_33791375

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33791375

out(pub, ~M_33798835) with ~M_33798835 = dhexp(key_s(alice),g) at {4} in copy a_33791375

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33791375

out(pub, (~M_33798976,~M_33798977,~M_33798978)) with ~M_33798976 = key_s(charlie), ~M_33798977 = key_e(charlie,alice), ~M_33798978 = key_e(charlie,bob) at {424} in copy a_33791373

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33791373

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33791373

out(pub, ~M_33799679) with ~M_33799679 = dhexp(key_s(alice),g) at {109} in copy a_33791373

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33791373

out(pub, ~M_33800020) with ~M_33800020 = dhexp(key_s(alice),g) at {4} in copy a_33791373

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33791373

out(pub, (~M_33800161,~M_33800162,~M_33800163)) with ~M_33800161 = key_s(charlie), ~M_33800162 = key_e(charlie,alice), ~M_33800163 = key_e(charlie,bob) at {424} in copy a_33791372

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33791372

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33791372

out(pub, ~M_33800864) with ~M_33800864 = dhexp(key_s(alice),g) at {109} in copy a_33791372

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33791372

out(pub, ~M_33801205) with ~M_33801205 = dhexp(key_s(alice),g) at {4} in copy a_33791372

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33791372

out(pub, (~M_33801346,~M_33801347,~M_33801348)) with ~M_33801346 = key_s(charlie), ~M_33801347 = key_e(charlie,alice), ~M_33801348 = key_e(charlie,bob) at {424} in copy a_33791371

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33791371

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33791371

out(pub, ~M_33802049) with ~M_33802049 = dhexp(key_s(alice),g) at {109} in copy a_33791371

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33791371

out(pub, ~M_33802390) with ~M_33802390 = dhexp(key_s(alice),g) at {4} in copy a_33791371

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33791371

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33791372

in(pub, concat3(a_33791368,a_33791370,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33794939),a_33791368),a_33791369))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33794939),a_33791368),a_33791369) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),a_33791369) at {226} in copy a_33791372

event RecvMsg(bob,alice,stage_a,a_33791369,true) at {245} in copy a_33791372

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),a_33791369))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33791368,empty,false))) at {246} in copy a_33791372

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),a_33791369))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33791368,empty,false))) at {277} in copy a_33791373

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33791373

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33791368)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),a_33791368)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),a_33791369)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33791368)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),a_33791369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),a_33791368,empty,false))) at {275} in copy a_33791373

out(pub, concat3(~M_33804090,empty,~M_33804092)) with ~M_33804090 = dhexp(key_e(bob,alice),g), ~M_33804092 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33791368)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33791368),a_33791369)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33791373

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33791377

in(pub, concat3(g,a_33791374,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33794939),g),a_33791367))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33794939),g),a_33791367) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33791367) at {226} in copy a_33791377

event RecvMsg(bob,alice,stage_a,a_33791367,true) at {245} in copy a_33791377

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33791367))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {246} in copy a_33791377

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33791367))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_33791378

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33791378

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33791367)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33791367)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {275} in copy a_33791378

out(pub, concat3(~M_33805670,empty,~M_33805672)) with ~M_33805670 = dhexp(key_e(bob,alice),g), ~M_33805672 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33791367)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33791378

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hash(somename,empty),~M_33804090),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33794939),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33794939),g),a_33791367)),~M_33804090),~M_33805672)) = msg_b(bob,alice) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) || (event(LeakS(phase1,alice)) && event(LeakS(p,bob))) is false.
Starting query attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice))
goal reachable: begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> attacker_p1(msg_b(bob,alice))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

3. The attacker has some term plaintext_a_33805822.
attacker(plaintext_a_33805822).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

6. By 1, the attacker may have the channel pub.
By 5, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

7. Using the function empty the attacker may obtain empty.
attacker(empty).

8. Using the function somename the attacker may obtain somename.
attacker(somename).

9. By 8, the attacker may know somename.
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

10. By 9, the attacker may know hash(somename,empty).
By 7, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

11. By 10, the attacker may know hash(hash(somename,empty),empty).
By 6, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

12. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 4, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g)).

13. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

14. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
By 3, the attacker may know plaintext_a_33805822.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)).

15. The attacker has some term b_33805818.
attacker(b_33805818).

16. By 4, the attacker may know g.
By 15, the attacker may know b_33805818.
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822).
Using the function concat3 the attacker may obtain concat3(g,b_33805818,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)).
attacker(concat3(g,b_33805818,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822))).

17. By 1, the attacker may have the channel pub.
By 16, the attacker may have the message concat3(g,b_33805818,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_33805818,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822))).

18. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 2 may be read at get {247}.
The message concat3(g,b_33805818,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)) that may be sent on channel pub by 17 may be received at input {226}.
We have g <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false)))).

19. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) that may be in a table by 18 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

20. By 1, the attacker may have the channel pub.
By 19, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

21. By 20, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

22. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

23. The attacker has some term plaintext_a_33805755.
attacker(plaintext_a_33805755).

24. The attacker has some term re_33805771.
attacker(re_33805771).

25. By 11, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 24, the attacker may know re_33805771.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771)).

26. By 7, the attacker may know empty.
By 13, the attacker may know minnonce.
By 25, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771).
By 23, the attacker may know plaintext_a_33805755.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)).

27. The attacker has some term b_33805751.
attacker(b_33805751).

28. By 24, the attacker may know re_33805771.
By 27, the attacker may know b_33805751.
By 26, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755).
Using the function concat3 the attacker may obtain concat3(re_33805771,b_33805751,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)).
attacker(concat3(re_33805771,b_33805751,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755))).

29. By 1, the attacker may have the channel pub.
By 28, the attacker may have the message concat3(re_33805771,b_33805751,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)).
So the attacker may send this message on this channel.
mess(pub,concat3(re_33805771,b_33805751,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755))).

30. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 22 may be read at get {247}.
The message concat3(re_33805771,b_33805751,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)) that may be sent on channel pub by 29 may be received at input {226}.
We have re_33805771 <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33805771,empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33805771,empty,false)))).

31. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33805771,empty,false))) that may be in a table by 30 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33805771)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33805771)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

32. By 1, the attacker may have the channel pub.
By 31, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33805771)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33805771)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33805771)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

33. By 32, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33805771)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33805771),plaintext_a_33805755)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

34. By 12, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g).
By 14, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822))).

35. By 34, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g))).

36. By 9, the attacker may know hash(somename,empty).
By 33, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g))).

37. By 36, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)).
By 13, the attacker may know minnonce.
By 35, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)).
By 21, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

38. By 37, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),plaintext_a_33805822)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function 3-proj-aeadpack the attacker may obtain msg_b(bob,alice).
attacker(msg_b(bob,alice)).

39. By 38, the attacker may know msg_b(bob,alice).
So the attacker may know msg_b(bob,alice) in phase 1.
attacker_p1(msg_b(bob,alice)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33808724,~M_33808725,~M_33808726)) with ~M_33808724 = key_s(charlie), ~M_33808725 = key_e(charlie,alice), ~M_33808726 = key_e(charlie,bob) at {424} in copy a_33805866

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33805866

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33805866

out(pub, ~M_33809427) with ~M_33809427 = dhexp(key_s(alice),g) at {109} in copy a_33805866

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33805866

out(pub, ~M_33809768) with ~M_33809768 = dhexp(key_s(alice),g) at {4} in copy a_33805866

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33805866

out(pub, (~M_33809909,~M_33809910,~M_33809911)) with ~M_33809909 = key_s(charlie), ~M_33809910 = key_e(charlie,alice), ~M_33809911 = key_e(charlie,bob) at {424} in copy a_33805865

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33805865

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33805865

out(pub, ~M_33810612) with ~M_33810612 = dhexp(key_s(alice),g) at {109} in copy a_33805865

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33805865

out(pub, ~M_33810953) with ~M_33810953 = dhexp(key_s(alice),g) at {4} in copy a_33805865

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33805865

out(pub, (~M_33811094,~M_33811095,~M_33811096)) with ~M_33811094 = key_s(charlie), ~M_33811095 = key_e(charlie,alice), ~M_33811096 = key_e(charlie,bob) at {424} in copy a_33805864

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33805864

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33805864

out(pub, ~M_33811797) with ~M_33811797 = dhexp(key_s(alice),g) at {109} in copy a_33805864

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33805864

out(pub, ~M_33812138) with ~M_33812138 = dhexp(key_s(alice),g) at {4} in copy a_33805864

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33805864

out(pub, (~M_33812279,~M_33812280,~M_33812281)) with ~M_33812279 = key_s(charlie), ~M_33812280 = key_e(charlie,alice), ~M_33812281 = key_e(charlie,bob) at {424} in copy a_33805863

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33805863

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33805863

out(pub, ~M_33812982) with ~M_33812982 = dhexp(key_s(alice),g) at {109} in copy a_33805863

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33805863

out(pub, ~M_33813323) with ~M_33813323 = dhexp(key_s(alice),g) at {4} in copy a_33805863

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33805863

out(pub, (~M_33813464,~M_33813465,~M_33813466)) with ~M_33813464 = key_s(charlie), ~M_33813465 = key_e(charlie,alice), ~M_33813466 = key_e(charlie,bob) at {424} in copy a_33805861

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33805861

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33805861

out(pub, ~M_33814167) with ~M_33814167 = dhexp(key_s(alice),g) at {109} in copy a_33805861

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33805861

out(pub, ~M_33814508) with ~M_33814508 = dhexp(key_s(alice),g) at {4} in copy a_33805861

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33805861

out(pub, (~M_33814649,~M_33814650,~M_33814651)) with ~M_33814649 = key_s(charlie), ~M_33814650 = key_e(charlie,alice), ~M_33814651 = key_e(charlie,bob) at {424} in copy a_33805860

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33805860

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33805860

out(pub, ~M_33815352) with ~M_33815352 = dhexp(key_s(alice),g) at {109} in copy a_33805860

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33805860

out(pub, ~M_33815693) with ~M_33815693 = dhexp(key_s(alice),g) at {4} in copy a_33805860

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33805860

out(pub, (~M_33815834,~M_33815835,~M_33815836)) with ~M_33815834 = key_s(charlie), ~M_33815835 = key_e(charlie,alice), ~M_33815836 = key_e(charlie,bob) at {424} in copy a_33805859

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33805859

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33805859

out(pub, ~M_33816537) with ~M_33816537 = dhexp(key_s(alice),g) at {109} in copy a_33805859

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33805859

out(pub, ~M_33816878) with ~M_33816878 = dhexp(key_s(alice),g) at {4} in copy a_33805859

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33805859

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33805860

in(pub, concat3(a_33805856,a_33805858,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33809427),a_33805856),a_33805857))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33809427),a_33805856),a_33805857) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),a_33805857) at {226} in copy a_33805860

event RecvMsg(bob,alice,stage_a,a_33805857,true) at {245} in copy a_33805860

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),a_33805857))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33805856,empty,false))) at {246} in copy a_33805860

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),a_33805857))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33805856,empty,false))) at {277} in copy a_33805861

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33805861

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33805856)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),a_33805856)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),a_33805857)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33805856)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),a_33805857)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),a_33805856,empty,false))) at {275} in copy a_33805861

out(pub, concat3(~M_33818578,empty,~M_33818580)) with ~M_33818578 = dhexp(key_e(bob,alice),g), ~M_33818580 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33805856)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33805856),a_33805857)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33805861

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33805865

in(pub, concat3(g,a_33805862,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33809427),g),a_33805855))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33809427),g),a_33805855) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33805855) at {226} in copy a_33805865

event RecvMsg(bob,alice,stage_a,a_33805855,true) at {245} in copy a_33805865

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33805855))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {246} in copy a_33805865

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33805855))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),g,empty,false))) at {277} in copy a_33805866

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33805866

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33805855)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33805855)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),g,empty,false))) at {275} in copy a_33805866

out(pub, concat3(~M_33820158,empty,~M_33820160)) with ~M_33820158 = dhexp(key_e(bob,alice),g), ~M_33820160 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),g),a_33805855)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33805866

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hash(somename,empty),~M_33818578),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33809427),g),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33809427),g),a_33805855)),~M_33818578),~M_33820160)) = msg_b(bob,alice) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_b(bob,alice)) ==> event(LeakS(phase0,alice)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true))
goal reachable: begin(LeakS(phase0,alice)) && attacker(m_33820162) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_33820162,true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. The attacker has some term plaintext_a_33820383.
attacker(plaintext_a_33820383).

3. Using the function pub the attacker may obtain pub.
attacker(pub).

4. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

5. By 3, the attacker may have the channel pub.
By 4, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

6. Using the function empty the attacker may obtain empty.
attacker(empty).

7. Using the function somename the attacker may obtain somename.
attacker(somename).

8. By 7, the attacker may know somename.
By 6, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

9. By 8, the attacker may know hash(somename,empty).
By 6, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

10. By 9, the attacker may know hash(hash(somename,empty),empty).
By 5, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

11. By 10, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 5, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g))).

12. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

13. By 6, the attacker may know empty.
By 12, the attacker may know minnonce.
By 11, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)).
By 2, the attacker may know plaintext_a_33820383.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)).

14. The attacker has some term b_33820379.
attacker(b_33820379).

15. By 5, the attacker may know dhexp(key_s(alice),g).
By 14, the attacker may know b_33820379.
By 13, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383).
Using the function concat3 the attacker may obtain concat3(dhexp(key_s(alice),g),b_33820379,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)).
attacker(concat3(dhexp(key_s(alice),g),b_33820379,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))).

16. By 3, the attacker may have the channel pub.
By 15, the attacker may have the message concat3(dhexp(key_s(alice),g),b_33820379,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)).
So the attacker may send this message on this channel.
mess(pub,concat3(dhexp(key_s(alice),g),b_33820379,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))).

17. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {247}.
The message concat3(dhexp(key_s(alice),g),b_33820379,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)) that may be sent on channel pub by 16 may be received at input {226}.
We have dhexp(key_s(alice),g) <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false)))).

18. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) that may be in a table by 17 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) may be inserted in a table at insert {275}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false)))).

19. We assume as hypothesis that
attacker(m_33820417).

20. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

21. The attacker has some term b_33820317.
attacker(b_33820317).

22. By 5, the attacker may know dhexp(key_s(alice),g).
By 21, the attacker may know b_33820317.
By 13, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383).
Using the function concat3 the attacker may obtain concat3(dhexp(key_s(alice),g),b_33820317,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)).
attacker(concat3(dhexp(key_s(alice),g),b_33820317,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))).

23. By 3, the attacker may have the channel pub.
By 22, the attacker may have the message concat3(dhexp(key_s(alice),g),b_33820317,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)).
So the attacker may send this message on this channel.
mess(pub,concat3(dhexp(key_s(alice),g),b_33820317,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))).

24. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 20 may be read at get {247}.
The message concat3(dhexp(key_s(alice),g),b_33820317,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)) that may be sent on channel pub by 23 may be received at input {226}.
We have dhexp(key_s(alice),g) <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false)))).

25. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) that may be in a table by 24 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

26. By 3, the attacker may have the channel pub.
By 25, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

27. By 26, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).

28. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

29. The attacker has some term plaintext_a_33820199.
attacker(plaintext_a_33820199).

30. The attacker has some term re_33820215.
attacker(re_33820215).

31. By 10, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 30, the attacker may know re_33820215.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215)).

32. By 6, the attacker may know empty.
By 12, the attacker may know minnonce.
By 31, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215).
By 29, the attacker may know plaintext_a_33820199.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)).

33. The attacker has some term b_33820195.
attacker(b_33820195).

34. By 30, the attacker may know re_33820215.
By 33, the attacker may know b_33820195.
By 32, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199).
Using the function concat3 the attacker may obtain concat3(re_33820215,b_33820195,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)).
attacker(concat3(re_33820215,b_33820195,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199))).

35. By 3, the attacker may have the channel pub.
By 34, the attacker may have the message concat3(re_33820215,b_33820195,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)).
So the attacker may send this message on this channel.
mess(pub,concat3(re_33820215,b_33820195,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199))).

36. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 28 may be read at get {247}.
The message concat3(re_33820215,b_33820195,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)) that may be sent on channel pub by 35 may be received at input {226}.
We have re_33820215 <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33820215,empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33820215,empty,false)))).

37. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),re_33820215,empty,false))) that may be in a table by 36 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33820215)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33820215)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

38. By 3, the attacker may have the channel pub.
By 37, the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33820215)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33820215)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33820215)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

39. By 38, the attacker may know concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),re_33820215)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),re_33820215),plaintext_a_33820199)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,alice),g).
attacker(dhexp(key_e(bob,alice),g)).

40. By 11, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)).
By 13, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383))).

41. By 40, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g))).

42. By 41, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)).
By 27, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

43. The event LeakS(phase0,alice) may be executed at {102}.
So the message key_s(alice) may be sent on channel pub at output {103}.
mess(pub,key_s(alice)).

44. By 3, the attacker may have the channel pub.
By 43, the message key_s(alice) may be sent on this channel.
So the attacker may obtain the message key_s(alice) by listening on this channel.
attacker(key_s(alice)).

45. By 44, the attacker may know key_s(alice).
By 39, the attacker may know dhexp(key_e(bob,alice),g).
Using the function dhexp the attacker may obtain dhexp(key_e(bob,alice),dhexp(key_s(alice),g)).
attacker(dhexp(key_e(bob,alice),dhexp(key_s(alice),g))).

46. By 8, the attacker may know hash(somename,empty).
By 45, the attacker may know dhexp(key_e(bob,alice),dhexp(key_s(alice),g)).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g)))).

47. By 46, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))).
By 45, the attacker may know dhexp(key_e(bob,alice),dhexp(key_s(alice),g)).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g)))).

48. By 47, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))).
By 12, the attacker may know minnonce.
By 42, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))).
By 19, the attacker may know m_33820417.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_33820417).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_33820417)).

49. The attacker has some term b_33820404.
attacker(b_33820404).

50. The attacker has some term a_33820403.
attacker(a_33820403).

51. By 50, the attacker may know a_33820403.
By 49, the attacker may know b_33820404.
By 48, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_33820417).
Using the function concat3 the attacker may obtain concat3(a_33820403,b_33820404,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_33820417)).
attacker(concat3(a_33820403,b_33820404,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_33820417))).

52. By 3, the attacker may have the channel pub.
By 51, the attacker may have the message concat3(a_33820403,b_33820404,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_33820417)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_33820403,b_33820404,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_33820417))).

53. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) that may be in a table by 18 may be read at get {312}.
The message concat3(a_33820403,b_33820404,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),plaintext_a_33820383)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),m_33820417)) that may be sent on channel pub by 52 may be received at input {278}.
So event RecvMsg(bob,alice,stage_c,m_33820417,true) may be executed at {309}.
end(RecvMsg(bob,alice,stage_c,m_33820417,true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_33825308,~M_33825309,~M_33825310)) with ~M_33825308 = key_s(charlie), ~M_33825309 = key_e(charlie,alice), ~M_33825310 = key_e(charlie,bob) at {424} in copy a_33820438

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820438

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820438

out(pub, ~M_33826011) with ~M_33826011 = dhexp(key_s(alice),g) at {109} in copy a_33820438

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820438

out(pub, ~M_33826352) with ~M_33826352 = dhexp(key_s(alice),g) at {4} in copy a_33820438

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820438

out(pub, (~M_33826493,~M_33826494,~M_33826495)) with ~M_33826493 = key_s(charlie), ~M_33826494 = key_e(charlie,alice), ~M_33826495 = key_e(charlie,bob) at {424} in copy a_33820437

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820437

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820437

out(pub, ~M_33827196) with ~M_33827196 = dhexp(key_s(alice),g) at {109} in copy a_33820437

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820437

out(pub, ~M_33827537) with ~M_33827537 = dhexp(key_s(alice),g) at {4} in copy a_33820437

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820437

out(pub, (~M_33827678,~M_33827679,~M_33827680)) with ~M_33827678 = key_s(charlie), ~M_33827679 = key_e(charlie,alice), ~M_33827680 = key_e(charlie,bob) at {424} in copy a_33820436

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820436

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820436

out(pub, ~M_33828381) with ~M_33828381 = dhexp(key_s(alice),g) at {109} in copy a_33820436

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820436

out(pub, ~M_33828722) with ~M_33828722 = dhexp(key_s(alice),g) at {4} in copy a_33820436

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820436

out(pub, (~M_33828863,~M_33828864,~M_33828865)) with ~M_33828863 = key_s(charlie), ~M_33828864 = key_e(charlie,alice), ~M_33828865 = key_e(charlie,bob) at {424} in copy a_33820435

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820435

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820435

out(pub, ~M_33829566) with ~M_33829566 = dhexp(key_s(alice),g) at {109} in copy a_33820435

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820435

out(pub, ~M_33829907) with ~M_33829907 = dhexp(key_s(alice),g) at {4} in copy a_33820435

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820435

out(pub, (~M_33830048,~M_33830049,~M_33830050)) with ~M_33830048 = key_s(charlie), ~M_33830049 = key_e(charlie,alice), ~M_33830050 = key_e(charlie,bob) at {424} in copy a_33820434

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820434

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820434

out(pub, ~M_33830751) with ~M_33830751 = dhexp(key_s(alice),g) at {109} in copy a_33820434

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820434

out(pub, ~M_33831092) with ~M_33831092 = dhexp(key_s(alice),g) at {4} in copy a_33820434

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820434

out(pub, (~M_33831233,~M_33831234,~M_33831235)) with ~M_33831233 = key_s(charlie), ~M_33831234 = key_e(charlie,alice), ~M_33831235 = key_e(charlie,bob) at {424} in copy a_33820432

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820432

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820432

out(pub, ~M_33831936) with ~M_33831936 = dhexp(key_s(alice),g) at {109} in copy a_33820432

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820432

out(pub, ~M_33832277) with ~M_33832277 = dhexp(key_s(alice),g) at {4} in copy a_33820432

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820432

out(pub, (~M_33832418,~M_33832419,~M_33832420)) with ~M_33832418 = key_s(charlie), ~M_33832419 = key_e(charlie,alice), ~M_33832420 = key_e(charlie,bob) at {424} in copy a_33820431

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820431

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820431

out(pub, ~M_33833121) with ~M_33833121 = dhexp(key_s(alice),g) at {109} in copy a_33820431

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820431

out(pub, ~M_33833462) with ~M_33833462 = dhexp(key_s(alice),g) at {4} in copy a_33820431

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820431

out(pub, (~M_33833603,~M_33833604,~M_33833605)) with ~M_33833603 = key_s(charlie), ~M_33833604 = key_e(charlie,alice), ~M_33833605 = key_e(charlie,bob) at {424} in copy a_33820430

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820430

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820430

out(pub, ~M_33834306) with ~M_33834306 = dhexp(key_s(alice),g) at {109} in copy a_33820430

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820430

out(pub, ~M_33834647) with ~M_33834647 = dhexp(key_s(alice),g) at {4} in copy a_33820430

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820430

out(pub, (~M_33834788,~M_33834789,~M_33834790)) with ~M_33834788 = key_s(charlie), ~M_33834789 = key_e(charlie,alice), ~M_33834790 = key_e(charlie,bob) at {424} in copy a_33820428

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820428

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820428

out(pub, ~M_33835491) with ~M_33835491 = dhexp(key_s(alice),g) at {109} in copy a_33820428

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820428

out(pub, ~M_33835832) with ~M_33835832 = dhexp(key_s(alice),g) at {4} in copy a_33820428

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820428

out(pub, (~M_33835973,~M_33835974,~M_33835975)) with ~M_33835973 = key_s(charlie), ~M_33835974 = key_e(charlie,alice), ~M_33835975 = key_e(charlie,bob) at {424} in copy a_33820427

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820427

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820427

out(pub, ~M_33836676) with ~M_33836676 = dhexp(key_s(alice),g) at {109} in copy a_33820427

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820427

out(pub, ~M_33837017) with ~M_33837017 = dhexp(key_s(alice),g) at {4} in copy a_33820427

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820427

out(pub, (~M_33837158,~M_33837159,~M_33837160)) with ~M_33837158 = key_s(charlie), ~M_33837159 = key_e(charlie,alice), ~M_33837160 = key_e(charlie,bob) at {424} in copy a_33820426

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820426

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820426

out(pub, ~M_33837861) with ~M_33837861 = dhexp(key_s(alice),g) at {109} in copy a_33820426

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820426

out(pub, ~M_33838202) with ~M_33838202 = dhexp(key_s(alice),g) at {4} in copy a_33820426

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820426

out(pub, (~M_33838343,~M_33838344,~M_33838345)) with ~M_33838343 = key_s(charlie), ~M_33838344 = key_e(charlie,alice), ~M_33838345 = key_e(charlie,bob) at {424} in copy a_33820422

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_33820422

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_33820422

out(pub, ~M_33839046) with ~M_33839046 = dhexp(key_s(alice),g) at {109} in copy a_33820422

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_33820422

out(pub, ~M_33839387) with ~M_33839387 = dhexp(key_s(alice),g) at {4} in copy a_33820422

event LeakS(phase0,alice) at {102} in copy a_33820422

out(pub, ~M_33839389) with ~M_33839389 = key_s(alice) at {103} in copy a_33820422

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_33820422

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33820427

in(pub, concat3(a_33820423,a_33820425,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33826011),a_33820423),a_33820424))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33826011),a_33820423),a_33820424) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),a_33820424) at {226} in copy a_33820427

event RecvMsg(bob,alice,stage_a,a_33820424,true) at {245} in copy a_33820427

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),a_33820424))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33820423,empty,false))) at {246} in copy a_33820427

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),a_33820424))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),a_33820423,empty,false))) at {277} in copy a_33820428

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33820428

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33820423)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),a_33820423)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),a_33820424)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33820423)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),a_33820424)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),a_33820423,empty,false))) at {275} in copy a_33820428

out(pub, concat3(~M_33841101,empty,~M_33841103)) with ~M_33841101 = dhexp(key_e(bob,alice),g), ~M_33841103 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),a_33820423)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),a_33820423),a_33820424)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33820428

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33820431

in(pub, concat3(~M_33826011,a_33820429,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33826011),~M_33826011),a_33820421))) with ~M_33826011 = dhexp(key_s(alice),g), encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33826011),~M_33826011),a_33820421) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421) at {226} in copy a_33820431

event RecvMsg(bob,alice,stage_a,a_33820421,true) at {245} in copy a_33820431

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) at {246} in copy a_33820431

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) at {277} in copy a_33820432

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33820432

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) at {275} in copy a_33820432

out(pub, concat3(~M_33842669,empty,~M_33842671)) with ~M_33842669 = dhexp(key_e(bob,alice),g), ~M_33842671 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33820432

get statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {247} in copy a_33820436

in(pub, concat3(~M_33826011,a_33820433,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33826011),~M_33826011),a_33820421))) with ~M_33826011 = dhexp(key_s(alice),g), encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33826011),~M_33826011),a_33820421) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421) at {226} in copy a_33820436

event RecvMsg(bob,alice,stage_a,a_33820421,true) at {245} in copy a_33820436

insert statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) at {246} in copy a_33820436

get statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) at {277} in copy a_33820437

event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) at {274} in copy a_33820437

insert statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) at {275} in copy a_33820437

out(pub, concat3(~M_33844249,empty,~M_33844251)) with ~M_33844249 = dhexp(key_e(bob,alice),g), ~M_33844251 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)) at {276} in copy a_33820437

get statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_s(alice),g),empty,false))) at {312} in copy a_33820438

in(pub, concat3(a_33820419,a_33820420,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_33839389,~M_33841101)),dhexp(~M_33839389,~M_33841101)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33826011),~M_33826011),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33826011),~M_33826011),a_33820421)),~M_33841101),~M_33842671),a_33820418))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_33839389,~M_33841101)),dhexp(~M_33839389,~M_33841101)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_33826011),~M_33826011),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),~M_33826011),~M_33826011),a_33820421)),~M_33841101),~M_33842671),a_33820418) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_s(alice),g)),a_33820421)),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),a_33820418) at {278} in copy a_33820438

event RecvMsg(bob,alice,stage_c,a_33820418,true) at {309} in copy a_33820438 (goal)

The event RecvMsg(bob,alice,stage_c,a_33820418,true) is executed.
A trace has been found.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) is false.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: begin(LeakS(phase0,alice)) && attacker(m_33845621) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_33845621,true))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,bob),true))
goal reachable: begin(SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,charlie),true))
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) is true.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice))
goal reachable: begin(LeakS(phase0,alice)) && attacker(m_33845626) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) -> end(RecvMsg(bob,alice,stage_c,m_33845626,true))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,bob),true))
goal reachable: begin(SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,charlie),true))
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,c_881,stage_c,m,true)) || event(LeakS(phase0,alice)) is true.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob))
goal reachable: begin(SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,charlie),true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {121}.
table(statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {144}.
The event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true) may be executed at {141}.
So the message concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))) may be sent on channel pub at output {143}.
mess(pub,concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))).

4. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {247}.
The message concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))) that may be sent on channel pub by 3 may be received at input {226}.
We have dhexp(key_e(alice,charlie),g) <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false)))).

5. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) that may be in a table by 4 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) may be inserted in a table at insert {275}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false)))).

6. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {121}.
table(statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {144}.
The event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true) may be executed at {141}.
So the entry statestore(alice,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,empty,empty,true))) may be inserted in a table at insert {142}.
table(statestore(alice,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,empty,empty,true)))).

8. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

9. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {121}.
table(statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

10. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 9 may be read at get {144}.
The event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true) may be executed at {141}.
So the message concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))) may be sent on channel pub at output {143}.
mess(pub,concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))).

11. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 8 may be read at get {247}.
The message concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))) that may be sent on channel pub by 10 may be received at input {226}.
We have dhexp(key_e(alice,charlie),g) <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false)))).

12. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) that may be in a table by 11 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

13. The entry statestore(alice,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,empty,empty,true))) that may be in a table by 7 may be read at get {173}.
The message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) that may be sent on channel pub by 12 may be received at input {145}.
So the entry statestore(alice,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,dhexp(key_e(bob,alice),g),empty,true))) may be inserted in a table at insert {172}.
table(statestore(alice,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,dhexp(key_e(bob,alice),g),empty,true)))).

14. The entry statestore(alice,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,dhexp(key_e(bob,alice),g),empty,true))) that may be in a table by 13 may be read at get {206}.
The event SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true) may be executed at {203}.
So the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),msg_c(alice,charlie))) may be sent on channel pub at output {205}.
mess(pub,concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),msg_c(alice,charlie)))).

15. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) that may be in a table by 5 may be read at get {312}.
The message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),msg_c(alice,charlie))) that may be sent on channel pub by 14 may be received at input {278}.
So event RecvMsg(bob,alice,stage_c,msg_c(alice,charlie),true) may be executed at {309}.
end(RecvMsg(bob,alice,stage_c,msg_c(alice,charlie),true)).


Could not find a trace corresponding to this derivation.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) || event(LeakS(phase0,bob)) cannot be proved.
Starting query event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice))
goal reachable: begin(SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true)) && begin(SendMsg(bob,alice,stage_b,msg_b(bob,alice),true)) && begin(SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true)) -> end(RecvMsg(bob,alice,stage_c,msg_c(alice,charlie),true))

1. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

2. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {121}.
table(statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {144}.
The event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true) may be executed at {141}.
So the message concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))) may be sent on channel pub at output {143}.
mess(pub,concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))).

4. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 1 may be read at get {247}.
The message concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))) that may be sent on channel pub by 3 may be received at input {226}.
We have dhexp(key_e(alice,charlie),g) <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false)))).

5. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) that may be in a table by 4 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) may be inserted in a table at insert {275}.
table(statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false)))).

6. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {121}.
table(statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {144}.
The event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true) may be executed at {141}.
So the entry statestore(alice,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,empty,empty,true))) may be inserted in a table at insert {142}.
table(statestore(alice,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,empty,empty,true)))).

8. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) may be inserted in a table at insert {225}.
table(statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false)))).

9. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {121}.
table(statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

10. The entry statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 9 may be read at get {144}.
The event SendMsg(alice,charlie,stage_a,msg_a(alice,charlie),true) may be executed at {141}.
So the message concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))) may be sent on channel pub at output {143}.
mess(pub,concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))).

11. The entry statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) that may be in a table by 8 may be read at get {247}.
The message concat3(dhexp(key_e(alice,charlie),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))) that may be sent on channel pub by 10 may be received at input {226}.
We have dhexp(key_e(alice,charlie),g) <> caught-fail.
So the entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) may be inserted in a table at insert {246}.
table(statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false)))).

12. The entry statestore(bob,alice,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) that may be in a table by 11 may be read at get {277}.
The event SendMsg(bob,alice,stage_b,msg_b(bob,alice),true) may be executed at {274}.
So the message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) may be sent on channel pub at output {276}.
mess(pub,concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))).

13. The entry statestore(alice,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,empty,empty,true))) that may be in a table by 7 may be read at get {173}.
The message concat3(dhexp(key_e(bob,alice),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))) that may be sent on channel pub by 12 may be received at input {145}.
So the entry statestore(alice,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,dhexp(key_e(bob,alice),g),empty,true))) may be inserted in a table at insert {172}.
table(statestore(alice,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,dhexp(key_e(bob,alice),g),empty,true)))).

14. The entry statestore(alice,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,charlie),g),key_e(alice,charlie)),empty,dhexp(key_e(bob,alice),g),empty,true))) that may be in a table by 13 may be read at get {206}.
The event SendMsg(alice,charlie,stage_c,msg_c(alice,charlie),true) may be executed at {203}.
So the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),msg_c(alice,charlie))) may be sent on channel pub at output {205}.
mess(pub,concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),msg_c(alice,charlie)))).

15. The entry statestore(bob,alice,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,alice),g),key_e(bob,alice)),dhexp(key_s(alice),g),dhexp(key_e(alice,charlie),g),empty,false))) that may be in a table by 5 may be read at get {312}.
The message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,alice),dhexp(key_e(alice,charlie),g))),dhexp(key_e(bob,alice),dhexp(key_s(alice),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,charlie),dhexp(key_e(bob,alice),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,charlie),g)),msg_a(alice,charlie))),dhexp(key_e(bob,alice),g)),msg_b(bob,alice))),msg_c(alice,charlie))) that may be sent on channel pub by 14 may be received at input {278}.
So event RecvMsg(bob,alice,stage_c,msg_c(alice,charlie),true) may be executed at {309}.
end(RecvMsg(bob,alice,stage_c,msg_c(alice,charlie),true)).


Could not find a trace corresponding to this derivation.
RESULT event(RecvMsg(bob,alice,stage_c,m,true)) ==> event(SendMsg(alice,bob,stage_c,m,true)) || event(LeakS(phase0,alice)) cannot be proved.
Starting query not attacker_p1(msg_c(alice,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) may be inserted in a table at insert {37}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true)))).

4. The attacker has some term plaintext_b_45980319.
attacker(plaintext_b_45980319).

5. Using the function g the attacker may obtain g.
attacker(g).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 1, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

11. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

12. By 1, the attacker may have the channel pub.
By 11, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

13. Using the function empty the attacker may obtain empty.
attacker(empty).

14. Using the function somename the attacker may obtain somename.
attacker(somename).

15. By 14, the attacker may know somename.
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

16. By 15, the attacker may know hash(somename,empty).
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

17. By 16, the attacker may know hash(hash(somename,empty),empty).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

18. By 17, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

20. By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 5, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

21. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

22. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 21, the attacker may know minnonce.
By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 4, the attacker may know plaintext_b_45980319.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)).

24. The attacker has some term b_45980315.
attacker(b_45980315).

25. By 5, the attacker may know g.
By 24, the attacker may know b_45980315.
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319).
Using the function concat3 the attacker may obtain concat3(g,b_45980315,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)).
attacker(concat3(g,b_45980315,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319))).

26. By 1, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(g,b_45980315,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_45980315,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319))).

27. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) that may be in a table by 3 may be read at get {68}.
The message concat3(g,b_45980315,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)) that may be sent on channel pub by 26 may be received at input {40}.
We have g <> caught-fail.
So the entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) may be inserted in a table at insert {67}.
table(statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true)))).

28. The entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) that may be in a table by 27 may be read at get {101}.
The event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) may be executed at {98}.
So the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob))) may be sent on channel pub at output {100}.
mess(pub,concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob)))).

29. By 1, the attacker may have the channel pub.
By 28, the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob))) by listening on this channel.
attacker(concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob)))).

30. By 29, the attacker may know concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob))).

31. By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319))).

32. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g))).

33. By 32, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g))).

34. By 33, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
By 21, the attacker may know minnonce.
By 31, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)).
By 30, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob))).

35. By 34, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45980319)),msg_c(alice,bob)).
Using the function 3-proj-aeadpack the attacker may obtain msg_c(alice,bob).
attacker(msg_c(alice,bob)).

36. By 35, the attacker may know msg_c(alice,bob).
So the attacker may know msg_c(alice,bob) in phase 1.
attacker_p1(msg_c(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_45983222,~M_45983223,~M_45983224)) with ~M_45983222 = key_s(charlie), ~M_45983223 = key_e(charlie,alice), ~M_45983224 = key_e(charlie,bob) at {424} in copy a_45980360

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45980360

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45980360

out(pub, ~M_45983925) with ~M_45983925 = dhexp(key_s(alice),g) at {109} in copy a_45980360

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45980360

out(pub, ~M_45984266) with ~M_45984266 = dhexp(key_s(alice),g) at {4} in copy a_45980360

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45980360

out(pub, (~M_45984407,~M_45984408,~M_45984409)) with ~M_45984407 = key_s(charlie), ~M_45984408 = key_e(charlie,alice), ~M_45984409 = key_e(charlie,bob) at {424} in copy a_45980359

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45980359

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45980359

out(pub, ~M_45985110) with ~M_45985110 = dhexp(key_s(alice),g) at {109} in copy a_45980359

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45980359

out(pub, ~M_45985451) with ~M_45985451 = dhexp(key_s(alice),g) at {4} in copy a_45980359

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45980359

out(pub, (~M_45985592,~M_45985593,~M_45985594)) with ~M_45985592 = key_s(charlie), ~M_45985593 = key_e(charlie,alice), ~M_45985594 = key_e(charlie,bob) at {424} in copy a_45980358

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45980358

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45980358

out(pub, ~M_45986295) with ~M_45986295 = dhexp(key_s(alice),g) at {109} in copy a_45980358

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45980358

out(pub, ~M_45986636) with ~M_45986636 = dhexp(key_s(alice),g) at {4} in copy a_45980358

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45980358

out(pub, (~M_45986777,~M_45986778,~M_45986779)) with ~M_45986777 = key_s(charlie), ~M_45986778 = key_e(charlie,alice), ~M_45986779 = key_e(charlie,bob) at {424} in copy a_45980357

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45980357

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45980357

out(pub, ~M_45987480) with ~M_45987480 = dhexp(key_s(alice),g) at {109} in copy a_45980357

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45980357

out(pub, ~M_45987821) with ~M_45987821 = dhexp(key_s(alice),g) at {4} in copy a_45980357

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45980357

out(pub, (~M_45987962,~M_45987963,~M_45987964)) with ~M_45987962 = key_s(charlie), ~M_45987963 = key_e(charlie,alice), ~M_45987964 = key_e(charlie,bob) at {424} in copy a_45980356

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45980356

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45980356

out(pub, ~M_45988665) with ~M_45988665 = dhexp(key_s(alice),g) at {109} in copy a_45980356

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45980356

out(pub, ~M_45989006) with ~M_45989006 = dhexp(key_s(alice),g) at {4} in copy a_45980356

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45980356

out(pub, (~M_45989147,~M_45989148,~M_45989149)) with ~M_45989147 = key_s(charlie), ~M_45989148 = key_e(charlie,alice), ~M_45989149 = key_e(charlie,bob) at {424} in copy a_45980355

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45980355

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45980355

out(pub, ~M_45989850) with ~M_45989850 = dhexp(key_s(alice),g) at {109} in copy a_45980355

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45980355

out(pub, ~M_45990191) with ~M_45990191 = dhexp(key_s(alice),g) at {4} in copy a_45980355

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45980355

out(pub, (~M_45990332,~M_45990333,~M_45990334)) with ~M_45990332 = key_s(charlie), ~M_45990333 = key_e(charlie,alice), ~M_45990334 = key_e(charlie,bob) at {424} in copy a_45980354

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45980354

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45980354

out(pub, ~M_45991035) with ~M_45991035 = dhexp(key_s(alice),g) at {109} in copy a_45980354

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45980354

out(pub, ~M_45991376) with ~M_45991376 = dhexp(key_s(alice),g) at {4} in copy a_45980354

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45980354

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_45980356

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_45980356

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_45980356

out(pub, concat3(~M_45992074,empty,~M_45992076)) with ~M_45992074 = dhexp(key_e(alice,bob),g), ~M_45992076 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_45980356

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_45980358

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_45980358

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_45980358

out(pub, concat3(~M_45992635,empty,~M_45992637)) with ~M_45992635 = dhexp(key_e(alice,bob),g), ~M_45992637 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_45980358

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {68} in copy a_45980359

in(pub, concat3(g,a_45980353,encrypt(hmac_hash2(hash(somename,empty),~M_45992074),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_45983925),~M_45992074),~M_45992076),g),a_45980352))) with encrypt(hmac_hash2(hash(somename,empty),~M_45992074),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_45983925),~M_45992074),~M_45992076),g),a_45980352) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45980352) at {40} in copy a_45980359

event RecvMsg(alice,bob,stage_b,a_45980352,true) at {66} in copy a_45980359

insert statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45980352))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {67} in copy a_45980359

get statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45980352))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {101} in copy a_45980360

event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) at {98} in copy a_45980360

insert statestore(alice,bob,statepack_d(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45980352)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45980352)),msg_c(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {99} in copy a_45980360

out(pub, concat3(empty,empty,~M_45994833)) with ~M_45994833 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45980352)),msg_c(alice,bob)) at {100} in copy a_45980360

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_45992074),~M_45983925),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_45983925),~M_45992074),~M_45992076),g),encrypt(hmac_hash2(hash(somename,empty),~M_45992074),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_45983925),~M_45992074),~M_45992076),g),a_45980352)),~M_45994833)) = msg_c(alice,bob) in phase 1.
A trace has been found.
RESULT not attacker_p1(msg_c(alice,bob)) is false.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) may be inserted in a table at insert {37}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true)))).

4. The attacker has some term plaintext_b_45994989.
attacker(plaintext_b_45994989).

5. Using the function g the attacker may obtain g.
attacker(g).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 1, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

11. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

12. By 1, the attacker may have the channel pub.
By 11, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

13. Using the function empty the attacker may obtain empty.
attacker(empty).

14. Using the function somename the attacker may obtain somename.
attacker(somename).

15. By 14, the attacker may know somename.
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

16. By 15, the attacker may know hash(somename,empty).
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

17. By 16, the attacker may know hash(hash(somename,empty),empty).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

18. By 17, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

20. By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 5, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

21. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

22. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 21, the attacker may know minnonce.
By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 4, the attacker may know plaintext_b_45994989.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)).

24. The attacker has some term b_45994985.
attacker(b_45994985).

25. By 5, the attacker may know g.
By 24, the attacker may know b_45994985.
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989).
Using the function concat3 the attacker may obtain concat3(g,b_45994985,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)).
attacker(concat3(g,b_45994985,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989))).

26. By 1, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(g,b_45994985,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_45994985,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989))).

27. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) that may be in a table by 3 may be read at get {68}.
The message concat3(g,b_45994985,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)) that may be sent on channel pub by 26 may be received at input {40}.
We have g <> caught-fail.
So the entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) may be inserted in a table at insert {67}.
table(statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true)))).

28. The entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) that may be in a table by 27 may be read at get {101}.
The event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) may be executed at {98}.
So the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob))) may be sent on channel pub at output {100}.
mess(pub,concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob)))).

29. By 1, the attacker may have the channel pub.
By 28, the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob))) by listening on this channel.
attacker(concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob)))).

30. By 29, the attacker may know concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob))).

31. By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989))).

32. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g))).

33. By 32, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g))).

34. By 33, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
By 21, the attacker may know minnonce.
By 31, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)).
By 30, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob))).

35. By 34, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_45994989)),msg_c(alice,bob)).
Using the function 3-proj-aeadpack the attacker may obtain msg_c(alice,bob).
attacker(msg_c(alice,bob)).

36. By 35, the attacker may know msg_c(alice,bob).
So the attacker may know msg_c(alice,bob) in phase 1.
attacker_p1(msg_c(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_45997892,~M_45997893,~M_45997894)) with ~M_45997892 = key_s(charlie), ~M_45997893 = key_e(charlie,alice), ~M_45997894 = key_e(charlie,bob) at {424} in copy a_45995030

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45995030

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45995030

out(pub, ~M_45998595) with ~M_45998595 = dhexp(key_s(alice),g) at {109} in copy a_45995030

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45995030

out(pub, ~M_45998936) with ~M_45998936 = dhexp(key_s(alice),g) at {4} in copy a_45995030

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45995030

out(pub, (~M_45999077,~M_45999078,~M_45999079)) with ~M_45999077 = key_s(charlie), ~M_45999078 = key_e(charlie,alice), ~M_45999079 = key_e(charlie,bob) at {424} in copy a_45995029

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45995029

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45995029

out(pub, ~M_45999780) with ~M_45999780 = dhexp(key_s(alice),g) at {109} in copy a_45995029

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45995029

out(pub, ~M_46000121) with ~M_46000121 = dhexp(key_s(alice),g) at {4} in copy a_45995029

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45995029

out(pub, (~M_46000262,~M_46000263,~M_46000264)) with ~M_46000262 = key_s(charlie), ~M_46000263 = key_e(charlie,alice), ~M_46000264 = key_e(charlie,bob) at {424} in copy a_45995028

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45995028

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45995028

out(pub, ~M_46000965) with ~M_46000965 = dhexp(key_s(alice),g) at {109} in copy a_45995028

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45995028

out(pub, ~M_46001306) with ~M_46001306 = dhexp(key_s(alice),g) at {4} in copy a_45995028

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45995028

out(pub, (~M_46001447,~M_46001448,~M_46001449)) with ~M_46001447 = key_s(charlie), ~M_46001448 = key_e(charlie,alice), ~M_46001449 = key_e(charlie,bob) at {424} in copy a_45995027

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45995027

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45995027

out(pub, ~M_46002150) with ~M_46002150 = dhexp(key_s(alice),g) at {109} in copy a_45995027

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45995027

out(pub, ~M_46002491) with ~M_46002491 = dhexp(key_s(alice),g) at {4} in copy a_45995027

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45995027

out(pub, (~M_46002632,~M_46002633,~M_46002634)) with ~M_46002632 = key_s(charlie), ~M_46002633 = key_e(charlie,alice), ~M_46002634 = key_e(charlie,bob) at {424} in copy a_45995026

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45995026

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45995026

out(pub, ~M_46003335) with ~M_46003335 = dhexp(key_s(alice),g) at {109} in copy a_45995026

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45995026

out(pub, ~M_46003676) with ~M_46003676 = dhexp(key_s(alice),g) at {4} in copy a_45995026

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45995026

out(pub, (~M_46003817,~M_46003818,~M_46003819)) with ~M_46003817 = key_s(charlie), ~M_46003818 = key_e(charlie,alice), ~M_46003819 = key_e(charlie,bob) at {424} in copy a_45995025

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45995025

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45995025

out(pub, ~M_46004520) with ~M_46004520 = dhexp(key_s(alice),g) at {109} in copy a_45995025

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45995025

out(pub, ~M_46004861) with ~M_46004861 = dhexp(key_s(alice),g) at {4} in copy a_45995025

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45995025

out(pub, (~M_46005002,~M_46005003,~M_46005004)) with ~M_46005002 = key_s(charlie), ~M_46005003 = key_e(charlie,alice), ~M_46005004 = key_e(charlie,bob) at {424} in copy a_45995024

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_45995024

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_45995024

out(pub, ~M_46005705) with ~M_46005705 = dhexp(key_s(alice),g) at {109} in copy a_45995024

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_45995024

out(pub, ~M_46006046) with ~M_46006046 = dhexp(key_s(alice),g) at {4} in copy a_45995024

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_45995024

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_45995026

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_45995026

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_45995026

out(pub, concat3(~M_46006744,empty,~M_46006746)) with ~M_46006744 = dhexp(key_e(alice,bob),g), ~M_46006746 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_45995026

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_45995028

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_45995028

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_45995028

out(pub, concat3(~M_46007305,empty,~M_46007307)) with ~M_46007305 = dhexp(key_e(alice,bob),g), ~M_46007307 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_45995028

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {68} in copy a_45995029

in(pub, concat3(g,a_45995023,encrypt(hmac_hash2(hash(somename,empty),~M_46006744),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_45998595),~M_46006744),~M_46006746),g),a_45995022))) with encrypt(hmac_hash2(hash(somename,empty),~M_46006744),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_45998595),~M_46006744),~M_46006746),g),a_45995022) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45995022) at {40} in copy a_45995029

event RecvMsg(alice,bob,stage_b,a_45995022,true) at {66} in copy a_45995029

insert statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45995022))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {67} in copy a_45995029

get statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45995022))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {101} in copy a_45995030

event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) at {98} in copy a_45995030

insert statestore(alice,bob,statepack_d(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45995022)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45995022)),msg_c(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {99} in copy a_45995030

out(pub, concat3(empty,empty,~M_46009503)) with ~M_46009503 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_45995022)),msg_c(alice,bob)) at {100} in copy a_45995030

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_46006744),~M_45998595),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_45998595),~M_46006744),~M_46006746),g),encrypt(hmac_hash2(hash(somename,empty),~M_46006744),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_45998595),~M_46006744),~M_46006746),g),a_45995022)),~M_46009503)) = msg_c(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || event(LeakS(phase1,bob)) is false.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice)))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) may be inserted in a table at insert {37}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true)))).

4. The attacker has some term plaintext_b_46009660.
attacker(plaintext_b_46009660).

5. Using the function g the attacker may obtain g.
attacker(g).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 1, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

11. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

12. By 1, the attacker may have the channel pub.
By 11, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

13. Using the function empty the attacker may obtain empty.
attacker(empty).

14. Using the function somename the attacker may obtain somename.
attacker(somename).

15. By 14, the attacker may know somename.
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

16. By 15, the attacker may know hash(somename,empty).
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

17. By 16, the attacker may know hash(hash(somename,empty),empty).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

18. By 17, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

20. By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 5, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

21. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

22. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 21, the attacker may know minnonce.
By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 4, the attacker may know plaintext_b_46009660.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)).

24. The attacker has some term b_46009656.
attacker(b_46009656).

25. By 5, the attacker may know g.
By 24, the attacker may know b_46009656.
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660).
Using the function concat3 the attacker may obtain concat3(g,b_46009656,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)).
attacker(concat3(g,b_46009656,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660))).

26. By 1, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(g,b_46009656,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_46009656,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660))).

27. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) that may be in a table by 3 may be read at get {68}.
The message concat3(g,b_46009656,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)) that may be sent on channel pub by 26 may be received at input {40}.
We have g <> caught-fail.
So the entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) may be inserted in a table at insert {67}.
table(statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true)))).

28. The entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) that may be in a table by 27 may be read at get {101}.
The event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) may be executed at {98}.
So the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob))) may be sent on channel pub at output {100}.
mess(pub,concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob)))).

29. By 1, the attacker may have the channel pub.
By 28, the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob))) by listening on this channel.
attacker(concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob)))).

30. By 29, the attacker may know concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob))).

31. By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660))).

32. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g))).

33. By 32, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g))).

34. By 33, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
By 21, the attacker may know minnonce.
By 31, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)).
By 30, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob))).

35. By 34, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46009660)),msg_c(alice,bob)).
Using the function 3-proj-aeadpack the attacker may obtain msg_c(alice,bob).
attacker(msg_c(alice,bob)).

36. By 35, the attacker may know msg_c(alice,bob).
So the attacker may know msg_c(alice,bob) in phase 1.
attacker_p1(msg_c(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_46012563,~M_46012564,~M_46012565)) with ~M_46012563 = key_s(charlie), ~M_46012564 = key_e(charlie,alice), ~M_46012565 = key_e(charlie,bob) at {424} in copy a_46009701

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46009701

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46009701

out(pub, ~M_46013266) with ~M_46013266 = dhexp(key_s(alice),g) at {109} in copy a_46009701

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46009701

out(pub, ~M_46013607) with ~M_46013607 = dhexp(key_s(alice),g) at {4} in copy a_46009701

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46009701

out(pub, (~M_46013748,~M_46013749,~M_46013750)) with ~M_46013748 = key_s(charlie), ~M_46013749 = key_e(charlie,alice), ~M_46013750 = key_e(charlie,bob) at {424} in copy a_46009700

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46009700

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46009700

out(pub, ~M_46014451) with ~M_46014451 = dhexp(key_s(alice),g) at {109} in copy a_46009700

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46009700

out(pub, ~M_46014792) with ~M_46014792 = dhexp(key_s(alice),g) at {4} in copy a_46009700

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46009700

out(pub, (~M_46014933,~M_46014934,~M_46014935)) with ~M_46014933 = key_s(charlie), ~M_46014934 = key_e(charlie,alice), ~M_46014935 = key_e(charlie,bob) at {424} in copy a_46009699

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46009699

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46009699

out(pub, ~M_46015636) with ~M_46015636 = dhexp(key_s(alice),g) at {109} in copy a_46009699

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46009699

out(pub, ~M_46015977) with ~M_46015977 = dhexp(key_s(alice),g) at {4} in copy a_46009699

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46009699

out(pub, (~M_46016118,~M_46016119,~M_46016120)) with ~M_46016118 = key_s(charlie), ~M_46016119 = key_e(charlie,alice), ~M_46016120 = key_e(charlie,bob) at {424} in copy a_46009698

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46009698

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46009698

out(pub, ~M_46016821) with ~M_46016821 = dhexp(key_s(alice),g) at {109} in copy a_46009698

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46009698

out(pub, ~M_46017162) with ~M_46017162 = dhexp(key_s(alice),g) at {4} in copy a_46009698

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46009698

out(pub, (~M_46017303,~M_46017304,~M_46017305)) with ~M_46017303 = key_s(charlie), ~M_46017304 = key_e(charlie,alice), ~M_46017305 = key_e(charlie,bob) at {424} in copy a_46009697

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46009697

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46009697

out(pub, ~M_46018006) with ~M_46018006 = dhexp(key_s(alice),g) at {109} in copy a_46009697

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46009697

out(pub, ~M_46018347) with ~M_46018347 = dhexp(key_s(alice),g) at {4} in copy a_46009697

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46009697

out(pub, (~M_46018488,~M_46018489,~M_46018490)) with ~M_46018488 = key_s(charlie), ~M_46018489 = key_e(charlie,alice), ~M_46018490 = key_e(charlie,bob) at {424} in copy a_46009696

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46009696

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46009696

out(pub, ~M_46019191) with ~M_46019191 = dhexp(key_s(alice),g) at {109} in copy a_46009696

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46009696

out(pub, ~M_46019532) with ~M_46019532 = dhexp(key_s(alice),g) at {4} in copy a_46009696

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46009696

out(pub, (~M_46019673,~M_46019674,~M_46019675)) with ~M_46019673 = key_s(charlie), ~M_46019674 = key_e(charlie,alice), ~M_46019675 = key_e(charlie,bob) at {424} in copy a_46009695

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46009695

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46009695

out(pub, ~M_46020376) with ~M_46020376 = dhexp(key_s(alice),g) at {109} in copy a_46009695

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46009695

out(pub, ~M_46020717) with ~M_46020717 = dhexp(key_s(alice),g) at {4} in copy a_46009695

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46009695

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_46009697

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_46009697

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_46009697

out(pub, concat3(~M_46021415,empty,~M_46021417)) with ~M_46021415 = dhexp(key_e(alice,bob),g), ~M_46021417 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_46009697

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_46009699

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_46009699

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_46009699

out(pub, concat3(~M_46021976,empty,~M_46021978)) with ~M_46021976 = dhexp(key_e(alice,bob),g), ~M_46021978 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_46009699

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {68} in copy a_46009700

in(pub, concat3(g,a_46009694,encrypt(hmac_hash2(hash(somename,empty),~M_46021415),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_46013266),~M_46021415),~M_46021417),g),a_46009693))) with encrypt(hmac_hash2(hash(somename,empty),~M_46021415),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_46013266),~M_46021415),~M_46021417),g),a_46009693) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46009693) at {40} in copy a_46009700

event RecvMsg(alice,bob,stage_b,a_46009693,true) at {66} in copy a_46009700

insert statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46009693))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {67} in copy a_46009700

get statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46009693))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {101} in copy a_46009701

event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) at {98} in copy a_46009701

insert statestore(alice,bob,statepack_d(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46009693)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46009693)),msg_c(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {99} in copy a_46009701

out(pub, concat3(empty,empty,~M_46024174)) with ~M_46024174 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46009693)),msg_c(alice,bob)) at {100} in copy a_46009701

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_46021415),~M_46013266),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_46013266),~M_46021415),~M_46021417),g),encrypt(hmac_hash2(hash(somename,empty),~M_46021415),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_46013266),~M_46021415),~M_46021417),g),a_46009693)),~M_46024174)) = msg_c(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) || (event(LeakS(phase1,bob)) && event(LeakS(p,alice))) is false.
Starting query attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob))
goal reachable: begin(SendMsg(alice,bob,stage_c,msg_c(alice,bob),true)) && begin(SendMsg(alice,bob,stage_a,msg_a(alice,bob),true)) -> attacker_p1(msg_c(alice,bob))

1. Using the function pub the attacker may obtain pub.
attacker(pub).

2. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

3. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 2 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) may be inserted in a table at insert {37}.
table(statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true)))).

4. The attacker has some term plaintext_b_46024330.
attacker(plaintext_b_46024330).

5. Using the function g the attacker may obtain g.
attacker(g).

6. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) may be inserted in a table at insert {16}.
table(statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true)))).

7. The entry statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) that may be in a table by 6 may be read at get {39}.
The event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) may be executed at {36}.
So the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on channel pub at output {38}.
mess(pub,concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

8. By 1, the attacker may have the channel pub.
By 7, the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))) by listening on this channel.
attacker(concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

9. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).

10. By 8, the attacker may know concat3(dhexp(key_e(alice,bob),g),empty,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(alice,bob),g).
attacker(dhexp(key_e(alice,bob),g)).

11. The message dhexp(key_s(alice),g) may be sent on channel pub at output {4}.
mess(pub,dhexp(key_s(alice),g)).

12. By 1, the attacker may have the channel pub.
By 11, the message dhexp(key_s(alice),g) may be sent on this channel.
So the attacker may obtain the message dhexp(key_s(alice),g) by listening on this channel.
attacker(dhexp(key_s(alice),g)).

13. Using the function empty the attacker may obtain empty.
attacker(empty).

14. Using the function somename the attacker may obtain somename.
attacker(somename).

15. By 14, the attacker may know somename.
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

16. By 15, the attacker may know hash(somename,empty).
By 13, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

17. By 16, the attacker may know hash(hash(somename,empty),empty).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))).

18. By 17, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g))).

19. By 18, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)).
By 9, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))).

20. By 19, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))).
By 5, the attacker may know g.
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g)).

21. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

22. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g))).

23. By 22, the attacker may know hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 21, the attacker may know minnonce.
By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 4, the attacker may know plaintext_b_46024330.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)).

24. The attacker has some term b_46024326.
attacker(b_46024326).

25. By 5, the attacker may know g.
By 24, the attacker may know b_46024326.
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330).
Using the function concat3 the attacker may obtain concat3(g,b_46024326,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)).
attacker(concat3(g,b_46024326,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330))).

26. By 1, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(g,b_46024326,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)).
So the attacker may send this message on this channel.
mess(pub,concat3(g,b_46024326,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330))).

27. The entry statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) that may be in a table by 3 may be read at get {68}.
The message concat3(g,b_46024326,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)) that may be sent on channel pub by 26 may be received at input {40}.
We have g <> caught-fail.
So the entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) may be inserted in a table at insert {67}.
table(statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true)))).

28. The entry statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) that may be in a table by 27 may be read at get {101}.
The event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) may be executed at {98}.
So the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob))) may be sent on channel pub at output {100}.
mess(pub,concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob)))).

29. By 1, the attacker may have the channel pub.
By 28, the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob))) may be sent on this channel.
So the attacker may obtain the message concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob))) by listening on this channel.
attacker(concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob)))).

30. By 29, the attacker may know concat3(empty,empty,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob)).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob))).

31. By 20, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g).
By 23, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330))).

32. By 15, the attacker may know hash(somename,empty).
By 10, the attacker may know dhexp(key_e(alice,bob),g).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g))).

33. By 32, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)).
By 12, the attacker may know dhexp(key_s(alice),g).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g))).

34. By 33, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)).
By 21, the attacker may know minnonce.
By 31, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)).
By 30, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob)).
Using the function decrypt the attacker may obtain aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob)).
attacker(aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob))).

35. By 34, the attacker may know aeadpack(true,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),plaintext_b_46024330)),msg_c(alice,bob)).
Using the function 3-proj-aeadpack the attacker may obtain msg_c(alice,bob).
attacker(msg_c(alice,bob)).

36. By 35, the attacker may know msg_c(alice,bob).
So the attacker may know msg_c(alice,bob) in phase 1.
attacker_p1(msg_c(alice,bob)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_46027233,~M_46027234,~M_46027235)) with ~M_46027233 = key_s(charlie), ~M_46027234 = key_e(charlie,alice), ~M_46027235 = key_e(charlie,bob) at {424} in copy a_46024371

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46024371

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46024371

out(pub, ~M_46027936) with ~M_46027936 = dhexp(key_s(alice),g) at {109} in copy a_46024371

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46024371

out(pub, ~M_46028277) with ~M_46028277 = dhexp(key_s(alice),g) at {4} in copy a_46024371

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46024371

out(pub, (~M_46028418,~M_46028419,~M_46028420)) with ~M_46028418 = key_s(charlie), ~M_46028419 = key_e(charlie,alice), ~M_46028420 = key_e(charlie,bob) at {424} in copy a_46024370

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46024370

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46024370

out(pub, ~M_46029121) with ~M_46029121 = dhexp(key_s(alice),g) at {109} in copy a_46024370

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46024370

out(pub, ~M_46029462) with ~M_46029462 = dhexp(key_s(alice),g) at {4} in copy a_46024370

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46024370

out(pub, (~M_46029603,~M_46029604,~M_46029605)) with ~M_46029603 = key_s(charlie), ~M_46029604 = key_e(charlie,alice), ~M_46029605 = key_e(charlie,bob) at {424} in copy a_46024369

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46024369

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46024369

out(pub, ~M_46030306) with ~M_46030306 = dhexp(key_s(alice),g) at {109} in copy a_46024369

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46024369

out(pub, ~M_46030647) with ~M_46030647 = dhexp(key_s(alice),g) at {4} in copy a_46024369

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46024369

out(pub, (~M_46030788,~M_46030789,~M_46030790)) with ~M_46030788 = key_s(charlie), ~M_46030789 = key_e(charlie,alice), ~M_46030790 = key_e(charlie,bob) at {424} in copy a_46024368

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46024368

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46024368

out(pub, ~M_46031491) with ~M_46031491 = dhexp(key_s(alice),g) at {109} in copy a_46024368

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46024368

out(pub, ~M_46031832) with ~M_46031832 = dhexp(key_s(alice),g) at {4} in copy a_46024368

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46024368

out(pub, (~M_46031973,~M_46031974,~M_46031975)) with ~M_46031973 = key_s(charlie), ~M_46031974 = key_e(charlie,alice), ~M_46031975 = key_e(charlie,bob) at {424} in copy a_46024367

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46024367

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46024367

out(pub, ~M_46032676) with ~M_46032676 = dhexp(key_s(alice),g) at {109} in copy a_46024367

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46024367

out(pub, ~M_46033017) with ~M_46033017 = dhexp(key_s(alice),g) at {4} in copy a_46024367

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46024367

out(pub, (~M_46033158,~M_46033159,~M_46033160)) with ~M_46033158 = key_s(charlie), ~M_46033159 = key_e(charlie,alice), ~M_46033160 = key_e(charlie,bob) at {424} in copy a_46024366

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46024366

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46024366

out(pub, ~M_46033861) with ~M_46033861 = dhexp(key_s(alice),g) at {109} in copy a_46024366

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46024366

out(pub, ~M_46034202) with ~M_46034202 = dhexp(key_s(alice),g) at {4} in copy a_46024366

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46024366

out(pub, (~M_46034343,~M_46034344,~M_46034345)) with ~M_46034343 = key_s(charlie), ~M_46034344 = key_e(charlie,alice), ~M_46034345 = key_e(charlie,bob) at {424} in copy a_46024365

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46024365

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46024365

out(pub, ~M_46035046) with ~M_46035046 = dhexp(key_s(alice),g) at {109} in copy a_46024365

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46024365

out(pub, ~M_46035387) with ~M_46035387 = dhexp(key_s(alice),g) at {4} in copy a_46024365

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46024365

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_46024367

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_46024367

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_46024367

out(pub, concat3(~M_46036085,empty,~M_46036087)) with ~M_46036085 = dhexp(key_e(alice,bob),g), ~M_46036087 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_46024367

get statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {39} in copy a_46024369

event SendMsg(alice,bob,stage_a,msg_a(alice,bob),true) at {36} in copy a_46024369

insert statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {37} in copy a_46024369

out(pub, concat3(~M_46036646,empty,~M_46036648)) with ~M_46036646 = dhexp(key_e(alice,bob),g), ~M_46036648 = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)) at {38} in copy a_46024369

get statestore(alice,bob,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,empty,empty,true))) at {68} in copy a_46024370

in(pub, concat3(g,a_46024364,encrypt(hmac_hash2(hash(somename,empty),~M_46036085),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_46027936),~M_46036085),~M_46036087),g),a_46024363))) with encrypt(hmac_hash2(hash(somename,empty),~M_46036085),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_46027936),~M_46036085),~M_46036087),g),a_46024363) = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46024363) at {40} in copy a_46024370

event RecvMsg(alice,bob,stage_b,a_46024363,true) at {66} in copy a_46024370

insert statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46024363))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {67} in copy a_46024370

get statestore(alice,bob,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46024363))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {101} in copy a_46024371

event SendMsg(alice,bob,stage_c,msg_c(alice,bob),true) at {98} in copy a_46024371

insert statestore(alice,bob,statepack_d(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46024363)),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46024363)),msg_c(alice,bob)))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(dhexp(key_e(alice,bob),g),key_e(alice,bob)),empty,g,empty,true))) at {99} in copy a_46024371

out(pub, concat3(empty,empty,~M_46038844)) with ~M_46038844 = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(alice,bob),g)),dhexp(key_s(alice),g)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(alice,bob),g)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g)),dhexp(key_e(alice,bob),g)),msg_a(alice,bob))),g),a_46024363)),msg_c(alice,bob)) at {100} in copy a_46024371

The attacker has the message 3-proj-aeadpack(decrypt(hmac_hash2(hmac_hash1(hash(somename,empty),~M_46036085),~M_46027936),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_46027936),~M_46036085),~M_46036087),g),encrypt(hmac_hash2(hash(somename,empty),~M_46036085),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),~M_46027936),~M_46036085),~M_46036087),g),a_46024363)),~M_46038844)) = msg_c(alice,bob) in phase 1.
A trace has been found.
RESULT attacker_p1(msg_c(alice,bob)) ==> event(LeakS(phase0,bob)) is false.
Starting query not event(RecvEnd(true))
goal reachable: begin(SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true)) -> end(RecvEnd(true))

1. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false)))).

2. The attacker has some term plaintext_a_46039085.
attacker(plaintext_a_46039085).

3. Using the function g the attacker may obtain g.
attacker(g).

4. Using the function pub the attacker may obtain pub.
attacker(pub).

5. The message (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)) may be sent on channel pub at output {424}.
mess(pub,(key_s(charlie),key_e(charlie,alice),key_e(charlie,bob))).

6. By 4, the attacker may have the channel pub.
By 5, the message (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)) may be sent on this channel.
So the attacker may obtain the message (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)) by listening on this channel.
attacker((key_s(charlie),key_e(charlie,alice),key_e(charlie,bob))).

7. By 6, the attacker may know (key_s(charlie),key_e(charlie,alice),key_e(charlie,bob)).
Using the function 1-proj-3-tuple the attacker may obtain key_s(charlie).
attacker(key_s(charlie)).

8. By 7, the attacker may know key_s(charlie).
By 3, the attacker may know g.
Using the function dhexp the attacker may obtain dhexp(key_s(charlie),g).
attacker(dhexp(key_s(charlie),g)).

9. Using the function empty the attacker may obtain empty.
attacker(empty).

10. Using the function somename the attacker may obtain somename.
attacker(somename).

11. By 10, the attacker may know somename.
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(somename,empty).
attacker(hash(somename,empty)).

12. By 11, the attacker may know hash(somename,empty).
By 9, the attacker may know empty.
Using the function hash the attacker may obtain hash(hash(somename,empty),empty).
attacker(hash(hash(somename,empty),empty)).

13. By 12, the attacker may know hash(hash(somename,empty),empty).
By 8, the attacker may know dhexp(key_s(charlie),g).
Using the function hash the attacker may obtain hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)).
attacker(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))).

14. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)).
By 8, the attacker may know dhexp(key_s(charlie),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g))).

15. Using the function minnonce the attacker may obtain minnonce.
attacker(minnonce).

16. By 9, the attacker may know empty.
By 15, the attacker may know minnonce.
By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)).
By 2, the attacker may know plaintext_a_46039085.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)).

17. The attacker has some term b_46039081.
attacker(b_46039081).

18. By 8, the attacker may know dhexp(key_s(charlie),g).
By 17, the attacker may know b_46039081.
By 16, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085).
Using the function concat3 the attacker may obtain concat3(dhexp(key_s(charlie),g),b_46039081,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)).
attacker(concat3(dhexp(key_s(charlie),g),b_46039081,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))).

19. By 4, the attacker may have the channel pub.
By 18, the attacker may have the message concat3(dhexp(key_s(charlie),g),b_46039081,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)).
So the attacker may send this message on this channel.
mess(pub,concat3(dhexp(key_s(charlie),g),b_46039081,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))).

20. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) that may be in a table by 1 may be read at get {353}.
The message concat3(dhexp(key_s(charlie),g),b_46039081,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)) that may be sent on channel pub by 19 may be received at input {332}.
We have dhexp(key_s(charlie),g) <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) may be inserted in a table at insert {352}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false)))).

21. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) that may be in a table by 20 may be read at get {383}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {380}.
So the entry statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) may be inserted in a table at insert {381}.
table(statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false)))).

22. The attacker has some term plaintext_c_46039111.
attacker(plaintext_c_46039111).

23. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false)))).

24. The attacker has some term b_46039014.
attacker(b_46039014).

25. By 8, the attacker may know dhexp(key_s(charlie),g).
By 24, the attacker may know b_46039014.
By 16, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085).
Using the function concat3 the attacker may obtain concat3(dhexp(key_s(charlie),g),b_46039014,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)).
attacker(concat3(dhexp(key_s(charlie),g),b_46039014,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))).

26. By 4, the attacker may have the channel pub.
By 25, the attacker may have the message concat3(dhexp(key_s(charlie),g),b_46039014,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)).
So the attacker may send this message on this channel.
mess(pub,concat3(dhexp(key_s(charlie),g),b_46039014,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))).

27. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) that may be in a table by 23 may be read at get {353}.
The message concat3(dhexp(key_s(charlie),g),b_46039014,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)) that may be sent on channel pub by 26 may be received at input {332}.
We have dhexp(key_s(charlie),g) <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) may be inserted in a table at insert {352}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false)))).

28. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) that may be in a table by 27 may be read at get {383}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {380}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {382}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

29. By 4, the attacker may have the channel pub.
By 28, the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

30. By 29, the attacker may know concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
Using the function 3-proj-concat3 the attacker may obtain encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)).
attacker(encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).

31. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) may be inserted in a table at insert {331}.
table(statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false)))).

32. The attacker has some term plaintext_a_46038886.
attacker(plaintext_a_46038886).

33. The attacker has some term re_46038902.
attacker(re_46038902).

34. By 13, the attacker may know hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)).
By 33, the attacker may know re_46038902.
Using the function hash the attacker may obtain hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902).
attacker(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902)).

35. By 9, the attacker may know empty.
By 15, the attacker may know minnonce.
By 34, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902).
By 32, the attacker may know plaintext_a_46038886.
Using the function encrypt the attacker may obtain encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886).
attacker(encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)).

36. The attacker has some term b_46038882.
attacker(b_46038882).

37. By 33, the attacker may know re_46038902.
By 36, the attacker may know b_46038882.
By 35, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886).
Using the function concat3 the attacker may obtain concat3(re_46038902,b_46038882,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)).
attacker(concat3(re_46038902,b_46038882,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886))).

38. By 4, the attacker may have the channel pub.
By 37, the attacker may have the message concat3(re_46038902,b_46038882,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)).
So the attacker may send this message on this channel.
mess(pub,concat3(re_46038902,b_46038882,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886))).

39. The entry statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) that may be in a table by 31 may be read at get {353}.
The message concat3(re_46038902,b_46038882,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)) that may be sent on channel pub by 38 may be received at input {332}.
We have re_46038902 <> caught-fail.
So the entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),re_46038902,empty,false))) may be inserted in a table at insert {352}.
table(statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),re_46038902,empty,false)))).

40. The entry statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),re_46038902,empty,false))) that may be in a table by 39 may be read at get {383}.
The event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) may be executed at {380}.
So the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),re_46038902)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on channel pub at output {382}.
mess(pub,concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),re_46038902)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

41. By 4, the attacker may have the channel pub.
By 40, the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),re_46038902)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) may be sent on this channel.
So the attacker may obtain the message concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),re_46038902)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))) by listening on this channel.
attacker(concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),re_46038902)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

42. By 41, the attacker may know concat3(dhexp(key_e(bob,charlie),g),empty,encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),re_46038902)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),re_46038902),plaintext_a_46038886)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
Using the function 1-proj-concat3 the attacker may obtain dhexp(key_e(bob,charlie),g).
attacker(dhexp(key_e(bob,charlie),g)).

43. By 14, the attacker may know hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)).
By 16, the attacker may know encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)).
attacker(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085))).

44. By 43, the attacker may know hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)).
By 42, the attacker may know dhexp(key_e(bob,charlie),g).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)).
attacker(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g))).

45. By 44, the attacker may know hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)).
By 30, the attacker may know encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)).
Using the function hash the attacker may obtain hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
attacker(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))).

46. By 7, the attacker may know key_s(charlie).
By 42, the attacker may know dhexp(key_e(bob,charlie),g).
Using the function dhexp the attacker may obtain dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g)).
attacker(dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))).

47. By 11, the attacker may know hash(somename,empty).
By 46, the attacker may know dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g)).
Using the function hmac_hash1 the attacker may obtain hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))).
attacker(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g)))).

48. By 47, the attacker may know hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))).
By 46, the attacker may know dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g)).
Using the function hmac_hash2 the attacker may obtain hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))).
attacker(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g)))).

49. By 48, the attacker may know hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))).
By 15, the attacker may know minnonce.
By 45, the attacker may know hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))).
By 22, the attacker may know plaintext_c_46039111.
Using the function encrypt the attacker may obtain encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_46039111).
attacker(encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_46039111)).

50. The attacker has some term b_46039106.
attacker(b_46039106).

51. The attacker has some term a_46039105.
attacker(a_46039105).

52. By 51, the attacker may know a_46039105.
By 50, the attacker may know b_46039106.
By 49, the attacker may know encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_46039111).
Using the function concat3 the attacker may obtain concat3(a_46039105,b_46039106,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_46039111)).
attacker(concat3(a_46039105,b_46039106,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_46039111))).

53. By 4, the attacker may have the channel pub.
By 52, the attacker may have the message concat3(a_46039105,b_46039106,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_46039111)).
So the attacker may send this message on this channel.
mess(pub,concat3(a_46039105,b_46039106,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_46039111))).

54. The entry statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) that may be in a table by 21 may be read at get {418}.
The message concat3(a_46039105,b_46039106,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),plaintext_a_46039085)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),plaintext_c_46039111)) that may be sent on channel pub by 53 may be received at input {384}.
So event RecvEnd(true) may be executed at {417}.
end(RecvEnd(true)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(pub, (~M_46043612,~M_46043613,~M_46043614)) with ~M_46043612 = key_s(charlie), ~M_46043613 = key_e(charlie,alice), ~M_46043614 = key_e(charlie,bob) at {424} in copy a_46039138

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039138

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039138

out(pub, ~M_46044315) with ~M_46044315 = dhexp(key_s(alice),g) at {109} in copy a_46039138

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039138

out(pub, ~M_46044656) with ~M_46044656 = dhexp(key_s(alice),g) at {4} in copy a_46039138

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039138

out(pub, (~M_46044797,~M_46044798,~M_46044799)) with ~M_46044797 = key_s(charlie), ~M_46044798 = key_e(charlie,alice), ~M_46044799 = key_e(charlie,bob) at {424} in copy a_46039137

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039137

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039137

out(pub, ~M_46045500) with ~M_46045500 = dhexp(key_s(alice),g) at {109} in copy a_46039137

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039137

out(pub, ~M_46045841) with ~M_46045841 = dhexp(key_s(alice),g) at {4} in copy a_46039137

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039137

out(pub, (~M_46045982,~M_46045983,~M_46045984)) with ~M_46045982 = key_s(charlie), ~M_46045983 = key_e(charlie,alice), ~M_46045984 = key_e(charlie,bob) at {424} in copy a_46039136

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039136

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039136

out(pub, ~M_46046685) with ~M_46046685 = dhexp(key_s(alice),g) at {109} in copy a_46039136

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039136

out(pub, ~M_46047026) with ~M_46047026 = dhexp(key_s(alice),g) at {4} in copy a_46039136

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039136

out(pub, (~M_46047167,~M_46047168,~M_46047169)) with ~M_46047167 = key_s(charlie), ~M_46047168 = key_e(charlie,alice), ~M_46047169 = key_e(charlie,bob) at {424} in copy a_46039135

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039135

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039135

out(pub, ~M_46047870) with ~M_46047870 = dhexp(key_s(alice),g) at {109} in copy a_46039135

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039135

out(pub, ~M_46048211) with ~M_46048211 = dhexp(key_s(alice),g) at {4} in copy a_46039135

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039135

out(pub, (~M_46048352,~M_46048353,~M_46048354)) with ~M_46048352 = key_s(charlie), ~M_46048353 = key_e(charlie,alice), ~M_46048354 = key_e(charlie,bob) at {424} in copy a_46039134

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039134

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039134

out(pub, ~M_46049055) with ~M_46049055 = dhexp(key_s(alice),g) at {109} in copy a_46039134

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039134

out(pub, ~M_46049396) with ~M_46049396 = dhexp(key_s(alice),g) at {4} in copy a_46039134

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039134

out(pub, (~M_46049537,~M_46049538,~M_46049539)) with ~M_46049537 = key_s(charlie), ~M_46049538 = key_e(charlie,alice), ~M_46049539 = key_e(charlie,bob) at {424} in copy a_46039132

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039132

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039132

out(pub, ~M_46050240) with ~M_46050240 = dhexp(key_s(alice),g) at {109} in copy a_46039132

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039132

out(pub, ~M_46050581) with ~M_46050581 = dhexp(key_s(alice),g) at {4} in copy a_46039132

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039132

out(pub, (~M_46050722,~M_46050723,~M_46050724)) with ~M_46050722 = key_s(charlie), ~M_46050723 = key_e(charlie,alice), ~M_46050724 = key_e(charlie,bob) at {424} in copy a_46039131

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039131

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039131

out(pub, ~M_46051425) with ~M_46051425 = dhexp(key_s(alice),g) at {109} in copy a_46039131

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039131

out(pub, ~M_46051766) with ~M_46051766 = dhexp(key_s(alice),g) at {4} in copy a_46039131

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039131

out(pub, (~M_46051907,~M_46051908,~M_46051909)) with ~M_46051907 = key_s(charlie), ~M_46051908 = key_e(charlie,alice), ~M_46051909 = key_e(charlie,bob) at {424} in copy a_46039130

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039130

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039130

out(pub, ~M_46052610) with ~M_46052610 = dhexp(key_s(alice),g) at {109} in copy a_46039130

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039130

out(pub, ~M_46052951) with ~M_46052951 = dhexp(key_s(alice),g) at {4} in copy a_46039130

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039130

out(pub, (~M_46053092,~M_46053093,~M_46053094)) with ~M_46053092 = key_s(charlie), ~M_46053093 = key_e(charlie,alice), ~M_46053094 = key_e(charlie,bob) at {424} in copy a_46039128

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039128

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039128

out(pub, ~M_46053795) with ~M_46053795 = dhexp(key_s(alice),g) at {109} in copy a_46039128

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039128

out(pub, ~M_46054136) with ~M_46054136 = dhexp(key_s(alice),g) at {4} in copy a_46039128

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039128

out(pub, (~M_46054277,~M_46054278,~M_46054279)) with ~M_46054277 = key_s(charlie), ~M_46054278 = key_e(charlie,alice), ~M_46054279 = key_e(charlie,bob) at {424} in copy a_46039127

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039127

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039127

out(pub, ~M_46054980) with ~M_46054980 = dhexp(key_s(alice),g) at {109} in copy a_46039127

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039127

out(pub, ~M_46055321) with ~M_46055321 = dhexp(key_s(alice),g) at {4} in copy a_46039127

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039127

out(pub, (~M_46055462,~M_46055463,~M_46055464)) with ~M_46055462 = key_s(charlie), ~M_46055463 = key_e(charlie,alice), ~M_46055464 = key_e(charlie,bob) at {424} in copy a_46039126

insert statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {331} in copy a_46039126

insert statestore(bob,alice,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(alice),g),empty,empty,false))) at {225} in copy a_46039126

out(pub, ~M_46056165) with ~M_46056165 = dhexp(key_s(alice),g) at {109} in copy a_46039126

insert statestore(alice,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {121} in copy a_46039126

out(pub, ~M_46056506) with ~M_46056506 = dhexp(key_s(alice),g) at {4} in copy a_46039126

insert statestore(alice,bob,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(alice),g))),keypairpack(dhexp(key_s(alice),g),key_s(alice)),keypairpack(empty,empty),empty,empty,empty,true))) at {16} in copy a_46039126

get statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {353} in copy a_46039127

in(pub, concat3(a_46039123,a_46039125,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),a_46039123),a_46039124))) with encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),a_46039123),a_46039124) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),a_46039124) at {332} in copy a_46039127

event RecvMsg(bob,charlie,stage_a,a_46039124,true) at {351} in copy a_46039127

insert statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),a_46039124))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),a_46039123,empty,false))) at {352} in copy a_46039127

get statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),a_46039124))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),a_46039123,empty,false))) at {383} in copy a_46039128

event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) at {380} in copy a_46039128

insert statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),a_46039123)),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),a_46039123)),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),a_46039124)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),a_46039123)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),a_46039124)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),a_46039123,empty,false))) at {381} in copy a_46039128

out(pub, concat3(~M_46058209,empty,~M_46058211)) with ~M_46058209 = dhexp(key_e(bob,charlie),g), ~M_46058211 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),a_46039123)),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),a_46039123),a_46039124)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)) at {382} in copy a_46039128

get statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {353} in copy a_46039131

in(pub, concat3(dhexp(~M_46043612,g),a_46039129,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),dhexp(~M_46043612,g)),a_46039121))) with dhexp(~M_46043612,g) = dhexp(key_s(charlie),g), encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),dhexp(~M_46043612,g)),a_46039121) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121) at {332} in copy a_46039131

event RecvMsg(bob,charlie,stage_a,a_46039121,true) at {351} in copy a_46039131

insert statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) at {352} in copy a_46039131

get statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) at {383} in copy a_46039132

event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) at {380} in copy a_46039132

insert statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) at {381} in copy a_46039132

out(pub, concat3(~M_46059777,empty,~M_46059779)) with ~M_46059777 = dhexp(key_e(bob,charlie),g), ~M_46059779 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)) at {382} in copy a_46039132

get statestore(bob,charlie,statepack_a(handshakestatepack(symmetricstatepack(cipherstatepack(empty,minnonce),hash(somename,empty),hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),empty,empty,false))) at {353} in copy a_46039136

in(pub, concat3(dhexp(~M_46043612,g),a_46039133,encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),dhexp(~M_46043612,g)),a_46039121))) with dhexp(~M_46043612,g) = dhexp(key_s(charlie),g), encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),dhexp(~M_46043612,g)),a_46039121) = encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121) at {332} in copy a_46039136

event RecvMsg(bob,charlie,stage_a,a_46039121,true) at {351} in copy a_46039136

insert statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) at {352} in copy a_46039136

get statestore(bob,charlie,statepack_b(handshakestatepack(symmetricstatepack(cipherstatepack(empty,increment_nonce(minnonce)),hash(somename,empty),hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121))),keypairpack(empty,empty),keypairpack(empty,empty),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) at {383} in copy a_46039137

event SendMsg(bob,charlie,stage_b,msg_b(bob,charlie),true) at {380} in copy a_46039137

insert statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) at {381} in copy a_46039137

out(pub, concat3(~M_46061357,empty,~M_46061359)) with ~M_46061357 = dhexp(key_e(bob,charlie),g), ~M_46061359 = encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)) at {382} in copy a_46039137

get statestore(bob,charlie,statepack_c(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),increment_nonce(minnonce)),hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie)))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) at {418} in copy a_46039138

in(pub, concat3(a_46039119,a_46039120,encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_46043612,~M_46058209)),dhexp(~M_46043612,~M_46058209)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),dhexp(~M_46043612,g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),dhexp(~M_46043612,g)),a_46039121)),~M_46058209),~M_46059779),a_46039122))) with encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(~M_46043612,~M_46058209)),dhexp(~M_46043612,~M_46058209)),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),dhexp(~M_46043612,g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(~M_46043612,g)),dhexp(~M_46043612,g)),a_46039121)),~M_46058209),~M_46059779),a_46039122) = encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),a_46039122) at {384} in copy a_46039138

event RecvMsg(bob,charlie,stage_c,a_46039122,true) at {415} in copy a_46039138

insert statestore(bob,charlie,statepack_d(handshakestatepack(symmetricstatepack(cipherstatepack(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),increment_nonce(minnonce)),hmac_hash1(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),hash(hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),encrypt(hmac_hash2(hmac_hash1(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),encrypt(hmac_hash2(hash(somename,empty),dhexp(key_e(bob,charlie),dhexp(key_s(charlie),g))),minnonce,hash(hash(hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),encrypt(empty,minnonce,hash(hash(hash(hash(somename,empty),empty),dhexp(key_s(charlie),g)),dhexp(key_s(charlie),g)),a_46039121)),dhexp(key_e(bob,charlie),g)),msg_b(bob,charlie))),a_46039122))),keypairpack(empty,empty),keypairpack(dhexp(key_e(bob,charlie),g),key_e(bob,charlie)),dhexp(key_s(charlie),g),dhexp(key_s(charlie),g),empty,false))) at {416} in copy a_46039138

event RecvEnd(true) at {417} in copy a_46039138 (goal)

The event RecvEnd(true) is executed.
A trace has been found.
RESULT not event(RecvEnd(true)) is false.
